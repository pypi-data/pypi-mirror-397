"use strict";(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[5316],{15836(t,e,s){s.d(e,{$Y:()=>l,AH:()=>o,Mh:()=>d,bv:()=>r,uQ:()=>a,xg:()=>u});var i=s(36549);const n="numbering-entry";function a(t,e,s=[]){const n={...i.MB.defaultConfig,...e},a=s;let o=a.length;const r=new Array;for(const e of t){if(e.skip)continue;const t=e.level;if(t>0&&t<=n.maximalDepth){const s=l(t,o,a,n);o=t,r.push({...e,prefix:s})}}return r}function o(t){return"text/html"===t}function r(t,e=!0){var s;const i=document.createElement("div");i.innerHTML=t;const n=new Array,a=i.querySelectorAll("h1, h2, h3, h4, h5, h6");for(const t of a){const e=parseInt(t.tagName[1],10);n.push({text:null!==(s=t.textContent)&&void 0!==s?s:"",level:e,id:null==t?void 0:t.getAttribute("id"),skip:t.classList.contains("jp-toc-ignore")||t.classList.contains("tocSkip")})}return n}function d(t,e,s){let i=t.querySelector(e);if(!i)return null;if(i.querySelector(`span.${n}`)){const a=t.querySelectorAll(e);for(const t of a)if(!t.querySelector(`span.${n}`)){i=t,h(t,s);break}}else h(i,s);return i}function l(t,e,s,i){const{baseNumbering:n,numberingH1:a,numberHeaders:o}=i;let r="";if(o){const i=a?1:2;if(t>e){for(let i=e;i<t-1;i++)s[i]=0;s[t-1]=t===i?n:1}else s[t-1]+=1,t<e&&s.splice(t);a?r=s.map(t=>null!=t?t:0).join(".")+". ":s.length>1&&(r=s.slice(1).map(t=>null!=t?t:0).join(".")+". ")}return r}function h(t,e){t.insertAdjacentHTML("afterbegin",`<span class="${n}">${e}</span>`)}function u(t){null==t||t.querySelectorAll(`span.${n}`).forEach(t=>{t.remove()})}},24877(t,e,s){s.d(e,{DJ:()=>_,MU:()=>u,Pz:()=>l,Xr:()=>m,mT:()=>g,xW:()=>h});var i=s(30427),n=s(52334),a=s(86012),o=s(51700),r=s(69325);const d=(0,r.createMutex)();function l(t){return"code"===t.type}function h(t){return"markdown"===t.type}function u(t){return"raw"===t.type}class c extends a.CodeEditor.Model{constructor(t={}){const{cell_type:e,sharedModel:s,...n}=t;super({sharedModel:null!=s?s:(0,r.createStandaloneCell)({cell_type:null!=e?e:"raw",id:t.id}),...n}),this.contentChanged=new i.Signal(this),this.stateChanged=new i.Signal(this),this._metadataChanged=new i.Signal(this),this._trusted=!1,this.standaloneModel=void 0===t.sharedModel,this.trusted=!!this.getMetadata("trusted")||!!t.trusted,this.sharedModel.changed.connect(this.onGenericChange,this),this.sharedModel.metadataChanged.connect(this._onMetadataChanged,this)}get metadataChanged(){return this._metadataChanged}get id(){return this.sharedModel.getId()}get metadata(){return this.sharedModel.metadata}get trusted(){return this._trusted}set trusted(t){const e=this.trusted;e!==t&&(this._trusted=t,this.onTrustedChanged(this,{newValue:t,oldValue:e}))}dispose(){this.isDisposed||(this.sharedModel.changed.disconnect(this.onGenericChange,this),this.sharedModel.metadataChanged.disconnect(this._onMetadataChanged,this),super.dispose())}onTrustedChanged(t,e){}deleteMetadata(t){return this.sharedModel.deleteMetadata(t)}getMetadata(t){return this.sharedModel.getMetadata(t)}setMetadata(t,e){void 0===e?this.sharedModel.deleteMetadata(t):this.sharedModel.setMetadata(t,e)}toJSON(){return this.sharedModel.toJSON()}onGenericChange(){this.contentChanged.emit(void 0)}_onMetadataChanged(t,e){this._metadataChanged.emit(e)}}class p extends c{constructor(t){var e;super(t);const s=null!==(e=t.contentFactory)&&void 0!==e?e:p.defaultContentFactory,i=this.sharedModel.getAttachments();this._attachments=s.createAttachmentsModel({values:i}),this._attachments.stateChanged.connect(this.onGenericChange,this),this._attachments.changed.connect(this._onAttachmentsChange,this),this.sharedModel.changed.connect(this._onSharedModelChanged,this)}get attachments(){return this._attachments}dispose(){this.isDisposed||(this._attachments.stateChanged.disconnect(this.onGenericChange,this),this._attachments.changed.disconnect(this._onAttachmentsChange,this),this._attachments.dispose(),this.sharedModel.changed.disconnect(this._onSharedModelChanged,this),super.dispose())}toJSON(){return super.toJSON()}_onAttachmentsChange(t,e){const s=this.sharedModel;d(()=>s.setAttachments(t.toJSON()))}_onSharedModelChanged(t,e){if(e.attachmentsChange){const t=this.sharedModel;d(()=>{var e;return this._attachments.fromJSON(null!==(e=t.getAttachments())&&void 0!==e?e:{})})}}}!function(t){class e{createAttachmentsModel(t){return new n.o(t)}}t.ContentFactory=e,t.defaultContentFactory=new e}(p||(p={}));class g extends p{constructor(t={}){super({cell_type:"raw",...t})}get type(){return"raw"}toJSON(){return super.toJSON()}}class m extends p{constructor(t={}){super({cell_type:"markdown",...t}),this.mimeType="text/x-ipythongfm"}get type(){return"markdown"}toJSON(){return super.toJSON()}}class _ extends c{constructor(t={}){var e;super({cell_type:"code",...t}),this._executedCode="",this._isDirty=!1;const s=null!==(e=null==t?void 0:t.contentFactory)&&void 0!==e?e:_.defaultContentFactory,i=this.trusted,n=this.sharedModel.getOutputs();this._outputs=s.createOutputArea({trusted:i,values:n}),this.sharedModel.changed.connect(this._onSharedModelChanged,this),this._outputs.changed.connect(this.onGenericChange,this),this._outputs.changed.connect(this.onOutputsChange,this)}get type(){return"code"}get executionCount(){return this.sharedModel.execution_count||null}set executionCount(t){this.sharedModel.execution_count=t||null}get executionState(){return this.sharedModel.executionState}set executionState(t){this.sharedModel.executionState=t}get isDirty(){return this._isDirty}set isDirty(t){this._setDirty(t)}get outputs(){return this._outputs}clearExecution(){this.outputs.clear(),this.executionCount=null,this.executionState="idle",this._setDirty(!1),this.sharedModel.deleteMetadata("execution"),this.trusted=!0}dispose(){this.isDisposed||(this.sharedModel.changed.disconnect(this._onSharedModelChanged,this),this._outputs.changed.disconnect(this.onGenericChange,this),this._outputs.changed.disconnect(this.onOutputsChange,this),this._outputs.dispose(),this._outputs=null,super.dispose())}onTrustedChanged(t,e){const s=e.newValue;if(this._outputs&&(this._outputs.trusted=s),s){const t=this.sharedModel,e=t.getMetadata();e.trusted=!0,t.setMetadata(e)}this.stateChanged.emit({name:"trusted",oldValue:e.oldValue,newValue:s})}toJSON(){return super.toJSON()}onOutputsChange(t,e){const s=this.sharedModel;d(()=>{switch(e.type){case"add":{for(const t of e.newValues)"stream"===t.type&&t.streamText.changed.connect((t,s)=>{if(void 0!==s.options&&s.options.silent)return;const i=this.sharedModel;"remove"===s.type?i.removeStreamOutput(e.newIndex,s.start,"silent-change"):i.appendStreamOutput(e.newIndex,s.value,"silent-change")},this);const t=e.newValues.map(t=>t.toJSON());s.updateOutputs(e.newIndex,e.newIndex,t,"silent-change");break}case"set":{const t=e.newValues.map(t=>t.toJSON());s.updateOutputs(e.oldIndex,e.oldIndex+t.length,t,"silent-change");break}case"remove":s.updateOutputs(e.oldIndex,e.oldValues.length,[],"silent-change");break;case"clear":s.clearOutputs();break;default:throw new Error(`Invalid event type: ${e.type}`)}})}_onSharedModelChanged(t,e){e.streamOutputChange&&d(()=>{for(const t of e.streamOutputChange)"delete"in t&&this._outputs.removeStreamOutput(t.delete),"insert"in t&&this._outputs.appendStreamOutput(t.insert.toString())}),e.outputsChange&&d(()=>{let t=0;for(const s of e.outputsChange){if("retain"in s&&(t+=s.retain),"delete"in s)for(let e=0;e<s.delete;e++)this._outputs.remove(t);if("insert"in s)for(const t of s.insert)this._outputs.add("toJSON"in t?t.toJSON():t)}}),e.executionCountChange&&this.stateChanged.emit({name:"executionCount",oldValue:e.executionCountChange.oldValue,newValue:e.executionCountChange.newValue}),e.executionStateChange&&("running"===e.executionStateChange.newValue&&this._setDirty(!1),this.stateChanged.emit({name:"executionState",oldValue:e.executionStateChange.oldValue,newValue:e.executionStateChange.newValue})),!e.sourceChange||null===this.executionCount&&"running"!==this.executionState||this._setDirty(this._executedCode!==this.sharedModel.getSource().trim())}_setDirty(t){t||(this._executedCode=this.sharedModel.getSource().trim()),t!==this._isDirty&&(this._isDirty=t,this.stateChanged.emit({name:"isDirty",oldValue:!t,newValue:t}))}}!function(t){class e{createOutputArea(t){return new o.OutputAreaModel(t)}}t.ContentFactory=e,t.defaultContentFactory=new e}(_||(_={}))},36549(t,e,s){s.d(e,{MB:()=>i});var i,n=s(68211);new n.Token("@jupyterlab/toc:ITableOfContentsRegistry","A service to register table of content factory."),new n.Token("@jupyterlab/toc:ITableOfContentsTracker","A widget tracker for table of contents."),function(t){t.defaultConfig={baseNumbering:1,maximalDepth:4,numberingH1:!0,numberHeaders:!1,includeOutput:!0,syncCollapseState:!1}}(i||(i={}))},52334(t,e,s){s.d(e,{Z:()=>r,o:()=>o});var i=s(33647),n=s(40488),a=s(30427);class o{constructor(t){var e;if(this._map=new i.ObservableMap,this._isDisposed=!1,this._stateChanged=new a.Signal(this),this._changed=new a.Signal(this),this._serialized=null,this._changeGuard=!1,this.contentFactory=null!==(e=t.contentFactory)&&void 0!==e?e:o.defaultContentFactory,t.values)for(const e of Object.keys(t.values))void 0!==t.values[e]&&this.set(e,t.values[e]);this._map.changed.connect(this._onMapChanged,this)}get stateChanged(){return this._stateChanged}get changed(){return this._changed}get keys(){return this._map.keys()}get length(){return this._map.keys().length}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,this._map.dispose(),a.Signal.clearData(this))}has(t){return this._map.has(t)}get(t){return this._map.get(t)}set(t,e){const s=this._createItem({value:e});this._map.set(t,s)}remove(t){this._map.delete(t)}clear(){this._map.values().forEach(t=>{t.dispose()}),this._map.clear()}fromJSON(t){this.clear(),Object.keys(t).forEach(e=>{void 0!==t[e]&&this.set(e,t[e])})}toJSON(){const t={};for(const e of this._map.keys())t[e]=this._map.get(e).toJSON();return t}_createItem(t){const e=this.contentFactory.createAttachmentModel(t);return e.changed.connect(this._onGenericChange,this),e}_onMapChanged(t,e){this._serialized&&!this._changeGuard&&(this._changeGuard=!0,this._serialized.set(this.toJSON()),this._changeGuard=!1),this._changed.emit(e),this._stateChanged.emit(void 0)}_onGenericChange(){this._stateChanged.emit(void 0)}}!function(t){class e{createAttachmentModel(t){return new n.AttachmentModel(t)}}t.ContentFactory=e,t.defaultContentFactory=new e}(o||(o={}));class r{constructor(t){this._parent=t.parent||null,this._model=t.model}async resolveUrl(t,e){return this._parent&&!t.startsWith("attachment:")?this._parent.resolveUrl(t,e):t}async getDownloadUrl(t){if(this._parent&&!t.startsWith("attachment:"))return this._parent.getDownloadUrl(t);const e=t.slice(11),s=this._model.get(e);if(void 0===s)return t;const{data:i}=s,a=Object.keys(i)[0];if(void 0===a||-1===n.imageRendererFactory.mimeTypes.indexOf(a))throw new Error(`Cannot render unknown image mime type "${a}".`);return`data:${a};base64,${i[a]}`}isLocal(t){var e,s,i;return!(this._parent&&!t.startsWith("attachment:"))||null===(i=null===(s=(e=this._parent).isLocal)||void 0===s?void 0:s.call(e,t))||void 0===i||i}}},76056(t,e,s){s.d(e,{fh:()=>U,Yr:()=>B,KI:()=>$,J0:()=>J});var i=s(70677),n=s(41621),a=s(52334),o=s(18504),r=s(62246),d=s(51700),l=s(40488),h=s(86752),u=s(15836),c=s(90182),p=s(64530),g=s(68211),m=s(45945),_=s(60731),C=s(86049),v=s(30427),y=s(80281),f=s(95870);class w extends p.ReactWidget{constructor(){super(),this.addClass("jp-Collapser")}get collapsed(){return!1}render(){return f.createElement("div",{className:"jp-Collapser-child",onClick:t=>this.handleClick(t)})}}class M extends w{constructor(){super(),this.addClass("jp-InputCollapser")}get collapsed(){var t;const e=null===(t=this.parent)||void 0===t?void 0:t.parent;return!!e&&e.inputHidden}handleClick(t){var e;const s=null===(e=this.parent)||void 0===e?void 0:e.parent;s&&(s.inputHidden=!s.inputHidden),this.update()}}class x extends w{constructor(){super(),this.addClass("jp-OutputCollapser")}get collapsed(){var t;const e=null===(t=this.parent)||void 0===t?void 0:t.parent;return!!e&&e.outputHidden}handleClick(t){var e,s;const i=null===(e=this.parent)||void 0===e?void 0:e.parent;if(i&&(i.outputHidden=!i.outputHidden,i.outputHidden)){let t=null===(s=i.parent)||void 0===s?void 0:s.node;t&&n._$.scrollIntoViewIfNeeded(t,i.node)}this.update()}}class S extends y.Widget{constructor(){super(),this.addClass("jp-CellHeader")}}class E extends y.Widget{constructor(){super(),this.addClass("jp-CellFooter")}}var b=s(86012);class O extends y.Widget{constructor(t){super(),this.addClass("jp-InputArea");const{contentFactory:e,editorOptions:s,model:i}=t;this.model=i,this.contentFactory=e;const n=this._prompt=e.createInputPrompt();n.addClass("jp-InputArea-prompt");const a=this._editor=new b.CodeEditorWrapper({factory:e.editorFactory,model:i,editorOptions:s});a.addClass("jp-InputArea-editor");const o=this.layout=new y.PanelLayout;o.addWidget(n),o.addWidget(a)}get editorWidget(){return this._editor}get editor(){return this._editor.editor}get promptNode(){return this._prompt.node}get renderedInput(){return this._rendered}renderInput(t){const e=this.layout;this._rendered&&(this._rendered.parent=null),this._editor.hide(),this._rendered=t,e.addWidget(t)}showEditor(){this._rendered&&(this._rendered.parent=null),this._editor.show()}setPrompt(t){this._prompt.executionCount=t}dispose(){this.isDisposed||(this._prompt=null,this._editor=null,this._rendered=null,super.dispose())}}!function(t){t.ContentFactory=class{constructor(t){this._editor=t.editorFactory}get editorFactory(){return this._editor}createInputPrompt(){return new D}}}(O||(O={}));class D extends y.Widget{constructor(){super(),this._executionCount=null,this.addClass("jp-InputPrompt")}get executionCount(){return this._executionCount}set executionCount(t){this._executionCount=t,this.node.textContent=null===t?" ":`[${t||" "}]:`}}class A extends y.Widget{constructor(t){var e,s,i;const n=document.createElement("div");super({node:n});const a=(null!==(e=t.translator)&&void 0!==e?e:c.nullTranslator).load("jupyterlab"),o=document.createElement("div");o.className=null!==(s=t.promptClass)&&void 0!==s?s:"",n.insertAdjacentHTML("afterbegin",o.outerHTML),this._cell=document.createElement("div"),this._cell.classList.add("jp-Placeholder-content"),this._cell.title=a.__("Click to expand");const r=this._cell.appendChild(document.createElement("div"));r.classList.add("jp-Placeholder-contentContainer"),this._textContent=r.appendChild(document.createElement("span")),this._textContent.className="jp-PlaceholderText",this._textContent.innerText=null!==(i=t.text)&&void 0!==i?i:"",n.appendChild(this._cell),p.ellipsesIcon.element({container:r.appendChild(document.createElement("span")),className:"jp-MoreHorizIcon",elementPosition:"center",height:"auto",width:"32px"}),this.addClass("jp-Placeholder"),this._callback=t.callback}set text(t){this._textContent.innerText=t}get text(){return this._textContent.innerText}onAfterAttach(t){super.onAfterAttach(t),this.node.addEventListener("click",this._callback)}onBeforeDetach(t){this.node.removeEventListener("click",this._callback),super.onBeforeDetach(t)}}class k extends A{constructor(t){super({...t,promptClass:"jp-Placeholder-prompt jp-InputPrompt"}),this.addClass("jp-InputPlaceholder")}}class H extends A{constructor(t){super({...t,promptClass:"jp-Placeholder-prompt jp-OutputPrompt"}),this.addClass("jp-OutputPlaceholder")}}const T="jp-mod-resizedCell";class P extends y.Widget{constructor(t){super(),this.targetNode=t,this._isActive=!1,this._isDragging=!1,this.sizeChanged=new v.Signal(this),this.addClass("jp-CellResizeHandle"),this._resizer=new C.Throttler(t=>this._resize(t),50)}dispose(){this._resizer.dispose(),super.dispose()}handleEvent(t){var e,s;switch(t.type){case"dblclick":null===(e=this.targetNode.parentNode)||void 0===e||e.childNodes.forEach(t=>{t.classList.remove(T)}),document.documentElement.style.setProperty("--jp-side-by-side-output-size","1fr"),this._isActive=!1;break;case"mousedown":this._isDragging=!0,this._isActive||(null===(s=this.targetNode.parentNode)||void 0===s||s.childNodes.forEach(t=>{t.classList.add(T)}),this._isActive=!0),window.addEventListener("mousemove",this),window.addEventListener("mouseup",this);break;case"mousemove":this._isActive&&this._isDragging&&this._resizer.invoke(t);break;case"mouseup":this._isDragging=!1,window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this)}}onAfterAttach(t){this.node.addEventListener("dblclick",this),this.node.addEventListener("mousedown",this),super.onAfterAttach(t)}onBeforeDetach(t){this.node.removeEventListener("dblclick",this),this.node.removeEventListener("mousedown",this),super.onBeforeDetach(t)}_resize(t){const{width:e,x:s}=this.targetNode.getBoundingClientRect(),i=e/(t.clientX-s)-1;if(0<i){const t=Math.max(Math.min(Math.abs(i),50),.05);document.documentElement.style.setProperty("--jp-side-by-side-output-size",`${t}fr`),this.sizeChanged.emit(t)}}}const F="jp-Cell-outputWrapper",j="jp-mod-dirty",I="jp-MarkdownHeadingCollapsed",N="jp-collapseHeadingButton",L="jp-showHiddenCellsButton",R="jp-mod-rendered",W="jp-mod-noOutputs",V="application/x-jupyter-icontentsrich";class U extends y.Widget{constructor(t){var e,s,n,a;super(),this.prompt="",this._displayChanged=new v.Signal(this),this._scrollRequested=new v.Signal(this),this._scrollHandlerExtension=i.EditorView.scrollHandler.of((t,e,s)=>{const n=null!==this._inViewport&&!this._inViewport;return this._scrollRequested.emit({defaultPrevented:n,scrollWithinCell:()=>{t.dispatch({effects:i.EditorView.scrollIntoView(e,s)})}}),n}),this._editorConfig={},this._editorExtensions=[],this._inputHidden=!1,this._inViewportChanged=new v.Signal(this),this._readOnly=!1,this._ready=new g.PromiseDelegate,this._resizeDebouncer=new C.Debouncer(()=>{this._displayChanged.emit()},0),this._syncCollapse=!1,this._syncEditable=!1,this.addClass("jp-Cell");const o=this._model=t.model;this.contentFactory=t.contentFactory,this.layout=null!==(e=t.layout)&&void 0!==e?e:new y.PanelLayout,this.translator=null!==(s=t.translator)&&void 0!==s?s:c.nullTranslator,this._editorConfig={searchWithCM:!1,...t.editorConfig},this._editorExtensions=null!==(n=t.editorExtensions)&&void 0!==n?n:[],this._editorExtensions.push(this._scrollHandlerExtension),this._placeholder=!0,this._inViewport=null,this.placeholder=null===(a=t.placeholder)||void 0===a||a,o.metadataChanged.connect(this.onMetadataChanged,this)}initializeState(){return this.loadCollapseState(),this.loadEditableState(),this}get displayChanged(){return this._displayChanged}get inViewport(){var t;return null!==(t=this._inViewport)&&void 0!==t&&t}set inViewport(t){this._inViewport!==t&&(this._inViewport=t,this._inViewportChanged.emit(this._inViewport))}get inViewportChanged(){return this._inViewportChanged}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder!==t&&!1===t&&(this.initializeDOM(),this._placeholder=t,this._ready.resolve())}get promptNode(){return this.placeholder?null:this._inputHidden?this._inputPlaceholder.node.firstElementChild:this._input.promptNode}get editorWidget(){var t,e;return null!==(e=null===(t=this._input)||void 0===t?void 0:t.editorWidget)&&void 0!==e?e:null}get editor(){var t,e;return null!==(e=null===(t=this._input)||void 0===t?void 0:t.editor)&&void 0!==e?e:null}get editorConfig(){return this._editorConfig}get headings(){return new Array}async getHeadings(){return[]}get model(){return this._model}get inputArea(){return this._input}get readOnly(){return this._readOnly}set readOnly(t){t!==this._readOnly&&(this._readOnly=t,this.syncEditable&&this.saveEditableState(),this.update())}isPlaceholder(){return this.placeholder}saveEditableState(){const{sharedModel:t}=this.model,e=t.getMetadata("editable");this.readOnly&&!1===e||!this.readOnly&&void 0===e||(this.readOnly?t.setMetadata("editable",!1):t.deleteMetadata("editable"))}loadEditableState(){this.readOnly=!1===this.model.sharedModel.getMetadata("editable")}get ready(){return this._ready.promise}setPrompt(t){return this._setPrompt(t)}_setPrompt(t){var e;this.prompt=t,null===(e=this._input)||void 0===e||e.setPrompt(t)}get inputHidden(){return this._inputHidden}set inputHidden(t){var e;if(this._inputHidden!==t){if(!this.placeholder){const s=this._inputWrapper.layout;t?(this._input.parent=null,this._inputPlaceholder&&(this._inputPlaceholder.text=null===(e=this.model.sharedModel.getSource().split("\n"))||void 0===e?void 0:e[0]),s.addWidget(this._inputPlaceholder)):(this._inputPlaceholder.parent=null,s.addWidget(this._input))}this._inputHidden=t,this.syncCollapse&&this.saveCollapseState(),this.handleInputHidden(t)}}saveCollapseState(){const t={...this.model.getMetadata("jupyter")};this.inputHidden&&!0===t.source_hidden||!this.inputHidden&&void 0===t.source_hidden||(this.inputHidden?t.source_hidden=!0:delete t.source_hidden,0===Object.keys(t).length?this.model.deleteMetadata("jupyter"):this.model.setMetadata("jupyter",t))}loadCollapseState(){var t;const e=null!==(t=this.model.getMetadata("jupyter"))&&void 0!==t?t:{};this.inputHidden=!!e.source_hidden}handleInputHidden(t){}get syncCollapse(){return this._syncCollapse}set syncCollapse(t){this._syncCollapse!==t&&(this._syncCollapse=t,t&&this.loadCollapseState())}get syncEditable(){return this._syncEditable}set syncEditable(t){this._syncEditable!==t&&(this._syncEditable=t,t&&this.loadEditableState())}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory,placeholder:!1,translator:this.translator})}dispose(){this.isDisposed||(this._resizeDebouncer.dispose(),this._input=null,this._model=null,this._inputWrapper=null,this._inputPlaceholder=null,super.dispose())}updateEditorConfig(t){this._editorConfig={...this._editorConfig,...t},this.editor&&this.editor.setBaseOptions(this._editorConfig)}get scrollRequested(){return this._scrollRequested}initializeDOM(){if(!this.placeholder)return;const t=this.contentFactory,e=this._model,s=t.createCellHeader();s.addClass("jp-Cell-header"),this.layout.addWidget(s);const i=this._inputWrapper=new y.Panel;i.addClass("jp-Cell-inputWrapper");const n=new M;n.addClass("jp-Cell-inputCollapser");const a=this._input=new O({model:e,contentFactory:t,editorOptions:this.getEditorOptions()});a.addClass("jp-Cell-inputArea"),i.addWidget(n),i.addWidget(a),this.layout.addWidget(i),this._inputPlaceholder=new k({callback:()=>{this.inputHidden=!this.inputHidden},text:a.model.sharedModel.getSource().split("\n")[0],translator:this.translator}),a.model.contentChanged.connect((t,e)=>{var s;this._inputPlaceholder&&this.inputHidden&&(this._inputPlaceholder.text=null===(s=t.sharedModel.getSource().split("\n"))||void 0===s?void 0:s[0])}),this.inputHidden&&(a.parent=null,i.layout.addWidget(this._inputPlaceholder));const o=this.contentFactory.createCellFooter();o.addClass("jp-Cell-footer"),this.layout.addWidget(o)}getEditorOptions(){return{config:this.editorConfig,extensions:this._editorExtensions}}onBeforeAttach(t){this.placeholder&&(this.placeholder=!1)}onAfterAttach(t){this.update()}onActivateRequest(t){var e;null===(e=this.editor)||void 0===e||e.focus()}onResize(t){this._resizeDebouncer.invoke()}onUpdateRequest(t){var e,s;this._model&&(null===(e=this.editor)||void 0===e?void 0:e.getOption("readOnly"))!==this._readOnly&&(null===(s=this.editor)||void 0===s||s.setOption("readOnly",this._readOnly))}onContentChanged(){var t;this.inputHidden&&this._inputPlaceholder&&(this._inputPlaceholder.text=null===(t=this.model.sharedModel.getSource().split("\n"))||void 0===t?void 0:t[0])}onMetadataChanged(t,e){switch(e.key){case"jupyter":this.syncCollapse&&this.loadCollapseState();break;case"editable":this.syncEditable&&this.loadEditableState()}}}!function(t){let e;!function(t){t[t.HTML=0]="HTML",t[t.Markdown=1]="Markdown"}(e=t.HeadingType||(t.HeadingType={})),t.ContentFactory=class{constructor(t){this._editorFactory=t.editorFactory}get editorFactory(){return this._editorFactory}createCellHeader(){return new S}createCellFooter(){return new E}createInputPrompt(){return new D}createOutputPrompt(){return new d.OutputPrompt}createStdin(t){return new d.Stdin(t)}}}(U||(U={}));class z extends y.PanelLayout{onBeforeAttach(t){let e=!0;const s=this.parent.node.firstElementChild;for(const i of this)s&&(i.node===s?e=!1:(_.MessageLoop.sendMessage(i,t),e?this.parent.node.insertBefore(i.node,s):this.parent.node.appendChild(i.node),this.parent.isHidden||i.setFlag(y.Widget.Flag.IsVisible),_.MessageLoop.sendMessage(i,y.Widget.Msg.AfterAttach)))}onAfterDetach(t){for(const e of this)!e.hasClass(F)&&e.node.isConnected&&(_.MessageLoop.sendMessage(e,y.Widget.Msg.BeforeDetach),this.parent.node.removeChild(e.node),_.MessageLoop.sendMessage(e,t))}}class B extends U{constructor(t){var e;super({layout:new z,...t,placeholder:!0}),this._detectCaretMovementInOuput=t=>{const e=null!==this._inViewport&&!this._inViewport,s=t.target;if(!(s&&s instanceof HTMLElement))return;this._lastTarget&&(this._lastTarget.removeEventListener("selectionchange",this._lastOnCaretMovedHandler),document.removeEventListener("selectionchange",this._lastOnCaretMovedHandler));const i=()=>{this._scrollRequested.emit({scrollWithinCell:({scroller:t})=>{n._$.scrollIntoViewIfNeeded(t,s)},defaultPrevented:e})};this._lastTarget=s,this._lastOnCaretMovedHandler=i,s.addEventListener("selectionchange",i,{once:!0}),document.addEventListener("selectionchange",i,{once:!0}),setTimeout(()=>{s.removeEventListener("selectionchange",i),document.removeEventListener("selectionchange",i)},250)},this._headingsCache=null,this._outputHidden=!1,this._outputWrapper=null,this._outputPlaceholder=null,this._syncScrolled=!1,this._lastTarget=null,this._lastOutputHeight="",this.addClass("jp-CodeCell");const s=this.translator.load("jupyterlab"),i=this._rendermime=t.rendermime,a=this.contentFactory,o=this.model;this.maxNumberOutputs=t.maxNumberOutputs;const r=0===o.outputs.length?s.__("Code Cell Content"):s.__("Code Cell Content with Output");this.node.setAttribute("aria-label",r);const l=this._output=new d.OutputArea({model:this.model.outputs,rendermime:i,contentFactory:a,maxNumberOutputs:this.maxNumberOutputs,translator:this.translator,promptOverlay:!0,inputHistoryScope:t.inputHistoryScope,showInputPlaceholder:t.showInputPlaceholder});l.node.addEventListener("keydown",this._detectCaretMovementInOuput),l.addClass("jp-Cell-outputArea"),l.toggleScrolling.connect(()=>{this.outputsScrolled=!this.outputsScrolled}),l.initialize.connect(()=>{this.updatePromptOverlayIcon()}),this.placeholder=null===(e=t.placeholder)||void 0===e||e,o.outputs.changed.connect(this.onOutputChanged,this),o.outputs.stateChanged.connect(this.onOutputChanged,this),o.stateChanged.connect(this.onStateChanged,this)}initializeDOM(){if(!this.placeholder)return;super.initializeDOM(),this._updatePrompt();const t=this._outputWrapper=new y.Panel;t.addClass(F);const e=new x;e.addClass("jp-Cell-outputCollapser"),t.addWidget(e),0===this.model.outputs.length&&this.addClass(W),this._output.outputLengthChanged.connect(this._outputLengthHandler,this),t.addWidget(this._output);const s=this.layout,i=new P(this.node);i.sizeChanged.connect(this._sizeChangedHandler,this),s.insertWidget(s.widgets.length-1,i),s.insertWidget(s.widgets.length-1,t),this.model.isDirty&&this.addClass(j),this._outputPlaceholder=new H({callback:()=>{this.outputHidden=!this.outputHidden},text:this.getOutputPlaceholderText(),translator:this.translator});const n=t.layout;this.outputHidden&&(n.removeWidget(this._output),n.addWidget(this._outputPlaceholder),this.inputHidden&&!t.isHidden&&this._outputWrapper.hide());const a=this.translator.load("jupyterlab"),o=0===this.model.outputs.length?a.__("Code Cell Content"):a.__("Code Cell Content with Output");this.node.setAttribute("aria-label",o)}getOutputPlaceholderText(){var t;const e=this.model.outputs.get(0);if(!(null==e?void 0:e.data))return;const s=["text/html","image/svg+xml","application/pdf","text/markdown","text/plain","application/vnd.jupyter.stderr","application/vnd.jupyter.stdout","text"].find(t=>{const s=e.data[t];return"string"==(Array.isArray(s)?typeof s[0]:typeof s)}),i=e.data[null!=s?s:""];return void 0!==i?null===(t=Array.isArray(i)?i:null==i?void 0:i.split("\n"))||void 0===t?void 0:t.find(t=>""!==t):void 0}initializeState(){return super.initializeState(),this.loadScrolledState(),this._updatePrompt(),this}get headings(){var t;return null!==(t=this._headingsCache)&&void 0!==t?t:[]}async getHeadings(){if(!this._headingsCache){const t=[],e=this.model.outputs;for(let s=0;s<e.length;s++){const i=e.get(s);let n=null,a=null;if(Object.keys(i.data).forEach(t=>{!a&&h.sl(t)?a=t:!n&&u.AH(t)&&(n=t)}),n){let e=i.data[n];"string"!=typeof e&&(e=e.join("\n")),t.push(...u.bv(this._rendermime.sanitizer.sanitize(e)).map(t=>({...t,outputIndex:s,type:U.HeadingType.HTML})))}else if(a){const e=await h.ZX(i.data[a],this._rendermime.markdownParser);t.push(...e.map(t=>({...t,outputIndex:s,type:U.HeadingType.Markdown})))}}this._headingsCache=t}return[...this._headingsCache]}get outputArea(){return this._output}get outputHidden(){return this._outputHidden}set outputHidden(t){var e;if(this._outputHidden!==t){if(!this.placeholder){const s=this._outputWrapper.layout;t?(s.removeWidget(this._output),s.addWidget(this._outputPlaceholder),this.inputHidden&&!this._outputWrapper.isHidden&&this._outputWrapper.hide(),this._outputPlaceholder&&(this._outputPlaceholder.text=null!==(e=this.getOutputPlaceholderText())&&void 0!==e?e:"")):(this._outputWrapper.isHidden&&this._outputWrapper.show(),s.removeWidget(this._outputPlaceholder),s.addWidget(this._output))}this._outputHidden=t,this.syncCollapse&&this.saveCollapseState()}}saveCollapseState(){this.model.sharedModel.transact(()=>{super.saveCollapseState();const t=this.model.getMetadata("collapsed");this.outputHidden&&!0===t||!this.outputHidden&&void 0===t||(this.outputHidden?this.model.setMetadata("collapsed",!0):this.model.deleteMetadata("collapsed"))},!1,"silent-change")}loadCollapseState(){super.loadCollapseState(),this.outputHidden=!!this.model.getMetadata("collapsed")}get outputsScrolled(){return this._outputsScrolled}set outputsScrolled(t){this.toggleClass("jp-mod-outputsScrolled",t),this._outputsScrolled=t,this.syncScrolled&&this.saveScrolledState(),this.updatePromptOverlayIcon()}updatePromptOverlayIcon(){var t;const e=o.DOMUtils.findElement(this.node,"jp-OutputArea-promptOverlay");if(!e)return;if(e.clientHeight<=24)return void(null===(t=e.firstChild)||void 0===t||t.remove());let s;this._outputsScrolled?(p.expandIcon.element({container:e}),s="Expand Output"):(p.collapseIcon.element({container:e}),s="Collapse Output");const i=this.translator.load("jupyterlab");e.title=i.__(s)}saveScrolledState(){const t=this.model.getMetadata("scrolled");this.outputsScrolled&&!0===t||!this.outputsScrolled&&void 0===t||(this.outputsScrolled?this.model.setMetadata("scrolled",!0):(this.outputArea.node.style.height="",this.model.deleteMetadata("scrolled")))}loadScrolledState(){"auto"===this.model.getMetadata("scrolled")?this.outputsScrolled=!1:this.outputsScrolled=!!this.model.getMetadata("scrolled")}get syncScrolled(){return this._syncScrolled}set syncScrolled(t){this._syncScrolled!==t&&(this._syncScrolled=t,t&&this.loadScrolledState())}handleInputHidden(t){this.placeholder||(!t&&this._outputWrapper.isHidden?this._outputWrapper.show():t&&!this._outputWrapper.isHidden&&this._outputHidden&&this._outputWrapper.hide())}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory,rendermime:this._rendermime,placeholder:!1,translator:this.translator})}cloneOutputArea(){return new d.SimplifiedOutputArea({model:this.model.outputs,contentFactory:this.contentFactory,rendermime:this._rendermime})}dispose(){this.isDisposed||(this._output.outputLengthChanged.disconnect(this._outputLengthHandler,this),this._output.node.removeEventListener("keydown",this._detectCaretMovementInOuput),this._rendermime=null,this._output=null,this._outputWrapper=null,this._outputPlaceholder=null,super.dispose())}onStateChanged(t,e){switch(e.name){case"executionCount":null!==e.newValue&&(this.model.executionState="idle"),this._updatePrompt();break;case"executionState":this._updatePrompt();break;case"isDirty":t.isDirty?this.addClass(j):this.removeClass(j)}}onOutputChanged(){var t;this._headingsCache=null,this._outputPlaceholder&&this.outputHidden&&(this._outputPlaceholder.text=null!==(t=this.getOutputPlaceholderText())&&void 0!==t?t:""),this.updatePromptOverlayIcon();const e=this.outputArea.node.style.height;0===this.model.outputs.length&&""!==e?(this._lastOutputHeight=e,this.outputArea.node.style.height=""):this.model.outputs.length>0&&""===e&&(this.outputArea.node.style.height=this._lastOutputHeight)}onMetadataChanged(t,e){switch(e.key){case"scrolled":this.syncScrolled&&this.loadScrolledState();break;case"collapsed":this.syncCollapse&&this.loadCollapseState()}super.onMetadataChanged(t,e)}_updatePrompt(){let t;t="running"==this.model.executionState?"*":`${this.model.executionCount||""}`,this._setPrompt(t)}_outputLengthHandler(t,e){const s=0===e;this.toggleClass(W,s);const i=this.translator.load("jupyterlab"),n=s?i.__("Code Cell Content"):i.__("Code Cell Content with Output");this.node.setAttribute("aria-label",n)}_sizeChangedHandler(t){this._displayChanged.emit()}}!function(t){t.execute=async function(t,e,s){var i;const n=t.model,a=n.sharedModel.getSource();if(!a.trim()||!(null===(i=e.session)||void 0===i?void 0:i.kernel))return void n.sharedModel.transact(()=>{n.clearExecution()},!1);const o={cellId:n.sharedModel.getId()};s={...n.metadata,...s,...o};const{recordTiming:r}=s;let l;n.sharedModel.transact(()=>{n.clearExecution(),t.outputHidden=!1},!1,"silent-change"),n.executionState="running",n.trusted=!0;try{const i=d.OutputArea.execute(a,t.outputArea,e,s);if(r){const e=t=>{let e;switch(t.header.msg_type){case"status":e=`status.${t.content.execution_state}`;break;case"execute_input":e="execute_input";break;default:return!0}const s=t.header.date||(new Date).toISOString(),i=Object.assign({},n.getMetadata("execution"));return i[`iopub.${e}`]=s,n.setMetadata("execution",i),!0};t.outputArea.future.registerMessageHook(e)}else n.deleteMetadata("execution");l=t.outputArea.future;const o=await i;if(n.executionCount=o.content.execution_count,r){const t=Object.assign({},n.getMetadata("execution")),e=o.metadata.started;e&&(t["shell.execute_reply.started"]=e);const s=o.header.date;t["shell.execute_reply"]=s||(new Date).toISOString(),n.setMetadata("execution",t)}return o}catch(e){if(l&&!t.isDisposed&&t.outputArea.future===l&&(t.model.executionState="idle",r&&l.isDisposed)){const t=Object.assign({},n.getMetadata("execution"));t.execution_failed=(new Date).toISOString(),n.setMetadata("execution",t)}throw e}}}(B||(B={}));class q extends U{handleEvent(t){switch(t.type){case"lm-dragover":this._evtDragOver(t);break;case"lm-drop":this._evtDrop(t)}}getEditorOptions(){var t,e;const s=null!==(t=super.getEditorOptions())&&void 0!==t?t:{};return s.extensions=[...null!==(e=s.extensions)&&void 0!==e?e:[],i.EditorView.domEventHandlers({dragenter:t=>{t.preventDefault()},dragover:t=>{t.preventDefault()},drop:t=>{this._evtNativeDrop(t)},paste:t=>{this._evtPaste(t)}})],s}onAfterAttach(t){super.onAfterAttach(t);const e=this.node;e.addEventListener("lm-dragover",this),e.addEventListener("lm-drop",this)}onBeforeDetach(t){const e=this.node;e.removeEventListener("lm-dragover",this),e.removeEventListener("lm-drop",this),super.onBeforeDetach(t)}_evtDragOver(t){(0,m.some)(l.imageRendererFactory.mimeTypes,e=>!!t.mimeData.hasData(V)&&t.mimeData.getData(V).model.mimetype===e)&&(t.preventDefault(),t.stopPropagation(),t.dropAction=t.proposedAction)}_evtPaste(t){var e;const s=null===(e=this.model.getMetadata("editable"))||void 0===e||e;if(t.clipboardData&&s){const e=t.clipboardData.items;for(let s=0;s<e.length;s++){if("text/plain"===e[s].type){if(s<e.length-1&&"file"===e[s+1].kind)continue;e[s].getAsString(t=>{var e,s;null===(s=(e=this.editor).replaceSelection)||void 0===s||s.call(e,t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"))})}this._attachFiles(t.clipboardData.items)}}t.preventDefault()}_evtNativeDrop(t){t.dataTransfer&&this._attachFiles(t.dataTransfer.items),t.preventDefault()}_evtDrop(t){const e=t.mimeData.types().filter(e=>{if(e===V){const e=t.mimeData.getData(V);return-1!==l.imageRendererFactory.mimeTypes.indexOf(e.model.mimetype)}return-1!==l.imageRendererFactory.mimeTypes.indexOf(e)});if(0!==e.length)if(t.preventDefault(),t.stopPropagation(),"none"!==t.proposedAction){t.dropAction="copy";for(const s of e)if(s===V){const{model:e,withContent:s}=t.mimeData.getData(V);if("file"===e.type){const t=this._generateURI(e.name);this.updateCellSourceWithAttachment(e.name,t),s().then(e=>{this.model.attachments.set(t,{[e.mimetype]:e.content})})}}else{const e=this._generateURI();this.model.attachments.set(e,{[s]:t.mimeData.getData(s)}),this.updateCellSourceWithAttachment(e,e)}}else t.dropAction="none"}_attachFiles(t){for(let e=0;e<t.length;e++){const s=t[e];if("file"===s.kind){const t=s.getAsFile();t&&this._attachFile(t)}}}_attachFile(t){const e=new FileReader;e.onload=s=>{const{href:i,protocol:n}=r.URLExt.parse(e.result);if("data:"!==n)return;const a=/([\w+\/\+]+)?(?:;(charset=[\w\d-]*|base64))?,(.*)/.exec(i);if(!a||4!==a.length)return;const o=a[1],d=a[3],l={[o]:d},h=this._generateURI(t.name);o.startsWith("image/")&&(this.model.attachments.set(h,l),this.updateCellSourceWithAttachment(t.name,h))},e.onerror=e=>{console.error(`Failed to attach ${t.name}`+e)},e.readAsDataURL(t)}_generateURI(t=""){const e=t.lastIndexOf(".");return-1!==e?g.UUID.uuid4().concat(t.substring(e)):g.UUID.uuid4()}}class $ extends q{constructor(t){var e,s,i,n,o;super({...t,placeholder:!0}),this._headingsCache=null,this._headingCollapsedChanged=new v.Signal(this),this._prevText="",this._rendered=!0,this._renderedChanged=new v.Signal(this),this._showEditorForReadOnlyMarkdown=!0,this._cachedHeadingText="",this._headingResolved=!1,this.addClass("jp-MarkdownCell"),this.model.contentChanged.connect(this.onContentChanged,this);const d=this.translator.load("jupyterlab");this.node.setAttribute("aria-label",d.__("Markdown Cell Content")),this._rendermime=t.rendermime.clone({resolver:new a.Z({parent:null!==(e=t.rendermime.resolver)&&void 0!==e?e:void 0,model:this.model.attachments})}),this._renderer=this._rendermime.createRenderer("text/markdown"),this._renderer.addClass("jp-MarkdownOutput"),this._headingCollapsed=null!==(s=this.model.getMetadata(I))&&void 0!==s&&s,this._showEditorForReadOnlyMarkdown=null!==(i=t.showEditorForReadOnlyMarkdown)&&void 0!==i?i:$.defaultShowEditorForReadOnlyMarkdown,this.placeholder=null===(n=t.placeholder)||void 0===n||n,this._monitor=new r.ActivityMonitor({signal:this.model.contentChanged,timeout:1e3}),this.ready.then(()=>{this.isDisposed||this._monitor.activityStopped.connect(()=>{this._rendered&&this.update()},this)}).catch(t=>{console.error("Failed to be ready",t)}),this._cachedHeadingText=this.model.sharedModel.getSource(),this._emptyPlaceholder=null!==(o=t.emptyPlaceholder)&&void 0!==o?o:d.__("Type Markdown and LaTeX: $ Î±^2 $")}get headingInfo(){const t=this.headings;if(t.length>0){const{text:e,level:s}=t.reduce((t,e)=>t.level<=e.level?t:e,t[0]);return{text:e,level:s}}return{text:"",level:-1}}get headings(){var t;return null!==(t=this._headingsCache)&&void 0!==t?t:[]}async getHeadings(){if(!this._headingsCache){const t=await h.ZX(this.model.sharedModel.getSource(),this._rendermime.markdownParser);this._headingsCache=t.map(t=>({...t,type:U.HeadingType.Markdown})),this._headingResolved=!0,this.renderCollapseButtons()}return[...this._headingsCache]}get headingCollapsed(){return this._headingCollapsed}set headingCollapsed(t){var e;if(this._headingCollapsed!==t){this._headingCollapsed=t,t?this.model.setMetadata(I,t):"undefined"!==this.model.getMetadata(I)&&this.model.deleteMetadata(I);const s=null===(e=this.inputArea)||void 0===e?void 0:e.promptNode.getElementsByClassName(N)[0];s&&(t?s.classList.add("jp-mod-collapsed"):s.classList.remove("jp-mod-collapsed")),this.renderCollapseButtons(this._renderer),this._headingCollapsedChanged.emit(this._headingCollapsed)}}get numberChildNodes(){return this._numberChildNodes}set numberChildNodes(t){this._numberChildNodes=t,this.renderCollapseButtons(this._renderer)}get headingCollapsedChanged(){return this._headingCollapsedChanged}get rendered(){return this._rendered}set rendered(t){this.readOnly&&!1===this._showEditorForReadOnlyMarkdown&&(t=!0),t!==this._rendered&&(this._rendered=t,this._handleRendered().then(()=>{this._displayChanged.emit(),this._renderedChanged.emit(this._rendered)}).catch(t=>{console.error("Failed to render",t)}))}get renderedChanged(){return this._renderedChanged}get showEditorForReadOnly(){return this._showEditorForReadOnlyMarkdown}set showEditorForReadOnly(t){this._showEditorForReadOnlyMarkdown=t,!1===t&&(this.rendered=!0)}get renderer(){return this._renderer}dispose(){this.isDisposed||(this._monitor.dispose(),super.dispose())}initializeDOM(){this.placeholder&&(super.initializeDOM(),this.renderCollapseButtons(this._renderer),this._handleRendered().catch(t=>{console.error("Failed to render",t)}))}maybeCreateCollapseButton(){var t;const{level:e}=this.headingInfo;if(e>0&&0==(null===(t=this.inputArea)||void 0===t?void 0:t.promptNode.getElementsByClassName(N).length)){let t=this.inputArea.promptNode.appendChild(document.createElement("button"));t.className=`jp-Button ${N}`,t.setAttribute("data-heading-level",e.toString()),this._headingCollapsed?t.classList.add("jp-mod-collapsed"):t.classList.remove("jp-mod-collapsed"),t.onclick=t=>{this.headingCollapsed=!this.headingCollapsed}}}maybeCreateOrUpdateExpandButton(){const t=this.node.getElementsByClassName(L);let e=this.translator.load("jupyterlab")._n("%1 cell hidden","%1 cells hidden",this._numberChildNodes);if(this.headingCollapsed&&this._numberChildNodes>0&&0==t.length){const t=document.createElement("button");t.className=`jp-mod-minimal jp-Button ${L}`,p.addIcon.render(t);const s=document.createElement("div");s.textContent=e,t.appendChild(s),t.onclick=()=>{this.headingCollapsed=!1},this.node.appendChild(t)}if(this.headingCollapsed&&this._numberChildNodes>0&&1==t.length&&(t[0].childNodes[1].textContent=e),!(this.headingCollapsed&&this._numberChildNodes>0))for(const e of t)this.node.removeChild(e)}onContentChanged(){super.onContentChanged();const t=this.model,e=t&&t.sharedModel.getSource();e!==this._cachedHeadingText&&(this._cachedHeadingText=e,this._headingsCache=null,this._headingResolved=!1)}renderCollapseButtons(t){this.node.classList.toggle(I,this._headingCollapsed),this.maybeCreateCollapseButton(),this.maybeCreateOrUpdateExpandButton()}renderInput(t){this.addClass(R),this.placeholder||this.isDisposed||(this.renderCollapseButtons(t),this.inputArea.renderInput(t))}showEditor(){if(this.removeClass(R),!this.placeholder&&!this.isDisposed){this.inputArea.showEditor();let t=(this.model.sharedModel.getSource().match(/^#+/g)||[""])[0].length;t>0&&this.inputArea.editor.setCursorPosition({column:t+1,line:0},{scroll:!1})}}onUpdateRequest(t){this._handleRendered().catch(t=>{console.error("Failed to render",t)}),super.onUpdateRequest(t)}updateCellSourceWithAttachment(t,e){var s,i;const n=`![${t}](attachment:${null!=e?e:t})`;null===(i=null===(s=this.editor)||void 0===s?void 0:s.replaceSelection)||void 0===i||i.call(s,n)}async _handleRendered(){this._rendered?(await this._updateRenderedInput(),this._rendered&&this.renderInput(this._renderer)):this.showEditor()}_updateRenderedInput(){if(this.placeholder)return Promise.resolve();const t=this.model,e=t&&t.sharedModel.getSource()||this._emptyPlaceholder;if(e!==this._prevText){const t=new l.MimeModel({data:{"text/markdown":e}});return this._prevText=e,this._renderer.renderModel(t)}return Promise.resolve()}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory,rendermime:this._rendermime,placeholder:!1,translator:this.translator})}get headingsResolved(){return this._headingResolved}}!function(t){t.defaultShowEditorForReadOnlyMarkdown=!0}($||($={}));class J extends U{constructor(t){super(t),this.addClass("jp-RawCell");const e=this.translator.load("jupyterlab");this.node.setAttribute("aria-label",e.__("Raw Cell Content"))}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory,placeholder:!1,translator:this.translator})}}},86049(t,e,s){s.r(e),s.d(e,{Debouncer:()=>d,Poll:()=>o,RateLimiter:()=>r,Throttler:()=>l});var i,n=s(68211),a=s(30427);class o{constructor(t){var e;this._disposed=new a.Signal(this),this._lingered=0,this._tick=new n.PromiseDelegate,this._ticked=new a.Signal(this),this._factory=t.factory,this._linger=null!==(e=t.linger)&&void 0!==e?e:i.DEFAULT_LINGER,this._standby=t.standby||i.DEFAULT_STANDBY,this._state={...i.DEFAULT_STATE,timestamp:(new Date).getTime()};const s=t.frequency||{},o=Math.max(s.interval||0,s.max||0,i.DEFAULT_FREQUENCY.max);this.frequency={...i.DEFAULT_FREQUENCY,...s,max:o},this.name=t.name||i.DEFAULT_NAME,"auto"in t&&!t.auto||setTimeout(()=>this.start())}get disposed(){return this._disposed}get frequency(){return this._frequency}set frequency(t){if(this.isDisposed||n.JSONExt.deepEqual(t,this.frequency||{}))return;let{backoff:e,interval:s,max:i}=t;if(s=Math.round(s),i=Math.round(i),"number"==typeof e&&e<1)throw new Error("Poll backoff growth factor must be at least 1");if((s<0||s>i)&&s!==o.NEVER)throw new Error("Poll interval must be between 0 and max");if(i>o.MAX_INTERVAL&&i!==o.NEVER)throw new Error(`Max interval must be less than ${o.MAX_INTERVAL}`);this._frequency={backoff:e,interval:s,max:i}}get isDisposed(){return"disposed"===this.state.phase}get standby(){return this._standby}set standby(t){this.isDisposed||this.standby===t||(this._standby=t)}get state(){return this._state}get tick(){return this._tick.promise}get ticked(){return this._ticked}async*[Symbol.asyncIterator](){for(;!this.isDisposed;)yield this.state,await this.tick.catch(()=>{})}dispose(){this.isDisposed||(this._state={...i.DISPOSED_STATE,timestamp:(new Date).getTime()},this._tick.promise.catch(t=>{}),this._tick.reject(new Error(`Poll (${this.name}) is disposed.`)),this._disposed.emit(void 0),a.Signal.clearData(this))}refresh(){return this.schedule({cancel:({phase:t})=>"refreshed"===t,interval:o.IMMEDIATE,phase:"refreshed"})}async schedule(t={}){if(this.isDisposed)return;if(t.cancel&&t.cancel(this.state))return;const e=this._tick,s=new n.PromiseDelegate,i={interval:this.frequency.interval,payload:null,phase:"standby",timestamp:(new Date).getTime(),...t};this._state=i,this._tick=s,clearTimeout(this._timeout),this._ticked.emit(this.state),e.resolve(this),await e.promise,i.interval!==o.NEVER?this._timeout=setTimeout(()=>{this.isDisposed||this.tick!==s.promise||this._execute()},i.interval):this._timeout=void 0}start(){return this.schedule({cancel:({phase:t})=>"constructed"!==t&&"standby"!==t&&"stopped"!==t,interval:o.IMMEDIATE,phase:"started"})}stop(){return this.schedule({cancel:({phase:t})=>"stopped"===t,interval:o.NEVER,phase:"stopped"})}get hidden(){return i.hidden}_execute(){let t="function"==typeof this.standby?this.standby():this.standby;if("never"===t?t=!1:"when-hidden"===t&&(this.hidden?t=++this._lingered>this._linger:(this._lingered=0,t=!1)),t)return void this.schedule();const e=this.tick;this._factory(this.state).then(t=>{this.isDisposed||this.tick!==e||this.schedule({payload:t,phase:"rejected"===this.state.phase?"reconnected":"resolved"})}).catch(t=>{this.isDisposed||this.tick!==e||this.schedule({interval:i.sleep(this.frequency,this.state),payload:t,phase:"rejected"})})}}!function(t){t.IMMEDIATE=0,t.MAX_INTERVAL=2147483647,t.NEVER=1/0}(o||(o={})),function(t){t.DEFAULT_BACKOFF=3,t.DEFAULT_FREQUENCY={backoff:!0,interval:1e3,max:3e4},t.DEFAULT_LINGER=1,t.DEFAULT_NAME="unknown",t.DEFAULT_STANDBY="when-hidden",t.DEFAULT_STATE={interval:o.NEVER,payload:null,phase:"constructed",timestamp:new Date(0).getTime()},t.DISPOSED_STATE={interval:o.NEVER,payload:null,phase:"disposed",timestamp:new Date(0).getTime()},t.sleep=function(e,s){const{backoff:i,interval:n,max:a}=e;if(n===o.NEVER)return n;const r=!0===i?t.DEFAULT_BACKOFF:!1===i?1:i,d=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}(n,s.interval*r);return Math.min(a,d)},t.hidden="undefined"!=typeof document&&(document.addEventListener("visibilitychange",()=>{t.hidden="hidden"===document.visibilityState}),document.addEventListener("pagehide",()=>{t.hidden="hidden"===document.visibilityState}),"hidden"===document.visibilityState)}(i||(i={}));class r{constructor(t,e=500){this.args=void 0,this.payload=null,this.limit=e,this.poll=new o({auto:!1,factory:async()=>{const{args:e}=this;return this.args=void 0,t(...e)},frequency:{backoff:!1,interval:o.NEVER,max:o.NEVER},standby:"never"}),this.payload=new n.PromiseDelegate,this.poll.ticked.connect((t,e)=>{const{payload:s}=this;return"resolved"===e.phase?(this.payload=new n.PromiseDelegate,void s.resolve(e.payload)):"rejected"===e.phase||"stopped"===e.phase?(this.payload=new n.PromiseDelegate,s.promise.catch(t=>{}),void s.reject(e.payload)):void 0},this)}get isDisposed(){return null===this.payload}dispose(){this.isDisposed||(this.args=void 0,this.payload=null,this.poll.dispose())}async stop(){return this.poll.stop()}}class d extends r{invoke(...t){return this.args=t,this.poll.schedule({interval:this.limit,phase:"invoked"}),this.payload.promise}}class l extends r{constructor(t,e){super(t,"number"==typeof e?e:e&&e.limit),this._trailing=!1,"number"!=typeof e&&e&&"trailing"===e.edge&&(this._trailing=!0),this._interval=this._trailing?this.limit:o.IMMEDIATE}invoke(...t){const e="invoked"!==this.poll.state.phase;return(e||this._trailing)&&(this.args=t),e&&this.poll.schedule({interval:this._interval,phase:"invoked"}),this.payload.promise}}},86752(t,e,s){s.d(e,{ZX:()=>o,oQ:()=>a,sl:()=>d});var i=s(18504),n=s(40488);async function a(t,e,s,a){try{const o=document.createElement("div");await(0,n.renderMarkdown)({markdownParser:t,host:o,source:e,trusted:!1,sanitizer:null!=a?a:new i.Sanitizer,shouldTypeset:!1,resolver:null,linkHandler:null,latexTypesetter:null});const r=o.querySelector(`h${s}`);return r?(null==a?void 0:a.allowNamedProperties)?r.id:r.getAttribute("data-jupyter-id"):null}catch(t){console.error("Failed to parse a heading.",t)}return null}async function o(t,e){if(!e)return console.warn("Couldn't parse headings; Markdown parser is null"),[];const s=await e.render(t),i=new Array;return(new DOMParser).parseFromString(s,"text/html").querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((t,e)=>{var s;const n=parseInt(t.tagName.substring(1),10),a=(null===(s=t.textContent)||void 0===s?void 0:s.trim())||"";i.push({text:a,line:e,level:n,raw:t.outerHTML,skip:l.test(t.outerHTML)})}),i}const r=["text/x-ipythongfm","text/x-markdown","text/x-gfm","text/markdown"];function d(t){return r.includes(t)}const l=/<\w+\s(.*?\s)?class="(.*?\s)?(jp-toc-ignore|tocSkip)(\s.*?)?"(\s.*?)?>/}}]);