"use strict";(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[7433],{37433(e,t,o){o.r(t),o.d(t,{default:()=>B});var n=o(96576),r=o(18504),s=o(86012),i=o(29950),a=o(5514),c=o(69464),l=o(38888),d=o(31480),p=o(40488),u=o(59182),h=o(90182),m=o(64530),b=o(45945),g=o(68211),C=o(49711),v=o(80281),y=o(76231);const _={id:"@jupyterlab/console-extension:foreign",description:"Add foreign handler of IOPub messages to the console.",requires:[a.IConsoleTracker,u.ISettingRegistry,h.ITranslator],optional:[r.ICommandPalette],activate:function(e,t,o,n,r){var s;const i=n.load("jupyterlab"),{shell:c}=e;t.widgetAdded.connect((e,t)=>{const n=t.console,r=new a.ForeignHandler({sessionContext:n.sessionContext,parent:n});w.foreignHandlerProperty.set(n,r),o.get("@jupyterlab/console-extension:tracker","showAllKernelActivity").then(({composite:e})=>{const t=e;r.enabled=t}),n.disposed.connect(()=>{r.dispose()})});const{commands:l}=e,d=i.__("Console"),p="console:toggle-show-all-kernel-activity";l.addCommand(p,{label:e=>i.__("Show All Kernel Activity"),execute:e=>{const o=function(e){const o=t.currentWidget;return!1!==e.activate&&o&&c.activateById(o.id),o}(e);if(!o)return;const n=w.foreignHandlerProperty.get(o.console);n&&(n.enabled=!n.enabled)},isToggled:()=>{var e;return null!==t.currentWidget&&!!(null===(e=w.foreignHandlerProperty.get(t.currentWidget.console))||void 0===e?void 0:e.enabled)},isEnabled:()=>null!==t.currentWidget&&t.currentWidget===c.currentWidget,describedBy:{args:{type:"object",properties:{activate:{type:"boolean",description:i.__("Whether to activate the widget")}}}}});const u=()=>{l.notifyCommandChanged(p)};t.currentChanged.connect(u),null===(s=c.currentChanged)||void 0===s||s.connect(u),r&&r.addItem({command:p,category:d,args:{isPalette:!0}})},autoStart:!0},f=_;var w;!function(e){e.foreignHandlerProperty=new y.AttachedProperty({name:"foreignHandler",create:()=>{}})}(w||(w={}));const x={id:"@jupyterlab/console-extension:cell-executor",description:"Provides the console cell executor.",autoStart:!0,provides:a.IConsoleCellExecutor,activate:()=>Object.freeze({runCell:a.runCell})};var k;!function(e){e.autoClosingBrackets="console:toggle-autoclosing-brackets",e.create="console:create",e.clear="console:clear",e.runUnforced="console:run-unforced",e.runForced="console:run-forced",e.linebreak="console:linebreak",e.interrupt="console:interrupt-kernel",e.restart="console:restart-kernel",e.closeAndShutdown="console:close-and-shutdown",e.open="console:open",e.inject="console:inject",e.changeKernel="console:change-kernel",e.getKernel="console:get-kernel",e.interactionMode="console:interaction-mode",e.redo="console:redo",e.replaceSelection="console:replace-selection",e.shutdown="console:shutdown",e.undo="console:undo",e.invokeCompleter="completer:invoke-console",e.selectCompleter="completer:select-console"}(k||(k={}));const I={id:"@jupyterlab/console-extension:tracker",description:"Provides the console widget tracker.",provides:a.IConsoleTracker,requires:[a.ConsolePanel.IContentFactory,s.IEditorServices,a.IConsoleCellExecutor,p.IRenderMimeRegistry,u.ISettingRegistry],optional:[n.ILayoutRestorer,c.IDefaultFileBrowser,d.IMainMenu,r.ICommandPalette,l.ILauncher,n.ILabStatus,r.ISessionContextDialogs,m.IFormRendererRegistry,h.ITranslator,r.ISessionContextDialogs,r.IToolbarWidgetRegistry],activate:async function(e,t,o,n,s,i,c,l,d,p,u,y,_,f,w,x,I){var E;const j=null!=w?w:h.nullTranslator,P=j.load("jupyterlab"),B=e.serviceManager,{commands:S,shell:W}=e,T=P.__("Console"),M=null!=_?_:new r.SessionContextDialogs({translator:j}),R="@jupyterlab/console-extension:tracker",K=["top","bottom","left","right"];let A;if(I){const e="ConsolePanel";A=(0,r.createToolbarFactory)(I,i,e,R,j),x&&I.addFactory(e,"kernelName",e=>r.Toolbar.createKernelNameItem(e.sessionContext,x,j)),I.addFactory(e,"kernelStatus",e=>{const t=e.sessionContext;return r.Toolbar.createKernelStatusItem(t)});const t=new v.Menu({commands:S});t.addClass("jp-CodeConsolePromptMenu"),K.forEach(e=>{t.addItem({command:`console:prompt-to-${e}`})}),I.addFactory(e,"promptPosition",e=>{const o=new m.ToolbarButton({tooltip:P.__("Change Console Prompt Position"),icon:m.dotsIcon,onClick:()=>{const e=o.node.getBoundingClientRect().right,n=o.node.getBoundingClientRect().bottom;t.open(e,n,{horizontalAlignment:"right"})}});return o})}const U=new r.WidgetTracker({namespace:"console"});async function D(e){var c,l;await B.ready;const d=new a.ConsolePanel({manager:B,contentFactory:t,mimeTypeService:o.mimeTypeService,rendermime:s,sessionDialogs:M,executor:n,translator:j,setBusy:null!==(c=y&&(()=>y.setBusy()))&&void 0!==c?c:void 0,...e});A&&(0,r.setToolbar)(d,A);const p=(await i.get("@jupyterlab/console-extension:tracker","interactionMode")).composite;return d.console.node.dataset.jpInteractionMode=p,await U.add(d),d.sessionContext.propertyChanged.connect(()=>{U.save(d)}),e.subshell&&d.sessionContext.kernelChanged.connect(async()=>{d.sessionContext.isDisposed||d.sessionContext.ready.then(async()=>{if(null===d.sessionContext.session)console.error("Cannot create subshell without session");else if(null===d.sessionContext.session.kernel)console.error("Cannot create subshell without kernel");else{const{kernel:e}=d.sessionContext.session;await e.info;const t=await e.requestCreateSubshell({}).done;e.subshellId=t.content.subshell_id}}).catch(e=>{console.error("Failed to initialize SessionContext or create new subshell.",e)})}),W.add(d,"main",{ref:e.ref,mode:e.insertMode,activate:!1!==e.activate,type:null!==(l=e.type)&&void 0!==l?l:"Console"}),d}c&&c.restore(U,{command:k.create,args:e=>{const{path:t,name:o,kernelPreference:n}=e.console.sessionContext;return{path:t,name:o,kernelPreference:{...n}}},name:e=>{var t;return null!==(t=e.console.sessionContext.path)&&void 0!==t?t:g.UUID.uuid4()},when:B.ready}),u&&B.ready.then(()=>{let e=null;const t=()=>{e&&(e.dispose(),e=null);const t=B.kernelspecs.specs;if(t){e=new C.DisposableSet;for(const o in t.kernelspecs){const n=o===t.default?0:1/0,r=t.kernelspecs[o],s=r.resources["logo-svg"]||r.resources["logo-64x64"];e.add(u.add({command:k.create,args:{isLauncher:!0,kernelPreference:{name:o}},category:P.__("Console"),rank:n,kernelIconUrl:s,metadata:{kernel:g.JSONExt.deepCopy(r.metadata||{})}}))}}};t(),B.kernelspecs.specsChanged.connect(t)});let F,O,L,q,z,H,$={};async function N(e){F=(await i.get(R,"clearCellsOnExecute")).composite,O=(await i.get(R,"clearCodeContentOnExecute")).composite,L=(await i.get(R,"hideCodeInput")).composite,q=(await i.get(R,"interactionMode")).composite,$=(await i.get(R,"promptCellConfig")).composite,z=(await i.get(R,"promptCellPosition")).composite,H=(await i.get(R,"showBanner")).composite;const t=e=>{var t,o;e.console.node.dataset.jpInteractionMode=q,e.console.editorConfig=$,null===(o=null===(t=e.console.promptCell)||void 0===t?void 0:t.editor)||void 0===o||o.setOptions($),e.console.setConfig({clearCellsOnExecute:F,clearCodeContentOnExecute:O,hideCodeInput:L,promptCellPosition:z,showBanner:H})};e?t(e):U.forEach(t)}if(i.pluginChanged.connect((e,t)=>{t===R&&N()}),await N(),f){const e=f.getRenderer("@jupyterlab/codemirror-extension:plugin.defaultConfig");e&&f.addRenderer("@jupyterlab/console-extension:tracker.promptCellConfig",e)}function G(){return null!==U.currentWidget&&U.currentWidget===W.currentWidget}function J(e){var t;const o=e[r.SemanticCommand.WIDGET]?null!==(t=U.find(t=>t.id===e[r.SemanticCommand.WIDGET]))&&void 0!==t?t:null:U.currentWidget;return!1!==e.activate&&o&&W.activateById(o.id),o}U.widgetAdded.connect((e,t)=>{N(t)}),S.addCommand(k.autoClosingBrackets,{execute:async e=>{var t;$.autoClosingBrackets=!!(null!==(t=e.force)&&void 0!==t?t:!$.autoClosingBrackets),await i.set(R,"promptCellConfig",$)},label:P.__("Auto Close Brackets for Code Console Prompt"),isToggled:()=>$.autoClosingBrackets,describedBy:{args:{type:"object",properties:{force:{type:"boolean",description:P.__("Whether to force the toggle state")}}}}}),S.addCommand(k.open,{label:P.__("Open a console for the provided `path`."),describedBy:{args:{type:"object",properties:{path:{type:"string",description:P.__("The path of the session to open")},activate:{type:"boolean",description:P.__("Whether to activate the console widget")}},required:["path"]}},execute:e=>{const t=e.path,o=U.find(e=>{var o;return(null===(o=e.console.sessionContext.session)||void 0===o?void 0:o.path)===t});return o?(!1!==e.activate&&W.activateById(o.id),o):B.ready.then(()=>(0,b.find)(B.sessions.running(),e=>e.path===t)?D(e):Promise.reject(`No running kernel session for path: ${t}`))}}),S.addCommand(k.create,{label:e=>{var t,o,n,r;if(e.isPalette)return P.__("New Console");if(e.isLauncher&&e.kernelPreference){const s=e.kernelPreference;return null!==(r=null===(n=null===(o=null===(t=B.kernelspecs)||void 0===t?void 0:t.specs)||void 0===o?void 0:o.kernelspecs[s.name||""])||void 0===n?void 0:n.display_name)&&void 0!==r?r:""}return P.__("Console")},icon:e=>e.isPalette?void 0:m.consoleIcon,describedBy:{args:{type:"object",properties:{isPalette:{type:"boolean",description:P.__("Whether the command is executed from the palette")},isLauncher:{type:"boolean",description:P.__("Whether the command is executed from the launcher")},kernelPreference:{type:"object",description:P.__("The kernel preference for the console")},basePath:{type:"string",description:P.__("The base path for the console")},cwd:{type:"string",description:P.__("The current working directory")},activate:{type:"boolean",description:P.__("Whether to activate the widget")},ref:{type:"string",description:P.__("The reference widget id for the insert location")},insertMode:{type:"string",description:P.__("The tab insert mode")}}}},execute:e=>{var t;return D({basePath:null!==(t=e.basePath||e.cwd||(null==l?void 0:l.model.path))&&void 0!==t?t:"",...e})}});const Y={top:m.dockTopIcon,bottom:m.dockBottomIcon,right:m.dockRightIcon,left:m.dockLeftIcon};K.forEach(e=>{const t=`console:prompt-to-${e}`;S.addCommand(t,{execute:t=>{const o=J(t);o&&o.console.setConfig({promptCellPosition:e})},isEnabled:G,label:P.__(`Prompt to ${e}`),icon:t=>t.isPalette?void 0:Y[e],describedBy:{args:{type:"object",properties:{activate:{type:"boolean",description:P.__("Whether to activate the widget")},isPalette:{type:"boolean",description:P.__("Whether the command is executed from palette")}}}}}),p&&p.addItem({command:t,category:T,args:{isPalette:!0}})}),S.addCommand(k.undo,{execute:e=>{var t;const o=J(e);if(!o)return;const n=null===(t=o.console.promptCell)||void 0===t?void 0:t.editor;n&&n.undo()},isEnabled:e=>{var t,o,n;if(!G())return!1;const r=null===(n=null===(o=null===(t=J(e))||void 0===t?void 0:t.console)||void 0===o?void 0:o.promptCell)||void 0===n?void 0:n.editor;return!!r&&r.model.sharedModel.canUndo()},icon:m.undoIcon.bindprops({stylesheet:"menuItem"}),label:P.__("Undo"),describedBy:{args:{type:"object",properties:{activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}}}),S.addCommand(k.redo,{execute:e=>{var t;const o=J(e);if(!o)return;const n=null===(t=o.console.promptCell)||void 0===t?void 0:t.editor;n&&n.redo()},isEnabled:e=>{var t,o,n;if(!G())return!1;const r=null===(n=null===(o=null===(t=J(e))||void 0===t?void 0:t.console)||void 0===o?void 0:o.promptCell)||void 0===n?void 0:n.editor;return!!r&&r.model.sharedModel.canRedo()},icon:m.redoIcon.bindprops({stylesheet:"menuItem"}),label:P.__("Redo"),describedBy:{args:{type:"object",properties:{activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}}}),S.addCommand(k.clear,{label:P.__("Clear Console Cells"),icon:e=>e.toolbar?m.clearIcon:void 0,describedBy:{args:{type:"object",properties:{toolbar:{type:"boolean",description:P.__("Whether executed from toolbar")},activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}},execute:e=>{const t=J(e);t&&t.console.clear()},isEnabled:G}),S.addCommand(k.runUnforced,{label:P.__("Run Cell (unforced)"),icon:e=>e.toolbar?m.runIcon:void 0,describedBy:{args:{type:"object",properties:{toolbar:{type:"boolean",description:P.__("Whether executed from toolbar")},activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}},execute:e=>{const t=J(e);if(t)return t.console.execute()},isEnabled:G}),S.addCommand(k.runForced,{label:P.__("Run Cell (forced)"),icon:e=>e.toolbar?m.runIcon:void 0,describedBy:{args:{type:"object",properties:{toolbar:{type:"boolean",description:P.__("Whether executed from toolbar")},activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}},execute:e=>{const t=J(e);if(t)return t.console.execute(!0)},isEnabled:G}),S.addCommand(k.linebreak,{label:P.__("Insert Line Break"),describedBy:{args:{type:"object",properties:{activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}},execute:e=>{const t=J(e);t&&t.console.insertLinebreak()},isEnabled:G}),S.addCommand(k.replaceSelection,{label:P.__("Replace Selection in Console"),describedBy:{args:{type:"object",properties:{text:{type:"string",description:P.__("The text to replace the selection with")},activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}},execute:e=>{const t=J(e);if(!t)return;const o=e.text||"";t.console.replaceSelection(o)},isEnabled:G}),S.addCommand(k.interrupt,{label:P.__("Interrupt Kernel"),describedBy:{args:{type:"object",properties:{activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}},execute:e=>{var t;const o=J(e);if(!o)return;const n=null===(t=o.console.sessionContext.session)||void 0===t?void 0:t.kernel;return n?n.interrupt():void 0},isEnabled:G}),S.addCommand(k.restart,{label:P.__("Restart Kernel…"),icon:e=>e.toolbar?m.refreshIcon:void 0,describedBy:{args:{type:"object",properties:{toolbar:{type:"boolean",description:P.__("Whether executed from toolbar")},activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}},execute:e=>{const t=J(e);if(t)return M.restart(t.console.sessionContext)},isEnabled:G}),S.addCommand(k.shutdown,{label:P.__("Shut Down"),describedBy:{args:{type:"object",properties:{activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}},execute:e=>{const t=J(e);if(t)return t.console.sessionContext.shutdown()}}),S.addCommand(k.closeAndShutdown,{label:P.__("Close and Shut Down…"),execute:e=>{const t=J(e);if(t)return(0,r.showDialog)({title:P.__("Shut down the console?"),body:P.__('Are you sure you want to close "%1"?',t.title.label),buttons:[r.Dialog.cancelButton({ariaLabel:P.__("Cancel console Shut Down")}),r.Dialog.warnButton({ariaLabel:P.__("Confirm console Shut Down")})]}).then(e=>!!e.button.accept&&S.execute(k.shutdown,{activate:!1}).then(()=>(t.dispose(),!0)))},isEnabled:G,describedBy:{args:{type:"object",properties:{activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}}}),S.addCommand(k.inject,{label:P.__("Inject some code in a console."),describedBy:{args:{type:"object",properties:{path:{type:"string",description:P.__("The path of the console session")},code:{type:"string",description:P.__("The code to inject")},metadata:{type:"object",description:P.__("The metadata for the code")},activate:{type:"boolean",description:P.__("Whether to activate the widget")}},required:["path","code"]}},execute:e=>{const t=e.path;U.find(o=>{var n;return(null===(n=o.console.sessionContext.session)||void 0===n?void 0:n.path)===t&&(!1!==e.activate&&W.activateById(o.id),o.console.inject(e.code,e.metadata),!0)})},isEnabled:G}),S.addCommand(k.changeKernel,{label:P.__("Change Kernel…"),describedBy:{args:{type:"object",properties:{activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}},execute:e=>{const t=J(e);if(t)return M.selectKernel(t.console.sessionContext)},isEnabled:G}),S.addCommand(k.getKernel,{label:P.__("Get Kernel"),describedBy:{args:{type:"object",properties:{activate:{type:"boolean",description:P.__("Whether to activate the widget")}}}},execute:e=>{var t;const o=J({activate:!1,...e});if(o)return null===(t=o.sessionContext.session)||void 0===t?void 0:t.kernel},isEnabled:G});const Q=[k.create],V=()=>{Object.values(k).filter(e=>!Q.includes(e)).forEach(t=>e.commands.notifyCommandChanged(t))};U.currentChanged.connect(V),null===(E=W.currentChanged)||void 0===E||E.connect(V),p&&[k.create,k.linebreak,k.clear,k.runUnforced,k.runForced,k.restart,k.interrupt,k.changeKernel,k.closeAndShutdown].forEach(e=>{p.addItem({command:e,category:T,args:{isPalette:!0}})}),d&&(d.fileMenu.closeAndCleaners.add({id:k.closeAndShutdown,isEnabled:G}),d.kernelMenu.kernelUsers.changeKernel.add({id:k.changeKernel,isEnabled:G}),d.kernelMenu.kernelUsers.clearWidget.add({id:k.clear,isEnabled:G}),d.kernelMenu.kernelUsers.interruptKernel.add({id:k.interrupt,isEnabled:G}),d.kernelMenu.kernelUsers.restartKernel.add({id:k.restart,isEnabled:G}),d.kernelMenu.kernelUsers.shutdownKernel.add({id:k.shutdown,isEnabled:G}),d.runMenu.codeRunners.run.add({id:k.runForced,isEnabled:G}),d.editMenu.clearers.clearCurrent.add({id:k.clear,isEnabled:G}),d.editMenu.undoers.redo.add({id:k.redo,isEnabled:G}),d.editMenu.undoers.undo.add({id:k.undo,isEnabled:G}),d.helpMenu.getKernel.add({id:k.getKernel,isEnabled:G}));const X={notebook:P.__("Execute with Shift+Enter"),terminal:P.__("Execute with Enter")};return S.addCommand(k.interactionMode,{label:e=>{var t;return null!==(t=X[e.interactionMode])&&void 0!==t?t:"Set the console interaction mode."},execute:async e=>{try{await i.set(R,"interactionMode",e.interactionMode)}catch(e){console.error(`Failed to set ${R}:keyMap - ${e.message}`)}},isToggled:e=>e.interactionMode===q,describedBy:{args:{type:"object",properties:{interactionMode:{type:"string",enum:["notebook","terminal"],description:P.__("The interaction mode for the console")}}}}}),U},autoStart:!0},E={id:"@jupyterlab/console-extension:factory",description:"Provides the console widget content factory.",provides:a.ConsolePanel.IContentFactory,requires:[s.IEditorServices],autoStart:!0,activate:(e,t)=>{const o=t.factoryService.newInlineEditor;return new a.ConsolePanel.ContentFactory({editorFactory:o})}},j={id:"@jupyterlab/console-extension:kernel-status",description:"Adds the console to the kernel status indicator model.",autoStart:!0,requires:[a.IConsoleTracker,r.IKernelStatusModel],activate:(e,t,o)=>{o.addSessionProvider(e=>e&&t.has(e)?e.sessionContext:null)}},P={id:"@jupyterlab/console-extension:cursor-position",description:"Adds the console to the code editor cursor position model.",autoStart:!0,requires:[a.IConsoleTracker,s.IPositionModel],activate:(e,t,o)=>{let n=null;o.addEditorProvider(async e=>{let r=null;if(e!==n){if(null==n||n.console.promptCellCreated.disconnect(o.update),n=null,e&&t.has(e)){e.console.promptCellCreated.connect(o.update);const t=e.console.promptCell;r=null,t&&(await t.ready,r=t.editor),n=e}}else if(e){const t=e.console.promptCell;r=null,t&&(await t.ready,r=t.editor)}return r})}},B=[E,I,f,j,P,{id:"@jupyterlab/console-extension:completer",description:"Adds completion to the console.",autoStart:!0,requires:[a.IConsoleTracker],optional:[i.ICompletionProviderManager,h.ITranslator,r.ISanitizer],activate:function(e,t,o,n,s){if(!o)return;const i=(null!=n?n:h.nullTranslator).load("jupyterlab"),a=null!=s?s:new r.Sanitizer;e.commands.addCommand(k.invokeCompleter,{label:i.__("Display the completion helper."),execute:()=>{const e=t.currentWidget&&t.currentWidget.id;if(e)return o.invoke(e)},describedBy:{args:{type:"object",properties:{}}}}),e.commands.addCommand(k.selectCompleter,{label:i.__("Select the completion suggestion."),execute:()=>{const e=t.currentWidget&&t.currentWidget.id;if(e)return o.select(e)},describedBy:{args:{type:"object",properties:{}}}}),e.commands.addKeyBinding({command:k.selectCompleter,keys:["Enter"],selector:".jp-ConsolePanel .jp-mod-completer-active"});const c=async(e,t)=>{var n,r;const s={editor:null!==(r=null===(n=t.console.promptCell)||void 0===n?void 0:n.editor)&&void 0!==r?r:null,session:t.console.sessionContext.session,widget:t};await o.updateCompleter(s),t.console.promptCellCreated.connect((e,n)=>{const r={editor:n.editor,session:e.sessionContext.session,widget:t,sanitzer:a};o.updateCompleter(r).catch(console.error)}),t.console.sessionContext.sessionChanged.connect(()=>{var e,n;const r={editor:null!==(n=null===(e=t.console.promptCell)||void 0===e?void 0:e.editor)&&void 0!==n?n:null,session:t.console.sessionContext.session,widget:t,sanitizer:a};o.updateCompleter(r).catch(console.error)})};t.widgetAdded.connect(c),o.activeProvidersChanged.connect(()=>{t.forEach(e=>{c(0,e).catch(e=>console.error(e))})})}},x]}}]);