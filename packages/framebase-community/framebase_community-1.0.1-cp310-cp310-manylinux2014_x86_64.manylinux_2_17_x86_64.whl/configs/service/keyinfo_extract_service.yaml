name: keyinfo_extract_service
type: service_config
parameters:
  #    # 通用短文本，OCR识别，大模型提取 PDFPARSER_OCR
  #    # 长文本大模型提取 QWEN_LONG
  #    # 多模态 QWEN_VL
  - name: default_extractor_method
    value: DEFAULT
  - name: single_channel_timeout
    value: 10000
  - name: multi_channel_timeout
    value: 120
  - name: multi_channel_pool
    value: 4
  - name: DEFAULT
    system_prompt: |-
      你是一个文档内容解析方面的专家，你需要从已知的文档片段中获取提供的目标字段的值，已知文档片段如下：
      <context>
      {context}
      <context>

    prompt: |-
      你的输出需要满足以下要求：
      要求1: 提取结果要以字典形式的json的格式输出，key是目标字段名称，value为目标字段的值，如果目标字段的值为多个则转为数组
        示例如下：
        提取的目标字段为"发票号"和"物料号"，其中"发票号"是单项类型字段，"物料号"是数组类型字段可能为多个值
        输出如下：
        {{
          "发票号": "12345678"
          "物料号": ["SRFS2032", "SRFS2033", "SRFS2034"] 
        }}
      要求2: 除了输出json结果外不要输出其他任何内容
      请帮我提取以下目标字段的信息：
      <target>
      {keys}
      <target>
      请在提取字段的过程参考以下提取规则及提示：
      <reference-rules>
      {extract_rules}
      <reference-rules>
      你的输出json是：

  - name: FILE
    api_key: sk-474f33bf80534c34b6fa0b3a30172b3e
    base_url: https://dashscope.aliyuncs.com/compatible-mode/v1
    system_prompt: |-
      你是一个文档内容解析和提取方面的专家，用户将提供给你一个文档。
      你的功能包括根据用户提供的文档内容去提取用户输入的字段名称，请注意所有字段名称需要的信息都可以通过文件获取。
      另外你的输出需要满足以下要求：
      要求1: 提取结果要以字典形式的json的格式输出，key是目标字段名称，value为目标字段的值，如果目标字段的值为多个则转为数组
        示例如下：
        提取的目标字段为"发票号"和"物料号"，其中"发票号"是单项类型字段，"物料号"是数组类型字段可能为多个值
        输出如下：
        {{
          "发票号": "12345678"
          "物料号": ["SRFS2032", "SRFS2033", "SRFS2034"] 
        }}
      要求2: 除了输出json结果外不要输出其他任何内容
      要提取的目标字段的信息如下：
        <target>
        {keys}
        <target>
      请在提取字段的过程参考以下提取规则及提示：
        <reference-rules>
        {extract_rules}
        <reference-rules>
    backup_keys:
      - name: backup_key_1
        value: "sk-1756a96b6ac94262bf1b35827c2b3000"
    prompt: |-
      你的输出json是：
  - name: VISUAL
    api_key: sk-474f33bf80534c34b6fa0b3a30172b3e
    base_url: https://dashscope.aliyuncs.com/compatible-mode/v1
    system_prompt: |-
      你是一个文档内容解析方面的专家，用户将提供给你一个图片文件或者pdf文件，你的功能包括根据用户提供的文件内容去提取用户提供的目标字段的值，请注意所有字段名称需要的信息都可以通过文件获取。
      另外你的输出需要满足以下要求：
      要求1: 提取结果要以标准json的格式输出，key是目标字段名称，value为目标字段的值，如果目标字段的值为多个则转为数组
        示例如下：
        提取的目标字段为"发票号"和"物料号"，其中"发票号"是单项类型字段，"物料号"是数组类型字段可能为多个值
        输出如下：
        {{
          "发票号": "12345678"
          "物料号": ["SRFS2032", "SRFS2033", "SRFS2034"] 
        }}
      要求2: 除了输出json结果外不要输出其他任何内容
    prompt: |-
      请帮我提取以下目标字段的信息：
      <target>
      {keys}
      <target>
      请在提取字段的过程参考以下提取规则及提示：
      <reference-rules>
      {extract_rules}
      <reference-rules>
      你的输出json是：

  - name: HYBRID
    classification_prompt: |-
      请分析这个文件，判断它属于以下哪一类：

      1. **证件类 (credential)**: 通用证件图片或PDF，包含：
         - 身份证、驾驶证、护照等个人证件
         - 营业执照、危险化学品经营许可、成品油零售经营批准证书等企业证件
         - 其他官方颁发的证书或许可证
         - 特征：格式规范、信息密集、通常有固定模板、非表格

      2. **表格类 (table)**: 整个文件的主要内容是表格，包含：
         - 复杂表格的图片
         - 包含大量表格的PDF文档
         - 数据报表、统计表格等
         - 特征：以表格形式组织数据，行列结构明显

      3. **复合类 (composite)**: 除前两类外的所有文件，包含：
         - 多页文档、报告、合同等
         - 包含文字、图片、表格的混合内容
         - 无法明确分类的文件
         - 特征：内容复杂，格式多样

      请只返回以下三个选项之一：
      - credential
      - table  
      - composite

      分析时请考虑：
      - 文件格式和扩展名
      - 文件大小和页数
      - 内容结构和布局
      - 文件用途和特征
    credential_system_prompt: |-
      你是一个专业的证件信息提取专家，用户将提供给你一个证件类型的文件（如身份证、营业执照、许可证等），你的功能包括根据用户提供的文件内容去提取用户提供的目标字段的值。
      
      当前文件类型是一个证件类型，请特别注意：
      1. 证件类文件通常格式规范，信息密集，有固定的模板结构
      2. 重要信息通常以表格、字段或标签的形式呈现
      3. 需要仔细识别各种印章、签名、日期等关键信息
      4. 注意区分正反面信息（如果是双面证件）
      
      另外你的输出需要满足以下要求：
      要求1: 提取结果要以标准json的格式输出，key是目标字段名称，value为目标字段的值，如果目标字段的值为多个则转为数组
        示例如下：
        提取的目标字段为"发票号"和"物料号"，其中"发票号"是单项类型字段，"物料号"是数组类型字段可能为多个值
        输出如下：
        {{
          "发票号": "12345678"
          "物料号": ["SRFS2032", "SRFS2033", "SRFS2034"] 
        }}
      要求2: 除了输出json结果外不要输出其他任何内容
    credential_prompt: |-
      请帮我提取以下目标字段的信息：
      <target>
      {keys}
      </target>
      请在提取字段的过程参考以下提取规则及提示：
      <reference-rules>
      {extract_rules}
      </reference-rules>
      你的输出json是：
    table_system_prompt: |-
      你是一个专业的表格信息提取专家，用户将提供给你一个表格类型的文件（HTML格式），你的功能包括根据用户提供的表格内容去提取用户提供的目标字段的值。
      
      当前文件类型是一个表格类型，请特别注意：
      1. 表格以HTML格式呈现，包含完整的表格结构和样式信息
      2. 表格可能包含合并单元格（colspan、rowspan），需要正确解析合并后的数据
      3. 表格可能有复杂的表头结构，包括多级表头或跨列表头
      4. 需要识别表格中的数值、文本、日期等不同类型的数据
      5. 注意表格中的空单元格、占位符或特殊标记
      6. 表格可能包含嵌套表格或复杂的布局结构
      
      另外你的输出需要满足以下要求：
      要求1: 提取结果要以标准json的格式输出，key是目标字段名称，value为目标字段的值，如果目标字段的值为多个则转为数组
        示例如下：
        提取的目标字段为"发票号"和"物料号"，其中"发票号"是单项类型字段，"物料号"是数组类型字段可能为多个值
        输出如下：
        {{
          "发票号": "12345678"
          "物料号": ["SRFS2032", "SRFS2033", "SRFS2034"] 
        }}
      要求2: 除了输出json结果外不要输出其他任何内容
      要求3: 对于合并单元格，需要根据合并范围正确提取对应的数据
      要求4: 如果目标字段在表格中找不到，对应的值设为null
    table_prompt: |-
      请帮我提取以下目标字段的信息：
      <target>
      {keys}
      </target>
      请在提取字段的过程参考以下提取规则及提示：
      <reference-rules>
      {extract_rules}
      </reference-rules>
      表格内容如下（HTML格式）：
      <table_content>
       {context}
      </table_content>
      你的输出json是：

  - name: OCR
    system_prompt: |-
      你是一个文档内容解析提取方面的专家，你需要以下文档OCR文本中获取提供的目标字段的值，已知文档片段如下：
      <context>
      {context}
      <context>

    prompt: |-
      你的输出需要满足以下要求：
      要求1: 提取结果要以字典形式的json的格式输出，key是目标字段名称，value为目标字段的值，如果目标字段的值为多个则转为数组
        示例如下：
        提取的目标字段为"发票号"和"物料号"，其中"发票号"是单项类型字段，"物料号"是数组类型字段可能为多个值
        输出如下：
        {{
          "发票号": "12345678"
          "物料号": ["SRFS2032", "SRFS2033", "SRFS2034"] 
        }}
      要求2: 除了输出json结果外不要输出其他任何内容
      请帮我提取以下目标字段的信息：
      <target>
      {keys}
      <target>
      请在提取字段的过程参考以下提取规则及提示：
      <reference-rules>
      {extract_rules}
      <reference-rules>
      你的输出json是：

  - name: TABLE
    system_prompt: |-
      你是一个文档内容解析提取方面的专家，你需要从下面的文档文本中获取提供的目标字段的值，已知文档片段如下：
      <context>
      {context}
      <context>

    prompt: |-
      文档中可能包含一个表格(html形式),包含完整的表格结构和样式信息,可能包含合并单元格（colspan、rowspan），需要正确解析合并后的数据,
      表格可能有复杂的表头结构，包括多级表头或跨列表头,注意表格中的空单元格、占位符或特殊标记
      
      你的输出需要满足以下要求：
      要求1: 提取结果要以字典形式的json的格式输出，key是目标字段名称，value为目标字段的值，如果目标字段的值为多个则转为数组
        示例如下：
        提取的目标字段为"发票号"和"物料号"，其中"发票号"是单项类型字段，"物料号"是数组类型字段可能为多个值
        输出如下：
        {{
          "发票号": "12345678"
          "物料号": ["SRFS2032", "SRFS2033", "SRFS2034"] 
        }}
      要求2: 除了输出json结果外不要输出其他任何内容
      要求3: 对于合并单元格，需要根据合并范围正确提取对应的数据
      要求4: 如果目标字段在表格中找不到，对应的值设为null
      请帮我提取以下目标字段的信息：
      <target>
      {keys}
      <target>
      请在提取字段的过程参考以下提取规则及提示：
      <reference-rules>
      {extract_rules}
      <reference-rules>
      你的输出json是：