"use strict";(self.webpackChunk_elyra_code_snippet_extension=self.webpackChunk_elyra_code_snippet_extension||[]).push([[509,453,55,436],{1411:(e,t,n)=>{n.d(t,{A:()=>s});var a=n(6758),o=n.n(a),i=n(935),r=n.n(i)()(o());r.push([e.id,'/*\n * Copyright 2018-2025 Elyra Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n.elyra-codeSnippet-drag-image {\n  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);\n  width: var(--jp-private-notebook-dragImage-width);\n  height: var(--jp-private-notebook-dragImage-height);\n  color: var(--jp-ui-font-color1);\n  background: var(--jp-layout-color1);\n}\n\n.elyra-metadata-code-snippets\n  .elyra-metadata-item\n  .elyra-expandableContainer-details-visible {\n  height: 100px;\n}\n',""]);const s=r},935:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",a=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),a&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),a&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,a,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(a)for(var s=0;s<this.length;s++){var d=this[s][0];null!=d&&(r[d]=!0)}for(var c=0;c<e.length;c++){var l=[].concat(e[c]);a&&r[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),t.push(l))}},t}},6758:e=>{e.exports=function(e){return e[1]}},3453:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var a=n(2591),o=n.n(a),i=n(1740),r=n.n(i),s=n(8128),d=n.n(s),c=n(855),l=n.n(c),p=n(3051),u=n.n(p),h=n(3656),m=n.n(h),v=n(1411),g={};g.styleTagTransform=m(),g.setAttributes=l(),g.insert=d().bind(null,"head"),g.domAPI=r(),g.insertStyleElement=u(),o()(v.A,g);const f=v.A&&v.A.locals?v.A.locals:void 0},2591:e=>{var t=[];function n(e){for(var n=-1,a=0;a<t.length;a++)if(t[a].identifier===e){n=a;break}return n}function a(e,a){for(var i={},r=[],s=0;s<e.length;s++){var d=e[s],c=a.base?d[0]+a.base:d[0],l=i[c]||0,p="".concat(c," ").concat(l);i[c]=l+1;var u=n(p),h={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==u)t[u].references++,t[u].updater(h);else{var m=o(h,a);a.byIndex=s,t.splice(s,0,{identifier:p,updater:m,references:1})}r.push(p)}return r}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=a(e=e||[],o=o||{});return function(e){e=e||[];for(var r=0;r<i.length;r++){var s=n(i[r]);t[s].references--}for(var d=a(e,o),c=0;c<i.length;c++){var l=n(i[c]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}i=d}}},8128:e=>{var t={};e.exports=function(e,n){var a=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},3051:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},855:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},1740:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,o&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},3656:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},96:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(o,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function s(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}d((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeSnippetService=t.CODE_SNIPPET_SCHEMA=t.CODE_SNIPPET_SCHEMASPACE=void 0;const o=n(548),i=n(9827);t.CODE_SNIPPET_SCHEMASPACE="code-snippets",t.CODE_SNIPPET_SCHEMA="code-snippet",t.CodeSnippetService=class{static findAll(){return a(this,void 0,void 0,(function*(){var e;return null!==(e=yield o.MetadataService.getMetadata(t.CODE_SNIPPET_SCHEMASPACE))&&void 0!==e?e:[]}))}static findByLanguage(e){return a(this,void 0,void 0,(function*(){try{const t=yield this.findAll(),n=[];for(const a of t)a.metadata.language===e&&n.push(a);return n}catch(e){return Promise.reject(e)}}))}static deleteCodeSnippet(e){return(0,i.showDialog)({title:`Delete snippet '${e.display_name}'?`,buttons:[i.Dialog.cancelButton(),i.Dialog.okButton()]}).then((n=>!!n.button.accept&&o.MetadataService.deleteMetadata(t.CODE_SNIPPET_SCHEMASPACE,e.name).then((()=>!0))))}}},3971:function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(o,i){function r(e){try{d(a.next(e))}catch(e){i(e)}}function s(e){try{d(a.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}d((a=a.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeSnippetWidget=void 0,n(3453);const i=n(8428),r=n(5836),s=n(9827),d=n(4568),c=n(2690),l=n(460),p=n(7292),u=n(7023),h=n(8389),m=n(1409),v=n(4053),g=n(7262),f=n(1355),C=o(n(3345)),S=n(96);class E extends i.MetadataDisplay{constructor(e){super(e),this.editors={},this.insertCodeSnippet=e=>a(this,void 0,void 0,(function*(){var t,n,a,o,i,r,s,c,l;const u=this.props.getCurrentWidget(),m=this.extractMetadataCodeSnippet(e),v=this.extractMetadataLanguage(e);if(null!==u)if(this.isFileEditor(u)){const a=u.content.editor,o=/^\.(md|mkdn?|mdown|markdown)$/,i=this.getEditorLanguage(u);null!==p.PathExt.extname(u.context.path).match(o)&&"markdown"!==v.toLowerCase()?null===(t=a.replaceSelection)||void 0===t||t.call(a,this.addMarkdownCodeBlock(v,m)):i?yield this.verifyLanguageAndInsert(e,i,a):null===(n=a.replaceSelection)||void 0===n||n.call(a,m)}else if(u instanceof h.NotebookPanel){const t=u,n=t.content.activeCell;if(null===n)return;const p=n.editor;if(null!==p){if(n instanceof d.CodeCell){const n=yield null===(o=null===(a=t.sessionContext.session)||void 0===a?void 0:a.kernel)||void 0===o?void 0:o.info,i=(null==n?void 0:n.language_info.name)||"";yield this.verifyLanguageAndInsert(e,i,p)}else n instanceof d.MarkdownCell&&"markdown"!==v.toLowerCase()?null===(i=p.replaceSelection)||void 0===i||i.call(p,this.addMarkdownCodeBlock(v,m)):null===(r=p.replaceSelection)||void 0===r||r.call(p,m);const g=t.content,f=null!==(s=g.activeCellIndex)&&void 0!==s?s:-1,C=new h.NotebookPanel.ContentFactory({editorFactory:this.props.editorServices.factoryService.newInlineEditor}),S={model:null===(c=g.activeCell)||void 0===c?void 0:c.model,rendermime:g.rendermime,contentFactory:C},E=C.createCodeCell(S);E.cell_type="code",null===(l=u.content.model)||void 0===l||l.sharedModel.insertCell(f,E),t.content.activeCellIndex=f+1}else this.showErrDialog("notebookCellEditor have to be not null")}else this.showErrDialog("Code snippet insert failed: Unsupported widget")})),this.isFileEditor=e=>e.content instanceof u.FileEditor,this.getEditorLanguage=e=>{var t;const n=l.EditorLanguageRegistry.getDefaultLanguages().find((t=>t.mime.includes(e.content.model.mimeType)));return null!==(t=null==n?void 0:n.displayName)&&void 0!==t?t:""},this.addMarkdownCodeBlock=(e,t)=>"```"+e+"\n"+t+"\n```",this.verifyLanguageAndInsert=(e,t,n)=>a(this,void 0,void 0,(function*(){var a,o;const i=this.extractMetadataCodeSnippet(e),r=this.extractMetadataLanguage(e);t&&r.toLowerCase()!==t.toLowerCase()?(yield this.showWarnDialog(t,e.display_name)).button.accept&&(null===(a=n.replaceSelection)||void 0===a||a.call(n,i)):null===(o=n.replaceSelection)||void 0===o||o.call(n,i)})),this.showWarnDialog=(e,t)=>a(this,void 0,void 0,(function*(){return(0,s.showDialog)({title:"Warning",body:`Code snippet "${t}" is incompatible with ${e}. Continue?`,buttons:[s.Dialog.cancelButton(),s.Dialog.okButton()]})})),this.showErrDialog=e=>(0,s.showDialog)({title:"Error",body:e,buttons:[s.Dialog.okButton()]}),this.extractMetadataCodeSnippet=e=>{var t;return(null!==(t=e.metadata.code)&&void 0!==t?t:[]).join("\n")},this.extractMetadataLanguage=e=>{var t;return null!==(t=e.metadata.language)&&void 0!==t?t:"Unknown"},this.extractMetadataDescription=e=>{var t;return null!==(t=e.metadata.description)&&void 0!==t?t:""},this.actionButtons=e=>[{title:"Copy to clipboard",icon:m.pasteIcon,feedback:"Copied!",onClick:()=>{s.Clipboard.copyToSystem(this.extractMetadataCodeSnippet(e))}},{title:"Insert",icon:r.importIcon,onClick:()=>{this.insertCodeSnippet(e)}},{title:"Edit",icon:m.editIcon,onClick:()=>{this.props.openMetadataEditor({onSave:this.props.updateMetadata,schemaspace:S.CODE_SNIPPET_SCHEMASPACE,schema:S.CODE_SNIPPET_SCHEMA,name:e.name})}},{title:"Duplicate",icon:m.copyIcon,onClick:()=>{i.MetadataCommonService.duplicateMetadataInstance(S.CODE_SNIPPET_SCHEMASPACE,e,this.props.metadata).then((e=>{this.props.updateMetadata()})).catch((e=>a(this,void 0,void 0,(function*(){yield r.RequestErrors.serverError(e)}))))}},{title:"Delete",icon:r.trashIcon,onClick:()=>{S.CodeSnippetService.deleteCodeSnippet(e).then((t=>{if(t){this.props.updateMetadata(),delete this.editors[e.name];const t=(0,v.find)(this.props.shell.widgets("main"),((t,n)=>t.id===`elyra-metadata-editor:${S.CODE_SNIPPET_SCHEMASPACE}:${S.CODE_SNIPPET_SCHEMA}:${e.name}`));t&&t.dispose()}})).catch((e=>a(this,void 0,void 0,(function*(){yield r.RequestErrors.serverError(e)}))))}}],this.renderMetadata=e=>C.default.createElement("div",{key:e.name,"data-item-id":e.display_name,className:i.METADATA_ITEM,style:this.state.metadata.includes(e)?{}:{display:"none"}},C.default.createElement(r.ExpandableComponent,{displayName:this.getDisplayName(e),tooltip:this.extractMetadataDescription(e),actionButtons:this.actionButtons(e),onExpand:()=>{this.editors[e.name].redo()},onMouseDown:t=>{this.handleDragSnippet(t,e)}},C.default.createElement("div",{id:e.name}))),this.createPreviewEditors=()=>{const e=this.props.editorServices.factoryService.newInlineEditor;this.props.metadata.map((t=>{const n=this.extractMetadataCodeSnippet(t);if(t.name in this.editors)this.editors[t.name].model.sharedModel.setSource(n);else{const a=document.getElementById(t.name);if(null===a)return;const o=this.extractMetadataLanguage(t),i=this.props.editorServices.mimeTypeService.getMimeTypeByLanguage({value:n,name:o,codemirror_mode:o}),r=e({config:{readOnly:!0},host:a,model:new c.CodeEditor.Model({mimeType:i})});r.model.sharedModel.setSource(n),this.editors[t.name]=r}}))},this._drag=null,this._dragData=null,this.handleDragMove=this.handleDragMove.bind(this),this._evtMouseUp=this._evtMouseUp.bind(this)}handleDragSnippet(e,t){const{button:n}=e;if(0!==n)return;this._dragData={pressX:e.clientX,pressY:e.clientY,dragImage:null};const a=e=>{this._evtMouseUp(e,t,o)},o=e=>{this.handleDragMove(e,t,o,a)},i=e.target;i.addEventListener("mouseup",a,{once:!0,capture:!0}),i.addEventListener("mousemove",o,!0),i.ondragstart=()=>!1}_evtMouseUp(e,t,n){e.preventDefault(),e.stopPropagation(),e.target.removeEventListener("mousemove",n,!0)}handleDragMove(e,t,n,a){e.preventDefault(),e.stopPropagation();const o=this._dragData;if(o&&this.shouldStartDrag(o.pressX,o.pressY,e.clientX,e.clientY)){const i=document.createElement("div");i.innerHTML=this.getDisplayName(t),i.classList.add("elyra-codeSnippet-drag-image"),o.dragImage=i;const r=e.target;r.removeEventListener("mousemove",n,!0),r.removeEventListener("mouseup",a,!0),this.startDrag(o.dragImage,t,e.clientX,e.clientY)}}shouldStartDrag(e,t,n,a){const o=Math.abs(n-e),i=Math.abs(a-t);return o>=0||i>=5}startDrag(e,t,n,o){return a(this,void 0,void 0,(function*(){var a,i;const r=this.props.getCurrentWidget().content,s=new h.NotebookPanel.ContentFactory({editorFactory:this.props.editorServices.factoryService.newInlineEditor}),d={model:null===(a=r.activeCell)||void 0===a?void 0:a.model,rendermime:r.rendermime,contentFactory:s},c={model:null===(i=r.activeCell)||void 0===i?void 0:i.model,rendermime:r.rendermime,contentFactory:s},l=s.createCodeCell(d),p=s.createMarkdownCell(c),u=this.extractMetadataLanguage(t),m="markdown"!==u.toLowerCase()?l:p,v=this.extractMetadataCodeSnippet(t);"markdown"!==u.toLowerCase()&&"code"===m.model.type&&m.model.sharedModel.setSource(v),"markdown"===u.toLowerCase()&&"markdown"===m.model.type&&m.model.sharedModel.setSource(v),this._drag=new f.Drag({mimeData:new g.MimeData,dragImage:e,supportedActions:"copy-move",proposedAction:"copy",source:this});const C=[m.model.toJSON()];return this._drag.mimeData.setData("application/vnd.jupyter.cells",C),this._drag.mimeData.setData("text/plain",v),this._drag.start(n,o).then((()=>{this._drag=null,this._dragData=null}))}))}getDisplayName(e){return`[${this.extractMetadataLanguage(e)}] ${e.display_name}`}sortMetadata(){this.props.metadata.sort(((e,t)=>this.getDisplayName(e).localeCompare(this.getDisplayName(t))))}matchesSearch(e,t){return e=e.toLowerCase(),t.name.toLowerCase().includes(e)||t.display_name.toLowerCase().includes(e)||this.extractMetadataLanguage(t).toLowerCase().includes(e)}componentDidMount(){this.createPreviewEditors()}componentDidUpdate(){this.createPreviewEditors()}}class y extends i.MetadataWidget{constructor(e){super(e),this.props=e}fetchMetadata(){return a(this,void 0,void 0,(function*(){return S.CodeSnippetService.findAll().catch((e=>a(this,void 0,void 0,(function*(){return yield r.RequestErrors.serverError(e),[]}))))}))}renderDisplay(e){return Array.isArray(e)&&!e.length?C.default.createElement("div",null,C.default.createElement("br",null),C.default.createElement("h6",{className:"elyra-no-metadata-msg"},"Click the + button to add ",this.props.display_name.toLowerCase())):C.default.createElement(E,{metadata:e,openMetadataEditor:this.openMetadataEditor,updateMetadata:this.updateMetadata,schemaspace:S.CODE_SNIPPET_SCHEMASPACE,getCurrentWidget:this.props.getCurrentWidget,className:"elyra-metadata-code-snippets",editorServices:this.props.editorServices,shell:this.props.app.shell,sortMetadata:!0})}}t.CodeSnippetWidget=y},8509:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.code_snippet_extension=void 0,n(3453);const a=n(5836),o=n(5584),i=n(9827),r=n(2690),s=n(4176),d=n(7023),c=n(2919),l=n(8389),p=n(96),u=n(3971),h="codesnippet:save-as-snippet";t.code_snippet_extension={id:"elyra-code-snippet-extension",autoStart:!0,requires:[i.ICommandPalette,o.ILayoutRestorer,r.IEditorServices],activate:(e,t,n,o)=>{console.log("Elyra - code-snippet extension is activated!");const i=new u.CodeSnippetWidget({app:e,display_name:"Code Snippets",schemaspace:p.CODE_SNIPPET_SCHEMASPACE,schema:p.CODE_SNIPPET_SCHEMA,icon:a.codeSnippetIcon,getCurrentWidget:()=>e.shell.currentWidget,editorServices:o,titleContext:"",addLabel:"code snippet"}),r=`elyra-metadata:${p.CODE_SNIPPET_SCHEMASPACE}`;i.id=r,i.title.icon=a.codeSnippetIcon,i.title.caption="Code Snippets",n.add(i,r),e.shell.add(i,"left",{rank:900}),e.commands.addCommand(h,{label:"Save As Code Snippet",isEnabled:()=>{var t,n;const a=e.shell.currentWidget,o=C(a);let i="";return o?i=m(o):f(a)&&(i=null!==(n=null===(t=document.getSelection())||void 0===t?void 0:t.toString())&&void 0!==n?n:""),i.length>0||!!(g(a)&&v().length>0)},isVisible:()=>!0,execute:()=>{var t,n;const a=e.shell.currentWidget,o=C(a);let r="";if(o?r=m(o):f(a)&&(r=null!==(n=null===(t=document.getSelection())||void 0===t?void 0:t.toString())&&void 0!==n?n:""),r.length>0)i.openMetadataEditor({schemaspace:p.CODE_SNIPPET_SCHEMASPACE,schema:p.CODE_SNIPPET_SCHEMA,code:r.split("\n"),onSave:i.updateMetadata});else{const e=v().join("\n\n").split("\n");i.openMetadataEditor({schemaspace:p.CODE_SNIPPET_SCHEMASPACE,schema:p.CODE_SNIPPET_SCHEMA,code:e,onSave:i.updateMetadata})}}}),e.contextMenu.addItem({command:h,selector:".jp-Cell"}),e.contextMenu.addItem({command:h,selector:".jp-FileEditor"}),e.contextMenu.addItem({command:h,selector:".jp-MarkdownViewer"});const m=(e,t)=>{var n,a;const o=e.getSelection(),i=e.getOffsetAt(o.start),r=e.getOffsetAt(o.end),s=e.model.sharedModel.getSource(),d=s.substring(i,r);return!d&&s?null!==(a=null===(n=document.getSelection())||void 0===n?void 0:n.toString())&&void 0!==a?a:"":d},v=()=>{const t=e.shell.currentWidget.content,n=t.activeCell,a=[];return n&&t.widgets.forEach((e=>{if(t.isSelectedOrActive(e)){const t=e.model.toJSON().source.toString();t.length>0&&a.push(t)}})),a},g=e=>e instanceof l.NotebookPanel,f=e=>e instanceof c.MarkdownDocument,C=e=>{if((e=>e instanceof s.DocumentWidget&&e.content instanceof d.FileEditor)(e))return e.content.editor;if(g(e)){const t=e.content.activeCell;return null==t?void 0:t.editor}}}},t.default=t.code_snippet_extension}}]);