(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8538],{73846:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dataset/new",function(){return a(17294)}])},77213:function(e,t,a){"use strict";a.d(t,{Z:function(){return x}});var s=a(24246),r=a(41013),n=a(88038),i=a.n(n),o=a(86677);a(27378);var l=a(25980),d=a(90867),c=a(42478),u=a(77830),h=()=>{let e=(0,o.useRouter)();return(0,s.jsx)(r.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,s.jsxs)(r.xuv,{children:[(0,s.jsxs)(r.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,s.jsx)(r.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,s.jsx)(r.wpx,{onClick:()=>{e.push(u.AD)},children:"Configure"})]}),(0,s.jsxs)(r.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},x=e=>{let{children:t,title:a,padded:n=!0,mainProps:u}=e,x=(0,l.hz)(),m=(0,o.useRouter)(),f="/privacy-requests"===m.pathname||"/datastore-connection"===m.pathname,g=!(x.flags.messagingConfiguration&&f),{data:y}=(0,c.JE)(void 0,{skip:g}),{data:p}=(0,d.PW)(void 0,{skip:g}),j=x.flags.messagingConfiguration&&(!y||!p)&&f;return(0,s.jsxs)(r.kCb,{"data-testid":a,direction:"column",h:"100vh",children:[(0,s.jsxs)(i(),{children:[(0,s.jsxs)("title",{children:["Fides Admin UI - ",a]}),(0,s.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)(r.kCb,{as:"main",direction:"column",py:n?6:0,px:n?10:0,h:n?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...u,children:[j?(0,s.jsx)(h,{}):null,t]})]})}},39715:function(e,t,a){"use strict";var s=a(24246),r=a(41013);a(27378),t.Z=e=>{let{isEmptyState:t,yamlError:a}=e;return(0,s.jsxs)(r.xuv,{w:"fit-content",bg:"white",p:3,borderRadius:3,children:[(0,s.jsxs)(r.Ugi,{children:[(0,s.jsx)(r.X6q,{as:"h5",color:"gray.700",size:"xs",children:"YAML"}),(0,s.jsx)(r.Vp9,{colorScheme:"red",size:"sm",variant:"solid",children:"Error"})]}),(0,s.jsx)(r.xuv,{bg:"red.50",border:"1px solid",borderColor:"red.300",color:"red.300",mt:"16px",borderRadius:"6px",children:(0,s.jsxs)(r.Ugi,{alignItems:"flex-start",margin:["14px","17px","14px","17px"],children:[(0,s.jsx)(r.f9v,{}),t&&(0,s.jsxs)(r.xuv,{children:[(0,s.jsx)(r.X6q,{as:"h5",color:"red.500",fontWeight:"semibold",size:"xs",children:"Error message:"}),(0,s.jsx)(r.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:"Yaml system is required"})]}),a&&(0,s.jsxs)(r.xuv,{children:[(0,s.jsx)(r.X6q,{as:"h5",color:"red.500",fontWeight:"semibold",size:"xs",children:"Error message:"}),(0,s.jsx)(r.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:a.message}),(0,s.jsx)(r.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:a.reason}),(0,s.jsxs)(r.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:["Ln ",(0,s.jsx)("b",{children:a.mark.line}),", Col"," ",(0,s.jsx)("b",{children:a.mark.column}),", Pos"," ",(0,s.jsx)("b",{children:a.mark.position})]})]})]})})]})}},41207:function(e,t,a){"use strict";a.d(t,{F:function(){return i},M:function(){return n}});var s=a(76649),r=a(65218);let n=a.n(r)()(()=>a.e(7088).then(a.bind(a,57088)).then(e=>e.default),{loadableGenerated:{webpack:()=>[57088]},ssr:!1}),i=e=>(0,s.Ln)({name:"string"},e)&&"YAMLException"===e.name},17294:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return R}});var s=a(24246),r=a(41013),n=a(27378),i=a(77213),o=a(77830),l=a(58754),d=a(34090),c=a(86677),u=a(16125),h=a(55484),x=a(25980),m=a(40324),f=a(812),g=a(58452),y=a(46628),p=a(83265),j=a(32885),v=a(60240),b=a(20386);let w=e=>!("system_type"in e),C={url:"",classify:!1,classifyConfirmed:!1},_=h.Ry().shape({url:h.Z_().required().label("Database URL"),classify:h.O7(),classifyConfirmed:h.O7().when(["url","classify"],{is:(e,t)=>e&&t,then:()=>h.O7().equals([!0])})});var k=()=>{let[e,{isLoading:t}]=(0,b.pR)(),[a,{isLoading:n}]=(0,b.IR)(),[i,{isLoading:l}]=(0,j.Du)(),h=t||n||l,k=(0,r.pmc)(),S=(0,c.useRouter)(),A=(0,x.hz)(),z=(0,u.I0)(),E=async t=>{var a;let s=await e({organization_key:p.Av,generate:{config:{connection_string:t.url},target:v.GC.DB,type:v.j.DATASETS}});if((0,f.D4)(s))return{error:(0,f.e$)(s.error)};let r=(null!==(a=s.data.generate_results)&&void 0!==a?a:[]).filter(w);return r&&r.length>0?{datasets:r}:{error:"Unable to generate a dataset with this connection."}},T=async e=>{let t=await a(e);return(0,f.D4)(t)?{error:(0,f.e$)(t.error)}:{dataset:t.data}},R=async e=>{let{values:t,datasets:a}=e,s=await i({dataset_schemas:a.map(e=>{let{name:t,fides_key:a}=e;return{fides_key:a,name:t}}),schema_config:{organization_key:p.Av,generate:{config:{connection_string:t.url},target:v.GC.DB,type:v.j.DATASETS}}});return(0,f.D4)(s)?{error:(0,f.e$)(s.error)}:{classifyInstances:s.data.classify_instances}},D=async e=>{var t;let a=await E(e);if("error"in a){k((0,y.Vo)(a.error));return}let s=await Promise.all(a.datasets.map(e=>T(e))),r=null!==(t=s.find(e=>"error"in e))&&void 0!==t?t:s[0];if("error"in r){k((0,y.Vo)(r.error));return}if(!e.classify){k((0,y.t5)("Generated ".concat(r.dataset.name," dataset"))),S.push({pathname:o.o5,query:{datasetId:r.dataset.fides_key}});return}let n=await R({values:e,datasets:a.datasets});if("error"in n){k((0,y.Vo)(n.error));return}k((0,y.t5)("Generate and classify are now in progress")),z((0,b.Zl)(r.dataset.fides_key)),S.push("/dataset")};return(0,s.jsx)(d.J9,{initialValues:{...C,classify:A.plus},validationSchema:_,onSubmit:D,validateOnChange:!1,validateOnBlur:!1,children:e=>{let{isSubmitting:t,errors:a,values:n,submitForm:i,resetForm:o,setFieldValue:l}=e;return(0,s.jsxs)(d.l0,{children:[(0,s.jsxs)(r.gCW,{spacing:8,align:"left",children:[(0,s.jsx)(r.xvT,{size:"sm",color:"gray.700",children:"Connect to a database using the connection URL. You may have received this URL from a colleague or your Ethyca developer support engineer."}),(0,s.jsx)(r.xuv,{children:(0,s.jsx)(m.j0,{name:"url",label:"Database URL"})}),A.plus?(0,s.jsx)(m.w8,{name:"classify",label:"Classify dataset",tooltip:"Use Fides Classify to suggest labels based on your data."}):null,(0,s.jsx)(r.xuv,{children:(0,s.jsx)(r.wpx,{type:"primary",htmlType:"submit",loading:t||h,disabled:t||h,"data-testid":"create-dataset-btn",children:"Generate dataset"})})]}),(0,s.jsx)(g.Z,{title:"Generate and classify this dataset",message:"You have chosen to generate and classify this dataset. This process may take several minutes. In the meantime you can continue using Fides. You will receive a notification when the process is complete.",isOpen:void 0!==a.classifyConfirmed,onClose:()=>{o({values:{...n,classifyConfirmed:!1}})},onConfirm:()=>{l("classifyConfirmed",!0),setTimeout(()=>{i()},0)}})]})}})},S=a(66527),A=a(17245),z=a(41207),E=a(39715),T=()=>{let[e]=(0,b.IR)(),[t,a]=(0,n.useState)(!0),[i,l]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1),h=(0,n.useRef)(null),x=(0,c.useRouter)(),m=(0,r.pmc)(),{errorAlert:g}=(0,A.VY)(),[p,j]=(0,n.useState)(void 0),v=e=>{S.ZP.load(e,{json:!0}),j(void 0)},w=async t=>{let a;return"object"==typeof t&&null!==t&&"dataset"in t&&Array.isArray(t.dataset)?[a]=t.dataset:Array.isArray(t)?[a]=t:a=t,e(a)},C=e=>{m((0,y.t5)("Successfully loaded new dataset YAML")),(0,b.Zl)(e.fides_key),x.push({pathname:o.o5,query:{datasetId:e.fides_key}})},_=async()=>{l(!0);let e=h.current.getValue(),t=S.ZP.load(e,{json:!0}),a=await w(t);(0,f.D4)(a)?m((0,y.Vo)((0,f.e$)(a.error))):"data"in a&&C(a.data),l(!1)};return(0,s.jsxs)(r.kCb,{gap:"97px",children:[(0,s.jsxs)(r.xuv,{w:"75%",children:[(0,s.jsx)(r.xuv,{color:"gray.700",fontSize:"14px",mb:4,children:"Get started creating your first dataset by pasting your dataset yaml below! You may have received this yaml from a colleague or your Ethyca developer support engineer."}),(0,s.jsxs)(r.gCW,{align:"stretch",children:[(0,s.jsx)(r.izJ,{color:"gray.100"}),(0,s.jsx)(z.M,{defaultLanguage:"yaml",height:"calc(100vh - 515px)",onChange:e=>{try{u(!0),v(e),a(!!(!e||""===e.trim()))}catch(e){(0,z.F)(e)?j(e):g("Could not parse the supplied YAML")}},onMount:e=>{h.current=e,h.current.focus()},options:{fontFamily:"Menlo",fontSize:13,minimap:{enabled:!0}},theme:"light"}),(0,s.jsx)(r.izJ,{color:"gray.100"}),(0,s.jsx)(r.wpx,{type:"primary",disabled:t||!!p||i,loading:i,onClick:_,htmlType:"submit",className:"mt-6 w-fit",children:"Create dataset"})]})]}),(0,s.jsx)(r.xuv,{children:d&&(t||p)&&(0,s.jsx)(E.Z,{isEmptyState:t,yamlError:p})})]})},R=()=>{let[e,t]=(0,n.useState)(null);return(0,s.jsxs)(i.Z,{title:"Create New Dataset",children:[(0,s.jsx)(l.Z,{heading:"Datasets",breadcrumbItems:[{title:"All datasets",href:o.$m},{title:"Create new"}]}),(0,s.jsxs)(r.Kqy,{spacing:8,children:[(0,s.jsxs)(r.xuv,{children:[(0,s.jsx)(r.wpx,{onClick:()=>t("yaml"),"data-testid":"upload-yaml-btn",className:"mr-2",children:"Upload a Dataset YAML"}),(0,s.jsx)(r.wpx,{onClick:()=>t("database"),ghost:"database"===e,className:"mr-2","data-testid":"connect-db-btn",children:"Connect to a database"})]}),"database"===e&&(0,s.jsx)(r.xuv,{w:{base:"100%",lg:"50%"},children:(0,s.jsx)(k,{})}),"yaml"===e&&(0,s.jsx)(r.xuv,{w:{base:"100%"},children:(0,s.jsx)(T,{})})]})]})}}},function(e){e.O(0,[431,6527,7245,1840,2888,9774,179],function(){return e(e.s=73846)}),_N_E=e.O()}]);