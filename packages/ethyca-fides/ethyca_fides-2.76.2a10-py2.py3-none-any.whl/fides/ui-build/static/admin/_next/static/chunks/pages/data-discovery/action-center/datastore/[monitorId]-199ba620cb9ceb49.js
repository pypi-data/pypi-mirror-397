(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6721],{58095:function(e,t,n){var r=n(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,n){for(var r=-1,l=null==e?0:e.length;++r<l;)if(n(t,e[r]))return!0;return!1}},95372:function(e){e.exports=function(e,t,n,r){for(var l=e.length,a=n+(r?1:-1);r?a--:++a<l;)if(t(e[a],a,e))return a;return -1}},8817:function(e,t,n){var r=n(95372),l=n(1129),a=n(58263);e.exports=function(e,t,n){return t==t?a(e,t,n):r(e,l,n)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,n){var r=n(52485),l=n(58095),a=n(21796),i=n(65581),s=n(47111),o=n(43735);e.exports=function(e,t,n){var c=-1,d=l,u=e.length,p=!0,h=[],f=h;if(n)p=!1,d=a;else if(u>=200){var y=t?null:s(e);if(y)return o(y);p=!1,d=i,f=new r}else f=t?[]:h;e:for(;++c<u;){var g=e[c],m=t?t(g):g;if(g=n||0!==g?g:0,p&&m==m){for(var _=f.length;_--;)if(f[_]===m)continue e;t&&f.push(m),h.push(g)}else d(f,m,n)||(f!==h&&f.push(m),h.push(g))}return h}},56632:function(e,t,n){var r=n(89278),l=n(80068),a=n(50098);e.exports=function(e){return function(t,n,i){var s=Object(t);if(!l(t)){var o=r(n,3);t=a(t),n=function(e){return o(s[e],e,s)}}var c=e(t,n,i);return c>-1?s[o?t[c]:c]:void 0}}},47111:function(e,t,n){var r=n(46151),l=n(50344),a=n(43735),i=r&&1/a(new r([,-0]))[1]==1/0?function(e){return new r(e)}:l;e.exports=i},58263:function(e){e.exports=function(e,t,n){for(var r=n-1,l=e.length;++r<l;)if(e[r]===t)return r;return -1}},64925:function(e,t,n){var r=n(56632)(n(66259));e.exports=r},66259:function(e,t,n){var r=n(95372),l=n(89278),a=n(47991),i=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return -1;var o=null==n?0:a(n);return o<0&&(o=i(s+o,0)),r(e,l(t,3),o)}},50344:function(e){e.exports=function(){}},94919:function(e,t,n){var r=n(91936),l=1/0;e.exports=function(e){return e?(e=r(e))===l||e===-l?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}},47991:function(e,t,n){var r=n(94919);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},83766:function(e,t,n){var r=n(92198);e.exports=function(e){return e&&e.length?r(e):[]}},83806:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/datastore/[monitorId]",function(){return n(73662)}])},20987:function(e,t,n){"use strict";var r,l,a,i;n.d(t,{H:function(){return r},J:function(){return l}}),(a=r||(r={})).STRING="string",a.STRING_ARRAY="string[]",(i=l||(l={})).SYSTEM="system",i.DATA_USE="data use",i.DATA_CATEGORY="data category",i.DATA_SUBJECT="data subject",i.PRIVACY_DECLARATION="privacy declaration"},12627:function(e,t,n){"use strict";var r=n(24246),l=n(79283),a=n(34929);t.Z=e=>{let{selectedTaxonomies:t,showDisabled:n=!1,...i}=e,{getDataCategoryDisplayNameProps:s,getDataCategories:o}=(0,a.Z)(),c=(n?o():o().filter(e=>e.active)).filter(e=>!(null==t?void 0:t.includes(e.fides_key))).map(e=>{let{name:t,primaryName:n}=s(e.fides_key);return{value:e.fides_key,name:t,primaryName:n,description:e.description||"",label:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("strong",{children:n||t}),n&&": ".concat(t)]}),title:e.fides_key}});return(0,r.jsx)(l.l,{options:c,...i})}},79283:function(e,t,n){"use strict";n.d(t,{l:function(){return d}});var r=n(24246),l=n(41013),a=n(72707),i=n.n(a);let s=e=>{let{data:{formattedTitle:t,description:n,name:a,primaryName:i}}=e;return(0,r.jsxs)(l.jqI,{gap:12,title:"".concat(t," - ").concat(n),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:i||a}),i&&": ".concat(a)]}),(0,r.jsx)("em",{className:"overflow-hidden text-ellipsis",children:n})]})},o=e=>"options"in e&&Array.isArray(e.options),c=e=>({...e,className:i().option,formattedTitle:e.formattedTitle||[e.primaryName,e.name].filter(e=>e).join(": ")}),d=e=>{let{options:t,...n}=e,a=null==t?void 0:t.map(e=>o(e)?{...e,options:e.options.map(c)}:c(e));return(0,r.jsx)(l.WPr,{options:a,filterOption:(e,t)=>{var n,r;return(null==t?void 0:null===(n=t.formattedTitle)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase()))||(null==t?void 0:null===(r=t.value)||void 0===r?void 0:r.toLowerCase().includes(e.toLowerCase()))||!1},optionFilterProp:"label",autoFocus:!0,variant:"borderless",optionRender:s,styles:{popup:{root:{minWidth:"500px"}}},className:"w-full p-0","data-testid":"taxonomy-select",...n})}},34929:function(e,t,n){"use strict";var r=n(24246),l=n(64925),a=n.n(l),i=n(27378),s=n(16134),o=n(30002),c=n(28079),d=n(57072);let u=()=>{let{isLoading:e}=(0,c.fd)(),t=(0,s.C)(c.U3),{isLoading:n}=(0,d.MO)(),r=(0,s.C)(d.qb),{isLoading:l}=(0,o.te)();return{dataUses:t,dataSubjects:(0,s.C)(o.ZL),dataCategories:r,isLoading:e||n||l}};t.Z=()=>{let{dataUses:e,dataCategories:t,dataSubjects:n,isLoading:l}=u(),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.split(".").slice(0,t).join(".")},o=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=t(e);if(!r)return{};let l=t(s(e,n)),a=!!r.parent_key;return{name:r.name||void 0,primaryName:a&&(null==l?void 0:l.name)!==r.name&&(null==l?void 0:l.name)||void 0}},c=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{name:l,primaryName:a}=o(e,t,n);return l?a?(0,r.jsxs)(i.Fragment,{children:[(0,r.jsxs)("strong",{children:[a,":"]})," ",l]},e):(0,r.jsx)("strong",{children:l},e):e},d=t=>a()(e,{fides_key:t}),p=e=>a()(t,{fides_key:e}),h=e=>a()(n,{fides_key:e});return{getDataUses:()=>e,getDataUseByKey:d,getDataUseDisplayName:e=>c(e,d,1),getDataUseDisplayNameProps:e=>o(e,d,1),getDataCategories:()=>t,getDataCategoryByKey:p,getDataCategoryDisplayName:e=>c(e,p,2),getDataCategoryDisplayNameProps:e=>o(e,p,2),getDataSubjects:()=>n,getDataSubjectByKey:h,getDataSubjectDisplayName:e=>{let t=h(e);return t?t.name:e},getDataSubjectDisplayNameProps:e=>{let t=h(e);return t?{name:t.name||e}:{}},getPrimaryKey:s,isLoading:l}}},84418:function(e,t,n){"use strict";n.d(t,{d:function(){return c}});var r=n(24246),l=n(41013),a=n(98784),i=n.n(a);let s=e=>{let{itemKey:t,actions:n}=e;return i().isEmpty(n)?null:(0,r.jsx)(l.jqI,{gap:"small",justify:"flex-end",children:n.map((e,a)=>{let{callback:i,label:s,disabled:o}=e;return(0,r.jsx)(l.wpx,{onClick:()=>i(t),type:a===n.length-1?"primary":"default",disabled:o,children:s},s)})})},o=e=>{let{title:t,titleIcon:n,titleTag:a}=e;return(0,r.jsxs)(l.jqI,{align:"center",gap:"small",children:[n,(0,r.jsx)("span",{children:t}),a&&(0,r.jsx)(l.j8w,{...a})]})},c=e=>{let{title:t,titleIcon:n,titleTag:a,actions:i,width:c=480,...d}=e;return(0,r.jsx)(l.To0,{title:(0,r.jsx)(o,{title:t,titleIcon:n,titleTag:a}),footer:d.footer||!i?d.footer:(0,r.jsx)(s,{itemKey:d.itemKey,actions:i}),width:c,...d})}},59001:function(e,t,n){"use strict";n.d(t,{Ch:function(){return o},Lo:function(){return i},_g:function(){return c},ac:function(){return a},aq:function(){return d}});var r,l,a,i,s=n(60240);let o="root";(r=a||(a={})).DATA_CATEGORY="data_category",r.DATA_USE="data_use",r.DATA_SUBJECT="data_subject",r.SYSTEM_GROUP="system_group",(l=i||(i={})).DATA_CATEGORIES="Data categories",l.DATA_USES="Data uses",l.DATA_SUBJECTS="Data subjects",l.SYSTEM_GROUPS="System groups";let c=e=>{switch(e){case"data_category":return"Data categories";case"data_use":return"Data uses";case"data_subject":return"Data subjects";case"system_group":return"System groups";default:return e}},d=e=>{switch(e){case"data_category":return{UPDATE:s.Sh.DATA_CATEGORY_UPDATE,CREATE:s.Sh.DATA_CATEGORY_CREATE,DELETE:s.Sh.DATA_CATEGORY_DELETE,READ:s.Sh.DATA_CATEGORY_READ};case"data_use":return{UPDATE:s.Sh.DATA_USE_UPDATE,CREATE:s.Sh.DATA_USE_CREATE,DELETE:s.Sh.DATA_USE_DELETE,READ:s.Sh.DATA_USE_READ};case"data_subject":return{UPDATE:s.Sh.DATA_SUBJECT_UPDATE,CREATE:s.Sh.DATA_SUBJECT_CREATE,DELETE:s.Sh.DATA_SUBJECT_DELETE,READ:s.Sh.DATA_SUBJECT_READ};case"system_group":return{UPDATE:s.Sh.SYSTEM_GROUP_UPDATE,CREATE:s.Sh.SYSTEM_GROUP_CREATE,DELETE:s.Sh.SYSTEM_GROUP_DELETE,READ:s.Sh.SYSTEM_GROUP_READ};default:return{UPDATE:s.Sh.TAXONOMY_UPDATE,CREATE:s.Sh.TAXONOMY_CREATE,DELETE:s.Sh.TAXONOMY_DELETE,READ:s.Sh.TAXONOMY_READ}}}},90673:function(e,t,n){"use strict";n.d(t,{Cd:function(){return a},Xl:function(){return i}});var r=n(20987),l=n(59001);let a=(e,t)=>{let n;if(null==t&&e.every(e=>void 0===e.parent_key))n=e;else{let r=null!=t?t:null;n=e.filter(e=>e.parent_key===r)}return n.map(t=>{var n,r;let l=t.fides_key;return{value:t.fides_key,label:t.name||t.fides_key,description:t.description,children:a(e,l),is_default:null!==(n=t.is_default)&&void 0!==n&&n,active:null!==(r=t.active)&&void 0!==r&&r}})},i=e=>{switch(e){case l.ac.DATA_CATEGORY:return r.J.DATA_CATEGORY;case l.ac.DATA_SUBJECT:return r.J.DATA_SUBJECT;case l.ac.DATA_USE:return r.J.DATA_USE;default:return e}}},57072:function(e,t,n){"use strict";n.d(t,{Bd:function(){return r.Bd},L5:function(){return r.L5},MO:function(){return r.MO},qb:function(){return r.qb}});var r=n(5785)},39864:function(e,t,n){"use strict";n.d(t,{Cy:function(){return s},EO:function(){return u},Hb:function(){return c},J1:function(){return i},Jy:function(){return l},Km:function(){return d},MU:function(){return r},ci:function(){return a},d9:function(){return o}});let{useGetCustomTaxonomiesQuery:r,useGetTaxonomyQuery:l,useLazyGetTaxonomyQuery:a,useCreateTaxonomyMutation:i,useUpdateTaxonomyMutation:s,useDeleteTaxonomyMutation:o,useCreateCustomTaxonomyMutation:c,useUpdateCustomTaxonomyMutation:d,useDeleteCustomTaxonomyMutation:u}=n(78780).u.injectEndpoints({endpoints:e=>({getTaxonomy:e.query({query:e=>({url:"taxonomies/".concat(e,"/elements")}),providesTags:(e,t,n)=>[{type:"Taxonomy",id:n}],transformResponse:e=>{let t=[],n=[...e],r=n.filter(e=>null===e.parent_key);r.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)),t.push(...r);let l=n.filter(e=>null!==e.parent_key);for(;l.length>0;){let e=l.filter(e=>t.some(t=>t.fides_key===e.parent_key));if(0===e.length){t.push(...l.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)));break}e.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)),t.push(...e),l=l.filter(t=>!e.includes(t))}return t}}),getCustomTaxonomies:e.query({query:()=>({url:"taxonomies"}),providesTags:()=>[{type:"Taxonomy"}]}),createTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,...n}=e;return{url:"taxonomies/".concat(t,"/elements"),method:"POST",body:n}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r}]}}),updateTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,...n}=e;return{url:"taxonomies/".concat(t,"/elements/").concat(n.fides_key),method:"PUT",body:n}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r}]}}),deleteTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,key:n}=e;return{url:"taxonomies/".concat(t,"/").concat(n),method:"DELETE"}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r}]}}),createCustomTaxonomy:e.mutation({query:e=>({url:"taxonomies",method:"POST",body:e}),invalidatesTags:()=>[{type:"Taxonomy"}]}),updateCustomTaxonomy:e.mutation({query:e=>{let{fides_key:t,...n}=e;return{url:"taxonomies/".concat(t),method:"PUT",body:n}},invalidatesTags:()=>[{type:"Taxonomy"}]}),deleteCustomTaxonomy:e.mutation({query:e=>({url:"taxonomies/".concat(e),method:"DELETE"}),invalidatesTags:()=>[{type:"Taxonomy"}]})})})},73662:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eY}});var r=n(24246),l=n(41013),a=n(25980),i=n(98784),s=n.n(i),o=n(79894),c=n.n(o),d=n(86677),u=n(27378),p=n(43929),h=n(30952),f=n(35287),y=n(17245),g=n(77830),m=n(58754),_=n(9270),v=n(37059),E=n(60240),T=n(62678),A=n(99824),x=n(26917);let S="space",b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"inclusive",{activeListItem:r=null,enableKeyboardShortcuts:l=!1}=t,[a,i]=(0,u.useState)(n),[o,c]=(0,u.useState)([]),d=(e,t)=>{(("inclusive"===a?t:!t)?"add":"remove")=="add"?c([...o,e]):c(o.filter(t=>t!==e))},h=e=>{i(e),c([])},f=s().difference(e,o),y="inclusive"===a?o:f,g="exclusive"===a?o:f;return(0,p.y1)("h",()=>{h("exclusive")},{enabled:l}),(0,p.y1)("l",()=>{h("inclusive")},{enabled:l}),(0,p.y1)(S,e=>{if(r){e.preventDefault();let t=y.includes(r.key);d(r.key,!t)}},{enabled:l},[r,y,d]),{checkboxProps:{checked:"inclusive"===a?y.length>0&&(null==e?void 0:e.length)===y.length:0===g.length,indeterminate:"inclusive"===a?y.length>0&&(null==e?void 0:e.length)!==y.length:g.length>0,onChange:e=>h(e.target.checked?"exclusive":"inclusive")},excludedKeys:g,listSelectMode:a,resetListSelect:()=>{c([]),i("inclusive")},selectedKeys:y,updateListSelectMode:h,updateSelectedListItem:d}},j=e=>{let{...t}=e;return(0,r.jsx)(l.$zI,{title:"Keyboard shortcuts",footer:null,...t,children:(0,r.jsx)(l.Yfl,{bordered:!0,column:1,items:[{key:"".concat(l.dHR.NAVIGATE_UP,"-").concat(l.dHR.NAVIGATE_DOWN),label:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:l.dHR.NAVIGATE_DOWN})," ","/"," ",(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:l.dHR.NAVIGATE_UP})]}),children:"Activate the next/previous field"},{key:S,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:S}),children:"Toggle checkbox of the active field"},{key:"h",label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"h"}),children:"Select all fields"},{key:"l",label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"l"}),children:"Deselect all fields"},{key:l.dHR.CLEAR_FOCUS,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:l.dHR.CLEAR_FOCUS}),children:"Clear the active field"},{key:A.b_.TOGGLE_DRAWER,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:A.b_.TOGGLE_DRAWER}),children:"Open/close details drawer for active field"},{key:A.b_.APPROVE,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:A.b_.APPROVE}),children:"Mark the active field as reviewed"},{key:A.b_.PROMOTE,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:A.b_.PROMOTE}),children:"Approve the active field"},{key:A.b_.MUTE,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:A.b_.MUTE}),children:"Ignore the active field"},{key:A.b_.UN_MUTE,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:A.b_.UN_MUTE}),children:"Restore the active field"},{key:A.b_.OPEN_CLASSIFICATION_SELECT,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:A.b_.OPEN_CLASSIFICATION_SELECT}),children:"Edit data categories for the active field"},{key:A.b_.REFRESH,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:A.b_.REFRESH}),children:"Refresh the list"},{key:A.b_.REFRESH,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:A.b_.REFRESH}),children:"Refresh the list"},{key:x.M,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"/"}),children:"Focus the search input"},{key:"?",label:(0,r.jsxs)("div",{className:"whitespace-nowrap",children:[(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"?"})," (",(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"shift"}),"+",(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"/"}),")"]}),children:"Open/close this modal"}]})})};var k=n(99089),D=n(83766),R=n.n(D),C=n(16394),O=n(59001),I=n(90673),w=n(39864),P=n(83158),M=n(3124),L=n.n(M);let N="load_more",U="skeleton",F=["Unlabeled","Classifying...","Classified","Reviewed","Approving...","Approved","Removed","Ignored","Error","Removing..."],q=["Approved","Ignored","Approving...","Removing..."],G=e=>e.filter(e=>!q.includes(e)),Y={addition:{label:"Unlabeled"},approved:{label:"Reviewed",color:l.tAb.ALERT},classification_addition:{label:"Classified",color:l.tAb.CAUTION},classification_error:{label:"Error",color:l.tAb.ERROR},classification_queued:{label:"Classifying...",color:l.tAb.INFO},classification_update:{label:"Classified",color:l.tAb.CAUTION},classifying:{label:"Classifying...",color:l.tAb.INFO},monitored:{label:"Approved",color:l.tAb.SUCCESS},muted:{label:"Ignored",color:l.tAb.DEFAULT},promoting:{label:"Approving...",color:l.tAb.DEFAULT},promotion_error:{label:"Error",color:l.tAb.ERROR},removal:{label:"Removed",color:l.tAb.ERROR},removing:{label:"Removing...",color:l.tAb.DEFAULT},removal_promotion_error:{label:"Error",color:l.tAb.ERROR}},$={[E.D$.DATABASE]:l.PJP.S9g,[E.D$.FIELD]:l.PJP.sgG,[E.D$.SCHEMA]:l.PJP.ehp,[E.D$.TABLE]:l.PJP.iA_},z={STATUS:"status-section",DATA_CATEGORY:"data-category-section",CONFIDENCE:"confidence-section"},J={[E.Ag.ADDITION]:{color:L().FIDESUI_SUCCESS,tooltip:"This resource was added in the latest scan"},[E.Ag.REMOVAL]:{color:L().FIDESUI_ERROR,tooltip:"This resource was removed in the latest scan"},[E.Ag.CHANGE]:{color:L().FIDESUI_WARNING,tooltip:"This resource was modified in the latest scan"}},B=[P.$.HIGH,P.$.MEDIUM,P.$.LOW,P.$.MANUAL],H=(e,t)=>{if(!e||0===e.length)return[];let n=(e,t)=>{let r=t=>{if(t.value===e)return{title:t.label||e,children:t.children||[]};if(t.children&&t.children.length>0){let r=n(e,t.children);if(r)return r}return null};return t.reduce((e,t)=>null!=e?e:r(t),null)},r=new Map;e.forEach(e=>{let l=e.split(".");l.forEach((e,a)=>{let i=l.slice(0,a+1).join(".");if(!r.has(i)){let e=n(i,t);r.set(i,{title:(null==e?void 0:e.title)||(0,C.kC)(i.split(".").pop()||i),key:i,checkable:!0,selectable:!1})}})});let l=Array.from(r.values()),a=new Map;l.forEach(e=>{let t=e.key.toString().split(".");if(t.length>1){let n=t.slice(0,-1).join(".");a.has(n)||a.set(n,[]),a.get(n).push(e)}});let i=e=>(a.get(e)||[]).map(e=>{let t=i(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}});return l.filter(e=>1===e.key.toString().split(".").length).map(e=>{let t=i(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}})},V=e=>{let{resourceStatus:t,setResourceStatus:n,dataCategory:a,confidenceBucket:i,setDataCategory:s,setConfidenceBucket:o,resetToInitialState:c,monitorId:d,stagedResourceUrn:p}=e,[h,f]=(0,u.useState)(t),[y,g]=(0,u.useState)(a),[m,_]=(0,u.useState)(i),[E,T]=(0,u.useState)([z.STATUS]);(0,u.useEffect)(()=>{f(t)},[t]),(0,u.useEffect)(()=>{_(i)},[i]),(0,u.useEffect)(()=>{g(a)},[a]);let A=p.join(","),x=(0,u.useRef)(!0);(0,u.useEffect)(()=>{if(x.current){x.current=!1;return}c()},[A]);let{data:S,refetch:b}=(0,v.S0)({monitor_config_id:d,staged_resource_urn:p},{refetchOnMountOrArgChange:!0}),[j,{data:k=[]}]=(0,w.ci)();(0,u.useEffect)(()=>{j(O.ac.DATA_CATEGORY)},[j]);let D=(0,u.useMemo)(()=>(0,I.Cd)(k),[k]),M=B.filter(e=>{var t;return null==S?void 0:null===(t=S.confidence_bucket)||void 0===t?void 0:t.includes(e)}),L=(0,u.useMemo)(()=>F.map(e=>({title:e.replace(/\.{3}$/,""),key:e,checkable:!0,selectable:!1,isLeaf:!0})),[]),N=(0,u.useMemo)(()=>(null==S?void 0:S.data_category)&&0!==S.data_category.length?H(S.data_category,D):[],[null==S?void 0:S.data_category,D]),U=[...L.length>0?[{title:"Status",key:z.STATUS,checkable:!0,selectable:!1,isLeaf:!1,children:L}]:[],...M.length>0?[{title:"Confidence",key:z.CONFIDENCE,checkable:!0,selectable:!1,isLeaf:!1,children:M.map(e=>({title:(0,C.kC)(e),key:e,checkable:!0,selectable:!1,isLeaf:!0}))}]:[],...N.length>0?[{title:"Data category",key:z.DATA_CATEGORY,checkable:!0,selectable:!1,isLeaf:!1,children:N}]:[]],q=(0,u.useMemo)(()=>R()([...null!=h?h:[],...null!=y?y:[],...null!=m?m:[]]),[h,y,m]),Y=(0,u.useMemo)(()=>{let e=0;return t&&(e+=new Set(t).size),a&&(e+=new Set(a).size),i&&(e+=new Set(i).size),e},[t,a,i]);return(0,r.jsx)(l.wn$,{treeProps:{checkable:!0,checkedKeys:q,onCheck:e=>{let t=Array.isArray(e)?e:e.checked,n=[],r=[],l=[],a=Object.values(z),i=(e,t)=>t.some(t=>t!==e&&t.startsWith("".concat(e,"."))),s=t.map(e=>e.toString());t.forEach(e=>{let t=e.toString();if(a.some(e=>e===t))return;let o=F.find(e=>e===t),c=Object.values(P.$).find(e=>e===t);o?n.push(o):c?r.push(c):i(t,s)||l.push(t)}),f(n.length>0?n:[]),g(l.length>0?l:[]),_(r.length>0?r:[])},treeData:U,expandedKeys:E,onExpand:e=>{T(e)}},onApply:()=>{n(h&&h.length>0?Array.from(new Set(h)):h),s(y&&y.length>0?Array.from(new Set(y)):y),o(m&&m.length>0?Array.from(new Set(m)):m)},onReset:()=>{c(),f(G([...F])),_([]),g([])},onClear:()=>{f([]),_([]),g([])},onOpenChange:e=>{if(e){b();return}f(t),_(i),g(a)},activeFiltersCount:Y})};var K=n(9110);let W=e=>{switch(e){case 1:return E.D$.DATABASE;case 2:return E.D$.SCHEMA;case 3:return E.D$.TABLE;default:return E.D$.FIELD}},Z=e=>{if(!e||"string"!=typeof e)return[];let t=e.trim();if(!t)return[];let n=t.split(".");if(n.length<2)return[];let r=n.filter(e=>e&&e.trim().length>0);return r.length<2?[]:(r.shift(),r.length>0&&r.pop(),0===r.length)?[]:r.map((e,t)=>{let n=$[W(t+1)];return{title:e.trim(),IconComponent:n}})};var Q=n(79283),X=n(34929),ee=e=>{let{onSelectDataCategory:t,urn:n,...a}=e,{getDataCategoryDisplayNameProps:i,getDataCategories:s}=(0,X.Z)(),o=s().filter(e=>e.active),[c,d]=(0,u.useState)(!1),p=o.map(e=>{let{name:t,primaryName:n}=i(e.fides_key);return{value:e.fides_key,label:(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:n||t}),n&&": ".concat(t)]}),name:t,primaryName:n,description:e.description||""}});return(0,r.jsx)(Q.l,{options:p,prefix:(0,r.jsx)(l.wpx,{"aria-label":"Add Data Category",type:"text",size:"small",icon:(0,r.jsx)(l.PJP.mm_,{}),disabled:a.disabled}),placeholder:"",suffixIcon:null,classNames:{root:"w-full max-w-full overflow-hidden p-0 cursor-pointer -ml-5"},style:{"--ant-select-multiple-selector-bg-disabled":"transparent"},variant:"borderless",autoFocus:!1,maxTagCount:"responsive",open:c,onOpenChange:e=>d(e),onSelect:e=>{t(e),d(!1)},"data-classification-select":n,popupMatchSelectWidth:600,...a})},et=n(97947),en=n.n(et),er=n(63537);let el=e=>{let{label:t,closable:n,onClose:a,isFromClassifier:i}=e;return(0,r.jsx)(l.j8w,{color:"white",bordered:!0,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},closable:n,onClose:a,style:{marginInlineEnd:"calc((var(--ant-padding-xs) * 0.5))"},icon:i&&(0,r.jsx)(l.QMR,{}),children:(0,r.jsx)(l.lKn,{size:"sm",children:t})})},ea=e=>{let{title:t,IconComponent:n}=e;return{title:n?(0,r.jsxs)(l.jqI,{gap:3,align:"center",children:[(0,r.jsx)(n,{}),(0,r.jsx)("span",{children:t})]}):t}};var ei=e=>{let{urn:t,name:n,diff_status:a,selected:i,onSelect:o,onSetDataCategories:c,dataCategoriesDisabled:d,onNavigate:u,actions:p,classifications:h,...f}=e,y="preferred_data_categories"in f?f.preferred_data_categories:[],g=s()(null==h?void 0:h.flatMap(e=>{let{confidence_bucket:t}=e,n=t?(0,er.Oq)(t):void 0;return n?[n]:[]})).thru(er.io).value();return(0,r.jsx)(l.krs.Item,{actions:[g&&(0,r.jsx)(K.D,{severity:g,className:"mr-2"}),...null!=p?p:[]],children:(0,r.jsx)(l.krs.Item.Meta,{avatar:(0,r.jsx)("div",{className:"ml-2",children:(0,r.jsx)(l.E_O,{checked:i,onChange:e=>o&&o(t,e.target.checked)})}),title:(0,r.jsxs)(l.jqI,{gap:12,align:"center",className:en()["monitor-field__title"],children:[(0,r.jsx)(l.wpx,{type:"text",size:"small",className:"-mx-2",onClick:()=>u&&u(t),children:n}),a&&a!==E.LL.ADDITION&&(0,r.jsx)(l.j8w,{bordered:!1,color:Y[a].color,children:Y[a].label}),(0,r.jsx)(l.esZ,{title:t,mouseEnterDelay:.5,children:(0,r.jsx)(l.zrq,{className:en()["monitor-field__breadcrumb"],items:Z(t).map(ea),role:"presentation",style:{overflow:"hidden"}})})]}),description:(0,r.jsx)(ee,{mode:"multiple",value:null!=y?y:[],urn:t,tagRender:e=>{let n=!!(null==h?void 0:h.find(t=>t.label===e.value));return el({...e,isFromClassifier:n,onClose:()=>{var n;c(t,null!==(n=null==y?void 0:y.filter(t=>t!==e.value))&&void 0!==n?n:[])}})},onSelectDataCategory:e=>{(null==y?void 0:y.includes(e))||c(t,[...null!=y?y:[],e])},disabled:d})})},t)},es=n(812),eo=n(32500),ec=n.n(eo);let ed=(e,t)=>e.find(e=>{let{children:n}=e;return n&&!!n.find(e=>e.key.toString()===t)}),eu=(e,t)=>{var n;return null!==(n=ed(e,t))&&void 0!==n?n:e.reduce((e,n)=>{if(n.children){var r;return null!==(r=ed(n.children,t))&&void 0!==r?r:eu(n.children,t)}return e},null)},ep=e=>{let{node:t,treeData:n,onLoadMore:a,actions:i}=e;if(!t.title)return null;if(t.key.toString().startsWith(N)){let e=eu(n,t.key.toString());return(0,r.jsx)(l.wpx,{type:"link",block:!0,onClick:()=>{(null==e?void 0:e.key)&&a(e.key.toString())},className:"p-0",children:t.title})}return t.key.toString().startsWith(U)?(0,r.jsx)(l.N_L,{paragraph:!1,title:{width:"80px"},active:!0,children:t.title}):(0,r.jsxs)(l.jqI,{gap:4,align:"center",className:"group ml-1 flex grow",children:[(0,r.jsx)(l.lKn,{ellipsis:{tooltip:t.title},className:"grow select-none",children:t.title}),(0,r.jsx)(l.S0p,{menu:{items:i?Object.entries(i).map(e=>{let[n,{disabled:r,...l}]=e;return{key:n,disabled:r([t]),...l}}):[],onClick:e=>{var n;let{key:r,domEvent:l}=e;l.preventDefault(),l.stopPropagation(),null===(n=i[r])||void 0===n||n.callback(t.key,[t])}},destroyOnHidden:!0,className:"group mr-1 flex-none group-[.multi-select]/monitor-tree:pointer-events-none group-[.multi-select]/monitor-tree:opacity-0",children:(0,r.jsx)(l.wpx,{"aria-label":"Show More Resource Actions",icon:(0,r.jsx)(l.PJP.r43,{className:"opacity-0 group-hover:opacity-100 group-[.ant-dropdown-open]:opacity-100"}),type:"text",size:"small",className:"self-end"})})]})},eh=(e,t,n)=>e.map(e=>e.key===t?{...e,status:n}:e.children?{...e,children:eh(e.children,t,n)}:e),ef=(e,t)=>e.map(e=>{if(e.key===t){let{children:t,...n}=e;return n}return e.children?{...e,children:ef(e.children,t)}:e}),ey=e=>{let t=[];return e.children&&e.children.length>0&&e.children.forEach(e=>{"string"==typeof e.key&&(t.push(e.key),t.push(...ey(e)))}),t},eg=(e,t)=>{for(let n of e){if(n.key===t)return n;if(n.children){let e=eg(n.children,t);if(e)return e}}},em=(e,t)=>{var n;let a=e.items.map(e=>{let t=e.resource_type?$[e.resource_type]:void 0,n=e.update_status?J[e.update_status]:void 0;return{title:e.name,key:e.urn,selectable:!0,icon:t?()=>(0,r.jsx)(l.esZ,{title:null==n?void 0:n.tooltip,children:(0,r.jsx)(l.y4X,{className:"h-full",offset:[0,5],color:null==n?void 0:n.color,dot:!!e.update_status,children:(0,r.jsx)(t,{className:"h-full"})})}):void 0,status:e.update_status,isLeaf:e.resource_type===E.D$.FIELD||!e.has_grandchildren,classifyable:[E.D$.SCHEMA,E.D$.TABLE,E.D$.ENDPOINT,E.D$.FIELD].includes(e.resource_type)}});return(null!==(n=null==a?void 0:a.length)&&void 0!==n?n:0)<100?a:[...a,{title:"Load more...",key:"".concat(N,"-").concat(e.page,"-").concat(t),selectable:!1,isLeaf:!0}]},e_=(e,t,n)=>e.map(e=>{if(e.key===t){var r,l;return{...e,children:[...null!==(l=null===(r=e.children)||void 0===r?void 0:r.filter(e=>!(e.key.toString().startsWith(N)||e.key.toString().startsWith(U))))&&void 0!==l?l:[],...n]}}return e.children?{...e,children:e_(e.children,t,n)}:e}),ev=(e,t,n)=>e.map(e=>e.key===t?{...e,children:n}:e.children?{...e,children:ev(e.children,t,n)}:e),eE=(e,t,n)=>e.map(e=>{if(e.key===t){var r;let t=(null!==(r=e.children)&&void 0!==r?r:[]).filter(e=>!(e.key.toString().startsWith(N)||e.key.toString().startsWith(U))),l=new Map(n.map(e=>[e.key,e])),a=new Map(t.map(e=>[e.key,e])),i=t.map(e=>{let t=l.get(e.key);return null!=t?t:e});return n.forEach(e=>{a.has(e.key)||i.push(e)}),{...e,children:i}}return e.children?{...e,children:eE(e.children,t,n)}:e}),eT=(0,u.forwardRef)((e,t)=>{let{setSelectedNodeKeys:n,selectedNodeKeys:a,nodeActions:i,primaryAction:s}=e,o=(0,d.useRouter)(),{errorAlert:c}=(0,y.VY)(),p=decodeURIComponent(o.query.monitorId),[h]=(0,v.RV)(),[f]=(0,v.M8)(),[g,m]=(0,u.useState)({}),[_,E]=(0,u.useState)([]),[T,A]=(0,u.useState)([]),x=(0,u.useRef)({}),S=(0,u.useRef)({}),b=(0,u.useCallback)(async e=>{var t;let{nodeKey:n,queryParams:r,fastUpdateFn:l,detailedUpdateFn:a}=e,i=(null!==(t=x.current[n])&&void 0!==t?t:0)+1;x.current[n]=i;let s=h({...r,include_descendant_details:!1}),o=h({...r,include_descendant_details:!0});s.then(e=>{let{data:t}=e;t&&x.current[n]===i&&S.current[n]!==i&&l(t)}),o.then(e=>{let{data:t}=e;t&&x.current[n]===i&&(S.current[n]=i,(null!=a?a:l)(t))})},[h]),j=(0,u.useCallback)(e=>new Promise(t=>{let{children:n,key:r}=e;if(n){t();return}let l=r.toString();b({nodeKey:l,queryParams:{monitor_config_id:p,staged_resource_urn:l,size:100},fastUpdateFn:e=>{E(t=>ev(t,r,em(e,l))),m(e=>({...e,[l]:{pageSize:100,pageIndex:1}}))}}),t()}),[b,p]),k=(0,u.useCallback)(e=>{let t=g[e];t&&(E(t=>e_(t,e,[...Array(100)].map((t,n)=>({key:"".concat(U,"-").concat(e,"-").concat(n),title:"SKELETON",isLeaf:!0})))),b({nodeKey:e,queryParams:{monitor_config_id:p,staged_resource_urn:e,size:100,page:t.pageIndex+1},fastUpdateFn:t=>{E(n=>e_(n,e,em(t,e)))},detailedUpdateFn:t=>{E(n=>eE(n,e,em(t,e))),m(t=>{var n,r;return{...t,[e]:{pageSize:100,pageIndex:(null!==(r=null===(n=t[e])||void 0===n?void 0:n.pageIndex)&&void 0!==r?r:0)+1}}})}}))},[g,b,p]),D=(0,u.useCallback)(e=>{E(t=>{let n=eg(t,e),r=[e];return n&&r.push(...ey(n)),A(e=>e.filter(e=>!r.includes(e.toString()))),m(e=>{let t={...e};return r.forEach(e=>{delete t[e]}),t}),r.forEach(e=>{delete x.current[e],delete S.current[e]}),ef(t,e)})},[]),R=(0,u.useCallback)(async e=>{let t=async e=>{try{let t=await f({monitor_config_id:p,...e&&{staged_resource_urn:e}});if(t.error){c((0,es.e$)(t.error),"Failed to get schema explorer ancestors statuses");return}let n=t.data;if(!n)return;e?D(e):n.forEach(e=>{D(e.urn)}),E(e=>n.reduce((e,t)=>eh(e,t.urn,t.update_status),e))}catch(e){c("An unexpected error occurred while refreshing the schema explorer")}};if(0===e.length){await t();return}await Promise.all(e.map(e=>t(e)))},[f,p,D,c]),O=(0,u.useCallback)((e,t)=>{A(e),t.expanded&&!t.node.children&&j&&j(t.node)},[j]);return(0,u.useImperativeHandle)(t,()=>({refreshResourcesAndAncestors:R})),(0,u.useEffect)(()=>{(async()=>{_.length>0||b({nodeKey:"root",queryParams:{monitor_config_id:p,size:100},fastUpdateFn:e=>{E(em(e))}})})()},[b,p,E,_.length]),(0,r.jsxs)(l.jqI,{gap:"middle",vertical:!0,className:"h-full",children:[(0,r.jsx)(l.lQT,{level:3,className:"sticky top-0",ellipsis:!0,children:"Schema explorer"}),(0,r.jsx)(l.a$q.DirectoryTree,{loadData:j,treeData:_,expandedKeys:T,onExpand:O,onSelect:e=>{n(e)},showIcon:!0,showLine:!0,blockNode:!0,multiple:!0,rootClassName:"h-full overflow-x-hidden ".concat(ec()["monitor-tree"]," group/monitor-tree ").concat(a.length>1?"multi-select":""),expandAction:"doubleClick",titleRender:e=>(0,r.jsx)(ep,{node:e,treeData:_,onLoadMore:k,actions:i})}),a.length>0&&(0,r.jsxs)(l.jqI,{justify:"space-between",align:"center",gap:"small",children:[(0,r.jsx)(l.wpx,{"aria-label":"Classify ".concat(a.length," Selected Nodes"),icon:(0,r.jsx)(l.QMR,{size:12}),size:"small",onClick:()=>{var e;return null===(e=i[s])||void 0===e?void 0:e.callback(a,a.flatMap(e=>{let t=eg(_,e.toString());return t?[t]:[]}))},className:"flex-none"}),(0,r.jsx)(l.lKn,{ellipsis:!0,children:"".concat(a.length," ").concat((0,C._6)(a.length,"resource","resources")," selected")}),(0,r.jsx)(l.S0p,{menu:{items:i?Object.entries(i).map(e=>{let[t,{label:n,disabled:r}]=e;return{key:t,label:n,disabled:r(a.flatMap(e=>{let t=eg(_,e.toString());return t?[t]:[]}))}}):[],onClick:e=>{var t;let{key:n,domEvent:r}=e;r.preventDefault(),r.stopPropagation(),null===(t=i[n])||void 0===t||t.callback(a,a.flatMap(e=>{let t=eg(_,e.toString());return t?[t]:[]}))}},destroyOnHidden:!0,className:"group mr-1 flex-none",children:(0,r.jsx)(l.wpx,{"aria-label":"Show More Resource Actions",icon:(0,r.jsx)(l.PJP.r43,{}),size:"small",className:"self-end"})})]})]})});eT.displayName="MonitorTree";var eA=n(12627),ex=n(84418);let eS=(e,t)=>(0,r.jsx)(t,{...e,className:"!sticky top-0 z-[2] bg-white"}),eb=e=>{var t;let{resource:n,fieldActions:a,...i}=e,s=(0,u.useMemo)(()=>{var e;if(!(null==n?void 0:n.classifications))return[];let t="preferred_data_categories"in n&&null!==(e=n.preferred_data_categories)&&void 0!==e?e:[];return n.classifications.filter(e=>t.includes(e.label))},[n]);return(0,r.jsx)(ex.d,{...i,classNames:{body:"!pt-0 !mt-[var(--ant-padding-lg)] max-h-full"},children:n?(0,r.jsx)(l.A5g,{defaultActiveKey:"details",renderTabBar:eS,items:[{key:"details",label:"Details",children:(0,r.jsxs)(l.jqI,{gap:"middle",vertical:!0,children:[(0,r.jsx)(l.Yfl,{bordered:!0,size:"small",column:1,items:[..."system_key"in n&&n.system_key?[{key:"system",label:"System",children:n.system_key}]:[],{key:"path",label:"Path",children:n.urn},{key:"data-type",label:"Data type",children:"source_data_type"in n?n.source_data_type:void 0},{key:"description",label:"Description",children:n.description}]}),(0,r.jsx)(l.PPS,{layout:"vertical",children:(0,r.jsx)(l.PPS.Item,{label:"Data categories",children:(0,r.jsx)(eA.Z,{variant:"outlined",mode:"multiple",maxTagCount:"responsive",value:"preferred_data_categories"in n?n.preferred_data_categories:[],autoFocus:!1,disabled:null==n||!n.diff_status||!A.$k["assign-categories"].some(e=>e===n.diff_status),onChange:e=>a["assign-categories"]([n.urn],!0,{user_assigned_data_categories:e})})})}),s.length>0&&(0,r.jsx)(l.krs,{"data-testid":"classifications-reasoning-list",dataSource:s,renderItem:e=>{let t=e.confidence_bucket?(0,er.Oq)(e.confidence_bucket):void 0;return(0,r.jsx)(l.krs.Item,{children:(0,r.jsx)(l.krs.Item.Meta,{avatar:(0,r.jsx)(l.t3Z,{icon:(0,r.jsx)(l.QMR,{color:"black"})}),title:(0,r.jsxs)(l.jqI,{align:"center",gap:"middle",children:[(0,r.jsx)("div",{children:e.label}),t&&(0,r.jsx)(K.D,{severity:t})]}),description:e.rationale})})}})]})},{key:"activity",label:"Activity",children:(0,r.jsx)(l.krs,{dataSource:"errors"in n&&n.errors?null===(t=n.errors)||void 0===t?void 0:t.map((e,t)=>({key:t,title:e.phase,description:new Date(e.timestamp).toLocaleString(),content:e.message})):[],renderItem:(e,t)=>(0,r.jsxs)(l.krs.Item,{children:[(0,r.jsx)(l.krs.Item.Meta,{title:e.title,description:e.description}),(0,r.jsx)(l.FUI,{ellipsis:{expandable:"collapsible",rows:3},copyable:{icon:(0,r.jsx)(l.PJP.CKM,{className:"pt-1",size:18})},children:e.content})]},t),itemLayout:"vertical"})}]}):null})};var ej=n(31883);let ek=(e,t)=>{let[n]=(0,k.rL)(),r=(0,l.UD8)(),a=(0,l.S37)(),i=l=>async(i,s,o)=>{let c=Date.now();if(!await a.confirm((0,er.nB)(A.Me[l],A.e_[l](o))))return;r.open({key:c,type:"loading",content:"".concat(A.T0[l]," ").concat(o," ").concat((0,C._6)(o,"resource","resources"),"..."),duration:0});let d=await n({query:{...i.query},path:{monitor_config_id:e,action_type:l},body:{excluded_resource_urns:s}});if((0,ej.D4)(d)){r.open({key:c,type:"error",content:(0,er.v_)(l),duration:5});return}if(r.open({key:c,type:"success",content:(0,er.NM)(l,o),duration:5}),t&&l!==T.FieldActionType.APPROVE){let e=i.query.staged_resource_urn||[];await t(e)}};return{"assign-categories":i(T.FieldActionType.ASSIGN_CATEGORIES),"promote-removals":i(T.FieldActionType.PROMOTE_REMOVALS),"un-approve":i(T.FieldActionType.UN_APPROVE),"un-mute":i(T.FieldActionType.UN_MUTE),approve:i(T.FieldActionType.APPROVE),classify:i(T.FieldActionType.CLASSIFY),mute:i(T.FieldActionType.MUTE),promote:i(T.FieldActionType.PROMOTE)}},eD={DRAWER_OPEN:".ant-drawer-open",DRAWER_SELECT:".ant-drawer-open .ant-select",SELECT:".ant-select",SELECT_SELECTOR:".ant-select-selector",SELECT_DISABLED:"ant-select-disabled",INPUT:"input",LIST_ITEM_SELECT:"[data-classification-select]"},eR=(e,t,n,r,a,i)=>{let s=(0,l.UD8)(),o=e=>{let t=e.querySelector(eD.SELECT_SELECTOR);if(!t)return!1;if(e.classList.contains(eD.SELECT_DISABLED))return s.warning("You cannot assign categories to this resource in its current state"),!1;let n=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(n);let r=e.querySelector(eD.INPUT);return r&&r.focus(),!0},c=n=>{var r;e&&(e.diff_status&&(null===(r=A.$k[n])||void 0===r?void 0:r.includes(e.diff_status))?t[n]([e.urn]):s.warning(A.Z8[n]))};(0,p.y1)(A.b_.APPROVE,()=>c(T.FieldActionType.APPROVE),[e,t]),(0,p.y1)(A.b_.PROMOTE,()=>c(T.FieldActionType.PROMOTE),[e,t]),(0,p.y1)(A.b_.MUTE,()=>c(T.FieldActionType.MUTE),[e,t]),(0,p.y1)(A.b_.UN_MUTE,()=>c(T.FieldActionType.UN_MUTE),[e,t]),(0,p.y1)(A.b_.REFRESH,()=>i(),[i]),(0,p.y1)(A.b_.TOGGLE_DRAWER,()=>{e&&a?r(void 0):e&&!a&&r(e.urn)},[e,r,a]),(0,p.y1)(A.b_.OPEN_CLASSIFICATION_SELECT,t=>{if(t.preventDefault(),!e)return;let n=null;if(a){let e=document.querySelector(eD.DRAWER_OPEN);e&&(n=e.querySelector(eD.SELECT))}else{let t=CSS.escape(e.urn);n=document.querySelector('[data-classification-select="'.concat(t,'"]'))}n&&o(n)},[e,s,a]),(0,p.y1)("escape",e=>{let t=document.activeElement;if((null==t?void 0:t.tagName)!=="INPUT")return;let n=t.closest(eD.LIST_ITEM_SELECT),r=t.closest(eD.DRAWER_SELECT);(n||r)&&(e.preventDefault(),e.stopPropagation(),t.blur())},{enableOnFormTags:["INPUT"]},[a])};var eC=n(70675);let eO=e=>{let[t,...n]=e.map(e=>Object.values(T.FieldActionType).flatMap(t=>A.$k[t].some(t=>t===e)?[t]:[]));return n.reduce((e,t)=>s().intersection(e,[...t]),null!=t?t:[])},eI=(e,t)=>{let[n]=(0,eC.LI)(),[r]=(0,v.Av)(),[a]=(0,eC.zV)(),[i]=(0,eC.Hf)(),[s]=(0,eC._J)(),[o]=(0,eC.NA)(),[c]=(0,v.n7)(),d=(0,l.UD8)(),u=(0,l.S37)(),p=(e,n)=>async function(r){let l=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=arguments.length>2?arguments[2]:void 0,i=Date.now();if(!(1===r.length&&l||await u.confirm((0,er.nB)(A.Me[e],A.e_[e](r.length)))))return;d.open({key:i,type:"loading",content:"".concat(A.T0[e]," ").concat(r.length," ").concat((0,C._6)(r.length,"resource","resources"),"..."),duration:0});let s=await n(r,a);if((0,ej.D4)(s)){d.open({key:i,type:"error",content:(0,er.v_)(e),duration:5});return}d.open({key:i,type:"success",content:(0,er.NM)(e,r.length),duration:5}),e!==T.FieldActionType.PROMOTE_REMOVALS&&t&&await t(r)},h=async e=>a({staged_resource_urns:e}),f=async e=>s({staged_resource_urns:e}),y=async e=>i({staged_resource_urns:e}),g=async t=>r({monitor_config_key:e,staged_resource_urns:t}),m=async(t,n)=>{var r;let[l]=t;return o({monitor_config_id:e,staged_resource_urn:l,user_assigned_data_categories:null!==(r=null==n?void 0:n.user_assigned_data_categories)&&void 0!==r?r:void 0})},_=async t=>n({monitor_config_key:e,staged_resource_urns:t}),E=async t=>c({monitor_config_key:e,staged_resource_urns:t});return{"assign-categories":p(T.FieldActionType.ASSIGN_CATEGORIES,m),"promote-removals":p(T.FieldActionType.PROMOTE_REMOVALS,E),"un-approve":()=>{},"un-mute":p(T.FieldActionType.UN_MUTE,f),approve:p(T.FieldActionType.APPROVE,_),classify:p(T.FieldActionType.CLASSIFY,g),mute:p(T.FieldActionType.MUTE,h),promote:p(T.FieldActionType.PROMOTE,y)}};var ew=n(40431);let eP=()=>{let[e,t]=(0,ew.v1)("resourceStatus",(0,ew.S$)((0,ew.km)(F))),[n,r]=(0,ew.v1)("confidenceBucket",(0,ew.S$)((0,ew.jx)(Object.values(P.$)))),[l,a]=(0,ew.v1)("dataCategory",(0,ew.S$)(ew.Oi));return(0,u.useEffect)(()=>{if(null===e){let e=G([...F]);t(e.length>0?e:[])}},[]),{resourceStatus:e,setResourceStatus:t,confidenceBucket:n,setConfidenceBucket:r,dataCategory:l,setDataCategory:a,reset:()=>{t([]),r([]),a([])},resetToInitialState:()=>{t(G([...F])),r(null),a(null)}}},eM=e=>new Map(e.map(e=>[e.key,e])),eL=(e,t)=>s()([...new Map([...e,...t]).entries()]).map(t=>{let[n,r]=t;return s().chain(e.get(n)).defaultTo(r).cloneDeep().merge(r).value()}).thru(eM).value();var eN=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],[t,n]=(0,u.useState)(new Map);return{nodes:t,update:r=>{let l=e?eL(t,r):r;s()([...l.entries()]).some(e=>{let[n,r]=e;return!s().isEqual(t.get(n),r)})&&n(e=>new Map([...e,...r]))},reset:()=>{n(new Map)}}},eU=(e,t)=>{var n,r;let l=(0,k.Fp)(e),a=(0,v.IC)(t,{skip:!t.stagedResourceUrn}),{update:i,nodes:o,reset:c}=eN();return(null===(n=l.data)||void 0===n?void 0:n.items)&&i(eM(l.data.items.map(e=>({key:e.urn,...e})))),{listQuery:{...l,nodes:s().chain(null===(r=l.data)||void 0===r?void 0:r.items).defaultTo([]).flatMap(e=>s().chain(o.get(e.urn)).thru(e=>e?[e]:[]).value()).thru(eM).value(),refetch:()=>{c(),l.refetch()}},detailsQuery:{...a,node:t.stagedResourceUrn?o.get(t.stagedResourceUrn):void 0,refetch:()=>{c(),a.refetch()}},nodes:o}};let eF=e=>Object.values(E.LL).flatMap(t=>Y[t].label===e?[t]:[]);var eq=()=>{var e,t,n,a,i,o,x,S;let D=(0,d.useRouter)(),R=decodeURIComponent(D.query.monitorId),C=(0,u.useRef)(null),[O,I]=(0,u.useState)(!1),{paginationProps:w,pageIndex:P,pageSize:M,resetPagination:L}=(0,_.S)({defaultPageSize:25}),N=(0,y.Rx)(),{resourceStatus:U,confidenceBucket:F,dataCategory:G,...$}=eP(),{data:z}=(0,v.vc)({monitor_config_id:R}),[J,B]=(0,u.useState)([]),H={path:{monitor_config_id:R},query:{staged_resource_urn:J.map(e=>e.toString()),search:N.searchProps.value,diff_status:U?U.flatMap(eF):void 0,confidence_bucket:F||void 0,data_category:G||void 0}},[K,W]=(0,u.useState)(),[Z,Q]=(0,u.useState)(),[X,ee]=(0,u.useState)(null),[et,{data:en,isFetching:er}]=(0,k.Nz)(),el=ek(R,async e=>{var t;await (null===(t=C.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),ea=eI(R,async e=>{var t;await (null===(t=C.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),{listQuery:{nodes:es,...eo},detailsQuery:{data:ec},nodes:ed}=eU({...H,query:{...H.query,size:M,page:P}},{stagedResourceUrn:K}),{excludedKeys:eu,listSelectMode:ep,resetListSelect:eh,selectedKeys:ef,updateSelectedListItem:ey,checkboxProps:eg}=b(Array.from(es.keys()),{activeListItem:Z?{...Z,key:null==Z?void 0:Z.key.toString()}:void 0,enableKeyboardShortcuts:!0}),em=async e=>{if((null==Z?void 0:Z.urn)&&e&&X){let t=[...es.values()].findIndex(t=>t.urn===e);-1!==t&&X(t)}W(e)};(0,p.y1)("?",()=>I(!O),{useKey:!0},[O]);let e_="exclusive"===ep?null==en?void 0:en.allowed_actions:eO(ef.flatMap(e=>{let t=ed.get(e);return(null==t?void 0:t.diff_status)?[t.diff_status]:[]})),ev=null!==(o=null===(e=eo.data)||void 0===e?void 0:e.total)&&void 0!==o?o:0,eE="exclusive"===ep&&(null===(t=eo.data)||void 0===t?void 0:t.total)?ev-eu.length:ef.length;return(0,u.useEffect)(()=>{L(),eh()},[U,F,J,N.searchQuery,G]),eR(Z,ea,ey,em,!!K,()=>eo.refetch()),(0,r.jsxs)(f.Z,{title:"Action center - Discovered assets by system",mainProps:{overflow:"hidden"},fullHeight:!0,children:[(0,r.jsx)(m.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:g.vi},{title:R}],isSticky:!1}),(0,r.jsxs)(l.LgQ,{className:"h-[calc(100%-48px)] overflow-hidden",children:[(0,r.jsx)(l.LgQ.Panel,{defaultSize:250,style:{paddingRight:"var(--ant-padding-md)"},children:(0,r.jsx)(eT,{ref:C,setSelectedNodeKeys:B,selectedNodeKeys:J,primaryAction:T.FieldActionType.CLASSIFY,nodeActions:Object.fromEntries(A.km.map(e=>[e,{label:A.Me[e],disabled:t=>s()(t).map(t=>(e!==T.FieldActionType.PROMOTE_REMOVALS||t.status!==E.Ag.REMOVAL)&&(e!==T.FieldActionType.CLASSIFY||!t.classifyable)).some(e=>!0===e),callback:t=>ea[e](t,!1)}]))})}),(0,r.jsx)(l.LgQ.Panel,{style:{paddingLeft:"var(--ant-padding-md)"},children:(0,r.jsxs)(l.jqI,{vertical:!0,gap:"middle",className:"h-full",children:[(0,r.jsxs)(l.jqI,{justify:"space-between",children:[(0,r.jsx)(l.lQT,{level:2,ellipsis:!0,children:"Monitor results"}),(0,r.jsx)(l.jqI,{align:"center",children:(null==z?void 0:z.last_monitored)&&(0,r.jsxs)(l.lKn,{type:"secondary",children:["Last scan:"," ",new Date(null==z?void 0:z.last_monitored).toLocaleString()]})})]}),(0,r.jsxs)(l.jqI,{justify:"space-between",wrap:"wrap",gap:"small",children:[(0,r.jsxs)(l.jqI,{gap:"small",children:[(0,r.jsx)(h.f,{value:N.searchQuery,onChange:N.updateSearch,placeholder:"Search"}),(0,r.jsx)(l.esZ,{title:"Display keyboard shortcuts",children:(0,r.jsx)(l.wpx,{"aria-label":"Display keyboard shortcuts",icon:(0,r.jsx)(l.PJP.N1d,{}),onClick:()=>I(!0)})})]}),(0,r.jsxs)(l.jqI,{gap:"small",children:[(0,r.jsx)(V,{resourceStatus:U,confidenceBucket:F,dataCategory:G,...$,monitorId:R,stagedResourceUrn:J.map(e=>e.toString())}),(0,r.jsx)(l.S0p,{onOpenChange:e=>{e&&"exclusive"===ep&&et({...H,query:{...H.query},body:{excluded_resource_urns:eu.map(e=>e.toString())}})},menu:{items:[...A.aK.map(e=>({key:e,label:!er&&(null==e_?void 0:e_.includes(e))?A.Me[e]:(0,r.jsx)(l.esZ,{title:A.Z8[e],children:A.Me[e]}),disabled:er||!(null==e_?void 0:e_.includes(e)),onClick:async()=>{"exclusive"===ep?await el[e](H,eu.map(e=>e.toString()),eE):await ea[e](ef.map(e=>e.toString())),eh()}}))]},disabled:ef.length<=0,children:(0,r.jsx)(l.wpx,{type:"primary",icon:(0,r.jsx)(l.PJP._ME,{}),iconPosition:"end",loading:er,children:"Actions"})}),(0,r.jsx)(l.esZ,{title:"Refresh",children:(0,r.jsx)(l.wpx,{icon:(0,r.jsx)(l.PJP.CQM,{}),onClick:()=>eo.refetch(),"aria-label":"Refresh"})})]})]}),(0,r.jsxs)(l.jqI,{gap:"middle",align:"center",children:[(0,r.jsx)(l.E_O,{id:"select-all",...eg}),(0,r.jsx)("label",{htmlFor:"select-all",children:"Select all"}),!!eE&&(0,r.jsxs)(l.lKn,{strong:!0,children:[eE.toLocaleString()," selected"]})]}),(0,r.jsx)(l.krs,{dataSource:[...es.values()],className:"-ml-3 h-full overflow-y-scroll pl-1",loading:eo.isFetching,enableKeyboardShortcuts:!0,locale:!N.searchProps.value&&s()(U).intersection(q).isEmpty()?{emptyText:(0,r.jsx)(l.oj8,{image:l.oj8.PRESENTED_IMAGE_SIMPLE,description:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:"All resources have been approved."}),(0,r.jsx)("div",{children:"You'll now find this data in Managed Datasets\n                                view."}),(0,r.jsx)("div",{children:"To see approved or ignored resources, adjust\n                                your filters"})]}),children:(0,r.jsxs)(l.jqI,{gap:"middle",justify:"center",children:[(0,r.jsx)(c(),{href:g.$m,passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(l.wpx,{children:"Manage datasets view"})}),(0,r.jsx)(l.wpx,{type:"primary","aria-label":"Refresh page",onClick:()=>{$.resetToInitialState(),D.reload()},children:"Refresh page"})]})})}:void 0,onActiveItemChange:(e,t,n)=>{ee(()=>n),(null==e?void 0:e.urn)?(Q({...e,key:e.urn}),K&&e.urn!==K&&W(e.urn)):Q(void 0)},renderItem:e=>ei({...e,selected:ef.includes(e.urn),onSelect:ey,onNavigate:em,onSetDataCategories:(e,t)=>ea["assign-categories"]([e],!0,{user_assigned_data_categories:t}),dataCategoriesDisabled:null==e||!e.diff_status||!A.$k["assign-categories"].some(t=>t===e.diff_status),actions:(null==e?void 0:e.diff_status)?A.Vr[e.diff_status].map(t=>(0,r.jsx)(l.esZ,{title:A.Me[t],children:(0,r.jsx)(l.wpx,{"aria-label":A.Me[t],icon:A.W3[t],onClick:()=>ea[t]([e.urn]),disabled:null==e||!e.diff_status||!A.$k[t].some(t=>t===e.diff_status),style:{fontSize:"var(--ant-button-content-font-size-lg)"}})},t)):[]})}),(0,r.jsx)(l.B7X,{...w,showSizeChanger:{suffixIcon:(0,r.jsx)(l.PJP._ME,{})},total:(null===(n=eo.data)||void 0===n?void 0:n.total)||0,hideOnSinglePage:(null===(a=w.pageSize)||void 0===a?void 0:a.toString())===(null===(i=w.pageSizeOptions)||void 0===i?void 0:i[0])})]})})]}),(0,r.jsx)(eb,{itemKey:null!==(x=null==ec?void 0:ec.urn)&&void 0!==x?x:"",title:null!==(S=null==ec?void 0:ec.name)&&void 0!==S?S:null,titleIcon:(0,r.jsx)(l.PJP.sgG,{}),titleTag:{bordered:!1,color:(null==ec?void 0:ec.diff_status)?Y[ec.diff_status].color:void 0,className:"font-normal text-[var(--ant-font-size-sm)]",children:(null==ec?void 0:ec.diff_status)?Y[ec.diff_status].label:null},actions:((null==ec?void 0:ec.diff_status)?A.Zu[ec.diff_status]:A.sB).map(e=>({label:A.Me[e],callback:t=>ea[e]([t]),disabled:null==ec||!ec.diff_status||!A.$k[e].some(e=>e===ec.diff_status)})),open:!!K,onClose:()=>W(void 0),resource:ec,fieldActions:ea,mask:!Z}),(0,r.jsx)(j,{open:O,onCancel:()=>I(!1)})]})};let eG=()=>(0,r.jsx)(r.Fragment,{children:"Attempting to access monitor results without the required feature flag enabled"});var eY=()=>{let{flags:e}=(0,a.hz)();return e.heliosV2?(0,r.jsx)(eq,{}):(0,r.jsx)(l.ux6,{status:"error",title:(0,r.jsx)(eG,{})})}},72707:function(e){e.exports={option:"TaxonomySelect_option__vY6v2"}},97947:function(e){e.exports={"monitor-field__title":"MonitorFieldListItem_monitor-field__title__YrxOU","monitor-field__breadcrumb":"MonitorFieldListItem_monitor-field__breadcrumb__Rn4vE"}},32500:function(e){e.exports={"monitor-tree":"MonitorTree_monitor-tree__QKz6T"}}},function(e){e.O(0,[431,7245,4589,5505,2888,9774,179],function(){return e(e.s=83806)}),_N_E=e.O()}]);