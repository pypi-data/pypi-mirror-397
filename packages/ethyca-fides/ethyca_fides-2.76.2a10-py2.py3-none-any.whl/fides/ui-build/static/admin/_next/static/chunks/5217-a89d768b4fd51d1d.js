(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5217],{79806:function(e,t,l){"use strict";l.d(t,{Gn:function(){return r},zR:function(){return s}});var i=l(24246),n=l(41013),a=l(56358);let s=e=>{let{title:t}=e;return(0,i.jsx)(n.OXI,{py:0,display:"flex",alignItems:"flex-start",children:(0,i.jsx)(n.xvT,{mr:"2",color:"gray.700",fontSize:"lg",lineHeight:1.8,children:t})})},r=e=>{let{onDelete:t,onEditYaml:l,formId:s,isSaving:r}=e;return(0,i.jsxs)(n.zeN,{justifyContent:"space-between",children:[t?(0,i.jsx)(n.wpx,{"aria-label":"delete",icon:(0,i.jsx)(a.q,{fontSize:"small"}),onClick:t,"data-testid":"delete-btn"}):null,(0,i.jsxs)("div",{className:"flex gap-2",children:[l&&(0,i.jsx)(n.wpx,{onClick:l,"data-testid":"edit-yaml-btn",children:"Edit YAML"}),(0,i.jsx)(n.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:s,loading:r,children:"Save"})]})]})};t.ZP=e=>{let{header:t,description:l,isOpen:a,onClose:s,children:r,footer:o}=e;return(0,i.jsxs)(n.dys,{placement:"right",isOpen:a,onClose:s,size:"md",children:[(0,i.jsx)(n.P1B,{}),(0,i.jsxs)(n.scA,{"data-testid":"edit-drawer-content",py:2,children:[(0,i.jsxs)(n.xuv,{display:"flex",justifyContent:"space-between",alignItems:"top",mr:2,py:2,gap:2,children:[(0,i.jsx)(n.xuv,{flex:1,minH:8,children:t}),(0,i.jsx)(n.xuv,{display:"flex",justifyContent:"flex-end",mr:2,children:(0,i.jsx)(n.wpx,{"aria-label":"Close editor",onClick:s,"data-testid":"close-drawer-btn",icon:(0,i.jsx)(n.Two,{fontSize:"smaller"})})})]}),(0,i.jsxs)(n.Ng0,{pt:1,children:[l?(0,i.jsx)(n.xvT,{fontSize:"sm",mb:4,color:"gray.600",children:l}):null,r]}),o]})]})}},18225:function(e,t,l){"use strict";var i=l(24246),n=l(41013);t.Z=e=>{let{alignment:t="center",...l}=e;return(0,i.jsx)(n.kCb,{boxSize:"full",align:"center",justify:t,children:(0,i.jsx)(n.$jN,{color:"primary",...l})})}},56358:function(e,t,l){"use strict";l.d(t,{q:function(){return n}});var i=l(24246);let n=(0,l(41013).IUT)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,i.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},94799:function(e,t,l){"use strict";l.d(t,{k:function(){return a}});var i=l(76649);let n=e=>(0,i.Ln)({id:"string"},e),a=e=>(null!=e?e:[]).filter(n)},30320:function(e,t,l){"use strict";l.d(t,{m:function(){return o}});var i=l(27378),n=l(25980),a=l(17245),s=l(32885),r=l(94799);let o=e=>{let{resourceFidesKey:t,resourceType:l}=e,{errorAlert:o}=(0,a.VY)(),{plus:d}=(0,n.hz)(),u=(0,i.useMemo)(()=>null!=t?t:"",[]),c=(0,s.YU)(!0,{skip:!d}),m=(0,s.VN)(l,{skip:!d}),{data:x,isLoading:p,error:y,isError:h}=(0,s.PV)(null!=t?t:"",{skip:""!==u&&!(d&&u)}),[f]=(0,s._D)(),v=c.isLoading||m.isLoading||p,j=(0,i.useMemo)(()=>new Map((0,r.k)(c.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[c.data]),g=(0,i.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),_=(0,i.useMemo)(()=>new Map((0,r.k)(g).map(e=>[e.id,e])),[g]),T=(0,i.useMemo)(()=>h&&y&&"status"in y&&404===y.status?new Map:new Map((0,r.k)(x).map(e=>[e.custom_field_definition_id,e])),[x,h,y]),b=(0,i.useMemo)(()=>{let e=[..._.keys()];return e.sort(),e},[_]),E=(0,i.useMemo)(()=>{let e={};return g&&T&&g.forEach(t=>{let l=T.get(t.id||"");l&&(t.allow_list_id&&"string[]"===t.field_type?e[l.custom_field_definition_id]=l.value:e[l.custom_field_definition_id]=l.value.toString())}),e},[g,T]),C=(0,i.useCallback)(async e=>{if(!d)return;let i="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!i)return;let{customFieldValues:n}=e;if(!n||0===Object.keys(n).length)return;let a=[],s=[];b.forEach(e=>{let t=T.get(e),l=n[e];void 0===l||""===l||Array.isArray(l)&&0===l.length?(null==t?void 0:t.id)&&s.push(t.id):a.push({custom_field_definition_id:e,resource_id:i,id:null==t?void 0:t.id,value:l})});try{await f({resource_type:l,resource_id:i,upsert:a,delete:s})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,T,o,t,b,f,l]);return{customFieldValues:E,definitionIdToCustomField:T,idToAllowListWithOptions:j,idToCustomFieldDefinition:_,isEnabled:d,isLoading:v,sortedCustomFieldDefinitionIds:b,upsertCustomFields:C}}},33162:function(e,t,l){"use strict";l.d(t,{uc:function(){return c},mZ:function(){return u.m}});var i=l(24246),n=l(41013),a=l(34090),s=l(20987),r=l(30234),o=l(97181),d=l(40324),u=l(30320);let c=e=>{let{resourceFidesKey:t,resourceType:l}=e,{idToAllowListWithOptions:c,idToCustomFieldDefinition:m,isEnabled:x,isLoading:p,sortedCustomFieldDefinitionIds:y}=(0,u.m)({resourceFidesKey:t,resourceType:l});return x&&0!==y.length?(0,i.jsx)(r.Z,{heading:"Custom fields",children:(0,i.jsx)(n.kCb,{flexDir:"column","data-testid":"custom-fields-list",children:(0,i.jsx)(n.kCb,{flexDir:"column",gap:"24px",children:p?(0,i.jsx)(n.M5Y,{children:(0,i.jsx)(n.$jN,{})}):y.length>0&&(0,i.jsx)(n.kCb,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:y.map(e=>{let t=m.get(e);if(!t)return null;let l="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===s.H.STRING)return(0,i.jsx)(a.gN,{name:l,children:e=>{let{field:l}=e;return(0,i.jsx)(d.j0,{...l,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let n=c.get(t.allow_list_id);if(!n)return null;let{options:r}=n;return(0,i.jsx)(o.d,{name:l,allowClear:!0,mode:t.field_type!==s.H.STRING?"multiple":void 0,label:t.name,options:r,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};l(94799)},97181:function(e,t,l){"use strict";l.d(t,{d:function(){return d}});var i=l(24246),n=l(41013),a=l(34090),s=l(27378),r=l(46238),o=l(40324);let d=e=>{let{name:t,label:l,labelProps:d,tooltip:u,isRequired:c,layout:m="inline",helperText:x,...p}=e,[y,h,{setValue:f}]=(0,a.U$)(t),v=!!(h.touched&&h.error),[j,g]=(0,s.useState)("");y.value||"tags"!==p.mode&&"multiple"!==p.mode||(y.value=[]),"tags"===p.mode&&"string"==typeof y.value&&(y.value=[y.value]);let _="tags"===p.mode?(e,t)=>e?e.value!==j||y.value.includes(j)?p.optionRender?p.optionRender(e,t):e.label:'Create "'.concat(j,'"'):void 0:p.optionRender||void 0,T=e=>{g(e),p.onSearch&&p.onSearch(e)},b=(e,t)=>{f(e),p.onChange&&p.onChange(e,t)};return"inline"===m?(0,i.jsx)(n.NIc,{isInvalid:v,isRequired:c,children:(0,i.jsxs)(n.rjZ,{templateColumns:l?"1fr 3fr":"1fr",children:[l?(0,i.jsx)(o.__,{htmlFor:p.id||t,...d,children:l}):null,(0,i.jsxs)(n.jqI,{align:"center",children:[(0,i.jsxs)(n.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,i.jsx)(n.WPr,{...y,id:p.id||t,"data-testid":"controlled-select-".concat(y.name),...p,optionRender:_,onSearch:"tags"===p.mode?T:void 0,onChange:b,value:y.value||void 0,status:v?"error":void 0}),x&&(0,i.jsx)(n.Q6r,{children:x}),(0,i.jsx)(o.Bc,{isInvalid:v,message:h.error,fieldName:y.name})]}),(0,i.jsx)(r.b,{label:u,className:v?"mt-2 self-start":void 0})]})]})}):(0,i.jsx)(n.NIc,{isInvalid:v,isRequired:c,children:(0,i.jsxs)(n.gCW,{alignItems:"start",children:[(0,i.jsxs)(n.jqI,{align:"center",children:[l?(0,i.jsx)(o.__,{htmlFor:p.id||t,fontSize:"xs",my:0,mr:1,...d,children:l}):null,(0,i.jsx)(r.b,{label:u})]}),(0,i.jsx)(n.WPr,{...y,id:p.id||t,"data-testid":"controlled-select-".concat(y.name),...p,optionRender:_,onSearch:"tags"===p.mode?T:void 0,onChange:b,value:y.value||void 0,status:v?"error":void 0}),x&&(0,i.jsx)(n.Q6r,{style:{marginTop:0},children:x}),(0,i.jsx)(o.Bc,{isInvalid:v,message:h.error,fieldName:y.name})]})})}},84418:function(e,t,l){"use strict";l.d(t,{d:function(){return d}});var i=l(24246),n=l(41013),a=l(98784),s=l.n(a);let r=e=>{let{itemKey:t,actions:l}=e;return s().isEmpty(l)?null:(0,i.jsx)(n.jqI,{gap:"small",justify:"flex-end",children:l.map((e,a)=>{let{callback:s,label:r,disabled:o}=e;return(0,i.jsx)(n.wpx,{onClick:()=>s(t),type:a===l.length-1?"primary":"default",disabled:o,children:r},r)})})},o=e=>{let{title:t,titleIcon:l,titleTag:a}=e;return(0,i.jsxs)(n.jqI,{align:"center",gap:"small",children:[l,(0,i.jsx)("span",{children:t}),a&&(0,i.jsx)(n.j8w,{...a})]})},d=e=>{let{title:t,titleIcon:l,titleTag:a,actions:s,width:d=480,...u}=e;return(0,i.jsx)(n.To0,{title:(0,i.jsx)(o,{title:t,titleIcon:l,titleTag:a}),footer:u.footer||!s?u.footer:(0,i.jsx)(r,{itemKey:u.itemKey,actions:s}),width:d,...u})}},33335:function(e,t,l){"use strict";l.d(t,{E:function(){return i}});let i=e=>e.toLowerCase().replace(/[ .]/g,"_").replace(/[^a-zA-Z0-9_<>-]/g,"")},30234:function(e,t,l){"use strict";var i=l(24246),n=l(41013);t.Z=e=>{let{heading:t,HeadingButton:l,children:a}=e;return(0,i.jsx)(n.Kqy,{spacing:4,children:(0,i.jsxs)(n.xuv,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,i.jsxs)(n.xuv,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,i.jsx)(n.X6q,{as:"h3",size:"xs",children:t}),l&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.LZC,{}),l]})]}),(0,i.jsx)(n.Kqy,{spacing:4,px:6,py:6,children:a})]})})}},22583:function(e,t,l){"use strict";l.d(t,{j:function(){return a}});var i=l(41013),n=l(60240);let a={[n.Ej.TAXONOMY_WHITE]:i.tAb.DEFAULT,[n.Ej.TAXONOMY_RED]:i.tAb.ERROR,[n.Ej.TAXONOMY_ORANGE]:i.tAb.WARNING,[n.Ej.TAXONOMY_YELLOW]:i.tAb.CAUTION,[n.Ej.TAXONOMY_GREEN]:i.tAb.SUCCESS,[n.Ej.TAXONOMY_BLUE]:i.tAb.INFO,[n.Ej.TAXONOMY_PURPLE]:i.tAb.ALERT,[n.Ej.SANDSTONE]:i.tAb.SANDSTONE,[n.Ej.MINOS]:i.tAb.MINOS}},92818:function(e,t,l){"use strict";l.d(t,{r:function(){return o}});var i=l(24246),n=l(27378),a=l(97181),s=l(22583),r=l(60240);let o={[r.Ej.TAXONOMY_WHITE]:"White",[r.Ej.TAXONOMY_RED]:"Red",[r.Ej.TAXONOMY_ORANGE]:"Orange",[r.Ej.TAXONOMY_YELLOW]:"Yellow",[r.Ej.TAXONOMY_GREEN]:"Green",[r.Ej.TAXONOMY_BLUE]:"Blue",[r.Ej.TAXONOMY_PURPLE]:"Purple",[r.Ej.SANDSTONE]:"Sandstone",[r.Ej.MINOS]:"Minos"},d=e=>{let{color:t,...l}=e;return(0,i.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(s.j[t],")"),border:t===r.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...l.style}})},u=e=>{let t=null==e?void 0:e.value,l=null==e?void 0:e.label;return(0,i.jsxs)("span",{className:"flex items-center",children:[(0,i.jsx)(d,{color:t}),(0,i.jsx)("span",{children:l})]})};t.Z=e=>{let t=Object.values(r.Ej).map(e=>({value:e,label:o[e]})),[l,s]=(0,n.useState)(void 0);return(0,i.jsx)(a.d,{...e,options:t,optionRender:u,layout:"stacked",value:l,onChange:e=>{s(e)},prefix:(0,i.jsx)(d,{color:null!=l?l:r.Ej.TAXONOMY_WHITE,style:{marginBottom:"2px"}})})}},15217:function(e,t,l){"use strict";l.d(t,{Z:function(){return ek}});var i,n,a=l(24246),s=l(41013),r=l(69238),o=l.n(r),d=l(86677),u=l(27378),c=l(25980),m=l(812),x=l(77213),p=l(58754),y=l(19904),h=l(32885),f=l(33335),v=l(39864),j=e=>{let{onClose:t}=e,[l,{isLoading:i}]=(0,v.Hb)(),n=(0,s.UD8)(),r=async e=>{var i;let a={...e,taxonomy_type:(0,f.E)(null!==(i=e.name)&&void 0!==i?i:"")},s=await l(a);if((0,m.D4)(s)){n.error((0,m.e$)(s.error));return}n.success("Taxonomy created successfully"),t()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.AntTypography.Paragraph,{children:"Create and organize the core terminology your team uses to describe data and how it's handled. Custom taxonomies let you define domain-specific concepts and then apply them to other privacy objects throughout the platform"}),(0,a.jsxs)(s.PPS,{layout:"vertical",onFinish:r,validateTrigger:["onBlur","onChange"],children:[(0,a.jsx)(s.PPS.Item,{label:"Taxonomy name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,a.jsx)(s.uFc,{"data-testid":"input-name"})}),(0,a.jsx)(s.PPS.Item,{label:"Description",name:"description",children:(0,a.jsx)(s.uFc.TextArea,{rows:2,"data-testid":"input-description"})}),(0,a.jsxs)(s.jqI,{gap:"small",justify:"space-between",children:[(0,a.jsx)(s.wpx,{onClick:t,disabled:i,children:"Cancel"}),(0,a.jsx)(s.wpx,{type:"primary",htmlType:"submit",loading:i,disabled:i,"data-testid":"save-btn",children:"Create taxonomy"})]})]})]})},g=l(33162),_=l(84418),T=l(67522),b=l(66006),E=l(60240),C=l(31883),A=e=>{let{taxonomy:t,onSubmit:l,formId:i,customFields:n}=e,{fides_key:r,...o}=null!=t?t:{},[d,c]=(0,u.useState)(!1),{valueTypeOptions:x}=(0,b.Z)(),p=(0,y.Tg)([E.Sh.CUSTOM_FIELD_DELETE]),[f,v]=s.$zI.useModal(),j=(0,s.UD8)(),[g]=(0,h.UF)(),{createOrUpdate:_}=(0,T.Z)(),A=async e=>{let t=await g({id:e});if((0,C.D4)(t)){j.error((0,m.e$)(t.error));return}j.success("Attribute removed successfully")},I=e=>{f.confirm({title:"Remove attribute",content:"Are you sure you want to remove this attribute?",onOk:()=>A(e),okText:"Remove",centered:!0})},k=async e=>{var t;let l=null==x?void 0:x.find(t=>t.value===e);if(!l||!r){j.error("Taxonomy type not found");return}let i=await _({name:null!==(t=l.label)&&void 0!==t?t:l.value,value_type:l.value,resource_type:r},void 0,void 0);if((0,C.D4)(i)){j.error((0,m.e$)(i.error));return}j.success("Attribute added successfully"),c(!1)};return(0,a.jsxs)(s.jqI,{vertical:!0,gap:"large",children:[v,(0,a.jsx)(s.Yfl,{children:(0,a.jsx)(s.Yfl.Item,{label:"Fides key",children:r})}),(0,a.jsxs)(s.PPS,{id:i,layout:"vertical",initialValues:o,onFinish:l,children:[(0,a.jsx)(s.PPS.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,a.jsx)(s.uFc,{})}),(0,a.jsx)(s.PPS.Item,{label:"Description",name:"description",children:(0,a.jsx)(s.uFc.TextArea,{})})]}),d&&(0,a.jsx)(s.WPr,{options:x,defaultOpen:!0,"aria-label":"Attribute type",onSelect:k}),!d&&(0,a.jsx)(s.wpx,{onClick:()=>c(!0),icon:(0,a.jsx)(s.PJP.mm_,{}),children:"Add attribute"}),(0,a.jsx)(s.krs,{children:n.map(e=>(0,a.jsx)(s.krs.Item,{actions:p?[(0,a.jsx)(s.wpx,{type:"link",onClick:()=>I(e.id),children:"Remove"},"remove")]:void 0,children:(0,a.jsx)(s.krs.Item.Meta,{title:e.name,description:e.description})},e.id))})]})};let I="custom-taxonomy-form";var k=e=>{let{taxonomy:t,onClose:l,onDelete:i,...n}=e,[r,{isLoading:o}]=(0,v.Km)(),d=(0,s.UD8)(),{sortedCustomFieldDefinitionIds:u,idToCustomFieldDefinition:c}=(0,g.mZ)({resourceType:t.fides_key}),x=u.map(e=>c.get(e)).sort((e,t)=>{var l,i;return(null!==(l=e.created_at)&&void 0!==l?l:"").localeCompare(null!==(i=t.created_at)&&void 0!==i?i:"")}),p=async e=>{if(!t.fides_key){d.error("Taxonomy not found");return}let l=await r({fides_key:t.fides_key,...e});if((0,m.D4)(l)){d.error((0,m.e$)(l.error));return}d.success("Taxonomy updated successfully")};return(0,a.jsx)(_.d,{title:"Edit ".concat(null==t?void 0:t.name),...n,itemKey:"",open:!!t,onClose:l,destroyOnHidden:!0,footer:(0,a.jsxs)(s.jqI,{justify:"space-between",className:"w-full",children:[(0,a.jsx)(s.wpx,{onClick:i,children:"Delete"}),(0,a.jsx)(s.wpx,{type:"primary",htmlType:"submit",form:I,loading:o,children:"Save"})]}),children:(0,a.jsx)(A,{taxonomy:t,onSubmit:p,formId:I,customFields:x})})},S=l(79806),N=l(56358),O=l(46628),P=l(59001),w=l(90673),R=l(30002),L=l(28079),D=l(69353),M=l(5785),F=e=>{let{taxonomyType:t}=e,[l,i]=(0,M.Vj)(),[n,a]=(0,R.nC)(),[s,r]=(0,L.dk)(),[o,d]=(0,D.cw)(),[c,m]=(0,M.Ti)(),[x,p]=(0,L.Ql)(),[y,h]=(0,R.wG)(),[f,j]=(0,D.Nr)(),[g]=(0,M.jU)(),[_]=(0,L.LG)(),[T]=(0,R.h8)(),[b]=(0,D.Xz)(),[E]=(0,M.K9)(),[C]=(0,L.gu)(),[A]=(0,R.Kv)(),[I]=(0,D.Uv)(),[k,S]=(0,v.ci)(),[N,O]=(0,v.J1)(),[w]=(0,v.Cy)(),[F]=(0,v.d9)(),V=(0,u.useCallback)(()=>t?k(t):Promise.resolve(void 0),[t,k]),H=(0,u.useCallback)(e=>t?N({taxonomyType:t,...e}):Promise.resolve(void 0),[t,N]),U=(0,u.useCallback)(e=>t?w({taxonomyType:t,...e}):Promise.resolve(void 0),[t,w]),Y=(0,u.useCallback)(e=>t?F({taxonomyType:t,key:e}):Promise.resolve(void 0),[t,F]);return t===P.ac.DATA_CATEGORY?{getAllTrigger:l,taxonomyItems:i.data||[],updateTrigger:g,deleteTrigger:E,createTrigger:c,isLoading:i.isLoading,isError:i.isError,isCreating:m.isLoading}:t===P.ac.DATA_USE?{getAllTrigger:s,taxonomyItems:r.data||[],updateTrigger:_,deleteTrigger:C,createTrigger:x,isLoading:r.isLoading,isError:r.isError,isCreating:p.isLoading}:t===P.ac.DATA_SUBJECT?{getAllTrigger:n,taxonomyItems:a.data||[],updateTrigger:T,deleteTrigger:A,createTrigger:y,isLoading:a.isLoading,isError:a.isError,isCreating:h.isLoading}:t===P.ac.SYSTEM_GROUP?{getAllTrigger:o,taxonomyItems:d.data||[],updateTrigger:b,deleteTrigger:I,createTrigger:f,isLoading:d.isLoading,isError:d.isError,isCreating:j.isLoading}:{getAllTrigger:V,taxonomyItems:(null==S?void 0:S.data)||[],updateTrigger:U,deleteTrigger:Y,createTrigger:H,isLoading:(null==S?void 0:S.isLoading)||!1,isError:(null==S?void 0:S.isError)||!1,isCreating:O.isLoading}},V=l(90104),H=l.n(V),U=l(20987),Y=l(18225),q=e=>{let{taxonomyKey:t,...l}=e,{data:i,isLoading:n}=(0,v.Jy)(t);return i?(0,a.jsx)(s.WPr,{options:i.map(e=>{var t;return{value:e.fides_key,label:null!==(t=e.name)&&void 0!==t?t:e.fides_key}}),loading:n,...l}):null},z=e=>{let{customFields:t,formId:l,form:i}=e,{idToAllowListWithOptions:n,idToCustomFieldDefinition:r,isEnabled:o,isLoading:d,sortedCustomFieldDefinitionIds:u}=t;return o&&0!==u.length?(0,a.jsx)(s.PPS,{form:i,name:l,initialValues:t.customFieldValues,layout:"vertical","data-testid":"custom-fields-form",children:d?(0,a.jsx)(Y.Z,{}):(0,a.jsx)("div",{children:!H()(u)&&(0,a.jsx)("div",{children:u.map(e=>{let l=r.get(e);if(!l)return null;let{id:i,name:o,description:d,allow_list_id:u,field_type:c}=l;if(!u)return(0,a.jsx)(s.PPS.Item,{name:i,label:o,tooltip:d,children:c===U.H.STRING?(0,a.jsx)(s.uFc,{}):(0,a.jsx)(q,{taxonomyKey:c,defaultValue:t.customFieldValues[i]})},e);let m=n.get(l.allow_list_id);if(!m)return null;let{options:x}=m;return(0,a.jsx)(s.PPS.Item,{name:i,label:o,tooltip:d,children:(0,a.jsx)(s.WPr,{mode:c!==U.H.STRING?"multiple":void 0,allowClear:!0,options:x})},e)})})})}):null},Z=l(43551),G=l.n(Z),W=()=>{let e=s.PPS.useFormInstance(),t=s.PPS.useWatch(["rights","values"],e);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.PPS.Item,{label:"Automated Decisions or Profiling",name:"automated_decisions_or_profiling",layout:"horizontal",valuePropName:"checked",children:(0,a.jsx)(s.E_O,{"data-testid":"edit-taxonomy-form_automated-decisions"})}),(0,a.jsx)(s.PPS.Item,{name:["rights","values"],label:"Rights",children:(0,a.jsx)(s.WPr,{mode:"multiple",options:(0,m.MM)(E.ts),"data-testid":"edit-taxonomy-form_rights"})}),t&&!H()(t)&&(0,a.jsx)(s.PPS.Item,{name:["rights","strategy"],label:"Strategy",required:!0,rules:[{required:!0,message:"Please select a strategy"}],children:(0,a.jsx)(s.WPr,{options:(0,m.MM)(E.jX),"data-testid":"edit-taxonomy-form_strategy"})})]})},B=l(83766),X=l.n(B),K=l(1315),J=l(22583),$=l(92818);let Q=e=>{let{color:t,...l}=e;return(0,a.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(J.j[t],")"),border:t===E.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...l.style}})};var ee=e=>{let t=Object.values(E.Ej).map(e=>({value:e,label:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(Q,{color:e}),(0,a.jsx)("span",{children:$.r[e]})]})}));return(0,a.jsx)(s.WPr,{...e,options:t,placeholder:"Select color"})};let et="all-suggested";var el=e=>{let{initialValues:t,onSubmit:l,form:i,formId:n,isDisabled:r}=e,{data:o=[],isLoading:d}=(0,L.fd)(),{data:c,isLoading:m}=(0,K.K3)(),x=(0,u.useMemo)(()=>o.map(e=>({label:e.name||e.fides_key,value:e.fides_key})),[o]),p=s.PPS.useWatch("systems",i),y=(0,u.useMemo)(()=>{var e;let t=p||[];if(!c||0===t.length)return[];let l=null!==(e=null==c?void 0:c.filter(e=>t.includes(e.fides_key)))&&void 0!==e?e:[];return X()(null==l?void 0:l.flatMap(e=>e.privacy_declarations.map(e=>e.data_use)))},[c,p]),h=(0,u.useMemo)(()=>{var e;return null!==(e=null==c?void 0:c.map(e=>({label:e.name||e.fides_key,value:e.fides_key})))&&void 0!==e?e:[]},[c]),f=(0,u.useMemo)(()=>{let e=[],t=[];return(x.forEach(l=>{y.includes(l.value)?e.push(l):t.push(l)}),0===e.length)?t:[{label:"Select all suggested",value:et},{label:(0,a.jsxs)(s.vyj,{children:[(0,a.jsx)(s.QMR,{size:14}),(0,a.jsx)("span",{children:"Suggested data uses"})]}),options:e},{label:(0,a.jsxs)(s.vyj,{children:[(0,a.jsx)(s.PJP.BBB,{}),(0,a.jsx)("span",{children:"All data uses"})]}),options:t}]},[x,y]);return(0,a.jsxs)(s.PPS,{name:n,initialValues:t,onFinish:e=>{var i,n;let a={...t,...e};(!(null==a?void 0:null===(i=a.rights)||void 0===i?void 0:i.values)||H()(null==a?void 0:null===(n=a.rights)||void 0===n?void 0:n.values))&&G()(a,"rights"),l(a)},layout:"vertical",form:i,children:[(0,a.jsx)(s.PPS.Item,{label:"Name",name:"name",children:(0,a.jsx)(s.uFc,{"data-testid":"edit-taxonomy-form_name",disabled:r})}),(0,a.jsx)(s.PPS.Item,{label:"Description",name:"description",children:(0,a.jsx)(s.uFc.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:r})}),(0,a.jsx)(s.PPS.Item,{label:"Systems",name:"systems",children:(0,a.jsx)(s.WPr,{mode:"multiple",placeholder:"Select systems",options:h,allowClear:!0,loading:m,disabled:r,"data-testid":"edit-taxonomy-form_systems"})}),(0,a.jsx)(s.PPS.Item,{label:"Color",name:"label_color",children:(0,a.jsx)(ee,{disabled:r,"data-testid":"edit-taxonomy-form_color"})}),(0,a.jsx)(s.PPS.Item,{label:"Data uses",name:"data_uses",children:(0,a.jsx)(s.WPr,{mode:"multiple",placeholder:"Select data uses",options:f,allowClear:!0,loading:d,disabled:r,onChange:e=>{if(e.includes(et)){let t=X()([...y,...e.filter(e=>e!==et)]);i.setFieldsValue({data_uses:t})}else i.setFieldsValue({data_uses:e})},"data-testid":"edit-taxonomy-form_data_uses"})})]})},ei=e=>{let{initialValues:t,onSubmit:l,form:i,formId:n,taxonomyType:r,isDisabled:o}=e,d=r===P.ac.DATA_SUBJECT;return r===P.ac.SYSTEM_GROUP?(0,a.jsx)(el,{initialValues:t,onSubmit:l,form:i,formId:n,isDisabled:o}):(0,a.jsxs)(s.PPS,{name:n,initialValues:t,onFinish:e=>{var i,n;let a={...t,...e};(!(null==a?void 0:null===(i=a.rights)||void 0===i?void 0:i.values)||H()(null==a?void 0:null===(n=a.rights)||void 0===n?void 0:n.values))&&G()(a,"rights"),l(a)},layout:"vertical",form:i,children:[(0,a.jsx)(s.PPS.Item,{label:"Name",name:"name",children:(0,a.jsx)(s.uFc,{"data-testid":"edit-taxonomy-form_name",disabled:o})}),(0,a.jsx)(s.PPS.Item,{label:"Description",name:"description",children:(0,a.jsx)(s.uFc.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:o})}),d&&(0,a.jsx)(W,{})]})},en=e=>{let{taxonomyItem:t,taxonomyType:l,onClose:i}=e,n="edit-taxonomy-form",[r]=s.PPS.useForm(),[o]=s.PPS.useForm(),d=(0,s.pmc)(),{isOpen:u,onOpen:c,onClose:x}=(0,s.qY0)(),{updateTrigger:p}=F({taxonomyType:l}),h=(0,w.Xl)(l),f=(0,g.mZ)({resourceFidesKey:null==t?void 0:t.fides_key,resourceType:h}),v=(0,y.Tg)([(0,P.aq)(l).UPDATE]),j=(0,y.Tg)([(0,P.aq)(l).DELETE]),_=async e=>{let l=await p(e);if((0,C.D4)(l)){d((0,O.Vo)((0,m.e$)(l.error)));return}if(f.isEnabled){let e=o.getFieldsValue();await f.upsertCustomFields({fides_key:null==t?void 0:t.fides_key,customFieldValues:e})}d((0,O.t5)("Taxonomy successfully updated")),i()},T=async()=>{await p({...t,active:!1}),x(),i()},b=async()=>{await p({...t,active:!0}),x(),i()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(S.ZP,{isOpen:!!t,onClose:i,header:(0,a.jsx)(S.zR,{title:(null==t?void 0:t.name)||""}),footer:(0,a.jsxs)(s.zeN,{justifyContent:"space-between",children:[(null==t?void 0:t.active)&&j&&(0,a.jsx)(s.esZ,{title:"Delete label",children:(0,a.jsx)(s.wpx,{"aria-label":"delete",icon:(0,a.jsx)(N.q,{fontSize:"small"}),onClick:c,"data-testid":"delete-btn"})}),!(null==t?void 0:t.active)&&v&&(0,a.jsx)(s.esZ,{title:"Enable label",children:(0,a.jsx)(s.wpx,{"aria-label":"enable",onClick:b,"data-testid":"enable-btn",icon:(0,a.jsx)(s.tEF,{fontSize:"small"})})}),(0,a.jsx)("div",{className:"flex gap-2",children:v&&(0,a.jsx)(s.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:n,children:"Save"})})]}),children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)(s.AntTypography.Title,{level:3,children:"Details"})}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"w-1/3 shrink-0 text-sm text-gray-500",children:"Fides key:"}),(0,a.jsx)(s.esZ,{title:null==t?void 0:t.fides_key,trigger:"click",children:(0,a.jsx)("span",{className:"flex-1 truncate","data-testid":"edit-drawer-fides-key",children:null==t?void 0:t.fides_key})})]})]}),!!t&&(0,a.jsx)(ei,{initialValues:t,onSubmit:_,form:r,formId:n,taxonomyType:l,isDisabled:!v}),f.isEnabled&&!f.isLoading&&(0,a.jsx)(z,{form:o,formId:"custom-fields-form",customFields:f})]}),(0,a.jsx)(s.cVQ,{isOpen:u,onClose:x,onConfirm:T,title:"Delete ".concat(l),message:(0,a.jsx)(s.Kqy,{children:(0,a.jsxs)(s.xvT,{children:["You are about to permanently delete the ",l," ",(0,a.jsx)(s.xvT,{color:"complimentary.500",as:"span",fontWeight:"bold",children:null==t?void 0:t.name})," ","from your taxonomy. Are you sure you would like to continue?"]})})})]})};l(51901);var ea=l(86298),es=l(3124),er=l.n(es);(i=n||(n={})).DEFAULT="DEFAULT",i.ACTIVE_HOVER="ACTIVE_HOVER",i.PARENT_OF_HOVER="PARENT_OF_HOVER",i.CHILD_OF_HOVER="CHILD_OF_HOVER",i.SIBLING_OF_HOVER="SIBLING_OF_HOVER",i.INACTIVE="INACTIVE";let eo=(0,u.createContext)({activeNodeKey:null,setActiveNodeKey:()=>{},onMouseEnter:()=>{},onMouseLeave:()=>{},getNodeHoverStatus:()=>"DEFAULT"}),ed=e=>{let{children:t}=e,[l,i]=(0,u.useState)(null),n=(0,u.useCallback)(e=>{e!==l&&i(e)},[l]),s=(0,u.useCallback)(()=>{i(null)},[]),r=(0,u.useCallback)(e=>l?e===l?"ACTIVE_HOVER":l.startsWith("".concat(e,"."))||e===P.Ch?"PARENT_OF_HOVER":e.startsWith("".concat(l,"."))||l===P.Ch?"CHILD_OF_HOVER":l.split(".").slice(0,-1).join(".")===e.split(".").slice(0,-1).join(".")?"SIBLING_OF_HOVER":"INACTIVE":"DEFAULT",[l]),o=(0,u.useMemo)(()=>({activeNodeKey:l,setActiveNodeKey:i,onMouseEnter:n,onMouseLeave:s,getNodeHoverStatus:r}),[l,i,n,s,r]);return(0,a.jsx)(eo.Provider,{value:o,children:t})};var eu=l(62266),ec=l(79658);let em=(0,eu.Z)();var ex=e=>{let{nodes:t,edges:l,options:i}=e;return(0,u.useMemo)(()=>{if(0===t.length)return{nodes:t,edges:l};let e=(0,ec.Z)().id(e=>e.id).parentId(e=>{var t;return null===(t=l.find(t=>t.target===e.id))||void 0===t?void 0:t.source})(t),n="LR"===i.direction?[35,320]:[320,35];return{nodes:em.nodeSize(n).separation((e,t)=>e.parent===t.parent?1:1.5)(e).descendants().map(e=>{let t;return t="LR"===i.direction?{x:e.y,y:e.x}:{x:e.x,y:e.y},{...e.data,position:t}}),edges:l}},[t,l,i])},ep=e=>{let{positionAbsoluteX:t,positionAbsoluteY:l,nodeWidth:i}=e,{setCenter:n,getZoom:a}=(0,ea._K)();return{centerScreenOnNode:(0,u.useCallback)(()=>n(t+i/2,l,{duration:500,zoom:a()}),[a,t,l,i,n])}},ey=l(1945),eh=l.n(ey),ef=l(8335),ev=e=>{let{type:t,inactive:l=!1}=e;return(0,a.jsx)(ea.HH,{type:t,position:"source"===t?ef.Ly.Right:ef.Ly.Left,style:{width:8,height:8,backgroundColor:l?er().FIDESUI_NEUTRAL_400:er().FIDESUI_MINOS},className:"transition-colors duration-300 ease-in"})},ej=e=>{let{data:t,positionAbsoluteX:l,positionAbsoluteY:i}=e,{onCancel:n,onSubmit:r,parentKey:o,isLoading:d=!1}=t,c=(0,u.useRef)(null),[m,x]=(0,u.useState)(""),{centerScreenOnNode:p}=ep({positionAbsoluteX:l,positionAbsoluteY:i,nodeWidth:200});(0,u.useEffect)(()=>{x("");let e=()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.focus({cursor:"start",preventScroll:!0})};(async()=>{await p(),e()})()},[o,p,l,i]);let y=()=>{!d&&m.trim()&&r(m)},h=()=>{d||n()};return(0,a.jsxs)("div",{style:{width:200},"data-testid":"taxonomy-text-input-node",children:[(0,a.jsx)(s.uFc,{placeholder:"Type label name...",ref:c,onBlur:h,onSubmit:y,value:m,onChange:e=>x(e.target.value),onKeyUp:e=>{"Escape"===e.key&&h()},onPressEnter:y,className:eh().input,suffix:d&&(0,a.jsx)(s.ZJQ,{size:"small"})}),(0,a.jsx)(ev,{type:"target"})]})},eg=e=>{let{getNodeHoverStatus:t}=(0,u.useContext)(eo),{target:l}=e,i=t(l),s=(0,u.useCallback)(()=>{switch(i){case n.ACTIVE_HOVER:case n.PARENT_OF_HOVER:return er().FIDESUI_MINOS;case n.INACTIVE:return er().NEUTRAL_400;default:return er().FIDESUI_SANDSTONE}},[i]),r=(0,u.useCallback)(()=>{switch(i){case n.ACTIVE_HOVER:case n.PARENT_OF_HOVER:return 2;default:return 1}},[i]);return(0,a.jsx)(ea.Jd,{...e,style:{stroke:s(),strokeWidth:r(),transition:"stroke 0.3s ease 0s"}})},e_=l(34770),eT=l.n(e_),eb=e=>{let{data:t,positionAbsoluteX:l,positionAbsoluteY:i}=e,{onMouseEnter:r,onMouseLeave:o,getNodeHoverStatus:d}=(0,u.useContext)(eo),{taxonomyType:c,taxonomyItem:m,onAddButtonClick:x,onTaxonomyItemClick:p,label:y,hasChildren:h,isLastCreatedItem:f,resetLastCreatedItemKey:v,userCanAddLabels:j}=t,{centerScreenOnNode:g}=ep({positionAbsoluteX:l,positionAbsoluteY:i,nodeWidth:200});(0,u.useEffect)(()=>{let e=async()=>{await g(),r(null==m?void 0:m.fides_key)};f&&(e(),v())},[f,r,null==m?void 0:m.fides_key,v,g]);let _=d(null==m?void 0:m.fides_key),T=(0,u.useCallback)(()=>{switch(_){case n.ACTIVE_HOVER:return eT()["button--hover"];case n.PARENT_OF_HOVER:return eT()["button--parent-hover"];case n.INACTIVE:return eT()["button--inactive"];case n.DEFAULT:case n.CHILD_OF_HOVER:case n.SIBLING_OF_HOVER:default:return""}},[_]),b=(null==m?void 0:m.fides_key)===P.Ch,E=c===P.ac.DATA_SUBJECT;return(0,a.jsxs)("div",{className:eT().container,onMouseEnter:()=>r(null==m?void 0:m.fides_key),onMouseLeave:()=>o(null==m?void 0:m.fides_key),"data-testid":"taxonomy-node-".concat(null==m?void 0:m.fides_key),children:[(0,a.jsx)(s.wpx,{className:"".concat(eT().button," ").concat(T()),onClick:()=>null==p?void 0:p(m),disabled:!p,type:"text",children:(0,a.jsxs)(s.AntTypography.Text,{ellipsis:!0,style:{color:"inherit"},children:[(null==m?void 0:m.active)===!1?"(disabled) ":"",y]})}),!b&&(0,a.jsx)(ev,{type:"target",inactive:_===n.INACTIVE}),h&&(0,a.jsx)(ev,{type:"source",inactive:_===n.INACTIVE}),j&&(!E||b)&&(0,a.jsx)("div",{className:eT()["add-button-container"],children:(0,a.jsx)(s.wpx,{type:"default",className:"".concat(eT()["add-button"]," ").concat(_===n.ACTIVE_HOVER?eT()["add-button--visible"]:""),icon:(0,a.jsx)(s.PJP.mm_,{size:20}),onClick:()=>null==x?void 0:x(m),size:"middle","data-testid":"taxonomy-add-child-label-button","aria-label":"Add child label to ".concat(y)})})]})};let eE=e=>{let{taxonomyType:t,taxonomyItems:l,draftNewItem:i,lastCreatedItemKey:n,resetLastCreatedItemKey:s,onRootItemClick:r,onTaxonomyItemClick:o,onAddButtonClick:d,onCancelDraftItem:c,onSubmitDraftItem:m,userCanAddLabels:x,isCreating:p=!1,rootNodeLabel:y}=e,{fitView:h}=(0,ea._K)();(0,u.useEffect)(()=>{setTimeout(()=>h(),150)},[h,t,l.length]);let f=[(0,u.useMemo)(()=>({id:P.Ch,position:{x:0,y:0},data:{label:y||t,taxonomyItem:{fides_key:P.Ch},taxonomyType:t,onTaxonomyItemClick:r,onAddButtonClick:d,hasChildren:0!==l.length,userCanAddLabels:x},type:"taxonomyTreeNode"}),[y,t,r,d,l.length,x])],v=[];if(l.forEach(e=>{let l=e.name||e.fides_key.split(".").pop()||"",i={id:e.fides_key,position:{x:0,y:0},data:{label:l,taxonomyType:t,taxonomyItem:e,onTaxonomyItemClick:o,onAddButtonClick:d,hasChildren:!1,isLastCreatedItem:n===e.fides_key,resetLastCreatedItemKey:s,userCanAddLabels:x},type:"taxonomyTreeNode"};f.push(i);let a=e.parent_key?f.find(t=>t.id===e.parent_key):null,r=a?a.id:P.Ch,u=e.fides_key,c={id:"".concat(r,"-").concat(u),source:r,target:u,type:"taxonomyTreeEdge"};v.push(c),a&&(a.data.hasChildren=!0)}),i){let e=i.parent_key||P.Ch;f.push({id:"draft-node",position:{x:0,y:0},type:"textInputNode",data:{parentKey:e,onCancel:c,onSubmit:m,isLoading:p},hidden:!i}),v.push({id:"draft-line",source:e,target:"draft-node",animated:!0});let t=f.find(t=>t.id===e);t&&(t.data.hasChildren=!0)}let{nodes:j,edges:g}=ex({nodes:f,edges:v,options:{direction:"LR"}}),_=(0,u.useMemo)(()=>({taxonomyTreeNode:eb,textInputNode:ej}),[]),T=(0,u.useMemo)(()=>({taxonomyTreeEdge:eg}),[]);return(0,a.jsx)("div",{className:"size-full",style:{backgroundColor:er().FIDESUI_BG_CORINTH},"data-testid":"taxonomy-interactive-tree",children:(0,a.jsx)(ed,{children:(0,a.jsxs)(ea.x$,{nodes:j,edges:g,nodeTypes:_,edgeTypes:T,maxZoom:2,minZoom:.3,nodesConnectable:!1,edgesFocusable:!1,elementsSelectable:!1,proOptions:{hideAttribution:!0},children:[(0,a.jsx)(ea.Aq,{color:er().FIDESUI_NEUTRAL_100,variant:ea.T7.Dots,size:3}),(0,a.jsx)(ea.a9,{nodeStrokeWidth:3,pannable:!0}),(0,a.jsx)(ea.ZX,{showInteractive:!1})]})})})};var eC=e=>(0,a.jsx)(ea.tV,{children:(0,a.jsx)(eE,{...e})});let eA="add new item",eI=P.ac.DATA_CATEGORY;var ek=e=>{let{initialTaxonomy:t}=e,l=(0,d.useRouter)(),i=null!=t?t:eI,n=!Object.values(P.ac).includes(i),r=(0,c.hz)().plus,{isLoading:f}=(0,h.x8)(),{data:g}=(0,v.MU)(void 0,{skip:!r}),{createTrigger:_,getAllTrigger:T,taxonomyItems:b=[],isCreating:E}=F({taxonomyType:i}),C="true"===l.query.showDisabledItems,A=(0,s.UD8)();(0,u.useEffect)(()=>{T()},[T,i]);let[I,S]=(0,u.useState)(null),[N,O]=(0,u.useState)(null),[w,R]=(0,u.useState)(null),[L,D]=(0,u.useState)(null),M=(0,s.S37)(),[V]=(0,v.EO)(),H=async()=>{if(!(null==N?void 0:N.fides_key)){A.error("Taxonomy not found");return}let e=await V(N.fides_key);if((0,m.D4)(e)){A.error((0,m.e$)(e.error));return}A.success("Taxonomy deleted successfully"),O(null);let t={...l.query};delete t.key,l.replace({pathname:"/taxonomy",query:t},void 0,{shallow:!0})},U=(0,u.useMemo)(()=>{var e;if(!g)return null;let t=g.find(e=>e.fides_key===i);return null!==(e=null==t?void 0:t.name)&&void 0!==e?e:null==t?void 0:t.fides_key},[g,i]),[Y,q]=(0,u.useState)(!1);(0,u.useEffect)(()=>{R(null),D(null),S(null)},[i]),(0,u.useEffect)(()=>{if(i===P.ac.SYSTEM_GROUP&&!f&&!r){let e={...l.query};delete e.key,l.replace({pathname:"/taxonomy",query:e},void 0,{shallow:!0})}},[i,r,f,l]);let z=(0,u.useCallback)(async e=>{if(!w)return;let t=(null==w?void 0:w.parent_key)===P.Ch,l={...w,name:e,parent_key:t?null:w.parent_key},i=await _(l);if((0,m.D4)(i)){A.error((0,m.e$)(i.error));return}D(i.data.fides_key),A.success("New label successfully created"),R(null)},[_,w,A]),Z=o()(b,"active"),G=(0,y.Tg)([(0,P.aq)(i).CREATE]);return(0,a.jsxs)(x.Z,{title:"Taxonomy",children:[(0,a.jsxs)(s.jqI,{vertical:!0,className:"h-full",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(p.Z,{heading:"Taxonomy"}),(0,a.jsx)("div",{className:"hidden",children:(0,a.jsx)("div",{className:"mb-5 flex justify-between",children:(0,a.jsxs)(s.vyj.Compact,{children:[(0,a.jsx)(s.uFc,{className:"min-w-[350px]",placeholder:"Search",allowClear:!0}),(0,a.jsx)(s.wpx,{type:"default",children:"Clear"})]})})})]}),(0,a.jsxs)("div",{className:"relative grow",children:[(0,a.jsx)("div",{className:"absolute left-2 top-2 z-[1]",children:(0,a.jsx)(s.AHg,{selectedKeys:[i],onSelect:e=>{let{key:t}=e;if(t===eA){q(!0);return}let i={...l.query};delete i.key,l.replace({pathname:"/taxonomy/".concat(t),query:i},void 0,{shallow:!0})},items:(()=>{let e={[P.Lo.DATA_CATEGORIES]:P.ac.DATA_CATEGORY,[P.Lo.DATA_USES]:P.ac.DATA_USE,[P.Lo.DATA_SUBJECTS]:P.ac.DATA_SUBJECT,[P.Lo.SYSTEM_GROUPS]:P.ac.SYSTEM_GROUP},t=(0,m.MM)(P.Lo).filter(e=>r||e.value!==P.Lo.SYSTEM_GROUPS).map(t=>({label:t.label,key:e[t.value]}));return(null==g?void 0:g.length)&&g.forEach(e=>{t.push({label:e.name,key:e.fides_key})}),r&&(t.push({type:"divider"}),t.push({label:"+ Create new",key:eA})),t})(),"data-testid":"taxonomy-type-selector"})}),(0,a.jsx)(s.$zI,{open:Y,destroyOnHidden:!0,onCancel:()=>q(!1),width:768,footer:null,centered:!0,title:"Create new taxonomy",children:(0,a.jsx)(j,{onClose:()=>q(!1)})}),(0,a.jsx)(eC,{userCanAddLabels:G,taxonomyItems:C?b:Z,draftNewItem:w,lastCreatedItemKey:L,resetLastCreatedItemKey:()=>D(null),onTaxonomyItemClick:e=>{S(e)},onRootItemClick:n?()=>{let e=null==g?void 0:g.find(e=>e.fides_key===i);e&&O(e)}:null,onAddButtonClick:e=>{var t;R({parent_key:null!==(t=null==e?void 0:e.fides_key)&&void 0!==t?t:null,is_default:!1,description:""})},taxonomyType:i,onCancelDraftItem:()=>R(null),onSubmitDraftItem:z,isCreating:E,rootNodeLabel:null!=U?U:(0,P._g)(i)})]})]}),I&&(0,a.jsx)(en,{taxonomyItem:I,taxonomyType:i,onClose:()=>S(null)}),r&&N&&(0,a.jsx)(k,{title:U?"Edit ".concat(U):"Edit taxonomy",onClose:()=>O(null),onDelete:()=>{M.confirm({title:"Delete ".concat(null==N?void 0:N.name,"?"),icon:null,content:(0,a.jsx)(s.AntTypography.Paragraph,{children:"Are you sure you want to delete this taxonomy? This action cannot be undone."}),okText:"Delete",okType:"primary",onOk:H,centered:!0})},taxonomy:N})]})}},90673:function(e,t,l){"use strict";l.d(t,{Cd:function(){return a},Xl:function(){return s}});var i=l(20987),n=l(59001);let a=(e,t)=>{let l;if(null==t&&e.every(e=>void 0===e.parent_key))l=e;else{let i=null!=t?t:null;l=e.filter(e=>e.parent_key===i)}return l.map(t=>{var l,i;let n=t.fides_key;return{value:t.fides_key,label:t.name||t.fides_key,description:t.description,children:a(e,n),is_default:null!==(l=t.is_default)&&void 0!==l&&l,active:null!==(i=t.active)&&void 0!==i&&i}})},s=e=>{switch(e){case n.ac.DATA_CATEGORY:return i.J.DATA_CATEGORY;case n.ac.DATA_SUBJECT:return i.J.DATA_SUBJECT;case n.ac.DATA_USE:return i.J.DATA_USE;default:return e}}},1945:function(e){e.exports={input:"TaxonomyTextInputNode_input__P9czz"}},34770:function(e){e.exports={container:"TaxonomyTreeNode_container__T4KpF",button:"TaxonomyTreeNode_button__mcbOd","button--hover":"TaxonomyTreeNode_button--hover__oycXY","button--parent-hover":"TaxonomyTreeNode_button--parent-hover__pwAPl","button--inactive":"TaxonomyTreeNode_button--inactive__Fjdpe","add-button-container":"TaxonomyTreeNode_add-button-container__eEoRN","add-button":"TaxonomyTreeNode_add-button__oM2vI","add-button--visible":"TaxonomyTreeNode_add-button--visible__Ojqqf"}}}]);