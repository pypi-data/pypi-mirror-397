(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[693],{74833:function(e,t,n){var r=n(56127),s=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(s,""):e}},56127:function(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},66726:function(e,t,n){var r=n(11611),s=n(82846),i=n(91936),a=Math.max,l=Math.min;e.exports=function(e,t,n){var o,d,c,u,m,p,h=0,f=!1,v=!1,x=!0;if("function"!=typeof e)throw TypeError("Expected a function");function j(t){var n=o,r=d;return o=d=void 0,h=t,u=e.apply(r,n)}function w(e){var n=e-p,r=e-h;return void 0===p||n>=t||n<0||v&&r>=c}function g(){var e,n,r,i=s();if(w(i))return b(i);m=setTimeout(g,(e=i-p,n=i-h,r=t-e,v?l(r,c-n):r))}function b(e){return(m=void 0,x&&o)?j(e):(o=d=void 0,u)}function y(){var e,n=s(),r=w(n);if(o=arguments,d=this,p=n,r){if(void 0===m)return h=e=p,m=setTimeout(g,t),f?j(e):u;if(v)return clearTimeout(m),m=setTimeout(g,t),j(p)}return void 0===m&&(m=setTimeout(g,t)),u}return t=i(t)||0,r(n)&&(f=!!n.leading,c=(v="maxWait"in n)?a(i(n.maxWait)||0,t):c,x="trailing"in n?!!n.trailing:x),y.cancel=function(){void 0!==m&&clearTimeout(m),h=0,o=p=d=m=void 0},y.flush=function(){return void 0===m?u:b(s())},y}},82846:function(e,t,n){var r=n(77400);e.exports=function(){return r.Date.now()}},91936:function(e,t,n){var r=n(74833),s=n(11611),i=n(55193),a=0/0,l=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,d=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return a;if(s(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=s(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=o.test(e);return n||d.test(e)?c(e.slice(2),n?2:8):l.test(e)?a:+e}},7873:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user-management",function(){return n(32802)}])},30952:function(e,t,n){"use strict";n.d(t,{f:function(){return o}});var r=n(24246),s=n(66726),i=n.n(s),a=n(27378),l=n(26917);let o=e=>{let{value:t,onChange:n,placeholder:s,...o}=e,[d,c]=(0,a.useState)(t);(0,a.useEffect)(()=>{c(t||"")},[t]);let u=i()(n,500),m=(0,a.useCallback)(e=>{c(e),u(e)},[]);return(0,r.jsx)(l.Z,{value:d,onChange:m,onClear:()=>{c(""),n("")},placeholder:s,...o})}},35287:function(e,t,n){"use strict";var r=n(24246),s=n(41013),i=n(88038),a=n.n(i);n(27378),t.Z=e=>{let{children:t,title:n,fullHeight:i,fullWidth:l,mainProps:o}=e;return(0,r.jsxs)(s.kCb,{"data-testid":n,direction:"column",height:i?"100vh":"calc(100vh - 48px)",width:l?"100vw":"calc(100vw - 240px)",children:[(0,r.jsxs)(a(),{children:[(0,r.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,r.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)(s.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...o,children:t})]})}},19904:function(e,t,n){"use strict";n.d(t,{Tg:function(){return a}});var r=n(24246),s=n(16134),i=n(31793);let a=e=>(0,s.C)(i.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:n}=e;return a(t)?(0,r.jsx)(r.Fragment,{children:n}):null}},99640:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(24246),s=n(41013),i=n(79894),a=n.n(i);let{Link:l,Text:o}=s.AntTypography,d=e=>{let{href:t,children:n,containerProps:i,...d}=e;return(0,r.jsx)(s.jqI,{...i,children:t?(0,r.jsx)(a(),{href:t,passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(l,{strong:!0,ellipsis:!0,onClick:e=>e.stopPropagation(),variant:"primary",...d,children:(0,r.jsx)(o,{unStyled:!0,ellipsis:{tooltip:n},children:n})})}):(0,r.jsx)(o,{strong:!0,ellipsis:!0,...d,children:n})})}},61038:function(e,t,n){"use strict";var r=n(24246),s=n(41013),i=n(34090),a=n(86677);n(27378);var l=n(55484),o=n(16134),d=n(40324),c=n(812),u=n(77830),m=n(46628),p=n(65497);let h={username:"",usernameConfirmation:""},f=e=>{let{id:t,username:n,onClose:r}=e,i=(0,s.pmc)(),d=(0,a.useRouter)(),h=(0,o.T)(),[f]=(0,p.I1)();return{handleDeleteUser:async()=>{let e=await f(t);(0,c.D4)(e)?i((0,m.Vo)((0,c.e$)(e.error))):(i((0,m.t5)("Successfully deleted user")),r()),h((0,p.Vv)(void 0)),d.push(u.e3)},validationSchema:l.Ry().shape({usernameConfirmation:l.Z_().required().oneOf([n],"Confirmation input must match the username").label("Username confirmation")})}};t.Z=e=>{let{user:t,...n}=e,{isOpen:a,onClose:l}=n,{handleDeleteUser:o,validationSchema:c}=f({id:t.id,username:t.username,onClose:l});return(0,r.jsxs)(s.u_l,{isCentered:!0,isOpen:a,onClose:l,children:[(0,r.jsx)(s.ZAr,{}),(0,r.jsx)(s.hzk,{"data-testid":"delete-user-modal",children:(0,r.jsx)(i.J9,{initialValues:h,validationSchema:c,onSubmit:o,children:e=>{let{isSubmitting:n,dirty:a,isValid:o}=e;return(0,r.jsxs)(i.l0,{children:[(0,r.jsx)(s.xBx,{children:"Delete User"}),(0,r.jsx)(s.olH,{}),(0,r.jsxs)(s.fef,{children:[(0,r.jsxs)(s.bZj,{status:"warning",overflow:"visible",colorScheme:"warn",marginBottom:4,children:[(0,r.jsx)(s.zMQ,{}),(0,r.jsxs)(s.XaZ,{children:[(0,r.jsx)(s.xvT,{as:"span",mb:2,children:"You are about to delete the user\xa0"}),(0,r.jsxs)(s.xvT,{as:"span",mb:2,fontStyle:"italic",fontWeight:"semibold",children:[t.username,"."]}),(0,r.jsx)(s.xvT,{mb:2,children:"This action cannot be undone. To confirm, please enter the userâ€™s username below."})]})]}),(0,r.jsx)(s.Kqy,{direction:"column",spacing:4,children:(0,r.jsx)(d.j0,{name:"usernameConfirmation",label:"Confirm username",placeholder:"Type the username to delete"})})]}),(0,r.jsx)(s.mzw,{children:(0,r.jsxs)("div",{className:"flex w-full gap-2",children:[(0,r.jsx)(s.wpx,{onClick:l,className:"w-1/2",children:"Cancel"}),(0,r.jsx)(s.wpx,{type:"primary",disabled:!a||!o,loading:n,htmlType:"submit",className:"w-1/2","data-testid":"submit-btn",children:"Delete User"})]})})]})}})})]})}},91437:function(e,t,n){"use strict";n.d(t,{K:function(){return s}});var r=n(60240);let s=[{label:"Owner",permissions_label:"Owner",roleKey:r.A7.OWNER,description:"Owners have view and edit access to the whole organization and can create new users"},{label:"Contributor",permissions_label:"Contributor",roleKey:r.A7.CONTRIBUTOR,description:"Contributors can create new users and have view and edit access to the whole organization. Contributors cannot configure storage and messaging services"},{label:"Viewer",permissions_label:"Viewer",roleKey:r.A7.VIEWER,description:"Viewers have view access to the Data Map and all systems"},{label:"Viewer & Approver",permissions_label:"Viewer & Approver",roleKey:r.A7.VIEWER_AND_APPROVER,description:"Viewer & Approvers have view access to the Data Map but can also manage Privacy Requests"},{label:"Approver",permissions_label:"Approver",roleKey:r.A7.APPROVER,description:"Approvers can only access the Privacy Requests portal to review, approve, and create new requests"},{label:"Internal respondent",permissions_label:"Internal respondent",roleKey:r.A7.RESPONDENT,description:"Internal respondents have limited access and can only view and complete manual DSR tasks assigned to them"},{label:"External respondent",permissions_label:"External respondent",roleKey:r.A7.EXTERNAL_RESPONDENT,description:"External respondents can only access the external task portal to complete manual DSR tasks assigned to them"}]},32802:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return C}});var r=n(24246),s=n(27378),i=n(41013),a=n(79894),l=n.n(a),o=n(16134),d=n(30952),c=n(77830),u=n(19904),m=n(60240),p=n(65497),h=n(91317),f=n(99640),v=n(8125),x=n(91437),j=n(61038);let w=e=>{let{userId:t}=e,{data:n}=(0,p.gU)(t,{skip:!t}),s=[];return n&&n.roles&&n.roles.forEach(e=>{let t=x.K.find(t=>t.roleKey===e);t&&s.push(t.permissions_label)}),(0,r.jsx)(r.Fragment,{children:s.map(e=>(0,r.jsx)(i.j8w,{"data-testid":"user-permissions-badge",children:e},e))})},g=e=>{let{userId:t}=e,{data:n}=(0,p.d6)(t,{skip:!t});return(0,r.jsx)(i.j8w,{className:"text-center","data-testid":"user-systems-badge",children:n?n.length:0})},b=e=>{let{user:t}=e,n=(0,i.qY0)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.wpx,{size:"small","aria-label":"delete",icon:(0,r.jsx)(i.PJP.ZNm,{}),onClick:e=>{e.stopPropagation(),n.onOpen()},"data-testid":"delete-user-btn"}),(0,r.jsx)(j.Z,{user:t,...n})]})};var y=()=>{let e=(0,o.C)(h.dy),t=(0,u.Tg)([m.Sh.USER_DELETE]),n=(0,u.Tg)([m.Sh.USER_UPDATE]),a=(0,v.o)({pagination:{defaultPageSize:25,pageSizeOptions:[25,50,100]},search:{defaultSearchQuery:""}}),{pageIndex:l,pageSize:d,searchQuery:x,updateSearch:j}=a,{data:y,isLoading:E,isFetching:_}=(0,p.wv)({page:l,size:d,username:x||void 0}),T=(0,s.useMemo)(()=>{var e,t;return{dataSource:null!==(e=null==y?void 0:y.items)&&void 0!==e?e:[],totalRows:null!==(t=null==y?void 0:y.total)&&void 0!==t?t:0,isLoading:E,isFetching:_,getRowKey:e=>{var t;return null!==(t=e.id)&&void 0!==t?t:""}}},[null==y?void 0:y.items,null==y?void 0:y.total,E,_]),{tableProps:C}=(0,v.V)(a,T);return{tableProps:C,columns:(0,s.useMemo)(()=>[{title:"Username",dataIndex:"username",key:"username",fixed:"left",render:(t,s)=>{let a=!!e&&e.id===s.id,l=n||a;return(0,r.jsxs)(i.jqI,{gap:"small",children:[(0,r.jsx)(f.Z,{href:l?"".concat(c.e3,"/profile/").concat(s.id):void 0,"data-testid":"user-link-".concat(s.id),children:t})," ",s.disabled&&(0,r.jsx)(i.j8w,{color:"success","data-testid":"invite-sent-badge",children:"Invite sent"})]})}},{title:"Email",dataIndex:"email_address",key:"email_address"},{title:"First name",dataIndex:"first_name",key:"first_name"},{title:"Last name",dataIndex:"last_name",key:"last_name"},{title:"Permissions",key:"permissions",render:(e,t)=>{var n;return(0,r.jsx)(w,{userId:null!==(n=t.id)&&void 0!==n?n:""})}},{title:"Assigned systems",key:"systems",render:(e,t)=>{var n;return(0,r.jsx)(g,{userId:null!==(n=t.id)&&void 0!==n?n:""})}},{title:"Created at",dataIndex:"created_at",key:"created_at",render:e=>e?new Date(e).toUTCString():null},...t?[{title:"",key:"actions",width:80,render:(e,t)=>(0,r.jsx)(b,{user:t})}]:[]],[t,n,e]),searchQuery:x,updateSearch:j}},E=()=>{let{tableProps:e,columns:t,searchQuery:n,updateSearch:a}=y(),h=(0,o.T)();return(0,s.useEffect)(()=>{h((0,p.Vv)(void 0))},[h]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.jqI,{justify:"space-between",className:"mb-4",children:[(0,r.jsx)(d.f,{value:n,onChange:a,placeholder:"Search by username","data-testid":"user-search"}),(0,r.jsx)(u.ZP,{scopes:[m.Sh.USER_CREATE],children:(0,r.jsx)(l(),{href:"".concat(c.e3,"/new"),passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(i.wpx,{type:"primary","data-testid":"add-new-user-btn",children:"Add new user"})})})]}),(0,r.jsx)(i.V5H,{...e,columns:t,"data-testid":"user-management-table",onRow:e=>({"data-testid":"row-".concat(e.id)})})]})},_=n(35287),T=n(58754),C=()=>(0,r.jsxs)(_.Z,{title:"User Management",children:[(0,r.jsx)(T.Z,{heading:"Users",breadcrumbItems:[{title:"All users"}],isSticky:!1}),(0,r.jsx)(E,{})]})}},function(e){e.O(0,[431,7245,3931,2888,9774,179],function(){return e(e.s=7873)}),_N_E=e.O()}]);