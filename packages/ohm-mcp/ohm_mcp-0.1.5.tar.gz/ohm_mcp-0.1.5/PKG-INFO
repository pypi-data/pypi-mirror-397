Metadata-Version: 2.4
Name: ohm-mcp
Version: 0.1.5
Summary: AI-Powered Python Refactoring & Code Quality Assistant - MCP Server with AST-based analysis
Author-email: Murugaraj <murugaraj@gmail.com>
Maintainer-email: Murugaraj <murugaraj@gmail.com>
License: MIT
Project-URL: Homepage, https://www.ohm-mcp.dev
Keywords: mcp,model-context-protocol,refactoring,code-quality,ast,python,static-analysis,testing,automation,developer-tools
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Topic :: Software Development :: Quality Assurance
Classifier: Topic :: Software Development :: Testing
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Utilities
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: mcp>=0.1.0

<div align="center">

<img src="https://raw.githubusercontent.com/Murugarajr/ohm-mcp-pypi/refs/heads/main/image/ohm-mcp.png" alt="OHM-MCP" width="300">

# OHM-MCP

**AI-Powered Python Refactoring & Code Quality Assistant**

Works with **GitHub Copilot**, **Cursor IDE**, **Cline**, and any MCP-compatible AI assistant.

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![MCP](https://img.shields.io/badge/MCP-0.1.0+-green.svg)](https://modelcontextprotocol.io)
[![AST-Based](https://img.shields.io/badge/AST--Based-100%25-brightgreen.svg)]()
[![License](https://img.shields.io/badge/license-MIT-blue.svg)]()

</div>

---

## âœ¨ Core Capabilities

<table>
<tr>
<td width="50%">

### ğŸ—ï¸ **Architecture**
- God Object Detection
- SOLID Violation Analysis
- Design Pattern Suggestions
- Dependency Injection Refactoring

### ğŸ”§ **Code Quality**
- AST Extract Method (100% accurate)
- Dead Code Elimination
- Import Refactoring
- Symbol Renaming (project-wide)
- Duplication Detection

</td>
<td width="50%">

### ğŸ“Š **Type Safety**
- Type Coverage Analysis
- Type Stub Generation
- Auto Test Generation

### âš¡ **Performance**
- O(nÂ²) Pattern Detection
- Hotspot Analysis
- Coverage-Driven Prioritization

### ğŸ¤– **Automation**
- Auto-Apply with Rollback
- Operation History
- Quality Dashboard

</td>
</tr>
</table>

---

## ğŸš€ Quick Start

### Installation
```bash
pip install -e .
```

### IDE Configuration

#### ğŸ“¦ **Option 1: NPX (Recommended - Auto-installs dependencies)**

<details>
<summary><b>ğŸ”µ GitHub Copilot (VS Code) with NPX</b></summary>

**After publishing to npm:**
```json
{
  "mcpServers": {
    "ohm-mcp": {
      "command": "npx",
      "args": ["ohm-mcp@latest"]
    }
  }
}
```

**For local development:**
```json
{
  "mcpServers": {
    "ohm-mcp": {
      "command": "npx",
      "args": ["--package", "/path/to/ohm-mcp-npm", "ohm-mcp"]
    }
  }
}
```

**Usage:**
- Open Copilot Chat
- Type `#` and select `ohm-mcp` tools
- Ask: "Analyze this file and suggest refactorings"

</details>

<details>
<summary><b>ğŸŸ£ Cursor IDE with NPX</b></summary>

**After publishing to npm:**
```json
{
  "mcpServers": {
    "ohm-mcp": {
      "command": "npx",
      "args": ["ohm-mcp@latest"]
    }
  }
}
```

**For local development:**
```json
{
  "mcpServers": {
    "ohm-mcp": {
      "command": "npx",
      "args": ["--package", "/path/to/ohm-mcp-npm", "ohm-mcp"]
    }
  }
}
```

**Usage:**
- Open Cursor Chat (Cmd+L / Ctrl+L)
- Tools are automatically available
- Ask: "Use ohm-mcp to detect dead code"

</details>

<details>
<summary><b>ğŸŸ¢ Cline (VS Code Extension) with NPX</b></summary>

**After publishing to npm:**
```json
{
  "mcpServers": {
    "ohm-mcp": {
      "command": "npx",
      "args": ["ohm-mcp@latest"]
    }
  }
}
```

**For local development:**
```json
{
  "mcpServers": {
    "ohm-mcp": {
      "command": "npx",
      "args": ["--package", "/path/to/ohm-mcp-npm", "ohm-mcp"]
    }
  }
}
```

**Usage:**
- Open Cline panel
- Tools are available in agent context
- Ask: "Analyze type coverage and suggest improvements"

</details>

#### ğŸ **Option 2: Direct Python (Manual setup)**

<details>
<summary><b>ğŸ”µ GitHub Copilot (VS Code) with Python</b></summary>

First install: `pip install ohm-mcp`

Then add to `.vscode/mcp.json`:
```json
{
  "servers": {
    "ohm-mcp": {
      "command": "python",
      "args": ["-m", "ohm_mcp.server"]
    }
  },
  "inputs": []
}
```

**Usage:**
- Open Copilot Chat
- Type `#` and select `ohm-mcp` tools
- Ask: "Analyze this file and suggest refactorings"

</details>

<details>
<summary><b>ğŸŸ£ Cursor IDE with Python</b></summary>

First install: `pip install ohm-mcp`

Then add to Cursor's MCP settings file (`.cursorrules` or MCP config):
```json
{
  "mcpServers": {
    "ohm-mcp": {
      "command": "python",
      "args": ["-m", "ohm_mcp.server"]
    }
  },
  "inputs": []
}
```

**Example with virtual environment:**
```json
{
  "mcpServers": {
    "ohm-mcp": {
      "command": "/Users/username/projects/venv/bin/python",
      "args": ["-m", "ohm_mcp.server"]
    }
  }
}
```

**Usage:**
- Open Cursor Chat (Cmd+L / Ctrl+L)
- Tools are automatically available
- Ask: "Use ohm-mcp to detect dead code"

</details>

<details>
<summary><b>ğŸŸ¢ Cline (VS Code Extension) with Python</b></summary>

First install: `pip install ohm-mcp`

Then add to Cline's MCP settings:
```json
{
  "mcpServers": {
    "ohm-mcp": {
      "command": "python",
      "args": ["-m", "ohm_mcp.server"]
    }
  }
}
```

**Example with virtual environment:**
```json
{
  "mcpServers": {
    "ohm-mcp": {
      "command": "/Users/username/projects/venv/bin/python",
      "args": ["-m", "ohm_mcp.server"]
    }
  }
}
```

**Note:** Cline requires absolute paths for both `command` and `cwd`.

**Usage:**
- Open Cline panel
- Tools are available in agent context
- Ask: "Analyze type coverage and suggest improvements"

</details>

<details>
<summary><b>ğŸ”§ Other MCP-Compatible Clients</b></summary>

Any MCP-compatible client can use this server. General configuration:

```json
{
  "mcpServers": {
    "ohm-mcp": {
      "command": "<python-interpreter-path>",
      "args": ["<path-to-mcp_server.py>"],
      "cwd": "<project-directory>"
    }
  }
}
```

**Finding your Python path:**
```bash
# Unix/Mac
which python
# or
which python3

# Windows
where python
```

</details>

---

## ğŸ¯ Key Tools

<details>
<summary><b>ğŸ—ï¸ Architecture & Design (4 tools)</b></summary>

| Tool | Purpose | Output |
|------|---------|--------|
| `analyze_architecture` | Detect God Objects, SOLID violations | Detailed issue report |
| `suggest_design_patterns` | Recommend patterns (Strategy, Factory, Observer) | Pattern suggestions + examples |
| `analyze_tight_coupling` | Find coupling issues | DI recommendations |
| `suggest_di_refactor` | Generate DI code | Before/after refactor |

</details>

<details>
<summary><b>ğŸ”§ Code Quality & Refactoring (6 tools)</b></summary>

| Tool | Purpose | Key Feature |
|------|---------|-------------|
| `extract_method_ast` | Extract code into function | 100% AST-based accuracy |
| `suggest_extractable_methods` | Find extractable blocks | Cohesion scoring |
| `detect_dead_code` | Find unused code | 5 types of dead code |
| `refactor_imports` | Update imports project-wide | Safe module renaming |
| `rename_symbol` | Rename across codebase | Conflict detection |
| `detect_code_duplicates` | Find DRY violations | Exact + near duplicates |

**Example - Extract Method:**
```python
# Input: Lines 45-60
result = extract_method_ast(code, 45, 60, "calculate_total")

# Output: Refactored code + patch + auto-detected params/returns
```

</details>

<details>
<summary><b>ğŸ“Š Type Safety & Testing (4 tools)</b></summary>

| Tool | Purpose | Benefit |
|------|---------|---------|
| `analyze_type_hints` | Check type coverage | Migration plan |
| `generate_type_stub` | Create .pyi files | Gradual typing |
| `generate_characterization_tests` | Auto-generate tests | Safe refactoring |
| `generate_test_for_function` | Single function tests | Targeted testing |

</details>

<details>
<summary><b>âš¡ Performance & Coverage (2 tools)</b></summary>

| Tool | Purpose | Detects |
|------|---------|---------|
| `analyze_performance` | Find bottlenecks | Nested loops, mutable defaults, O(nÂ²) |
| `prioritize_by_coverage` | Risk-based prioritization | High-risk uncovered code |

</details>

<details>
<summary><b>ğŸ¤– Automated Execution (3 tools)</b></summary>

```mermaid
graph LR
    A[apply_refactoring] --> B{Dry Run?}
    B -->|Yes| C[Show Preview]
    B -->|No| D[Create Backup]
    D --> E[Apply Changes]
    E --> F{Run Tests}
    F -->|Pass| G[Success]
    F -->|Fail| H[Auto Rollback]
    H --> I[rollback_refactoring]
```

**Features:**
- âœ… Automatic backup before changes
- âœ… Test execution validation
- âœ… Auto-rollback on failure
- âœ… Full audit trail (`show_refactoring_history`)

</details>

<details>
<summary><b>ğŸ“ˆ Metrics & Reporting (1 tool)</b></summary>

**`generate_quality_report`** - Comprehensive dashboard in HTML/Markdown/JSON

**Output Preview:**

```
ğŸ“Š Health Score: 85/100 (Good)
ğŸ“ Files: 47 | Lines: 12,450 | Tech Debt: 23 pts

ğŸ“Š Type Coverage: 67%
ğŸ—‘ï¸ Dead Code: 8 imports, 12 variables, 3 functions
âš¡ Performance: 4 nested loops, 2 mutable defaults
ğŸ“‹ Duplication: 3 exact, 5 near-duplicates
```

**Visual Dashboard:**
- ğŸ¨ Circular health gauge
- ğŸ“Š Color-coded metrics (ğŸŸ¢ğŸŸ¡ğŸ”´)
- ğŸ“ˆ Trend tracking ready
- ğŸ”— CI/CD integration (JSON export)

</details>

---

## ğŸ’¡ Common Workflows

### 1ï¸âƒ£ **Safe Refactoring**
```bash
generate_characterization_tests â†’ pytest â†’ extract_method_ast â†’ pytest
```

### 2ï¸âƒ£ **Eliminate Duplication**
```bash
detect_code_duplicates â†’ review suggestions â†’ extract_method_ast
```

### 3ï¸âƒ£ **Type Migration**
```bash
analyze_type_hints â†’ follow migration plan â†’ generate_type_stub
```

### 4ï¸âƒ£ **Performance Optimization**
```bash
analyze_performance â†’ prioritize_by_coverage â†’ apply fixes
```

### 5ï¸âƒ£ **Module Refactoring**
```bash
refactor_imports(old="myapp.old", new="myapp.new") â†’ review patches
```

### 6ï¸âƒ£ **Symbol Renaming**
```bash
rename_symbol(old="calc", new="calculate", preview_only=True) â†’ apply
```

### 7ï¸âƒ£ **Quality Tracking**
```bash
generate_quality_report(format="html") â†’ open dashboard â†’ track trends
```

---

## ğŸ¨ Visual Examples

### Quality Dashboard Preview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” Code Quality Dashboard                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚       â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®     ğŸ“ Overview          â”‚
â”‚       â”‚   85    â”‚     Files: 47            â”‚
â”‚       â”‚  /100   â”‚     Lines: 12,450        â”‚
â”‚       â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯     Tech Debt: 23        â”‚
â”‚     Health Score                            â”‚
â”‚                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š Type Coverage       âš¡ Performance      â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 67%         ğŸ”´ 4 nested loops  â”‚
â”‚  120/180 typed          ğŸŸ¡ 2 mutable args  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ—‘ï¸ Dead Code           ğŸ“‹ Duplication      â”‚
â”‚  8 imports              3 exact            â”‚
â”‚  12 variables           5 near             â”‚
â”‚  3 functions                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Symbol Rename Preview

```diff
# Before
- def calc(x, y):
-     return x + y
- result = calc(5, 3)

# After
+ def calculate_sum(x, y):
+     return x + y
+ result = calculate_sum(5, 3)

âœ… 1 function renamed
âœ… 3 call sites updated
âœ… 0 conflicts detected
```

---

## ğŸ§  Design Principles

| Principle | Implementation |
|-----------|----------------|
| ğŸ§ª **Test-First** | Auto-generate characterization tests before refactoring |
| â†©ï¸ **Reversible** | Every change = backup + rollback capability |
| ğŸ¯ **AST-Driven** | 100% accurate (no regex) |
| ğŸ“Š **Risk-Aware** | Coverage + complexity = prioritization |
| ğŸ›ï¸ **SOLID** | Detect violations + concrete fixes |
| ğŸš« **No Blindness** | Analyze â†’ Plan â†’ Validate |

---

## ğŸ”Œ IDE Compatibility

<table>
<tr>
<td align="center" width="100%">
<b>ğŸ¤– Any MCP Client</b><br>
âœ… Standard Protocol<br>
âœ… Easy Setup<br>
âœ… Works with all MCP-compatible AI assistants
</td>
</tr>
</table>

---


## ğŸ“Š Comparison

| Feature | OHM MCP | Traditional Tools |
|---------|---------|-------------------|
| Accuracy | 100% AST | ~70% Regex |
| Safety | Auto backup/rollback | Manual |
| Testing | Auto-generates | Manual |
| Automation | Full | Suggestions only |
| Dashboard | HTML/JSON/MD | Text logs |
| IDE Support | Copilot/Cursor/Cline | Limited |

---

## ğŸ¯ Use Cases

<table>
<tr>
<td><b>ğŸ‘¨â€ğŸ’» Developers</b><br>â€¢ Refactor legacy code safely<br>â€¢ Find dead code<br>â€¢ Optimize performance</td>
<td><b>ğŸ‘¥ Teams</b><br>â€¢ Track tech debt<br>â€¢ Enforce standards<br>â€¢ Design patterns</td>
<td><b>ğŸš€ CI/CD</b><br>â€¢ Quality gates<br>â€¢ Trend tracking<br>â€¢ Block bad PRs</td>
</tr>
</table>

---

## ğŸ“ˆ Metrics

```
âœ… 13 Advanced Capabilities
âœ… 30+ Static Checks
âœ… 100% AST Accuracy
âœ… Zero Regex Patterns
âœ… Automated Execution
âœ… Beautiful Dashboards
âœ… Universal MCP Compatibility
```

---

## ğŸ› ï¸ Troubleshooting

<details>
<summary><b>MCP Connection Issues</b></summary>

1. **Verify Python path:**
   ```bash
   which python  # Unix/Mac
   where python  # Windows
   ```

2. **Test MCP server directly:**
   ```bash
   python mcp_server.py
   ```

3. **Check logs:**
   - VS Code: Check Output panel
   - Cursor: Check Cursor logs
   - Cline: Check Cline settings panel

4. **Common issues:**
   - âŒ Relative paths in `command` â†’ Use absolute paths
   - âŒ Missing virtual environment â†’ Activate venv first
   - âŒ Wrong `cwd` for Cline â†’ Must be absolute path

</details>

---

## ğŸ¤ Contributing

Run before submitting:
```bash
./static_analyser.sh  # Runs ruff, mypy, pylint, flake8
pytest                 # All tests must pass
```

---

## ğŸ™ Credits

Built with [Model Context Protocol](https://modelcontextprotocol.io) â€¢ Python AST â€¢ Compatible with GitHub Copilot, Cursor IDE, Cline

---

<div align="center">

**Made with â¤ï¸ for better code quality**

â­ **Star this repo** if it helps you write cleaner code!

[Documentation](https://www.ohm-mcp.dev) 

</div>
