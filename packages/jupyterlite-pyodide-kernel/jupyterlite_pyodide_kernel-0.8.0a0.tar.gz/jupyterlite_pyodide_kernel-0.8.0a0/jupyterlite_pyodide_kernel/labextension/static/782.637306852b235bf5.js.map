{"version":3,"file":"782.637306852b235bf5.js?v=637306852b235bf5","sources":["webpack://@jupyterlite/pyodide-kernel-extension/../../node_modules/@jupyterlite/services/lib/contents/drivefs.js","webpack://@jupyterlite/pyodide-kernel-extension/../../node_modules/@jupyterlite/services/lib/contents/emscripten.js"],"sourcesContent":["// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { UUID } from '@lumino/coreutils';\nimport { DIR_MODE, SEEK_CUR, SEEK_END, instanceOfStream } from './emscripten';\nexport const DRIVE_SEPARATOR = ':';\nexport const BLOCK_SIZE = 4096;\nconst encoder = new TextEncoder();\nconst decoder = new TextDecoder('utf-8');\n// Mapping flag -> do we need to overwrite the file upon closing it\nconst flagNeedsWrite = {\n    0 /*O_RDONLY*/: false,\n    1 /*O_WRONLY*/: true,\n    2 /*O_RDWR*/: true,\n    64 /*O_CREAT*/: true,\n    65 /*O_WRONLY|O_CREAT*/: true,\n    66 /*O_RDWR|O_CREAT*/: true,\n    129 /*O_WRONLY|O_EXCL*/: true,\n    193 /*O_WRONLY|O_CREAT|O_EXCL*/: true,\n    514 /*O_RDWR|O_TRUNC*/: true,\n    577 /*O_WRONLY|O_CREAT|O_TRUNC*/: true,\n    578 /*O_CREAT|O_RDWR|O_TRUNC*/: true,\n    705 /*O_WRONLY|O_CREAT|O_EXCL|O_TRUNC*/: true,\n    706 /*O_RDWR|O_CREAT|O_EXCL|O_TRUNC*/: true,\n    1024 /*O_APPEND*/: true,\n    1025 /*O_WRONLY|O_APPEND*/: true,\n    1026 /*O_RDWR|O_APPEND*/: true,\n    1089 /*O_WRONLY|O_CREAT|O_APPEND*/: true,\n    1090 /*O_RDWR|O_CREAT|O_APPEND*/: true,\n    1153 /*O_WRONLY|O_EXCL|O_APPEND*/: true,\n    1154 /*O_RDWR|O_EXCL|O_APPEND*/: true,\n    1217 /*O_WRONLY|O_CREAT|O_EXCL|O_APPEND*/: true,\n    1218 /*O_RDWR|O_CREAT|O_EXCL|O_APPEND*/: true,\n    4096 /*O_RDONLY|O_DSYNC*/: true,\n    4098 /*O_RDWR|O_DSYNC*/: true,\n};\nexport class DriveFSEmscriptenStreamOps {\n    constructor(fs) {\n        this.fs = fs;\n    }\n    open(stream) {\n        var _a;\n        const path = this.fs.realPath(stream.node);\n        if (this.fs.FS.isFile(stream.node.mode)) {\n            try {\n                const file = this.fs.API.get(path);\n                stream.file = file;\n            }\n            catch (e) {\n                // If we're opening a file for writing and the file does not exist, create it! Otherwise, throw the proper error\n                // We need to do this because the current thread is thinking a file exist (isFile returns true)\n                // whilst it was actually deleted in the main thread\n                // if writing\n                const flags = (_a = stream.flags) !== null && _a !== void 0 ? _a : stream.shared.flags;\n                let parsedFlags = typeof flags === 'string' ? parseInt(flags, 10) : flags;\n                parsedFlags &= 0x1fff;\n                let needsWrite = true;\n                if (parsedFlags in flagNeedsWrite) {\n                    needsWrite = flagNeedsWrite[parsedFlags];\n                }\n                if (needsWrite) {\n                    stream.node = this.fs.node_ops.mknod(stream.node.parent, stream.node.name, stream.node.mode, 0);\n                    const file = this.fs.API.get(path);\n                    stream.file = file;\n                }\n                else {\n                    throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES['ENOENT']);\n                }\n            }\n        }\n    }\n    close(stream) {\n        var _a;\n        if (!this.fs.FS.isFile(stream.node.mode) || !stream.file) {\n            return;\n        }\n        const path = this.fs.realPath(stream.node);\n        const flags = (_a = stream.flags) !== null && _a !== void 0 ? _a : stream.shared.flags;\n        let parsedFlags = typeof flags === 'string' ? parseInt(flags, 10) : flags;\n        parsedFlags &= 0x1fff;\n        let needsWrite = true;\n        if (parsedFlags in flagNeedsWrite) {\n            needsWrite = flagNeedsWrite[parsedFlags];\n        }\n        if (needsWrite) {\n            this.fs.API.put(path, stream.file);\n        }\n        stream.file = undefined;\n    }\n    read(stream, buffer, offset, length, position) {\n        if (length <= 0 ||\n            stream.file === undefined ||\n            position >= (stream.file.data.length || 0)) {\n            return 0;\n        }\n        const size = Math.min(stream.file.data.length - position, length);\n        buffer.set(stream.file.data.subarray(position, position + size), offset);\n        return size;\n    }\n    write(stream, buffer, offset, length, position) {\n        var _a;\n        if (length <= 0 || stream.file === undefined) {\n            return 0;\n        }\n        const now = Date.now();\n        stream.node.timestamp = now;\n        stream.node.atime = now;\n        stream.node.mtime = now;\n        stream.node.ctime = now;\n        if (position + length > (((_a = stream.file) === null || _a === void 0 ? void 0 : _a.data.length) || 0)) {\n            const oldData = stream.file.data ? stream.file.data : new Uint8Array();\n            stream.file.data = new Uint8Array(position + length);\n            stream.file.data.set(oldData);\n        }\n        stream.file.data.set(buffer.subarray(offset, offset + length), position);\n        return length;\n    }\n    llseek(stream, offset, whence) {\n        var _a;\n        let position = offset;\n        if (whence === SEEK_CUR) {\n            position += (_a = stream.position) !== null && _a !== void 0 ? _a : stream.shared.position;\n        }\n        else if (whence === SEEK_END) {\n            if (this.fs.FS.isFile(stream.node.mode)) {\n                if (stream.file !== undefined) {\n                    position += stream.file.data.length;\n                }\n                else {\n                    throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM);\n                }\n            }\n        }\n        if (position < 0) {\n            throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EINVAL);\n        }\n        return position;\n    }\n}\nexport class DriveFSEmscriptenNodeOps {\n    constructor(fs) {\n        this.node = (nodeOrStream) => {\n            if (instanceOfStream(nodeOrStream)) {\n                return nodeOrStream.node;\n            }\n            return nodeOrStream;\n        };\n        this.getattr = (value) => {\n            const node = this.node(value);\n            return {\n                ...this.fs.API.getattr(this.fs.realPath(node)),\n                mode: node.mode,\n                ino: node.id,\n            };\n        };\n        this.setattr = (value, attr) => {\n            const node = this.node(value);\n            for (const [key, value] of Object.entries(attr)) {\n                switch (key) {\n                    case 'mode':\n                        node.mode = value;\n                        break;\n                    case 'timestamp':\n                        node.timestamp = value;\n                        break;\n                    case 'atime':\n                        node.atime = value;\n                        break;\n                    case 'mtime':\n                        node.mtime = value;\n                        break;\n                    case 'ctime':\n                        node.ctime = value;\n                        break;\n                    case 'size': {\n                        const size = value;\n                        const path = this.fs.realPath(node);\n                        if (this.fs.FS.isFile(node.mode) && size >= 0) {\n                            let file;\n                            try {\n                                file = this.fs.API.get(path);\n                            }\n                            catch (e) {\n                                // TODO: Should do anything here? Should we create the file?\n                                break;\n                            }\n                            const oldData = file.data ? file.data : new Uint8Array();\n                            if (size !== oldData.length) {\n                                if (size < oldData.length) {\n                                    file.data = file.data.slice(0, size);\n                                }\n                                else {\n                                    file.data = new Uint8Array(size);\n                                    file.data.set(oldData);\n                                }\n                                this.fs.API.put(path, file);\n                            }\n                        }\n                        else {\n                            console.warn('setattr size of', size, 'on', node, 'not yet implemented');\n                        }\n                        break;\n                    }\n                    case 'dontFollow':\n                        // Ignore for now\n                        break;\n                    default:\n                        console.warn('setattr', key, 'of', value, 'on', node, 'not yet implemented');\n                        break;\n                }\n            }\n        };\n        this.lookup = (parent, name) => {\n            const node = this.node(parent);\n            const path = this.fs.PATH.join2(this.fs.realPath(node), name);\n            const result = this.fs.API.lookup(path);\n            if (!result.ok) {\n                throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES['ENOENT']);\n            }\n            return this.fs.createNode(node, name, result.mode, 0);\n        };\n        this.mknod = (parent, name, mode, dev) => {\n            const node = this.node(parent);\n            const path = this.fs.PATH.join2(this.fs.realPath(node), name);\n            this.fs.API.mknod(path, mode);\n            return this.fs.createNode(node, name, mode, dev);\n        };\n        this.rename = (value, newDir, newName) => {\n            const oldNode = this.node(value);\n            const newDirNode = this.node(newDir);\n            this.fs.API.rename(oldNode.parent\n                ? this.fs.PATH.join2(this.fs.realPath(oldNode.parent), oldNode.name)\n                : oldNode.name, this.fs.PATH.join2(this.fs.realPath(newDirNode), newName));\n            // Updating the in-memory node\n            oldNode.name = newName;\n            oldNode.parent = newDirNode;\n        };\n        this.unlink = (parent, name) => {\n            return this.fs.API.rmdir(this.fs.PATH.join2(this.fs.realPath(this.node(parent)), name));\n        };\n        this.rmdir = (parent, name) => {\n            return this.fs.API.rmdir(this.fs.PATH.join2(this.fs.realPath(this.node(parent)), name));\n        };\n        this.readdir = (value) => {\n            return this.fs.API.readdir(this.fs.realPath(this.node(value)));\n        };\n        this.symlink = (parent, newName, oldPath) => {\n            throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES['EPERM']);\n        };\n        this.readlink = (node) => {\n            throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES['EINVAL']);\n        };\n        this.fs = fs;\n    }\n}\n/**\n * ContentsAPI base class\n */\nexport class ContentsAPI {\n    constructor(options) {\n        this._driveName = options.driveName;\n        this._mountpoint = options.mountpoint;\n        this.FS = options.FS;\n        this.ERRNO_CODES = options.ERRNO_CODES;\n    }\n    lookup(path) {\n        return this.request({ method: 'lookup', path: this.normalizePath(path) });\n    }\n    getmode(path) {\n        return this.request({ method: 'getmode', path: this.normalizePath(path) });\n    }\n    mknod(path, mode) {\n        return this.request({\n            method: 'mknod',\n            path: this.normalizePath(path),\n            data: { mode },\n        });\n    }\n    rename(oldPath, newPath) {\n        return this.request({\n            method: 'rename',\n            path: this.normalizePath(oldPath),\n            data: { newPath: this.normalizePath(newPath) },\n        });\n    }\n    readdir(path) {\n        const dirlist = this.request({\n            method: 'readdir',\n            path: this.normalizePath(path),\n        });\n        dirlist.push('.');\n        dirlist.push('..');\n        return dirlist;\n    }\n    rmdir(path) {\n        return this.request({ method: 'rmdir', path: this.normalizePath(path) });\n    }\n    get(path) {\n        const response = this.request({\n            method: 'get',\n            path: this.normalizePath(path),\n        });\n        if (!response) {\n            throw new this.FS.ErrnoError(this.ERRNO_CODES['ENOENT']);\n        }\n        const serializedContent = response.content;\n        const format = response.format;\n        switch (format) {\n            case 'json':\n            case 'text':\n                return {\n                    data: encoder.encode(serializedContent),\n                    format,\n                };\n            case 'base64': {\n                const binString = atob(serializedContent);\n                const len = binString.length;\n                const data = new Uint8Array(len);\n                for (let i = 0; i < len; i++) {\n                    data[i] = binString.charCodeAt(i);\n                }\n                return {\n                    data,\n                    format,\n                };\n            }\n            default:\n                throw new this.FS.ErrnoError(this.ERRNO_CODES['ENOENT']);\n        }\n    }\n    put(path, value) {\n        switch (value.format) {\n            case 'json':\n            case 'text':\n                return this.request({\n                    method: 'put',\n                    path: this.normalizePath(path),\n                    data: {\n                        format: value.format,\n                        data: decoder.decode(value.data),\n                    },\n                });\n            case 'base64': {\n                let binary = '';\n                for (let i = 0; i < value.data.byteLength; i++) {\n                    binary += String.fromCharCode(value.data[i]);\n                }\n                return this.request({\n                    method: 'put',\n                    path: this.normalizePath(path),\n                    data: {\n                        format: value.format,\n                        data: btoa(binary),\n                    },\n                });\n            }\n        }\n    }\n    getattr(path) {\n        const stats = this.request({\n            method: 'getattr',\n            path: this.normalizePath(path),\n        });\n        // Emscripten 4.0.9+ (used by Pyodide 0.28+) requires all three timestamps\n        // to be valid Date objects with .getTime() method (see https://github.com/emscripten-core/emscripten/pull/22998).\n        // Fallback to epoch if any timestamp is missing/null/undefined.\n        const defaultDate = new Date(0);\n        stats.atime = stats.atime ? new Date(stats.atime) : defaultDate;\n        stats.mtime = stats.mtime ? new Date(stats.mtime) : defaultDate;\n        stats.ctime = stats.ctime ? new Date(stats.ctime) : defaultDate;\n        // ensure a non-undefined size (0 isn't great, though)\n        stats.size = stats.size || 0;\n        return stats;\n    }\n    /**\n     * Normalize a Path by making it compliant for the content manager\n     *\n     * @param path: the path relatively to the Emscripten drive\n     */\n    normalizePath(path) {\n        // Remove mountpoint prefix\n        if (path.startsWith(this._mountpoint)) {\n            path = path.slice(this._mountpoint.length);\n        }\n        // Add JupyterLab drive name\n        if (this._driveName) {\n            path = `${this._driveName}${DRIVE_SEPARATOR}${path}`;\n        }\n        return path;\n    }\n}\n/**\n * An Emscripten-compatible synchronous Contents API using the service worker.\n */\nexport class ServiceWorkerContentsAPI extends ContentsAPI {\n    /**\n     * Construct a new ServiceWorkerContentsAPI.\n     */\n    constructor(options) {\n        super(options);\n        this._baseUrl = options.baseUrl;\n        this._browsingContextId = options.browsingContextId || '';\n    }\n    request(data) {\n        const xhr = new XMLHttpRequest();\n        xhr.open('POST', encodeURI(this.endpoint), false);\n        // Generate unique request ID for correlation\n        const requestId = UUID.uuid4();\n        // Add the origin browsing context ID and request ID to the request\n        const requestWithMetadata = {\n            data: { ...data, requestId },\n            browsingContextId: this._browsingContextId,\n            requestId,\n        };\n        try {\n            xhr.send(JSON.stringify(requestWithMetadata));\n        }\n        catch (e) {\n            console.error(e);\n        }\n        if (xhr.status >= 400) {\n            throw new this.FS.ErrnoError(this.ERRNO_CODES['EINVAL']);\n        }\n        return JSON.parse(xhr.responseText);\n    }\n    /**\n     * Get the api/drive endpoint\n     */\n    get endpoint() {\n        return `${this._baseUrl}api/drive`;\n    }\n}\nexport class DriveFS {\n    constructor(options) {\n        this.FS = options.FS;\n        this.PATH = options.PATH;\n        this.ERRNO_CODES = options.ERRNO_CODES;\n        this.API = this.createAPI(options);\n        this.driveName = options.driveName;\n        this.node_ops = new DriveFSEmscriptenNodeOps(this);\n        this.stream_ops = new DriveFSEmscriptenStreamOps(this);\n    }\n    /**\n     * Create the ContentsAPI.\n     *\n     * This is supposed to be overwritten if needed.\n     */\n    createAPI(options) {\n        if (!options.browsingContextId || !options.baseUrl) {\n            throw new Error('Cannot create service-worker API without current browsingContextId');\n        }\n        return new ServiceWorkerContentsAPI(options);\n    }\n    mount(mount) {\n        return this.createNode(null, mount.mountpoint, DIR_MODE | 511, 0);\n    }\n    createNode(parent, name, mode, dev) {\n        const FS = this.FS;\n        if (!FS.isDir(mode) && !FS.isFile(mode)) {\n            throw new FS.ErrnoError(this.ERRNO_CODES['EINVAL']);\n        }\n        const node = FS.createNode(parent, name, mode, dev);\n        node.node_ops = this.node_ops;\n        node.stream_ops = this.stream_ops;\n        return node;\n    }\n    getMode(path) {\n        return this.API.getmode(path);\n    }\n    realPath(node) {\n        const parts = [];\n        let currentNode = node;\n        parts.push(currentNode.name);\n        while (currentNode.parent !== currentNode) {\n            currentNode = currentNode.parent;\n            parts.push(currentNode.name);\n        }\n        parts.reverse();\n        return this.PATH.join.apply(null, parts);\n    }\n}\n//# sourceMappingURL=drivefs.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nexport const DIR_MODE = 16895; // 040777\nexport const FILE_MODE = 33206; // 100666\nexport const SEEK_CUR = 1;\nexport const SEEK_END = 2;\nexport function instanceOfStream(nodeOrStream) {\n    return 'node' in nodeOrStream;\n}\n//# sourceMappingURL=emscripten.js.map"],"names":["TextEncoder","TextDecoder","parseInt","Math","n","Date","Uint8Array","Object","console","s","atob","String","btoa","XMLHttpRequest","encodeURI","JSON","Error"],"mappings":"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"}