[project]
dependencies = [
  "snakemake-interface-common>=1.22.0,<2",
  "snakemake-interface-storage-plugins>=4.3.2,<5",
]
name = "snakemake-storage-plugin-nersc"
description = "Snakemake plugin to interact with the NERSC filesystem"
maintainers = [
    { name = "The LEGEND Collaboration" },
]

requires-python = ">=3.11,<4.0"
version = "0.1.3"

[[project.authors]]
name = "Luigi Pertoldi"
email = "luigi.pertoldi@protonmail.com"

[project.urls]
Repository = "https://github.com/legend-exp/snakemake-storage-plugin-nersc"
Documentation = "https://snakemake.github.io/snakemake-plugin-catalog/plugins/storage/nersc.html"

[build-system]
build-backend = "hatchling.build"
requires = ["hatchling", "hatch-vcs"]

[dependency-groups]
dev = [
  "ruff",
  "coverage",
  "pytest",
  "twine",
  "build",
  "snakemake"
]

[tool.hatch.version]
source = "vcs"

[project.entry-points."snakemake.storage_plugins"]
nersc = "snakemake_storage_plugin_nersc:StorageProvider"

[tool.pixi.workspace]
channels = ["conda-forge", "bioconda"]
platforms = ["linux-64", "osx-arm64"]

[tool.pixi.dependencies]
python = "3.12.*"

[tool.pixi.pypi-dependencies]
snakemake-storage-plugin-nersc = { path = ".", editable = true }

[tool.pixi.environments]
default = { solve-group = "default" }
dev = { features = ["dev"], solve-group = "default" }

[tool.pixi.feature.dev.tasks]
lint = "ruff check --fix --unsafe-fixes"
format = "ruff format"
test = "python -m pytest -vv"
test-coverage = "coverage run -m pytest -vv"
coverage-report = "coverage report"
build = "python -m build"
check-build = { cmd = "python -m twine check dist/*", depends-on = ["build"] }

[tool.ruff]
exclude = ["build", "dist", ".pixi"]
