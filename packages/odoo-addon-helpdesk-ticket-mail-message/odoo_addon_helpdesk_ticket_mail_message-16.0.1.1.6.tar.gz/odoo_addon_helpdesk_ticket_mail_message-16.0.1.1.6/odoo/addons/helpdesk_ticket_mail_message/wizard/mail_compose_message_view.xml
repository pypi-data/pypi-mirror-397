<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <record model="ir.ui.view" id="email_compose_message_helpdesk_wizard_form">
            <field name="name">email.compose.message.helpdesk.wizard.form</field>
            <field name="model">mail.compose.message</field>
            <field name="inherit_id" ref="mail.email_compose_message_wizard_form"/>
            <field name="arch" type="xml">
                <field name="subject" position="after">
                    <field name="mail_message_id" invisible="1"/>
                    <field
                        name="scheduled_date"
                        string="Scheduled Date"
                        attrs="{'invisible':[('composition_mode', '!=', 'mass_mail')]}"
                    />
                    <field
                        name="include_history_in_email"
                        string="Include Message History in Email"
                        attrs="{'invisible':[
                            '|',
                            '|',
                            ('mail_message_id', '!=', False),
                            ('template_id', '=', False),
                            ('composition_mode', '!=', 'mass_mail')
                        ]}"
                    />
                </field>
                <xpath expr="//notebook/page[1]/div/group/field[@name='template_id']" position="replace">
                    <field name="available_mail_template_ids" invisible="1"/>
                    <field name="template_id" options="{'no_create': True}"
                        context="{'default_model': model, 'default_body_html': body, 'default_subject': subject, 'lang': lang}"
                        domain="[('id', 'in', available_mail_template_ids)]"
                    />
                    <field
                        name="lang"
                        string="Template language"
                        attrs="{'invisible': [('template_id', '=', False)]}"
                    />
                    <field name="helpdesk_ticket_tag_ids" widget="many2many_tags" string="Related ticket tags"/>
                </xpath>
                <xpath expr="//notebook/page[1]/div/field[@name='body']" position="replace">
                </xpath>
                <xpath expr="//notebook/page[1]/div/group" position="after">
                    <field name="body" class="oe-bordered-editor" placeholder="Write your message here..." options="{'style-inline': true}" attrs="{'readonly': [('can_edit_body', '=', False)]}" force_save="1"/>
                </xpath>
            </field>
        </record>

        <record id="action_mail_compose_message_wizard" model="ir.actions.act_window">
            <field name="name">Compose Email</field>
            <field name="res_model">mail.compose.message</field>
            <field name="binding_model_id" ref="mail.model_mail_compose_message"/>
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>
    </data>
</odoo>
