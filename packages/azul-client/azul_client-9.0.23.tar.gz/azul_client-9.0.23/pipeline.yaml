trigger: none
pr:
  - main

pool:
  name: AppTest Debian
  demands: Agent.OS -equals Linux

resources:
  repositories:
    - repository: PipelineTemplates
      type: git
      name: CyberLab-Services/pipeline-templates
      ref: refs/heads/main
      trigger: none
    # update container image reference
    - repository: azul-app-azure
      endpoint: AustralianCyberSecurityCentre
      type: github
      name: AustralianCyberSecurityCentre/azul-app-azure
      ref: refs/heads/main
      trigger: none
  pipelines:
    - pipeline: azul-bedrock
      source: ag-github-dev\ag-azul-bedrock-release-dev
      project: Azul
      trigger: true

extends:
  template: v2/stages/test-build-publish.yaml@PipelineTemplates
  parameters:
    is_python: true
    is_python_package: true
    python_integration: true
    is_dev: true
    is_docker: true
    is_deploy: true
    deploy_subdir: azul-dev
