"""
AWS CloudFormation LakeFormation Resources

⚠️  AUTO-GENERATED FILE - DO NOT EDIT MANUALLY ⚠️

This file is automatically generated from the AWS CloudFormation Resource Specification.
Any manual changes will be overwritten when regenerated.

Version Information:
  CloudFormation Spec: 227.0.0
  Generator Version: 1.0.0
  Combined: spec-227.0.0_gen-1.0.0
  Generated: 2025-12-15 17:57:26

To regenerate this file:
    uv run python -m cloudformation_dataclasses.codegen.generator --service LakeFormation
"""

from __future__ import annotations

from dataclasses import dataclass
from typing import Any, ClassVar, Optional, Union

from cloudformation_dataclasses.core.base import CloudFormationResource
from cloudformation_dataclasses.intrinsics.functions import GetAtt, Ref, Sub


@dataclass
class ColumnWildcard:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    excluded_column_names: Optional[Union[list[str], Ref]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.excluded_column_names is not None:
            if hasattr(self.excluded_column_names, 'to_dict'):
                props['ExcludedColumnNames'] = self.excluded_column_names.to_dict()
            elif isinstance(self.excluded_column_names, list):
                props['ExcludedColumnNames'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.excluded_column_names
                ]
            else:
                props['ExcludedColumnNames'] = self.excluded_column_names

        return props


@dataclass
class RowFilter:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    all_rows_wildcard: Optional[Union[dict[str, Any], Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    filter_expression: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.all_rows_wildcard is not None:
            if hasattr(self.all_rows_wildcard, 'to_dict'):
                props['AllRowsWildcard'] = self.all_rows_wildcard.to_dict()
            elif isinstance(self.all_rows_wildcard, list):
                props['AllRowsWildcard'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.all_rows_wildcard
                ]
            else:
                props['AllRowsWildcard'] = self.all_rows_wildcard

        if self.filter_expression is not None:
            if hasattr(self.filter_expression, 'to_dict'):
                props['FilterExpression'] = self.filter_expression.to_dict()
            elif isinstance(self.filter_expression, list):
                props['FilterExpression'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.filter_expression
                ]
            else:
                props['FilterExpression'] = self.filter_expression

        return props


@dataclass
class DataCellsFilter(CloudFormationResource):
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lakef"""

    resource_type: ClassVar[str] = "AWS::LakeFormation::DataCellsFilter"

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    table_name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    column_names: Optional[Union[list[str], Ref]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    row_filter: Optional[RowFilter] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    database_name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    table_catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    column_wildcard: Optional[ColumnWildcard] = None

    def _get_properties(self) -> dict[str, Any]:
        """Serialize resource properties to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.table_name is not None:
            # Serialize table_name (handle intrinsic functions)
            if hasattr(self.table_name, 'to_dict'):
                props["TableName"] = self.table_name.to_dict()
            elif isinstance(self.table_name, list):
                # Serialize list items (may contain intrinsic functions)
                props['TableName'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table_name
                ]
            else:
                props["TableName"] = self.table_name

        if self.column_names is not None:
            # Serialize column_names (handle intrinsic functions)
            if hasattr(self.column_names, 'to_dict'):
                props["ColumnNames"] = self.column_names.to_dict()
            elif isinstance(self.column_names, list):
                # Serialize list items (may contain intrinsic functions)
                props['ColumnNames'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.column_names
                ]
            else:
                props["ColumnNames"] = self.column_names

        if self.row_filter is not None:
            # Serialize row_filter (handle intrinsic functions)
            if hasattr(self.row_filter, 'to_dict'):
                props["RowFilter"] = self.row_filter.to_dict()
            elif isinstance(self.row_filter, list):
                # Serialize list items (may contain intrinsic functions)
                props['RowFilter'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.row_filter
                ]
            else:
                props["RowFilter"] = self.row_filter

        if self.database_name is not None:
            # Serialize database_name (handle intrinsic functions)
            if hasattr(self.database_name, 'to_dict'):
                props["DatabaseName"] = self.database_name.to_dict()
            elif isinstance(self.database_name, list):
                # Serialize list items (may contain intrinsic functions)
                props['DatabaseName'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.database_name
                ]
            else:
                props["DatabaseName"] = self.database_name

        if self.table_catalog_id is not None:
            # Serialize table_catalog_id (handle intrinsic functions)
            if hasattr(self.table_catalog_id, 'to_dict'):
                props["TableCatalogId"] = self.table_catalog_id.to_dict()
            elif isinstance(self.table_catalog_id, list):
                # Serialize list items (may contain intrinsic functions)
                props['TableCatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table_catalog_id
                ]
            else:
                props["TableCatalogId"] = self.table_catalog_id

        if self.name is not None:
            # Serialize name (handle intrinsic functions)
            if hasattr(self.name, 'to_dict'):
                props["Name"] = self.name.to_dict()
            elif isinstance(self.name, list):
                # Serialize list items (may contain intrinsic functions)
                props['Name'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.name
                ]
            else:
                props["Name"] = self.name

        if self.column_wildcard is not None:
            # Serialize column_wildcard (handle intrinsic functions)
            if hasattr(self.column_wildcard, 'to_dict'):
                props["ColumnWildcard"] = self.column_wildcard.to_dict()
            elif isinstance(self.column_wildcard, list):
                # Serialize list items (may contain intrinsic functions)
                props['ColumnWildcard'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.column_wildcard
                ]
            else:
                props["ColumnWildcard"] = self.column_wildcard

        return props



@dataclass
class Admins:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    pass


@dataclass
class CreateDatabaseDefaultPermissions:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    pass


@dataclass
class CreateTableDefaultPermissions:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    pass


@dataclass
class DataLakePrincipal:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    data_lake_principal_identifier: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.data_lake_principal_identifier is not None:
            if hasattr(self.data_lake_principal_identifier, 'to_dict'):
                props['DataLakePrincipalIdentifier'] = self.data_lake_principal_identifier.to_dict()
            elif isinstance(self.data_lake_principal_identifier, list):
                props['DataLakePrincipalIdentifier'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.data_lake_principal_identifier
                ]
            else:
                props['DataLakePrincipalIdentifier'] = self.data_lake_principal_identifier

        return props


@dataclass
class ExternalDataFilteringAllowList:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    pass


@dataclass
class PrincipalPermissions:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    permissions: Optional[Union[list[str], Ref]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    principal: Optional[DataLakePrincipal] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.permissions is not None:
            if hasattr(self.permissions, 'to_dict'):
                props['Permissions'] = self.permissions.to_dict()
            elif isinstance(self.permissions, list):
                props['Permissions'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.permissions
                ]
            else:
                props['Permissions'] = self.permissions

        if self.principal is not None:
            if hasattr(self.principal, 'to_dict'):
                props['Principal'] = self.principal.to_dict()
            elif isinstance(self.principal, list):
                props['Principal'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.principal
                ]
            else:
                props['Principal'] = self.principal

        return props


@dataclass
class ReadOnlyAdmins:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    pass


@dataclass
class DataLakeSettings(CloudFormationResource):
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lakef"""

    resource_type: ClassVar[str] = "AWS::LakeFormation::DataLakeSettings"

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    allow_external_data_filtering: Optional[Union[bool, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    external_data_filtering_allow_list: Optional[ExternalDataFilteringAllowList] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    create_table_default_permissions: Optional[CreateTableDefaultPermissions] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    mutation_type: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    parameters: Optional[Union[dict[str, Any], Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    read_only_admins: Optional[ReadOnlyAdmins] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    allow_full_table_external_data_access: Optional[Union[bool, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    admins: Optional[Admins] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    create_database_default_permissions: Optional[CreateDatabaseDefaultPermissions] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    authorized_session_tag_value_list: Optional[Union[list[str], Ref]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    trusted_resource_owners: Optional[Union[list[str], Ref]] = None

    def _get_properties(self) -> dict[str, Any]:
        """Serialize resource properties to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.allow_external_data_filtering is not None:
            # Serialize allow_external_data_filtering (handle intrinsic functions)
            if hasattr(self.allow_external_data_filtering, 'to_dict'):
                props["AllowExternalDataFiltering"] = self.allow_external_data_filtering.to_dict()
            elif isinstance(self.allow_external_data_filtering, list):
                # Serialize list items (may contain intrinsic functions)
                props['AllowExternalDataFiltering'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.allow_external_data_filtering
                ]
            else:
                props["AllowExternalDataFiltering"] = self.allow_external_data_filtering

        if self.external_data_filtering_allow_list is not None:
            # Serialize external_data_filtering_allow_list (handle intrinsic functions)
            if hasattr(self.external_data_filtering_allow_list, 'to_dict'):
                props["ExternalDataFilteringAllowList"] = self.external_data_filtering_allow_list.to_dict()
            elif isinstance(self.external_data_filtering_allow_list, list):
                # Serialize list items (may contain intrinsic functions)
                props['ExternalDataFilteringAllowList'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.external_data_filtering_allow_list
                ]
            else:
                props["ExternalDataFilteringAllowList"] = self.external_data_filtering_allow_list

        if self.create_table_default_permissions is not None:
            # Serialize create_table_default_permissions (handle intrinsic functions)
            if hasattr(self.create_table_default_permissions, 'to_dict'):
                props["CreateTableDefaultPermissions"] = self.create_table_default_permissions.to_dict()
            elif isinstance(self.create_table_default_permissions, list):
                # Serialize list items (may contain intrinsic functions)
                props['CreateTableDefaultPermissions'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.create_table_default_permissions
                ]
            else:
                props["CreateTableDefaultPermissions"] = self.create_table_default_permissions

        if self.mutation_type is not None:
            # Serialize mutation_type (handle intrinsic functions)
            if hasattr(self.mutation_type, 'to_dict'):
                props["MutationType"] = self.mutation_type.to_dict()
            elif isinstance(self.mutation_type, list):
                # Serialize list items (may contain intrinsic functions)
                props['MutationType'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.mutation_type
                ]
            else:
                props["MutationType"] = self.mutation_type

        if self.parameters is not None:
            # Serialize parameters (handle intrinsic functions)
            if hasattr(self.parameters, 'to_dict'):
                props["Parameters"] = self.parameters.to_dict()
            elif isinstance(self.parameters, list):
                # Serialize list items (may contain intrinsic functions)
                props['Parameters'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.parameters
                ]
            else:
                props["Parameters"] = self.parameters

        if self.read_only_admins is not None:
            # Serialize read_only_admins (handle intrinsic functions)
            if hasattr(self.read_only_admins, 'to_dict'):
                props["ReadOnlyAdmins"] = self.read_only_admins.to_dict()
            elif isinstance(self.read_only_admins, list):
                # Serialize list items (may contain intrinsic functions)
                props['ReadOnlyAdmins'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.read_only_admins
                ]
            else:
                props["ReadOnlyAdmins"] = self.read_only_admins

        if self.allow_full_table_external_data_access is not None:
            # Serialize allow_full_table_external_data_access (handle intrinsic functions)
            if hasattr(self.allow_full_table_external_data_access, 'to_dict'):
                props["AllowFullTableExternalDataAccess"] = self.allow_full_table_external_data_access.to_dict()
            elif isinstance(self.allow_full_table_external_data_access, list):
                # Serialize list items (may contain intrinsic functions)
                props['AllowFullTableExternalDataAccess'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.allow_full_table_external_data_access
                ]
            else:
                props["AllowFullTableExternalDataAccess"] = self.allow_full_table_external_data_access

        if self.admins is not None:
            # Serialize admins (handle intrinsic functions)
            if hasattr(self.admins, 'to_dict'):
                props["Admins"] = self.admins.to_dict()
            elif isinstance(self.admins, list):
                # Serialize list items (may contain intrinsic functions)
                props['Admins'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.admins
                ]
            else:
                props["Admins"] = self.admins

        if self.create_database_default_permissions is not None:
            # Serialize create_database_default_permissions (handle intrinsic functions)
            if hasattr(self.create_database_default_permissions, 'to_dict'):
                props["CreateDatabaseDefaultPermissions"] = self.create_database_default_permissions.to_dict()
            elif isinstance(self.create_database_default_permissions, list):
                # Serialize list items (may contain intrinsic functions)
                props['CreateDatabaseDefaultPermissions'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.create_database_default_permissions
                ]
            else:
                props["CreateDatabaseDefaultPermissions"] = self.create_database_default_permissions

        if self.authorized_session_tag_value_list is not None:
            # Serialize authorized_session_tag_value_list (handle intrinsic functions)
            if hasattr(self.authorized_session_tag_value_list, 'to_dict'):
                props["AuthorizedSessionTagValueList"] = self.authorized_session_tag_value_list.to_dict()
            elif isinstance(self.authorized_session_tag_value_list, list):
                # Serialize list items (may contain intrinsic functions)
                props['AuthorizedSessionTagValueList'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.authorized_session_tag_value_list
                ]
            else:
                props["AuthorizedSessionTagValueList"] = self.authorized_session_tag_value_list

        if self.trusted_resource_owners is not None:
            # Serialize trusted_resource_owners (handle intrinsic functions)
            if hasattr(self.trusted_resource_owners, 'to_dict'):
                props["TrustedResourceOwners"] = self.trusted_resource_owners.to_dict()
            elif isinstance(self.trusted_resource_owners, list):
                # Serialize list items (may contain intrinsic functions)
                props['TrustedResourceOwners'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.trusted_resource_owners
                ]
            else:
                props["TrustedResourceOwners"] = self.trusted_resource_owners

        return props



@dataclass
class ColumnWildcard:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    excluded_column_names: Optional[Union[list[str], Ref]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.excluded_column_names is not None:
            if hasattr(self.excluded_column_names, 'to_dict'):
                props['ExcludedColumnNames'] = self.excluded_column_names.to_dict()
            elif isinstance(self.excluded_column_names, list):
                props['ExcludedColumnNames'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.excluded_column_names
                ]
            else:
                props['ExcludedColumnNames'] = self.excluded_column_names

        return props


@dataclass
class DataLakePrincipal:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    data_lake_principal_identifier: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.data_lake_principal_identifier is not None:
            if hasattr(self.data_lake_principal_identifier, 'to_dict'):
                props['DataLakePrincipalIdentifier'] = self.data_lake_principal_identifier.to_dict()
            elif isinstance(self.data_lake_principal_identifier, list):
                props['DataLakePrincipalIdentifier'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.data_lake_principal_identifier
                ]
            else:
                props['DataLakePrincipalIdentifier'] = self.data_lake_principal_identifier

        return props


@dataclass
class DataLocationResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    s3_resource: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.s3_resource is not None:
            if hasattr(self.s3_resource, 'to_dict'):
                props['S3Resource'] = self.s3_resource.to_dict()
            elif isinstance(self.s3_resource, list):
                props['S3Resource'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.s3_resource
                ]
            else:
                props['S3Resource'] = self.s3_resource

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        return props


@dataclass
class DatabaseResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    name: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        if self.name is not None:
            if hasattr(self.name, 'to_dict'):
                props['Name'] = self.name.to_dict()
            elif isinstance(self.name, list):
                props['Name'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.name
                ]
            else:
                props['Name'] = self.name

        return props


@dataclass
class Resource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    table_resource: Optional[TableResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    database_resource: Optional[DatabaseResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    data_location_resource: Optional[DataLocationResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    table_with_columns_resource: Optional[TableWithColumnsResource] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.table_resource is not None:
            if hasattr(self.table_resource, 'to_dict'):
                props['TableResource'] = self.table_resource.to_dict()
            elif isinstance(self.table_resource, list):
                props['TableResource'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table_resource
                ]
            else:
                props['TableResource'] = self.table_resource

        if self.database_resource is not None:
            if hasattr(self.database_resource, 'to_dict'):
                props['DatabaseResource'] = self.database_resource.to_dict()
            elif isinstance(self.database_resource, list):
                props['DatabaseResource'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.database_resource
                ]
            else:
                props['DatabaseResource'] = self.database_resource

        if self.data_location_resource is not None:
            if hasattr(self.data_location_resource, 'to_dict'):
                props['DataLocationResource'] = self.data_location_resource.to_dict()
            elif isinstance(self.data_location_resource, list):
                props['DataLocationResource'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.data_location_resource
                ]
            else:
                props['DataLocationResource'] = self.data_location_resource

        if self.table_with_columns_resource is not None:
            if hasattr(self.table_with_columns_resource, 'to_dict'):
                props['TableWithColumnsResource'] = self.table_with_columns_resource.to_dict()
            elif isinstance(self.table_with_columns_resource, list):
                props['TableWithColumnsResource'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table_with_columns_resource
                ]
            else:
                props['TableWithColumnsResource'] = self.table_with_columns_resource

        return props


@dataclass
class TableResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    database_name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    table_wildcard: Optional[TableWildcard] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    name: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.database_name is not None:
            if hasattr(self.database_name, 'to_dict'):
                props['DatabaseName'] = self.database_name.to_dict()
            elif isinstance(self.database_name, list):
                props['DatabaseName'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.database_name
                ]
            else:
                props['DatabaseName'] = self.database_name

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        if self.table_wildcard is not None:
            if hasattr(self.table_wildcard, 'to_dict'):
                props['TableWildcard'] = self.table_wildcard.to_dict()
            elif isinstance(self.table_wildcard, list):
                props['TableWildcard'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table_wildcard
                ]
            else:
                props['TableWildcard'] = self.table_wildcard

        if self.name is not None:
            if hasattr(self.name, 'to_dict'):
                props['Name'] = self.name.to_dict()
            elif isinstance(self.name, list):
                props['Name'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.name
                ]
            else:
                props['Name'] = self.name

        return props


@dataclass
class TableWildcard:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    pass


@dataclass
class TableWithColumnsResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    column_names: Optional[Union[list[str], Ref]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    database_name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    column_wildcard: Optional[ColumnWildcard] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.column_names is not None:
            if hasattr(self.column_names, 'to_dict'):
                props['ColumnNames'] = self.column_names.to_dict()
            elif isinstance(self.column_names, list):
                props['ColumnNames'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.column_names
                ]
            else:
                props['ColumnNames'] = self.column_names

        if self.database_name is not None:
            if hasattr(self.database_name, 'to_dict'):
                props['DatabaseName'] = self.database_name.to_dict()
            elif isinstance(self.database_name, list):
                props['DatabaseName'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.database_name
                ]
            else:
                props['DatabaseName'] = self.database_name

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        if self.name is not None:
            if hasattr(self.name, 'to_dict'):
                props['Name'] = self.name.to_dict()
            elif isinstance(self.name, list):
                props['Name'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.name
                ]
            else:
                props['Name'] = self.name

        if self.column_wildcard is not None:
            if hasattr(self.column_wildcard, 'to_dict'):
                props['ColumnWildcard'] = self.column_wildcard.to_dict()
            elif isinstance(self.column_wildcard, list):
                props['ColumnWildcard'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.column_wildcard
                ]
            else:
                props['ColumnWildcard'] = self.column_wildcard

        return props


@dataclass
class Permissions(CloudFormationResource):
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lakef"""

    resource_type: ClassVar[str] = "AWS::LakeFormation::Permissions"

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    data_lake_principal: Optional[DataLakePrincipal] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    resource: Optional[Resource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    permissions: Optional[Union[list[str], Ref]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    permissions_with_grant_option: Optional[Union[list[str], Ref]] = None

    def _get_properties(self) -> dict[str, Any]:
        """Serialize resource properties to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.data_lake_principal is not None:
            # Serialize data_lake_principal (handle intrinsic functions)
            if hasattr(self.data_lake_principal, 'to_dict'):
                props["DataLakePrincipal"] = self.data_lake_principal.to_dict()
            elif isinstance(self.data_lake_principal, list):
                # Serialize list items (may contain intrinsic functions)
                props['DataLakePrincipal'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.data_lake_principal
                ]
            else:
                props["DataLakePrincipal"] = self.data_lake_principal

        if self.resource is not None:
            # Serialize resource (handle intrinsic functions)
            if hasattr(self.resource, 'to_dict'):
                props["Resource"] = self.resource.to_dict()
            elif isinstance(self.resource, list):
                # Serialize list items (may contain intrinsic functions)
                props['Resource'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.resource
                ]
            else:
                props["Resource"] = self.resource

        if self.permissions is not None:
            # Serialize permissions (handle intrinsic functions)
            if hasattr(self.permissions, 'to_dict'):
                props["Permissions"] = self.permissions.to_dict()
            elif isinstance(self.permissions, list):
                # Serialize list items (may contain intrinsic functions)
                props['Permissions'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.permissions
                ]
            else:
                props["Permissions"] = self.permissions

        if self.permissions_with_grant_option is not None:
            # Serialize permissions_with_grant_option (handle intrinsic functions)
            if hasattr(self.permissions_with_grant_option, 'to_dict'):
                props["PermissionsWithGrantOption"] = self.permissions_with_grant_option.to_dict()
            elif isinstance(self.permissions_with_grant_option, list):
                # Serialize list items (may contain intrinsic functions)
                props['PermissionsWithGrantOption'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.permissions_with_grant_option
                ]
            else:
                props["PermissionsWithGrantOption"] = self.permissions_with_grant_option

        return props



@dataclass
class ColumnWildcard:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    excluded_column_names: Optional[Union[list[str], Ref]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.excluded_column_names is not None:
            if hasattr(self.excluded_column_names, 'to_dict'):
                props['ExcludedColumnNames'] = self.excluded_column_names.to_dict()
            elif isinstance(self.excluded_column_names, list):
                props['ExcludedColumnNames'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.excluded_column_names
                ]
            else:
                props['ExcludedColumnNames'] = self.excluded_column_names

        return props


@dataclass
class DataCellsFilterResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    table_name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    database_name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    table_catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    name: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.table_name is not None:
            if hasattr(self.table_name, 'to_dict'):
                props['TableName'] = self.table_name.to_dict()
            elif isinstance(self.table_name, list):
                props['TableName'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table_name
                ]
            else:
                props['TableName'] = self.table_name

        if self.database_name is not None:
            if hasattr(self.database_name, 'to_dict'):
                props['DatabaseName'] = self.database_name.to_dict()
            elif isinstance(self.database_name, list):
                props['DatabaseName'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.database_name
                ]
            else:
                props['DatabaseName'] = self.database_name

        if self.table_catalog_id is not None:
            if hasattr(self.table_catalog_id, 'to_dict'):
                props['TableCatalogId'] = self.table_catalog_id.to_dict()
            elif isinstance(self.table_catalog_id, list):
                props['TableCatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table_catalog_id
                ]
            else:
                props['TableCatalogId'] = self.table_catalog_id

        if self.name is not None:
            if hasattr(self.name, 'to_dict'):
                props['Name'] = self.name.to_dict()
            elif isinstance(self.name, list):
                props['Name'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.name
                ]
            else:
                props['Name'] = self.name

        return props


@dataclass
class DataLakePrincipal:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    data_lake_principal_identifier: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.data_lake_principal_identifier is not None:
            if hasattr(self.data_lake_principal_identifier, 'to_dict'):
                props['DataLakePrincipalIdentifier'] = self.data_lake_principal_identifier.to_dict()
            elif isinstance(self.data_lake_principal_identifier, list):
                props['DataLakePrincipalIdentifier'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.data_lake_principal_identifier
                ]
            else:
                props['DataLakePrincipalIdentifier'] = self.data_lake_principal_identifier

        return props


@dataclass
class DataLocationResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    resource_arn: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.resource_arn is not None:
            if hasattr(self.resource_arn, 'to_dict'):
                props['ResourceArn'] = self.resource_arn.to_dict()
            elif isinstance(self.resource_arn, list):
                props['ResourceArn'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.resource_arn
                ]
            else:
                props['ResourceArn'] = self.resource_arn

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        return props


@dataclass
class DatabaseResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    name: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        if self.name is not None:
            if hasattr(self.name, 'to_dict'):
                props['Name'] = self.name.to_dict()
            elif isinstance(self.name, list):
                props['Name'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.name
                ]
            else:
                props['Name'] = self.name

        return props


@dataclass
class LFTag:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    tag_key: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    tag_values: Optional[Union[list[str], Ref]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.tag_key is not None:
            if hasattr(self.tag_key, 'to_dict'):
                props['TagKey'] = self.tag_key.to_dict()
            elif isinstance(self.tag_key, list):
                props['TagKey'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.tag_key
                ]
            else:
                props['TagKey'] = self.tag_key

        if self.tag_values is not None:
            if hasattr(self.tag_values, 'to_dict'):
                props['TagValues'] = self.tag_values.to_dict()
            elif isinstance(self.tag_values, list):
                props['TagValues'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.tag_values
                ]
            else:
                props['TagValues'] = self.tag_values

        return props


@dataclass
class LFTagKeyResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    tag_key: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    tag_values: Optional[Union[list[str], Ref]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.tag_key is not None:
            if hasattr(self.tag_key, 'to_dict'):
                props['TagKey'] = self.tag_key.to_dict()
            elif isinstance(self.tag_key, list):
                props['TagKey'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.tag_key
                ]
            else:
                props['TagKey'] = self.tag_key

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        if self.tag_values is not None:
            if hasattr(self.tag_values, 'to_dict'):
                props['TagValues'] = self.tag_values.to_dict()
            elif isinstance(self.tag_values, list):
                props['TagValues'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.tag_values
                ]
            else:
                props['TagValues'] = self.tag_values

        return props


@dataclass
class LFTagPolicyResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    expression: Optional[list[LFTag]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    resource_type: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.expression is not None:
            if hasattr(self.expression, 'to_dict'):
                props['Expression'] = self.expression.to_dict()
            elif isinstance(self.expression, list):
                props['Expression'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.expression
                ]
            else:
                props['Expression'] = self.expression

        if self.resource_type is not None:
            if hasattr(self.resource_type, 'to_dict'):
                props['ResourceType'] = self.resource_type.to_dict()
            elif isinstance(self.resource_type, list):
                props['ResourceType'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.resource_type
                ]
            else:
                props['ResourceType'] = self.resource_type

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        return props


@dataclass
class Resource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    lf_tag: Optional[LFTagKeyResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    table: Optional[TableResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    data_cells_filter: Optional[DataCellsFilterResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    table_with_columns: Optional[TableWithColumnsResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    lf_tag_policy: Optional[LFTagPolicyResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    database: Optional[DatabaseResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    data_location: Optional[DataLocationResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog: Optional[Union[dict[str, Any], Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.lf_tag is not None:
            if hasattr(self.lf_tag, 'to_dict'):
                props['LFTag'] = self.lf_tag.to_dict()
            elif isinstance(self.lf_tag, list):
                props['LFTag'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.lf_tag
                ]
            else:
                props['LFTag'] = self.lf_tag

        if self.table is not None:
            if hasattr(self.table, 'to_dict'):
                props['Table'] = self.table.to_dict()
            elif isinstance(self.table, list):
                props['Table'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table
                ]
            else:
                props['Table'] = self.table

        if self.data_cells_filter is not None:
            if hasattr(self.data_cells_filter, 'to_dict'):
                props['DataCellsFilter'] = self.data_cells_filter.to_dict()
            elif isinstance(self.data_cells_filter, list):
                props['DataCellsFilter'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.data_cells_filter
                ]
            else:
                props['DataCellsFilter'] = self.data_cells_filter

        if self.table_with_columns is not None:
            if hasattr(self.table_with_columns, 'to_dict'):
                props['TableWithColumns'] = self.table_with_columns.to_dict()
            elif isinstance(self.table_with_columns, list):
                props['TableWithColumns'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table_with_columns
                ]
            else:
                props['TableWithColumns'] = self.table_with_columns

        if self.lf_tag_policy is not None:
            if hasattr(self.lf_tag_policy, 'to_dict'):
                props['LFTagPolicy'] = self.lf_tag_policy.to_dict()
            elif isinstance(self.lf_tag_policy, list):
                props['LFTagPolicy'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.lf_tag_policy
                ]
            else:
                props['LFTagPolicy'] = self.lf_tag_policy

        if self.database is not None:
            if hasattr(self.database, 'to_dict'):
                props['Database'] = self.database.to_dict()
            elif isinstance(self.database, list):
                props['Database'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.database
                ]
            else:
                props['Database'] = self.database

        if self.data_location is not None:
            if hasattr(self.data_location, 'to_dict'):
                props['DataLocation'] = self.data_location.to_dict()
            elif isinstance(self.data_location, list):
                props['DataLocation'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.data_location
                ]
            else:
                props['DataLocation'] = self.data_location

        if self.catalog is not None:
            if hasattr(self.catalog, 'to_dict'):
                props['Catalog'] = self.catalog.to_dict()
            elif isinstance(self.catalog, list):
                props['Catalog'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog
                ]
            else:
                props['Catalog'] = self.catalog

        return props


@dataclass
class TableResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    database_name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    table_wildcard: Optional[Union[dict[str, Any], Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    name: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.database_name is not None:
            if hasattr(self.database_name, 'to_dict'):
                props['DatabaseName'] = self.database_name.to_dict()
            elif isinstance(self.database_name, list):
                props['DatabaseName'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.database_name
                ]
            else:
                props['DatabaseName'] = self.database_name

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        if self.table_wildcard is not None:
            if hasattr(self.table_wildcard, 'to_dict'):
                props['TableWildcard'] = self.table_wildcard.to_dict()
            elif isinstance(self.table_wildcard, list):
                props['TableWildcard'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table_wildcard
                ]
            else:
                props['TableWildcard'] = self.table_wildcard

        if self.name is not None:
            if hasattr(self.name, 'to_dict'):
                props['Name'] = self.name.to_dict()
            elif isinstance(self.name, list):
                props['Name'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.name
                ]
            else:
                props['Name'] = self.name

        return props


@dataclass
class TableWithColumnsResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    column_names: Optional[Union[list[str], Ref]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    database_name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    column_wildcard: Optional[ColumnWildcard] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.column_names is not None:
            if hasattr(self.column_names, 'to_dict'):
                props['ColumnNames'] = self.column_names.to_dict()
            elif isinstance(self.column_names, list):
                props['ColumnNames'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.column_names
                ]
            else:
                props['ColumnNames'] = self.column_names

        if self.database_name is not None:
            if hasattr(self.database_name, 'to_dict'):
                props['DatabaseName'] = self.database_name.to_dict()
            elif isinstance(self.database_name, list):
                props['DatabaseName'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.database_name
                ]
            else:
                props['DatabaseName'] = self.database_name

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        if self.name is not None:
            if hasattr(self.name, 'to_dict'):
                props['Name'] = self.name.to_dict()
            elif isinstance(self.name, list):
                props['Name'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.name
                ]
            else:
                props['Name'] = self.name

        if self.column_wildcard is not None:
            if hasattr(self.column_wildcard, 'to_dict'):
                props['ColumnWildcard'] = self.column_wildcard.to_dict()
            elif isinstance(self.column_wildcard, list):
                props['ColumnWildcard'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.column_wildcard
                ]
            else:
                props['ColumnWildcard'] = self.column_wildcard

        return props


@dataclass
class PrincipalPermissions(CloudFormationResource):
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lakef"""

    resource_type: ClassVar[str] = "AWS::LakeFormation::PrincipalPermissions"

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    resource: Optional[Resource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    permissions: Optional[Union[list[str], Ref]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    catalog: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    principal: Optional[DataLakePrincipal] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    permissions_with_grant_option: Optional[Union[list[str], Ref]] = None

    def _get_properties(self) -> dict[str, Any]:
        """Serialize resource properties to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.resource is not None:
            # Serialize resource (handle intrinsic functions)
            if hasattr(self.resource, 'to_dict'):
                props["Resource"] = self.resource.to_dict()
            elif isinstance(self.resource, list):
                # Serialize list items (may contain intrinsic functions)
                props['Resource'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.resource
                ]
            else:
                props["Resource"] = self.resource

        if self.permissions is not None:
            # Serialize permissions (handle intrinsic functions)
            if hasattr(self.permissions, 'to_dict'):
                props["Permissions"] = self.permissions.to_dict()
            elif isinstance(self.permissions, list):
                # Serialize list items (may contain intrinsic functions)
                props['Permissions'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.permissions
                ]
            else:
                props["Permissions"] = self.permissions

        if self.catalog is not None:
            # Serialize catalog (handle intrinsic functions)
            if hasattr(self.catalog, 'to_dict'):
                props["Catalog"] = self.catalog.to_dict()
            elif isinstance(self.catalog, list):
                # Serialize list items (may contain intrinsic functions)
                props['Catalog'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog
                ]
            else:
                props["Catalog"] = self.catalog

        if self.principal is not None:
            # Serialize principal (handle intrinsic functions)
            if hasattr(self.principal, 'to_dict'):
                props["Principal"] = self.principal.to_dict()
            elif isinstance(self.principal, list):
                # Serialize list items (may contain intrinsic functions)
                props['Principal'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.principal
                ]
            else:
                props["Principal"] = self.principal

        if self.permissions_with_grant_option is not None:
            # Serialize permissions_with_grant_option (handle intrinsic functions)
            if hasattr(self.permissions_with_grant_option, 'to_dict'):
                props["PermissionsWithGrantOption"] = self.permissions_with_grant_option.to_dict()
            elif isinstance(self.permissions_with_grant_option, list):
                # Serialize list items (may contain intrinsic functions)
                props['PermissionsWithGrantOption'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.permissions_with_grant_option
                ]
            else:
                props["PermissionsWithGrantOption"] = self.permissions_with_grant_option

        return props

    @property
    def attr_resource_identifier(self) -> GetAtt:
        """Get the ResourceIdentifier attribute."""
        return self.get_att("ResourceIdentifier")

    @property
    def attr_principal_identifier(self) -> GetAtt:
        """Get the PrincipalIdentifier attribute."""
        return self.get_att("PrincipalIdentifier")




@dataclass
class Resource(CloudFormationResource):
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lakef"""

    resource_type: ClassVar[str] = "AWS::LakeFormation::Resource"

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    resource_arn: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    with_federation: Optional[Union[bool, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    use_service_linked_role: Optional[Union[bool, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    hybrid_access_enabled: Optional[Union[bool, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    role_arn: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def _get_properties(self) -> dict[str, Any]:
        """Serialize resource properties to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.resource_arn is not None:
            # Serialize resource_arn (handle intrinsic functions)
            if hasattr(self.resource_arn, 'to_dict'):
                props["ResourceArn"] = self.resource_arn.to_dict()
            elif isinstance(self.resource_arn, list):
                # Serialize list items (may contain intrinsic functions)
                props['ResourceArn'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.resource_arn
                ]
            else:
                props["ResourceArn"] = self.resource_arn

        if self.with_federation is not None:
            # Serialize with_federation (handle intrinsic functions)
            if hasattr(self.with_federation, 'to_dict'):
                props["WithFederation"] = self.with_federation.to_dict()
            elif isinstance(self.with_federation, list):
                # Serialize list items (may contain intrinsic functions)
                props['WithFederation'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.with_federation
                ]
            else:
                props["WithFederation"] = self.with_federation

        if self.use_service_linked_role is not None:
            # Serialize use_service_linked_role (handle intrinsic functions)
            if hasattr(self.use_service_linked_role, 'to_dict'):
                props["UseServiceLinkedRole"] = self.use_service_linked_role.to_dict()
            elif isinstance(self.use_service_linked_role, list):
                # Serialize list items (may contain intrinsic functions)
                props['UseServiceLinkedRole'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.use_service_linked_role
                ]
            else:
                props["UseServiceLinkedRole"] = self.use_service_linked_role

        if self.hybrid_access_enabled is not None:
            # Serialize hybrid_access_enabled (handle intrinsic functions)
            if hasattr(self.hybrid_access_enabled, 'to_dict'):
                props["HybridAccessEnabled"] = self.hybrid_access_enabled.to_dict()
            elif isinstance(self.hybrid_access_enabled, list):
                # Serialize list items (may contain intrinsic functions)
                props['HybridAccessEnabled'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.hybrid_access_enabled
                ]
            else:
                props["HybridAccessEnabled"] = self.hybrid_access_enabled

        if self.role_arn is not None:
            # Serialize role_arn (handle intrinsic functions)
            if hasattr(self.role_arn, 'to_dict'):
                props["RoleArn"] = self.role_arn.to_dict()
            elif isinstance(self.role_arn, list):
                # Serialize list items (may contain intrinsic functions)
                props['RoleArn'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.role_arn
                ]
            else:
                props["RoleArn"] = self.role_arn

        return props



@dataclass
class Tag(CloudFormationResource):
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lakef"""

    resource_type: ClassVar[str] = "AWS::LakeFormation::Tag"

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    tag_key: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    tag_values: Optional[Union[list[str], Ref]] = None

    def _get_properties(self) -> dict[str, Any]:
        """Serialize resource properties to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.tag_key is not None:
            # Serialize tag_key (handle intrinsic functions)
            if hasattr(self.tag_key, 'to_dict'):
                props["TagKey"] = self.tag_key.to_dict()
            elif isinstance(self.tag_key, list):
                # Serialize list items (may contain intrinsic functions)
                props['TagKey'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.tag_key
                ]
            else:
                props["TagKey"] = self.tag_key

        if self.catalog_id is not None:
            # Serialize catalog_id (handle intrinsic functions)
            if hasattr(self.catalog_id, 'to_dict'):
                props["CatalogId"] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                # Serialize list items (may contain intrinsic functions)
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props["CatalogId"] = self.catalog_id

        if self.tag_values is not None:
            # Serialize tag_values (handle intrinsic functions)
            if hasattr(self.tag_values, 'to_dict'):
                props["TagValues"] = self.tag_values.to_dict()
            elif isinstance(self.tag_values, list):
                # Serialize list items (may contain intrinsic functions)
                props['TagValues'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.tag_values
                ]
            else:
                props["TagValues"] = self.tag_values

        return props



@dataclass
class DatabaseResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    name: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        if self.name is not None:
            if hasattr(self.name, 'to_dict'):
                props['Name'] = self.name.to_dict()
            elif isinstance(self.name, list):
                props['Name'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.name
                ]
            else:
                props['Name'] = self.name

        return props


@dataclass
class LFTagPair:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    tag_key: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    tag_values: Optional[Union[list[str], Ref]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.tag_key is not None:
            if hasattr(self.tag_key, 'to_dict'):
                props['TagKey'] = self.tag_key.to_dict()
            elif isinstance(self.tag_key, list):
                props['TagKey'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.tag_key
                ]
            else:
                props['TagKey'] = self.tag_key

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        if self.tag_values is not None:
            if hasattr(self.tag_values, 'to_dict'):
                props['TagValues'] = self.tag_values.to_dict()
            elif isinstance(self.tag_values, list):
                props['TagValues'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.tag_values
                ]
            else:
                props['TagValues'] = self.tag_values

        return props


@dataclass
class Resource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    table: Optional[TableResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    table_with_columns: Optional[TableWithColumnsResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    database: Optional[DatabaseResource] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog: Optional[Union[dict[str, Any], Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.table is not None:
            if hasattr(self.table, 'to_dict'):
                props['Table'] = self.table.to_dict()
            elif isinstance(self.table, list):
                props['Table'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table
                ]
            else:
                props['Table'] = self.table

        if self.table_with_columns is not None:
            if hasattr(self.table_with_columns, 'to_dict'):
                props['TableWithColumns'] = self.table_with_columns.to_dict()
            elif isinstance(self.table_with_columns, list):
                props['TableWithColumns'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table_with_columns
                ]
            else:
                props['TableWithColumns'] = self.table_with_columns

        if self.database is not None:
            if hasattr(self.database, 'to_dict'):
                props['Database'] = self.database.to_dict()
            elif isinstance(self.database, list):
                props['Database'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.database
                ]
            else:
                props['Database'] = self.database

        if self.catalog is not None:
            if hasattr(self.catalog, 'to_dict'):
                props['Catalog'] = self.catalog.to_dict()
            elif isinstance(self.catalog, list):
                props['Catalog'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog
                ]
            else:
                props['Catalog'] = self.catalog

        return props


@dataclass
class TableResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    database_name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    table_wildcard: Optional[Union[dict[str, Any], Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    name: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.database_name is not None:
            if hasattr(self.database_name, 'to_dict'):
                props['DatabaseName'] = self.database_name.to_dict()
            elif isinstance(self.database_name, list):
                props['DatabaseName'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.database_name
                ]
            else:
                props['DatabaseName'] = self.database_name

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        if self.table_wildcard is not None:
            if hasattr(self.table_wildcard, 'to_dict'):
                props['TableWildcard'] = self.table_wildcard.to_dict()
            elif isinstance(self.table_wildcard, list):
                props['TableWildcard'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.table_wildcard
                ]
            else:
                props['TableWildcard'] = self.table_wildcard

        if self.name is not None:
            if hasattr(self.name, 'to_dict'):
                props['Name'] = self.name.to_dict()
            elif isinstance(self.name, list):
                props['Name'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.name
                ]
            else:
                props['Name'] = self.name

        return props


@dataclass
class TableWithColumnsResource:
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lak"""

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    column_names: Optional[Union[list[str], Ref]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    database_name: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    catalog_id: Optional[Union[str, Ref, GetAtt, Sub]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuid
    name: Optional[Union[str, Ref, GetAtt, Sub]] = None

    def to_dict(self) -> dict[str, Any]:
        """Serialize to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.column_names is not None:
            if hasattr(self.column_names, 'to_dict'):
                props['ColumnNames'] = self.column_names.to_dict()
            elif isinstance(self.column_names, list):
                props['ColumnNames'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.column_names
                ]
            else:
                props['ColumnNames'] = self.column_names

        if self.database_name is not None:
            if hasattr(self.database_name, 'to_dict'):
                props['DatabaseName'] = self.database_name.to_dict()
            elif isinstance(self.database_name, list):
                props['DatabaseName'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.database_name
                ]
            else:
                props['DatabaseName'] = self.database_name

        if self.catalog_id is not None:
            if hasattr(self.catalog_id, 'to_dict'):
                props['CatalogId'] = self.catalog_id.to_dict()
            elif isinstance(self.catalog_id, list):
                props['CatalogId'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.catalog_id
                ]
            else:
                props['CatalogId'] = self.catalog_id

        if self.name is not None:
            if hasattr(self.name, 'to_dict'):
                props['Name'] = self.name.to_dict()
            elif isinstance(self.name, list):
                props['Name'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.name
                ]
            else:
                props['Name'] = self.name

        return props


@dataclass
class TagAssociation(CloudFormationResource):
    """http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lakef"""

    resource_type: ClassVar[str] = "AWS::LakeFormation::TagAssociation"

    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    lf_tags: Optional[list[LFTagPair]] = None
    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-reso
    resource: Optional[Resource] = None

    def _get_properties(self) -> dict[str, Any]:
        """Serialize resource properties to CloudFormation format."""
        props: dict[str, Any] = {}

        if self.lf_tags is not None:
            # Serialize lf_tags (handle intrinsic functions)
            if hasattr(self.lf_tags, 'to_dict'):
                props["LFTags"] = self.lf_tags.to_dict()
            elif isinstance(self.lf_tags, list):
                # Serialize list items (may contain intrinsic functions)
                props['LFTags'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.lf_tags
                ]
            else:
                props["LFTags"] = self.lf_tags

        if self.resource is not None:
            # Serialize resource (handle intrinsic functions)
            if hasattr(self.resource, 'to_dict'):
                props["Resource"] = self.resource.to_dict()
            elif isinstance(self.resource, list):
                # Serialize list items (may contain intrinsic functions)
                props['Resource'] = [
                    item.to_dict() if hasattr(item, 'to_dict') else item
                    for item in self.resource
                ]
            else:
                props["Resource"] = self.resource

        return props

    @property
    def attr_resource_identifier(self) -> GetAtt:
        """Get the ResourceIdentifier attribute."""
        return self.get_att("ResourceIdentifier")

    @property
    def attr_tags_identifier(self) -> GetAtt:
        """Get the TagsIdentifier attribute."""
        return self.get_att("TagsIdentifier")



