# This file was auto-generated by Fern from our API Definition.

import datetime as dt
import typing

from ..core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ..core.request_options import RequestOptions
from ..types.get_conversation_resolution_response import GetConversationResolutionResponse
from ..types.get_histogram_analytics_response import GetHistogramAnalyticsResponse
from ..types.get_insights_response import GetInsightsResponse
from ..types.group_by import GroupBy
from .raw_client import AsyncRawAnalyticsClient, RawAnalyticsClient


class AnalyticsClient:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._raw_client = RawAnalyticsClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> RawAnalyticsClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        RawAnalyticsClient
        """
        return self._raw_client

    def get_analytics_histogram(
        self,
        domain: str,
        *,
        start_date: typing.Optional[dt.datetime] = None,
        end_date: typing.Optional[dt.datetime] = None,
        group_by: typing.Optional[GroupBy] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> GetHistogramAnalyticsResponse:
        """
        Parameters
        ----------
        domain : str

        start_date : typing.Optional[dt.datetime]
            The start date of the period to retrieve analytics for

        end_date : typing.Optional[dt.datetime]
            The end date of the period to retrieve analytics for

        group_by : typing.Optional[GroupBy]
            The field to group the analytics by

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetHistogramAnalyticsResponse
            Successful Response

        Examples
        --------
        import datetime

        from fern_fai_sdk import FernAI

        client = FernAI(
            token="YOUR_TOKEN",
        )
        client.analytics.get_analytics_histogram(
            domain="domain",
            start_date=datetime.datetime.fromisoformat(
                "2024-01-15 09:30:00+00:00",
            ),
            end_date=datetime.datetime.fromisoformat(
                "2024-01-15 09:30:00+00:00",
            ),
            group_by="DAY",
        )
        """
        _response = self._raw_client.get_analytics_histogram(
            domain, start_date=start_date, end_date=end_date, group_by=group_by, request_options=request_options
        )
        return _response.data

    def generate_all_insights(
        self,
        *,
        start_date: typing.Optional[dt.datetime] = None,
        end_date: typing.Optional[dt.datetime] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> typing.Optional[typing.Any]:
        """
        Generate insights for all domains with queries in the specified period.

        Parameters
        ----------
        start_date : typing.Optional[dt.datetime]
            The start date of the period to generate insights for

        end_date : typing.Optional[dt.datetime]
            The end date of the period to generate insights for

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        typing.Optional[typing.Any]
            Successful Response

        Examples
        --------
        import datetime

        from fern_fai_sdk import FernAI

        client = FernAI(
            token="YOUR_TOKEN",
        )
        client.analytics.generate_all_insights(
            start_date=datetime.datetime.fromisoformat(
                "2024-01-15 09:30:00+00:00",
            ),
            end_date=datetime.datetime.fromisoformat(
                "2024-01-15 09:30:00+00:00",
            ),
        )
        """
        _response = self._raw_client.generate_all_insights(
            start_date=start_date, end_date=end_date, request_options=request_options
        )
        return _response.data

    def trigger_scheduled_insights_generation(
        self, *, request_options: typing.Optional[RequestOptions] = None
    ) -> typing.Optional[typing.Any]:
        """
        Manually trigger the scheduled weekly insights generation job.

        Parameters
        ----------
        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        typing.Optional[typing.Any]
            Successful Response

        Examples
        --------
        from fern_fai_sdk import FernAI

        client = FernAI(
            token="YOUR_TOKEN",
        )
        client.analytics.trigger_scheduled_insights_generation()
        """
        _response = self._raw_client.trigger_scheduled_insights_generation(request_options=request_options)
        return _response.data

    def get_query_insights(
        self, domain: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> GetInsightsResponse:
        """
        Get the most recent insights for a domain.

        Parameters
        ----------
        domain : str

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetInsightsResponse
            Successful Response

        Examples
        --------
        from fern_fai_sdk import FernAI

        client = FernAI(
            token="YOUR_TOKEN",
        )
        client.analytics.get_query_insights(
            domain="domain",
        )
        """
        _response = self._raw_client.get_query_insights(domain, request_options=request_options)
        return _response.data

    def get_scheduler_status(
        self, *, request_options: typing.Optional[RequestOptions] = None
    ) -> typing.Optional[typing.Any]:
        """
        Get the status of the scheduler and its jobs.

        Parameters
        ----------
        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        typing.Optional[typing.Any]
            Successful Response

        Examples
        --------
        from fern_fai_sdk import FernAI

        client = FernAI(
            token="YOUR_TOKEN",
        )
        client.analytics.get_scheduler_status()
        """
        _response = self._raw_client.get_scheduler_status(request_options=request_options)
        return _response.data

    def get_conversation_resolution(
        self,
        domain: str,
        *,
        start_date: typing.Optional[dt.datetime] = None,
        end_date: typing.Optional[dt.datetime] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> GetConversationResolutionResponse:
        """
        Get conversation resolution metrics for a domain in a given time period.

        Parameters
        ----------
        domain : str

        start_date : typing.Optional[dt.datetime]
            The start date of the period to retrieve resolution metrics for

        end_date : typing.Optional[dt.datetime]
            The end date of the period to retrieve resolution metrics for

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetConversationResolutionResponse
            Successful Response

        Examples
        --------
        import datetime

        from fern_fai_sdk import FernAI

        client = FernAI(
            token="YOUR_TOKEN",
        )
        client.analytics.get_conversation_resolution(
            domain="domain",
            start_date=datetime.datetime.fromisoformat(
                "2024-01-15 09:30:00+00:00",
            ),
            end_date=datetime.datetime.fromisoformat(
                "2024-01-15 09:30:00+00:00",
            ),
        )
        """
        _response = self._raw_client.get_conversation_resolution(
            domain, start_date=start_date, end_date=end_date, request_options=request_options
        )
        return _response.data


class AsyncAnalyticsClient:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._raw_client = AsyncRawAnalyticsClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> AsyncRawAnalyticsClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        AsyncRawAnalyticsClient
        """
        return self._raw_client

    async def get_analytics_histogram(
        self,
        domain: str,
        *,
        start_date: typing.Optional[dt.datetime] = None,
        end_date: typing.Optional[dt.datetime] = None,
        group_by: typing.Optional[GroupBy] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> GetHistogramAnalyticsResponse:
        """
        Parameters
        ----------
        domain : str

        start_date : typing.Optional[dt.datetime]
            The start date of the period to retrieve analytics for

        end_date : typing.Optional[dt.datetime]
            The end date of the period to retrieve analytics for

        group_by : typing.Optional[GroupBy]
            The field to group the analytics by

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetHistogramAnalyticsResponse
            Successful Response

        Examples
        --------
        import asyncio
        import datetime

        from fern_fai_sdk import AsyncFernAI

        client = AsyncFernAI(
            token="YOUR_TOKEN",
        )


        async def main() -> None:
            await client.analytics.get_analytics_histogram(
                domain="domain",
                start_date=datetime.datetime.fromisoformat(
                    "2024-01-15 09:30:00+00:00",
                ),
                end_date=datetime.datetime.fromisoformat(
                    "2024-01-15 09:30:00+00:00",
                ),
                group_by="DAY",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.get_analytics_histogram(
            domain, start_date=start_date, end_date=end_date, group_by=group_by, request_options=request_options
        )
        return _response.data

    async def generate_all_insights(
        self,
        *,
        start_date: typing.Optional[dt.datetime] = None,
        end_date: typing.Optional[dt.datetime] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> typing.Optional[typing.Any]:
        """
        Generate insights for all domains with queries in the specified period.

        Parameters
        ----------
        start_date : typing.Optional[dt.datetime]
            The start date of the period to generate insights for

        end_date : typing.Optional[dt.datetime]
            The end date of the period to generate insights for

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        typing.Optional[typing.Any]
            Successful Response

        Examples
        --------
        import asyncio
        import datetime

        from fern_fai_sdk import AsyncFernAI

        client = AsyncFernAI(
            token="YOUR_TOKEN",
        )


        async def main() -> None:
            await client.analytics.generate_all_insights(
                start_date=datetime.datetime.fromisoformat(
                    "2024-01-15 09:30:00+00:00",
                ),
                end_date=datetime.datetime.fromisoformat(
                    "2024-01-15 09:30:00+00:00",
                ),
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.generate_all_insights(
            start_date=start_date, end_date=end_date, request_options=request_options
        )
        return _response.data

    async def trigger_scheduled_insights_generation(
        self, *, request_options: typing.Optional[RequestOptions] = None
    ) -> typing.Optional[typing.Any]:
        """
        Manually trigger the scheduled weekly insights generation job.

        Parameters
        ----------
        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        typing.Optional[typing.Any]
            Successful Response

        Examples
        --------
        import asyncio

        from fern_fai_sdk import AsyncFernAI

        client = AsyncFernAI(
            token="YOUR_TOKEN",
        )


        async def main() -> None:
            await client.analytics.trigger_scheduled_insights_generation()


        asyncio.run(main())
        """
        _response = await self._raw_client.trigger_scheduled_insights_generation(request_options=request_options)
        return _response.data

    async def get_query_insights(
        self, domain: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> GetInsightsResponse:
        """
        Get the most recent insights for a domain.

        Parameters
        ----------
        domain : str

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetInsightsResponse
            Successful Response

        Examples
        --------
        import asyncio

        from fern_fai_sdk import AsyncFernAI

        client = AsyncFernAI(
            token="YOUR_TOKEN",
        )


        async def main() -> None:
            await client.analytics.get_query_insights(
                domain="domain",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.get_query_insights(domain, request_options=request_options)
        return _response.data

    async def get_scheduler_status(
        self, *, request_options: typing.Optional[RequestOptions] = None
    ) -> typing.Optional[typing.Any]:
        """
        Get the status of the scheduler and its jobs.

        Parameters
        ----------
        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        typing.Optional[typing.Any]
            Successful Response

        Examples
        --------
        import asyncio

        from fern_fai_sdk import AsyncFernAI

        client = AsyncFernAI(
            token="YOUR_TOKEN",
        )


        async def main() -> None:
            await client.analytics.get_scheduler_status()


        asyncio.run(main())
        """
        _response = await self._raw_client.get_scheduler_status(request_options=request_options)
        return _response.data

    async def get_conversation_resolution(
        self,
        domain: str,
        *,
        start_date: typing.Optional[dt.datetime] = None,
        end_date: typing.Optional[dt.datetime] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> GetConversationResolutionResponse:
        """
        Get conversation resolution metrics for a domain in a given time period.

        Parameters
        ----------
        domain : str

        start_date : typing.Optional[dt.datetime]
            The start date of the period to retrieve resolution metrics for

        end_date : typing.Optional[dt.datetime]
            The end date of the period to retrieve resolution metrics for

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetConversationResolutionResponse
            Successful Response

        Examples
        --------
        import asyncio
        import datetime

        from fern_fai_sdk import AsyncFernAI

        client = AsyncFernAI(
            token="YOUR_TOKEN",
        )


        async def main() -> None:
            await client.analytics.get_conversation_resolution(
                domain="domain",
                start_date=datetime.datetime.fromisoformat(
                    "2024-01-15 09:30:00+00:00",
                ),
                end_date=datetime.datetime.fromisoformat(
                    "2024-01-15 09:30:00+00:00",
                ),
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.get_conversation_resolution(
            domain, start_date=start_date, end_date=end_date, request_options=request_options
        )
        return _response.data
