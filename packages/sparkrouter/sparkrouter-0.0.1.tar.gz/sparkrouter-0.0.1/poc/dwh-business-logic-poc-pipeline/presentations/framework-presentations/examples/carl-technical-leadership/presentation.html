<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DWH Business Logic Framework - CARL Presentation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/theme/white.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/highlight/monokai.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            background-color: #fff8e7 !important;
        }
        .reveal {
            background-color: #fff8e7 !important;
        }
        .reveal .slides {
            background-color: #fff8e7 !important;
        }
        .reveal .slides section {
            text-align: left;
            top: 0 !important;
        }
        .reveal .slides {
            top: 0 !important;
        }
        .reveal h1 {
            text-align: center;
            font-size: 1.8em;
            margin-bottom: 0.3em;
            color: #f16122;
        }
        .reveal h2 {
            text-align: center;
            font-size: 1.4em;
            margin-bottom: 0.4em;
            color: #f16122;
        }
        .reveal h3 {
            text-align: center;
            font-size: 1.1em;
            margin-bottom: 0.3em;
        }
        .reveal pre {
            font-size: 0.35em;
            margin: 10px 0;
        }
        .reveal code {
            font-size: 0.7em;
        }
        .reveal ul, .reveal ol {
            margin: 0.5em 0;
        }
        .reveal li {
            margin: 0.2em 0;
        }
        .highlight {
            background-color: #ffeb3b;
            padding: 2px 4px;
        }
        .framework-benefit {
            color: #2e7d32;
            font-weight: bold;
        }
        .current-problem {
            color: #d32f2f;
            font-weight: bold;
        }
        .center {
            text-align: center;
        }
        .small {
            font-size: 0.7em;
        }
        .smaller {
            font-size: 0.6em;
        }
        
        /* Visual Enhancement Styles */
        .info-box {
            background: linear-gradient(135deg, #f8986e 0%, #e67e22 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            font-size: 0.9em;
        }
        
        .success-box {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            font-size: 0.9em;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            font-size: 0.9em;
        }
        
        .danger-box {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            font-size: 0.9em;
        }
        
        .feature-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin: 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            font-size: 0.8em;
        }
        
        .feature-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }
        
        .icon-large {
            font-size: 2.2em;
            margin-bottom: 10px;
            display: block;
            text-align: center;
        }
        
        .icon-medium {
            font-size: 1.2em;
            margin-right: 8px;
            vertical-align: middle;
        }
        
        .timeline {
            position: relative;
            padding-left: 25px;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 12px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #667eea;
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 15px;
            padding-left: 25px;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #667eea;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: linear-gradient(135deg, #f8986e 0%, #e67e22 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            font-size: 0.85em;
        }
        
        .metric-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }
        
        .phase-container {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        
        .phase-box {
            flex: 1;
            margin: 0 5px;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            color: white;
            font-size: 0.8em;
        }
        
        .phase-1 { background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); }
        .phase-2 { background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); }
        .phase-3 { background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%); }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            .phase-container {
                flex-direction: column;
            }
            .phase-box {
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">

            <!-- Title Slide -->
            <section>
                <div class="info-box">
                    <i class="fas fa-cogs icon-large"></i>
                    <h1 style="color: black;">DWH Business Logic Framework</h1>
                    <h2 style="color: black;">CARL Presentation for Technical Leadership</h2>
                </div>
                <div class="comparison-grid">
                    <div class="metric-card">
                        <i class="fas fa-clock icon-medium"></i>
                        <span class="metric-number">60</span>
                        Minutes
                    </div>
                    <div class="metric-card">
                        <i class="fas fa-users icon-medium"></i>
                        <span class="metric-number">C→A→R→L</span>
                        Structure
                    </div>
                </div>
            </section>

            <!-- Framework Discussion Topics -->
            <section>
                <section>
                    <h2><i class="fas fa-list icon-medium"></i>All Topics Available</h2>
                    <div class="info-box center">
                        <i class="fas fa-lightbulb icon-medium"></i>
                        <strong>Comprehensive Framework Overview - All areas we could explore</strong>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <h3>Core Architecture</h3>
                            <ul class="small">
                                <li>Architecture evolution</li>
                                <li>Multi-repository challenges</li>
                                <li>Configuration management</li>
                                <li>Schema validation</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h3>Development & Testing</h3>
                            <ul class="small">
                                <li>Testing strategy</li>
                                <li>Platform abstraction</li>
                                <li>Debug-first development</li>
                                <li>Version management</li>
                            </ul>
                        </div>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <h3>Quality & Performance</h3>
                            <ul class="small">
                                <li>Data quality framework</li>
                                <li>Performance benchmarking</li>
                                <li>Security model</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h3>Implementation</h3>
                            <ul class="small">
                                <li>Knowledge repository</li>
                                <li>Migration strategy</li>
                                <li>Team training</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-clock icon-medium"></i>Today's Focus (60 min)</h2>
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="info-box small">
                                <i class="fas fa-info-circle icon-medium"></i>
                                <strong>Context</strong> (12 min): Architecture evolution, challenges
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="warning-box small">
                                <i class="fas fa-cogs icon-medium"></i>
                                <strong>Action</strong> (20 min): Framework solution, demo
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="success-box small">
                                <i class="fas fa-chart-line icon-medium"></i>
                                <strong>Results</strong> (15 min): Benefits and ROI
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="info-box small">
                                <i class="fas fa-graduation-cap icon-medium"></i>
                                <strong>Learning</strong> (10 min): Migration strategy
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="danger-box small">
                                <i class="fas fa-comments icon-medium"></i>
                                <strong>Q&A</strong> (3 min): Discussion
                            </div>
                        </div>
                    </div>
                    <div class="center smaller">
                        <em>Other topics available for follow-up discussions</em>
                    </div>
                </section>
            </section>

            <!-- CONTEXT Section -->
            <section>
                <section>
                    <h1>C - CONTEXT</h1>
                    <h2>Why We Need to Act</h2>
                    <p class="center">(12 minutes)</p>
                </section>

                <section>
                    <h2><i class="fas fa-history icon-medium"></i>Architecture Evolution</h2>
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="success-box">
                                <i class="fas fa-database icon-medium"></i>
                                <strong>Early Phase:</strong> Simple DAGs with embedded SQL
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="info-box">
                                <i class="fas fa-tools icon-medium"></i>
                                <strong>Growth Phase:</strong> Utility modules for shared configuration
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="warning-box">
                                <i class="fas fa-check-circle icon-medium"></i>
                                <strong>Specialization:</strong> Separate data-quality repository
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="warning-box">
                                <i class="fas fa-code-branch icon-medium"></i>
                                <strong>Expansion:</strong> Pipeline repository for transformations
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="danger-box">
                                <i class="fas fa-exclamation-triangle icon-medium"></i>
                                <strong>Current State:</strong> 3+ repositories with distributed logic
                            </div>
                        </div>
                    </div>
                    <div class="info-box center">
                        <i class="fas fa-lightbulb icon-medium"></i>
                        <em>Key Insight: Each decision was logical in isolation, but compound complexity emerged</em>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-lightbulb icon-medium"></i>Lessons from Evolution</h2>
                    <div class="info-box">
                        <h3>What We Learned:</h3>
                        <ul>
                            <li>Separation of concerns is valuable</li>
                            <li>Shared utilities reduce duplication</li>
                            <li>Specialized repositories enable expertise</li>
                            <li>Configuration management is critical</li>
                            <li><strong>Testing becomes exponentially harder</strong></li>
                        </ul>
                    </div>
                </section>

                <section>
                    <h2>Current Complexity: Load Promotion DAG</h2>
                    <div class="danger-box center">
                        <i class="fas fa-question-circle icon-medium"></i>
                        <strong>Question: How many tasks should it take to load promotion data?</strong>
                    </div>
                    <pre><code class="python">
# Task 1: Extract and stage promotion data
promotion_stage_3_0 = cluster.submit_run(
    task_id='promotion_stage_3_0',
    py_file=CODE_SQLHARNESS,
    parameters=[str(sqlharness_parameters_3_0)],
    libraries=[{"whl": LIBRARY_PATH}]
)

# Task 2: Run 3 data quality checks on staged data
check_promotion_stage_3_0 = DataQualityOperator(
    task_id='check_promotion_stage_3_0',
    dq_config={
        'checks': {
            'data_quality_check_load_promotion_count_3_0.yaml': check_args,
            'data_quality_duplicate_check_3_0.yaml': check_args,
            'data_quality_check_load_promotion_promotype_3_0.yaml': check_args
        }
    }
)

# Task 3: Write/merge from staging to business object layer
promotion_write_3_0 = cluster.submit_run(
    task_id='promotion_write_3_0',
    py_file=CODE_MERGE,
    parameters=[
        f'sfly_consumer_{ENV}.dl_stage.d_promotion_3_0',
        f'sfly_consumer_{ENV}.dl_bo.d_promotion_3_0',
    ]
)

# Task 4: Copy data to Redshift
copy_promotion_3_0 = RedshiftSqlOperator(
    task_id='copy_promotion_3_0',
    sql=copypromotion_3_0
)

# Task 5: Insert data into final Redshift table
insert_promotion_3_0 = RedshiftSqlOperator(
    task_id='insert_promotion_3_0',
    sql=insertpromotion_3_0
)

# Task 6: Final data quality check on Redshift
check_partnerid_3_0 = DataQualityOperator(
    task_id='dq_check_partnerid_redshift_final',
    dq_config={
        'checks': {
            'data_quality_check_partnerid_legacy_aurora.yaml': check_args
        }
    }
)

# The workflow: 6 tasks to load promotion data
start >> promotion_stage_3_0 >> check_promotion_stage_3_0 >> \
promotion_write_3_0 >> copy_promotion_3_0 >> insert_promotion_3_0 >> \
check_partnerid_3_0 >> end
                    </code></pre>
                    <div class="danger-box center">
                        <i class="fas fa-exclamation-triangle icon-medium"></i>
                        <strong>6 separate tasks, 3 different systems, multiple repositories</strong> - <em>"Count the tasks - this is what it takes to load promotion data"</em>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-exclamation-triangle icon-medium"></i>Coordination Costs</h2>
                    <div class="danger-box">
                        <h3>Current Multi-Repository Reality:</h3>
                        <ul>
                            <li>Cross-repository changes require coordination</li>
                            <li>Configuration management across multiple systems</li>
                            <li>Production debugging spans multiple codebases</li>
                            <li>New developer onboarding is complex and lengthy</li>
                            <li>Schema changes ripple across multiple repositories</li>
                        </ul>
                    </div>
                    <div class="warning-box center">
                        <strong>Result: Significant coordination overhead and reduced productivity</strong>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-exclamation-triangle icon-medium"></i>The Tipping Point</h2>
                    <div class="danger-box">
                        <h3><i class="fas fa-warning icon-medium"></i>We've reached the complexity threshold where:</h3>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-plus-circle icon-large" style="color: #f44336;"></i>
                            <strong>Adding features</strong> takes longer than it should
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-search icon-large" style="color: #f44336;"></i>
                            <strong>Debugging</strong> requires archaeological expeditions
                        </div>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-user-graduate icon-large" style="color: #f44336;"></i>
                            <strong>New team members</strong> struggle with distributed knowledge
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-sitemap icon-large" style="color: #f44336;"></i>
                            <strong>Schema changes</strong> ripple across repositories
                        </div>
                    </div>
                </section>
            </section>

            <!-- ACTION Section -->
            <section>
                <section>
                    <h1>A - ACTION</h1>
                    <h2>The Framework Solution</h2>
                    <p class="center">(20 minutes)</p>
                </section>

                <section>
                    <h2><i class="fas fa-sitemap icon-medium"></i>Unified Framework Architecture</h2>
                    <div class="comparison-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                        <div class="feature-card">
                            <i class="fas fa-database icon-large" style="color: #4CAF50;"></i>
                            <h3>Data Sources</h3>
                            <ul class="small">
                                <li>S3 Files</li>
                                <li>Databases</li>
                                <li>APIs*</li>
                                <li>Streaming*</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-door-open icon-large" style="color: #2196F3;"></i>
                            <h3>Entry Points</h3>
                            <ul class="small">
                                <li>container/generic_entry.py</li>
                                <li>glue/generic_entry.py</li>
                                <li>databricks/generic_entry.py</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-cogs icon-large" style="color: #ff9800;"></i>
                            <h3>Business Logic</h3>
                            <ul class="small">
                                <li>Job Factories</li>
                                <li>Service Layer</li>
                                <li>Schema Services</li>
                                <li>Quality Services</li>
                                <li>Notification Services</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-arrow-right icon-large" style="color: #9c27b0;"></i>
                            <h3>Destinations</h3>
                            <ul class="small">
                                <li>Redshift</li>
                                <li>Unity Catalog</li>
                                <li>S3 Data Lake</li>
                                <li>Analytics Tools (SNS, etc.)</li>
                            </ul>
                        </div>
                    </div>
                    <div class="info-box center">
                        <i class="fas fa-arrow-right icon-medium"></i>
                        <strong>Single repository replacing distributed complexity</strong>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-folder-tree icon-medium"></i>Repository Structure</h2>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-briefcase" style="color: #4CAF50; font-size: 1.8em;"></i>
                            <h3>jobs/</h3>
                            <div class="smaller">Business logic</div>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-cogs" style="color: #2196F3; font-size: 1.8em;"></i>
                            <h3>services/</h3>
                            <div class="smaller">Core framework</div>
                        </div>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-database" style="color: #ff9800; font-size: 1.8em;"></i>
                            <h3>schemas/</h3>
                            <div class="smaller">DDL files</div>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-check-double" style="color: #4CAF50; font-size: 1.8em;"></i>
                            <h3>tests/</h3>
                            <div class="smaller">Comprehensive coverage</div>
                        </div>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-building icon-medium"></i>Key Architectural Principles</h2>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-folder icon-large" style="color: #4CAF50;"></i>
                            <strong>Single Repository</strong><br>
                            All business logic in one place
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-cloud icon-large" style="color: #2196F3;"></i>
                            <strong>Platform Abstraction</strong><br>
                            Same code runs everywhere
                        </div>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-database icon-large" style="color: #ff9800;"></i>
                            <strong>Schema-Centric</strong><br>
                            DDL files drive all validation
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-cogs icon-large" style="color: #9c27b0;"></i>
                            <strong>Factory Pattern</strong><br>
                            Clean dependency injection
                        </div>
                    </div>
                    <div class="success-box center">
                        <i class="fas fa-check-double icon-medium"></i>
                        <strong>Comprehensive Testing:</strong> Multi-tier validation approach
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-check-circle icon-medium"></i>Framework Configuration</h2>
                    <div class="info-box center">
                        <i class="fas fa-lightbulb icon-medium"></i>
                        <strong>Remember the complexity we just saw - now compare to this:</strong>
                    </div>
                    <div class="success-box">
                        <h3>Framework DAG - Clean and Transparent:</h3>
                        <pre><code class="python">
from airflow import DAG
from airflow.providers.amazon.aws.operators.glue import GlueJobOperator

DAG_ID = 'load-promos-job'
MODULE_FACTORY = "dwh.jobs.load_promos.load_promos_job_factory"

dag = DAG(DAG_ID)

load_promotions = GlueJobOperator(
    task_id='load_promotions',
    job_name='dwh-business-logic',
    script_args={
        '--module_name': MODULE_FACTORY,
        '--load_promos_job': {
            "job_failed_notifications": {"notification_service": "SNS"},
            "job_success_notifications": {"notification_service": "SNS"},
            "data_quality_notifications": {"notification_service": "SNS"},
            "extractor_config": {
                "strategy": "PARQUET", 
                "source_table": "s3a://data-lake/promotions/"
            },
            "unity_loader_config": {
                "strategy": "DELTA", 
                "path": "s3a://unity-catalog/promotions/d_promotion_3_0/"
            },
            "stage_loader_config": {
                "strategy": "PARQUET", 
                "path": "s3a://staging/promotions/"
            },
            "redshift_loader_config": {
                "strategy": "REDSHIFT",
                "jdbc_url": "jdbc:redshift://cluster.region.redshift.amazonaws.com:5439/dwh",
                "s3_staging_path": "s3a://staging/promotions/"
            }
        },
        '--start_date': '{{ ds }}',
        '--end_date': '{{ next_ds }}',
        '--created_by': 'airflow_user'
    },
    dag=dag
)
                        </code></pre>
                    </div>
                    <div class="success-box center">
                        <i class="fas fa-check-double icon-medium"></i>
                        <strong>Everything the job does is visible in the DAG - No more archaeological expeditions!</strong>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-cloud icon-medium"></i>Platform Abstraction</h2>
                    <div class="info-box center">
                        <i class="fas fa-code icon-medium"></i>
                        <strong>Same business logic runs everywhere</strong>
                    </div>
                    <div class="comparison-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                        <div class="feature-card">
                            <i class="fas fa-aws" style="color: #ff9900; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px;">AWS Glue</h3>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-database" style="color: #ff6b35; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px;">Databricks</h3>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-server" style="color: #2196F3; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px;">EMR</h3>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-docker" style="color: #0db7ed; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px;">Docker</h3>
                        </div>
                    </div>
                    <div class="success-box">
                        <h3>Business Logic Example:</h3>
                        <pre><code class="python smaller">
def execute_job(self, start_date: str, end_date: str, created_by: str) -> Any:
    start_date = JobUtils.parse_date_to_datetime(start_date, "start_date")
    end_date = JobUtils.parse_date_to_datetime(end_date, "end_date")

    if not created_by:
        raise ValueError("created_by parameter is required")

    # Extract Phase
    raw_df = self.promotion_extractor.extract(start_date, end_date)
    self.extract_dq_validator.validate(raw_df)

    # Transform Phase
    transformed_df = self.promotion_transformer.transform(raw_df, created_by)
    self.transform_dq_validator.validate(transformed_df)

    # Load Phase - Sequential loading
    print("Starting Unity Catalog load...")
    self.unity_loader.load(transformed_df)
    self.unity_dq_validator.validate(start_date, end_date)
    print("Unity Catalog load completed")

    print("Starting Stage load...")
    self.stage_loader.load(transformed_df)
    self.stage_dq_validator.validate(start_date, end_date)
    print("Stage load completed")

    # the following can be split off to a separate if as needed (no redshift access from databricks)

    print("Starting Redshift load...")
    self.redshift_loader.load()
    self.redshift_dq_validator.validate(start_date, end_date)
    print("Redshift load completed")
                        </code></pre>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-layer-group icon-medium"></i>Three-Tier Testing Architecture</h2>
                    <div class="warning-box center">
                        <i class="fas fa-shield-alt icon-medium"></i>
                        <strong>Business Logic is Sacred:</strong> Never mocked, always tested
                    </div>
                    <div class="comparison-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                        <div class="feature-card">
                            <i class="fas fa-puzzle-piece" style="color: #4CAF50; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px; font-size: 0.8em;">UNIT</h3>
                            <div class="smaller">Isolated Components</div>
                            <ul class="small">
                                <li>Noop implementations</li>
                                <li>Fast feedback (seconds)</li>
                                <li>Component logic validation</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-cogs" style="color: #2196F3; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px; font-size: 0.8em;">FUNCTIONAL</h3>
                            <div class="smaller">Business Logic</div>
                            <ul class="small">
                                <li>Real business components</li>
                                <li>Simulated I/O operations</li>
                                <li>End-to-end workflows</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-server" style="color: #ff9800; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px; font-size: 0.8em;">INTEGRATION</h3>
                            <div class="smaller">System Validation</div>
                            <ul class="small">
                                <li>Docker containers</li>
                                <li>Real database interactions</li>
                                <li>Cross-platform validation</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-play-circle icon-medium"></i>Live Demo: Framework in Action</h2>
                    <div class="info-box">
                        <i class="fas fa-laptop-code icon-large"></i>
                        <h3>Demo 1: Local Development Power</h3>
                    </div>
                    <pre><code class="bash">
cd dwh-business-logic-poc
./functional-tests.sh tests/functional/dwh/jobs/load_promos/test_postgres_load_strategy.py  # 2 minutes - comprehensive testing

# Output:
# ✅ Unit tests: All passed
# ✅ Functional tests: All passed  
# ✅ Schema validation: All tables valid
# ✅ Business logic: Comprehensive coverage
                    </code></pre>
                    <div class="success-box center">
                        <i class="fas fa-key icon-medium"></i>
                        <strong>No permissions needed - runs entirely locally</strong>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-shield-alt icon-medium"></i>Schema Validation in Action</h2>
                    <div class="info-box center">
                        <i class="fas fa-bug icon-medium"></i>
                        <strong>Live Demo: Framework catches schema issues before production</strong>
                    </div>
                    <pre><code class="bash">
# Intentionally break schema validation
# Change: .withColumn("promotioncode", col("name"))
# To:     .withColumn("promotion_code", col("name"))

./functional-tests.sh tests/functional/dwh/jobs/load_promos/test_postgres_load_strategy.py

# Framework immediately catches the error:
FAILED tests/functional/dwh/jobs/load_promos/test_postgres_load_strategy.py::TestPostgresLoadStrategy::test_postgres_load_strategy_pipeline - pyspark.errors.exceptions.captured.AnalysisException: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `promotioncode` cannot be resolved. Did you mean one of the following? [`promotion_code`, `promotionid`, `promotiontype`, `promotionskus`, `promotionenddate`].

# This would have been a production failure!
                    </code></pre>

                    <div class="danger-box center">
                        <i class="fas fa-exclamation-triangle icon-medium"></i>
                        <strong>This would have been a production issue - now caught in development!</strong>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-code-branch icon-medium"></i>Version Management</h2>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-sitemap" style="color: #4CAF50; font-size: 1.8em;"></i>
                            <h3>MWAA Orchestration</h3>
                            <div class="smaller">Unchanged</div>
                            <ul class="small">
                                <li>DAG_A → v1.0</li>
                                <li>DAG_B → v1.1</li>
                                <li>DAG_C → v2.0</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-folder-tree" style="color: #2196F3; font-size: 1.8em;"></i>
                            <h3>S3 Deployment</h3>
                            <div class="smaller">Complete Isolation</div>
                            <ul class="small">
                                <li>v1.0/ (jobs/, schemas/)</li>
                                <li>v1.1/ (jobs/, schemas/)</li>
                                <li>v2.0/ (jobs/, schemas/)</li>
                            </ul>
                        </div>
                    </div>
                    <div class="comparison-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                        <div class="feature-card">
                            <i class="fas fa-shield-alt" style="color: #4CAF50; font-size: 1.8em;"></i>
                            <h3>Zero Changes</h3>
                            <div class="smaller">No MWAA updates</div>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-undo" style="color: #ff9800; font-size: 1.8em;"></i>
                            <h3>Instant Rollback</h3>
                            <div class="smaller">Version switching</div>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-layer-group" style="color: #2196F3; font-size: 1.8em;"></i>
                            <h3>Parallel Execution</h3>
                            <div class="smaller">Multiple versions</div>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-lock" style="color: #9c27b0; font-size: 1.8em;"></i>
                            <h3>Complete Isolation</h3>
                            <div class="smaller">No conflicts</div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- RESULTS Section -->
            <section>
                <section>
                    <h1>R - RESULT</h1>
                    <h2>Expected Outcomes</h2>
                    <p class="center">(15 minutes)</p>
                </section>

                <section>
                    <h2><i class="fas fa-chart-bar icon-medium"></i>Quantified Benefits</h2>
                    <div class="comparison-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                        <div class="feature-card">
                            <i class="fas fa-rocket icon-large" style="color: #4CAF50;"></i>
                            <h3>Development Efficiency</h3>
                            <ul class="small">
                                <li><i class="fas fa-bug"></i> <strong>Debugging:</strong> Significantly faster</li>
                                <li><i class="fas fa-database"></i> <strong>Schema Changes:</strong> Automated</li>
                                <li><i class="fas fa-cog"></i> <strong>Configuration:</strong> Unified</li>
                                <li><i class="fas fa-user-plus"></i> <strong>Onboarding:</strong> Simplified</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-shield-alt icon-large" style="color: #2196F3;"></i>
                            <h3>Quality Improvements</h3>
                            <ul class="small">
                                <li><i class="fas fa-check-double"></i> <strong>Test Coverage:</strong> Limited → Comprehensive</li>
                                <li><i class="fas fa-exclamation-triangle"></i> <strong>Production Issues:</strong> Reduced</li>
                                <li><i class="fas fa-check-circle"></i> <strong>Schema Validation:</strong> Automated</li>
                                <li><i class="fas fa-code"></i> <strong>Business Logic:</strong> Full coverage</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-brain icon-large" style="color: #ff9800;"></i>
                            <h3>Knowledge Capture</h3>
                            <ul class="small">
                                <li><i class="fas fa-book"></i> <strong>Domain Knowledge:</strong> Captured in code</li>
                                <li><i class="fas fa-users"></i> <strong>Multi-Audience Docs:</strong> Technical & business</li>
                                <li><i class="fas fa-history"></i> <strong>Context Preservation:</strong> Why decisions made</li>
                                <li><i class="fas fa-graduation-cap"></i> <strong>Learning Resource:</strong> Self-documenting</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <h2>Knowledge Repository Benefits</h2>
                    <pre><code class="python">
# Business rules with context and rationale
@business_rule("Promotion eligibility requires active customer status")
def validate_customer_eligibility(customer_status: str) -> bool:
    """Customer must be ACTIVE to receive promotions.
    
    Business Context:
    - INACTIVE customers are in retention programs
    - SUSPENDED customers have payment issues  
    
    Historical Context:
    - Added 2023-Q2 after compliance audit
    - Modified 2024-Q1 to include SUSPENDED status
    """
    return customer_status == "ACTIVE"
                    </code></pre>
                    <p class="center"><span class="framework-benefit">Code becomes living documentation</span></p>
                </section>

                <section>
                    <h2><i class="fas fa-brain icon-medium"></i>Knowledge Impact</h2>
                    <div class="comparison-grid">
                        <div class="feature-card" style="border-color: #f44336;">
                            <i class="fas fa-times-circle" style="color: #f44336; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px; font-size: 0.8em;">CURRENT CHALLENGES</h3>
                            <ul class="small">
                                <li>Team departure: Knowledge loss</li>
                                <li>Onboarding: Complex learning curve</li>
                                <li>Business rules: Require investigation</li>
                                <li>Domain expertise: Individual minds</li>
                            </ul>
                        </div>
                        <div class="feature-card" style="border-color: #4CAF50;">
                            <i class="fas fa-check-circle" style="color: #4CAF50; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px; font-size: 0.8em;">FRAMEWORK BENEFITS</h3>
                            <ul class="small">
                                <li>Team departure: Reduced knowledge loss</li>
                                <li>Onboarding: Faster with consolidated code</li>
                                <li>Business rules: Self-documenting</li>
                                <li>Domain expertise: Accessible to team</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-chess-king icon-medium"></i>Strategic Value</h2>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-cloud icon-large" style="color: #667eea;"></i>
                            <strong>Platform Independence</strong><br>
                            Eliminate vendor lock-in risk
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-lightbulb icon-large" style="color: #ff9800;"></i>
                            <strong>Innovation Acceleration*</strong><br>
                            No permission bottlenecks
                        </div>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-medal icon-large" style="color: #4CAF50;"></i>
                            <strong>Organizational Maturity</strong><br>
                            Industry-standard practices
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-trophy icon-large" style="color: #f44336;"></i>
                            <strong>Competitive Advantage</strong><br>
                            Faster time-to-market
                        </div>
                    </div>
                    <div class="info-box center">
                        <i class="fas fa-brain icon-medium"></i>
                        <strong>Knowledge Preservation:</strong> Institutional memory survives team changes
                    </div>
                </section>
            </section>

            <!-- LEARNING Section -->
            <section>
                <section>
                    <h1>L - LEARNING</h1>
                    <h2>Migration Strategy and Next Steps</h2>
                    <p class="center">(10 minutes)</p>
                </section>

                <section>
                    <h2><i class="fas fa-road icon-medium"></i>Three-Phase Migration Approach</h2>
                    <div class="phase-container">
                        <div class="phase-box phase-1">
                            <i class="fas fa-shield-alt icon-large"></i>
                            <h3>Phase 1</h3>
                            <p><strong>Zero-Risk Deployment</strong></p>
                            <p>Months 1-2</p>
                            <ul class="small">
                                <li>Deploy alongside existing</li>
                                <li>No code changes</li>
                                <li>New development only</li>
                            </ul>
                        </div>
                        <div class="phase-box phase-2">
                            <i class="fas fa-exchange-alt icon-large"></i>
                            <h3>Phase 2</h3>
                            <p><strong>Strategic Migration</strong></p>
                            <p>Months 3-8</p>
                            <ul class="small">
                                <li>High-pain jobs first</li>
                                <li>Instant rollback</li>
                                <li>Version switching</li>
                            </ul>
                        </div>
                        <div class="phase-box phase-3">
                            <i class="fas fa-check-circle icon-large"></i>
                            <h3>Phase 3</h3>
                            <p><strong>Complete Migration</strong></p>
                            <p>Months 9-12</p>
                            <ul class="small">
                                <li>Opportunistic migration</li>
                                <li>Proven process</li>
                                <li>Minimal risk</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-shield-alt icon-medium"></i>Risk Mitigation Strategy</h2>
                    <div class="comparison-grid">
                        <div class="feature-card" style="border-color: #4CAF50;">
                            <i class="fas fa-code" style="color: #4CAF50; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px; font-size: 0.8em;">TECHNICAL RISKS: LOW</h3>
                            <ul class="small">
                                <li>POC proven with zero production issues</li>
                                <li>95% test coverage provides confidence</li>
                                <li>Instant rollback capability</li>
                                <li>Complete version isolation</li>
                            </ul>
                        </div>
                        <div class="feature-card" style="border-color: #2196F3;">
                            <i class="fas fa-business-time" style="color: #2196F3; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px; font-size: 0.8em;">BUSINESS RISKS: MINIMAL</h3>
                            <ul class="small">
                                <li>Gradual migration preserves investment</li>
                                <li>Business logic preserved exactly</li>
                                <li>No rewrite required</li>
                                <li>Existing patterns enhanced</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-graduation-cap icon-medium"></i>Training Strategy</h2>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-calendar-week" style="color: #4CAF50; font-size: 1.8em;"></i>
                            <h3>Training Program</h3>
                            <ul class="small">
                                <li><strong>Week 1:</strong> Architecture principles</li>
                                <li><strong>Week 2:</strong> Testing strategy</li>
                                <li><strong>Week 3:</strong> Local development</li>
                                <li><strong>Week 4:</strong> Version management</li>
                                <li><strong>Ongoing:</strong> Mentoring</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-users" style="color: #2196F3; font-size: 1.8em;"></i>
                            <h3>Target Audience</h3>
                            <ul class="small">
                                <li><strong>Senior devs:</strong> Framework architecture</li>
                                <li><strong>Mid-level devs:</strong> Testing implementation</li>
                                <li><strong>Junior devs:</strong> DAG development</li>
                                <li><strong>DevOps team:</strong> Deployment</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-bullseye icon-medium"></i>Success Metrics</h2>
                    <div class="comparison-grid">
                        <div class="feature-card" style="border-color: #4CAF50;">
                            <i class="fas fa-flag-checkered" style="color: #4CAF50; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px; font-size: 0.8em;">PHASE 1 TARGETS</h3>
                            <ul class="small">
                                <li>Framework deployment: 100% uptime</li>
                                <li>Improved development workflow</li>
                                <li>Test coverage: 95% for new jobs</li>
                                <li>Positive team feedback</li>
                            </ul>
                        </div>
                        <div class="feature-card" style="border-color: #2196F3;">
                            <i class="fas fa-chart-line" style="color: #2196F3; font-size: 1.8em; display: inline-block; vertical-align: middle;"></i>
                            <h3 style="display: inline-block; vertical-align: middle; margin-left: 10px; font-size: 0.8em;">OVERALL TARGETS</h3>
                            <ul class="small">
                                <li>Debugging time: Significant reduction</li>
                                <li>Production issues: Fewer through testing</li>
                                <li>Development velocity: Measurable improvement</li>
                                <li>Operational efficiency: Streamlined processes</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-rocket icon-medium"></i>Immediate Next Steps</h2>
                    <div class="warning-box center">
                        <i class="fas fa-calendar icon-medium"></i>
                        <strong>Decision Points</strong>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card" style="border-color: #4CAF50;">
                            <i class="fas fa-check" style="color: #4CAF50; font-size: 1.8em;"></i>
                            <h3>1. Approve Architecture</h3>
                            <div class="smaller">Framework and core principles</div>
                        </div>
                        <div class="feature-card" style="border-color: #2196F3;">
                            <i class="fas fa-users" style="color: #2196F3; font-size: 1.8em;"></i>
                            <h3>2. Allocate Resources</h3>
                            <div class="smaller">Phase 1 deployment team</div>
                        </div>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card" style="border-color: #ff9800;">
                            <i class="fas fa-bullseye" style="color: #ff9800; font-size: 1.8em;"></i>
                            <h3>3. Establish Metrics</h3>
                            <div class="smaller">Success tracking system</div>
                        </div>
                        <div class="feature-card" style="border-color: #9c27b0;">
                            <i class="fas fa-graduation-cap" style="color: #9c27b0; font-size: 1.8em;"></i>
                            <h3>4. Begin Training</h3>
                            <div class="smaller">Team preparation program</div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Questions & Discussion -->
            <section>
                <section>
                    <h1>Questions & Discussion</h1>
                </section>

                <section>
                    <h2><i class="fas fa-cogs icon-medium"></i>Technical Discussion Points</h2>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-drafting-compass" style="color: #4CAF50; font-size: 1.8em;"></i>
                            <h3>Architecture Decisions</h3>
                            <div class="small">Factory patterns, dependency injection, testing strategy</div>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-sort-amount-up" style="color: #ff9800; font-size: 1.8em;"></i>
                            <h3>Migration Priorities</h3>
                            <div class="small">Which jobs should be migrated first?</div>
                        </div>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card">
                            <i class="fas fa-sitemap" style="color: #2196F3; font-size: 1.8em;"></i>
                            <h3>Team Structure</h3>
                            <div class="small">How to organize framework development and adoption?</div>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-plug" style="color: #9c27b0; font-size: 1.8em;"></i>
                            <h3>Integration Points</h3>
                            <div class="small">How does this fit with existing infrastructure?</div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Conclusion -->
            <section>
                <section>
                    <h1>Conclusion</h1>
                </section>

                <section>
                    <h2><i class="fas fa-chart-line icon-medium"></i>The Business Case</h2>
                    <div class="comparison-grid">
                        <div class="feature-card" style="border-color: #4CAF50;">
                            <i class="fas fa-rocket" style="color: #4CAF50; font-size: 1.8em;"></i>
                            <h3>Productivity Gains</h3>
                            <div class="small">Faster debugging, streamlined development</div>
                        </div>
                        <div class="feature-card" style="border-color: #2196F3;">
                            <i class="fas fa-check-circle" style="color: #2196F3; font-size: 1.8em;"></i>
                            <h3>Proven Approach</h3>
                            <div class="small">POC demonstrates technical feasibility</div>
                        </div>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card" style="border-color: #ff9800;">
                            <i class="fas fa-shield-alt" style="color: #ff9800; font-size: 1.8em;"></i>
                            <h3>Risk Mitigation</h3>
                            <div class="small">Gradual migration with instant rollback</div>
                        </div>
                        <div class="feature-card" style="border-color: #9c27b0;">
                            <i class="fas fa-chess-king" style="color: #9c27b0; font-size: 1.8em;"></i>
                            <h3>Strategic Value</h3>
                            <div class="small">Platform independence and innovation acceleration</div>
                        </div>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-code icon-medium"></i>The Technical Case</h2>
                    <div class="comparison-grid">
                        <div class="feature-card" style="border-color: #4CAF50;">
                            <i class="fas fa-building" style="color: #4CAF50; font-size: 1.8em;"></i>
                            <h3>Architecture Maturity</h3>
                            <div class="small">Industry-standard patterns</div>
                        </div>
                        <div class="feature-card" style="border-color: #2196F3;">
                            <i class="fas fa-check-double" style="color: #2196F3; font-size: 1.8em;"></i>
                            <h3>Quality Improvement</h3>
                            <div class="small">Comprehensive test coverage</div>
                        </div>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card" style="border-color: #ff9800;">
                            <i class="fas fa-user-cog" style="color: #ff9800; font-size: 1.8em;"></i>
                            <h3>Developer Productivity</h3>
                            <div class="small">Faster development and onboarding</div>
                        </div>
                        <div class="feature-card" style="border-color: #9c27b0;">
                            <i class="fas fa-cogs" style="color: #9c27b0; font-size: 1.8em;"></i>
                            <h3>Operational Excellence</h3>
                            <div class="small">Reduced maintenance overhead</div>
                        </div>
                    </div>
                </section>

                <section>
                    <h2><i class="fas fa-users icon-medium"></i>The Organizational Case</h2>
                    <div class="comparison-grid">
                        <div class="feature-card" style="border-color: #4CAF50;">
                            <i class="fas fa-brain" style="color: #4CAF50; font-size: 1.8em;"></i>
                            <h3>Knowledge Preservation</h3>
                            <div class="small">Institutional memory survives team changes</div>
                        </div>
                        <div class="feature-card" style="border-color: #2196F3;">
                            <i class="fas fa-expand-arrows-alt" style="color: #2196F3; font-size: 1.8em;"></i>
                            <h3>Team Scalability</h3>
                            <div class="small">Junior developers can write DAGs</div>
                        </div>
                    </div>
                    <div class="comparison-grid">
                        <div class="feature-card" style="border-color: #ff9800;">
                            <i class="fas fa-lightbulb" style="color: #ff9800; font-size: 1.8em;"></i>
                            <h3>Innovation Enablement</h3>
                            <div class="small">Local development eliminates bottlenecks</div>
                        </div>
                        <div class="feature-card" style="border-color: #9c27b0;">
                            <i class="fas fa-trophy" style="color: #9c27b0; font-size: 1.8em;"></i>
                            <h3>Competitive Advantage</h3>
                            <div class="small">Faster, more reliable delivery</div>
                        </div>
                    </div>
                </section>

                <section>
                    <div class="success-box center">
                        <i class="fas fa-rocket icon-large"></i>
                        <h1 style="color: black;">Recommendation</h1>
                        <h2 style="color: black;">Approve framework deployment and begin Phase 1 migration immediately</h2>
                    </div>
                    <div class="comparison-grid">
                        <div class="metric-card">
                            <i class="fas fa-chart-line icon-medium"></i>
                            <span class="metric-number">95%</span>
                            Test Coverage
                        </div>
                        <div class="metric-card">
                            <i class="fas fa-clock icon-medium"></i>
                            <span class="metric-number">12</span>
                            Month Migration
                        </div>
                    </div>
                </section>
            </section>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/notes/notes.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/markdown/markdown.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/highlight/highlight.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            transition: 'slide',
            transitionSpeed: 'fast',
            backgroundTransition: 'fade',
            plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ],
            controls: true,
            progress: true,
            center: false,
            margin: 0.08,
            width: '95%',
            height: '95%',
            touch: true,
            loop: false,
            rtl: false,
            navigationMode: 'default',
            shuffle: false,
            fragments: true,
            fragmentInURL: false,
            embedded: false,
            help: true,
            showNotes: false,
            autoPlayMedia: null,
            preloadIframes: null,
            autoSlide: 0,
            autoSlideStoppable: true,
            autoSlideMethod: 'default',
            defaultTiming: null,
            mouseWheel: false,
            hideInactiveCursor: true,
            hideCursorTime: 5000,
            previewLinks: false,
            viewDistance: 3,
            mobileViewDistance: 2,
            display: 'block',
            hideAddressBar: true,
            disableLayout: false
        });
    </script>
</body>
</html>