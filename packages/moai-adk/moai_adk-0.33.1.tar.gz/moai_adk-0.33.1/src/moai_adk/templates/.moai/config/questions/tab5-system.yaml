# Tab 5: System & GitHub Integration
# Priority: OPTIONAL
# Questions: 7

metadata:
  id: tab_5_system_github
  label: "Tab 5: System & GitHub Integration"
  description: "Configure MoAI system settings, GitHub automation"
  priority: OPTIONAL
  order: 5
  setting_count: 7

target_sections:
  - sections/system.yaml

batches:
  # Batch 5.1: MoAI System Settings
  - batch_id: "5.1"
    label: "MoAI System Settings"
    conditional: false
    questions:
      - id: update_check_frequency
        question: "MoAI version check frequency?"
        header: "Update Check"
        field: "moai.update_check_frequency"
        type: select_single
        multi_select: false
        required: true
        options:
          - label: "Daily"
            description: "Check for updates daily (recommended)"
            value: "daily"
          - label: "Weekly"
            description: "Check for updates weekly"
            value: "weekly"
          - label: "Never"
            description: "Disable update checks"
            value: "never"
        target:
          file: "sections/system.yaml"
          path: "moai.update_check_frequency"

      - id: version_check_enabled
        question: "Enable version checking?"
        header: "Version Check"
        field: "moai.version_check.enabled"
        type: select_single
        multi_select: false
        required: true
        options:
          - label: "Enabled"
            description: "Enable version checking (recommended)"
            value: true
          - label: "Disabled"
            description: "Disable version checking"
            value: false
        target:
          file: "sections/system.yaml"
          path: "moai.version_check.enabled"

      - id: cache_ttl_hours
        question: "Version check cache TTL hours?"
        header: "Cache TTL"
        field: "moai.version_check.cache_ttl_hours"
        type: number_input
        multi_select: false
        required: true
        options:
          - label: "24 hours"
            description: "Cache version info for 24 hours (recommended)"
            value: 24
          - label: "Other"
            description: "Enter custom hours"
            value: "{{prompt_user}}"
        target:
          file: "sections/system.yaml"
          path: "moai.version_check.cache_ttl_hours"

  # Batch 5.2: GitHub Automation Settings
  - batch_id: "5.2"
    label: "GitHub Automation Settings"
    conditional: false
    questions:
      - id: enable_trust_5
        question: "Enable TRUST 5 in GitHub templates?"
        header: "TRUST 5"
        field: "github.enable_trust_5"
        type: select_single
        multi_select: false
        required: true
        options:
          - label: "Enabled"
            description: "Include TRUST 5 sections in PR templates (recommended)"
            value: true
          - label: "Disabled"
            description: "Omit TRUST 5 sections"
            value: false
        target:
          file: "sections/system.yaml"
          path: "github.enable_trust_5"

      - id: auto_delete_branches
        question: "Auto-delete merged branches?"
        header: "Auto Delete"
        field: "github.auto_delete_branches"
        type: select_single
        multi_select: false
        required: false
        options:
          - label: "Enabled"
            description: "Delete branches after merge (recommended)"
            value: true
          - label: "Disabled"
            description: "Keep branches after merge"
            value: false
          - label: "Not Set"
            description: "Use GitHub default"
            value: null
        target:
          file: "sections/system.yaml"
          path: "github.auto_delete_branches"

      - id: spec_git_workflow
        question: "SPEC Git workflow?"
        header: "SPEC Workflow"
        field: "github.spec_git_workflow"
        type: select_single
        multi_select: false
        required: true
        options:
          - label: "Develop Direct"
            description: "Direct commits to develop (recommended for personal)"
            value: "develop_direct"
          - label: "Feature Branch"
            description: "Always create feature branches"
            value: "feature_branch"
          - label: "Per SPEC"
            description: "Ask user for each SPEC"
            value: "per_spec"
        target:
          file: "sections/system.yaml"
          path: "github.spec_git_workflow"

validation:
  checkpoint: "after_tab_5"
  rules:
    - name: "validate_cache_ttl"
      description: "Cache TTL must be positive"
      field: "moai.version_check.cache_ttl_hours"
      validation: "range"
      min: 1
      max: 168
