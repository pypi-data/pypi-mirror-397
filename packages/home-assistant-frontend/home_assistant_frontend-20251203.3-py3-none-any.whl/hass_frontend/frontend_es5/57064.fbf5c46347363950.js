"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["57064"],{12814:function(t,e,n){n.d(e,{Vy:function(){return o},fI:function(){return s},ux:function(){return d}});var r=n(22786),i=n(79468);const a=54;function o(t,e){const n=t%a+1;return e.getPropertyValue(`--color-${n}`)}function s(t,e){const n=e.getPropertyValue(`--graph-color-${t+1}`)||o(t,e);return(0,i.RQ)(n)}const d=(0,r.A)(t=>Array.from({length:a},(e,n)=>s(n,t)),(t,e)=>t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1")&&t[0].getPropertyValue("--color-1")===e[0].getPropertyValue("--color-1"))},75428:function(t,e,n){n.d(e,{D:function(){return a}});var r=n(75158),i=n.n(r);const a=t=>i()(t,{whiteList:{},stripIgnoreTag:!0,stripIgnoreTagBody:!0})},3609:function(t,e,n){n.a(t,async function(t,e){try{n(46449),n(23792),n(44114),n(72712),n(26910),n(93514),n(18111),n(22489),n(20116),n(7588),n(61701),n(18237),n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698),n(62953);var r=n(40445),i=n(77845),a=n(96196),o=n(22786),s=n(88696),d=n(40257),c=n(3461),l=n(75428),u=n(44439),h=n(77476),p=(n(38962),t([u,s]));[u,s]=p.then?(await p)():p;let f,g,y=t=>t;const v=5,x=12,_=6,m=5;class b extends a.WF{render(){var t;const e={grid:{top:0,bottom:0,left:0,right:0},tooltip:{trigger:"item",formatter:this._renderTooltip,appendTo:document.body}};return(0,a.qy)(f||(f=y`<ha-chart-base .data="${0}" .options="${0}" height="100%" .extraComponents="${0}"></ha-chart-base>`),this._createData(this.data,null===(t=this._sizeController.value)||void 0===t?void 0:t.width),e,[d.A])}_processLinks(t,e){const n=new Map,r=new Map,i=[];return e.forEach(e=>{var a;const o=t.find(t=>t.id===e.source),s=t.find(t=>t.id===e.target);if(!o||!s)return;const d=r.get(o.id)||0,c=n.get(s.id)||0,l=o.value-d,u=s.value-c,h=Math.min(null!==(a=e.value)&&void 0!==a?a:l,l,u);n.set(s.id,c+h),r.set(o.id,d+h),h>0&&i.push(Object.assign(Object.assign({},e),{},{value:h}))}),i}_findParentIndex(t,e,n){var r;const i=null===(r=e.find(e=>e.target===t))||void 0===r?void 0:r.source;if(!i)return-1;let a=0;for(let o=n.length-1;o>=0;o--){const t=n[o],e=t.findIndex(t=>t.id===i);if(-1!==e)return a+e;a+=t.length}return-1}constructor(...t){super(...t),this.data={nodes:[],links:[]},this.vertical=!1,this._sizeController=new s.P(this,{callback:t=>{var e;return null===(e=t[0])||void 0===e?void 0:e.contentRect}}),this._renderTooltip=t=>{const e=t.data,n=this.valueFormatter?this.valueFormatter(e.value):e.value;if(e.id){var r;const i=this.data.nodes.find(t=>t.id===e.id);return`${t.marker} ${(0,l.D)(null!==(r=null==i?void 0:i.label)&&void 0!==r?r:e.id)}<br>${n}`}if(e.source&&e.target){var i,a;const t=this.data.nodes.find(t=>t.id===e.source),r=this.data.nodes.find(t=>t.id===e.target);return`${(0,l.D)(null!==(i=null==t?void 0:t.label)&&void 0!==i?i:e.source)} → ${(0,l.D)(null!==(a=null==r?void 0:r.label)&&void 0!==a?a:e.target)}<br>${n}`}return null},this._createData=(0,o.A)((t,e=0)=>{const n=t.nodes.filter(t=>t.value>0),r=[...new Set(n.map(t=>t.index))].sort(),i=new Map,a=[];r.forEach((e,r)=>{i.set(e,r);const o=n.filter(t=>t.index===e);o.length>0&&a.push(a.length>0?o.sort((e,n)=>{const r=this._findParentIndex(e.id,t.links,a),i=this._findParentIndex(n.id,t.links,a);return r===i?0:-1===r?1:-1===i?-1:r-i}):o)});const o=this._processLinks(n,t.links),s=e/r.length-h.hD-m;return{id:"sankey",type:"sankey",nodes:a.flat().map(t=>({id:t.id,value:t.value,itemStyle:{color:t.color},depth:i.get(t.index)})),links:o,draggable:!1,orient:this.vertical?"vertical":"horizontal",nodeWidth:15,nodeGap:_,lineStyle:{color:"gradient",opacity:.4,curveness:.5},layoutIterations:0,animationDuration:500,label:{formatter:e=>{var n,r;return null!==(n=null===(r=t.nodes.find(t=>t.id===e.data.id))||void 0===r?void 0:r.label)&&void 0!==n?n:e.data.id},position:this.vertical?"bottom":"right",distance:m,minMargin:5,overflow:"break"},labelLayout:t=>{if(this.vertical){const e=t.text.split(" ").reduce((t,e)=>t.length>e.length?t:e,""),n=(0,c.W)(e,x),r=t.rect.width+6,i=Math.min(x,r/n*x);return{fontSize:i>1?i:0,width:r,align:"center",dy:-2}}const e=t.rect.height+8,n=Math.min(e/t.labelRect.height*x,x);return{fontSize:n,lineHeight:n,width:s,height:t.rect.height}},top:this.vertical?0:v,bottom:this.vertical?25:v,left:this.vertical?v:0,right:this.vertical?v:s+m,emphasis:{focus:"adjacency"}}})}}b.styles=(0,a.AH)(g||(g=y`:host{display:block;flex:1;max-width:100%;background:var(--ha-card-background,var(--card-background-color))}ha-chart-base{width:100%;height:100%}`)),(0,r.__decorate)([(0,i.MZ)({attribute:!1})],b.prototype,"hass",void 0),(0,r.__decorate)([(0,i.MZ)({attribute:!1})],b.prototype,"data",void 0),(0,r.__decorate)([(0,i.MZ)({type:Boolean})],b.prototype,"vertical",void 0),(0,r.__decorate)([(0,i.MZ)({type:String,attribute:!1})],b.prototype,"valueFormatter",void 0),(0,r.__decorate)([(0,i.wk)()],b.prototype,"_sizeController",void 0),b=(0,r.__decorate)([(0,i.EM)("ha-sankey-chart")],b),e()}catch(f){e(f)}})},34296:function(t,e,n){n(23792),n(62953);var r=n(40445),i=n(96229),a=n(26069),o=n(91735),s=n(42034),d=n(96196),c=n(77845);let l,u,h,p,f=t=>t;class g extends i.k{renderOutline(){return this.filled?(0,d.qy)(l||(l=f`<span class="filled"></span>`)):super.renderOutline()}getContainerClasses(){return Object.assign(Object.assign({},super.getContainerClasses()),{},{active:this.active})}renderPrimaryContent(){return(0,d.qy)(u||(u=f` <span class="leading icon" aria-hidden="true"> ${0} </span> <span class="label">${0}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${0} </span> `),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}renderTrailingIcon(){return(0,d.qy)(h||(h=f`<slot name="trailing-icon"></slot>`))}constructor(...t){super(...t),this.filled=!1,this.active=!1}}g.styles=[o.R,s.R,a.R,(0,d.AH)(p||(p=f`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`))],(0,r.__decorate)([(0,c.MZ)({type:Boolean,reflect:!0})],g.prototype,"filled",void 0),(0,r.__decorate)([(0,c.MZ)({type:Boolean})],g.prototype,"active",void 0),g=(0,r.__decorate)([(0,c.EM)("ha-assist-chip")],g)},77476:function(t,e,n){n.d(e,{Es:function(){return r},dc:function(){return a},hD:function(){return i}});const r=10,i=30,a=20},23528:function(t,e,n){n.a(t,async function(t,r){try{n.d(e,{$3:function(){return v},$O:function(){return w},$j:function(){return x},ED:function(){return s},JE:function(){return M},OQ:function(){return k},PU:function(){return E},Ph:function(){return g},Uf:function(){return z},W1:function(){return y},Wr:function(){return h},Z:function(){return l},gF:function(){return _},iY:function(){return m},jU:function(){return d},nN:function(){return S},p3:function(){return u},pJ:function(){return f},r_:function(){return c},sz:function(){return p}});n(74423),n(23792),n(18111),n(13579),n(62953);var i=n(28978),a=n(380),o=t([a]);a=(o.then?(await o)():o)[0];var s=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({});const d=["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"],c=["L","gal","ft³","m³","CCF","MCF"],l=t=>t.sendMessagePromise({type:"recorder/info"}),u=(t,e)=>t.callWS({type:"recorder/list_statistic_ids",statistic_type:e}),h=(t,e)=>t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e}),p=(t,e,n,r,i="hour",a,o)=>t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==n?void 0:n.toISOString(),statistic_ids:r,period:i,units:a,types:o}),f=(t,e,n,r)=>t.callWS({type:"recorder/statistic_during_period",statistic_id:e,units:r,fixed_period:n.fixed_period?{start_time:n.fixed_period.start instanceof Date?n.fixed_period.start.toISOString():n.fixed_period.start,end_time:n.fixed_period.end instanceof Date?n.fixed_period.end.toISOString():n.fixed_period.end}:void 0,calendar:n.calendar?Object.assign(Object.assign({},"week"===n.calendar.period?{first_weekday:(0,a.D)(t.locale).substring(0,3)}:{}),n.calendar):void 0,rolling_window:n.rolling_window}),g=t=>t.callWS({type:"recorder/validate_statistics"}),y=(t,e,n,r)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:n,unit_class:r}),v=(t,e)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:e}),x=t=>{let e=null;if(!t)return null;for(const n of t)null!==n.change&&void 0!==n.change&&(null===e?e=n.change:e+=n.change);return e},_=(t,e)=>{let n=null;for(const r of e){if(!(r in t))continue;const e=x(t[r]);null!==e&&(null===n?n=e:n+=e)}return n},m=(t,e)=>t.some(t=>void 0!==t[e]&&null!==t[e]),b=["mean","min","max"],I=["sum","state","change"],S=(t,e)=>!(!b.includes(e)||0===t.mean_type)||!(!I.includes(e)||!t.has_sum),z=(t,e,n,r,i)=>{const a=new Date(n).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:a,adjustment:r,adjustment_unit_of_measurement:i})},w=(t,e,n)=>{const r=t.states[e];return r?(0,i.u)(r):(null==n?void 0:n.name)||e},M=(t,e,n)=>{let r;var i;e&&(r=null===(i=t.states[e])||void 0===i?void 0:i.attributes.unit_of_measurement);return void 0===r?null==n?void 0:n.statistics_unit_of_measurement:r},k=t=>t.includes(":"),E=t=>t.callWS({type:"recorder/update_statistics_issues"});r()}catch(d){r(d)}})},48949:function(t,e,n){n.d(e,{Q:function(){return s}});n(23792),n(62953);var r=n(40445),i=n(77845),a=n(84187),o=n(71769);const s=t=>{class e extends t{connectedCallback(){super.connectedCallback(),this._unsubMql=(0,o.m)("all and (max-width: 450px), all and (max-height: 500px)",t=>{this._isMobileSize=t})}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._unsubMql)||void 0===t||t.call(this),this._unsubMql=void 0}constructor(...t){super(...t),this._isMobileSize=!1,this._isMobileClient=a.M}}return(0,r.__decorate)([(0,i.wk)()],e.prototype,"_isMobileSize",void 0),e}},40257:function(t,e,n){n.d(e,{A:function(){return p}});var r=n(84267),i=(n(78350),n(23792),n(44114),n(72712),n(26910),n(30237),n(18111),n(22489),n(20116),n(30531),n(7588),n(61701),n(18237),n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698),n(62953),n(83354));function a(t){return"passThrough"in t}const o=1;function s(t,e){t.eachSeriesByType("sankey",t=>{if("justify"!==t.get("nodeAlign"))return;const n=t.get("nodeWidth"),r=t.get("nodeGap"),s=(0,i.Lj)(t,e).refContainer,{width:l,height:u}=s,h=t.getGraph();!function(t,e,n,r,i,s,l){const u=t.filter(t=>t.getLayout().value>0),h=[...new Set(u.map(t=>t.hostGraph.data.getRawDataItem(t.dataIndex).depth||0))].sort(),p=function(t,e){const n=[];return e.forEach(e=>{const r=function(t,e,n){if(0===t.getLayout().value)return[];const r=d(t.node1,e),i=d(t.node2,e),a=function(t){const e=t.hostGraph.edgeData.getRawDataItem(t.dataIndex);return e.value}(t),o=function(t,e,n){return n.slice(t+1,e)}(r.depthIndex,i.depthIndex,e),s=t.node1.hostGraph.data.getRawDataItem(t.node1.dataIndex),c=t.node2.hostGraph.data.getRawDataItem(t.node2.dataIndex),l=o.map(t=>{const e=function(t,e,n,r){return{passThrough:!0,id:`${t}-${e}-${n}`,value:r,depth:n,sourceId:t,targetId:e}}(s.id,c.id,t,a);return n.push(e),e.id});return l}(e,t,n);e.passThroughNodeIds=r}),n}(h,e),f=function(t,e,n,r,i,s,d){const{sectionSize:l,sectionDepthSize:u}=function(t,e,n,r,i){const a=("vertical"===t?e:n)-2*i,o="vertical"===t?n/r.length:e/r.length;return{sectionSize:a,sectionDepthSize:o}}(s,r,i,n,d),h=function(t,e){const n={};return t.forEach(t=>{const e=t.getLayout().depth;n[e]?n[e].push(t):n[e]=[t]}),e.forEach(t=>{n[t.depth]?n[t.depth].push(t):n[t.depth]=[t]}),n}(t,e),p=function(t,e){const n={};return e.forEach((r,i)=>{const o=[...t[r]||[]].sort((r,o)=>{const s=a(r),d=a(o);if(s&&d){if(i>0){const s=e[i-1],d=n[s]||t[s]||[],c=d.findIndex(t=>(a(t),t.id)===r.sourceId),l=d.findIndex(t=>(a(t),t.id)===o.sourceId);if(c!==l&&-1!==c&&-1!==l)return c-l}if(i<e.length-1){const n=e[i+1],s=t[n]||[],d=s.findIndex(t=>(a(t),t.id)===r.targetId),c=s.findIndex(t=>(a(t),t.id)===o.targetId);if(d!==c&&-1!==d&&-1!==c)return d-c}}return 0});n[r]=o}),n}(h,n);let f=0;const g=n.map(t=>{const e=function(t){return t.map(t=>({node:t,id:t.id,value:a(t)?t.value:t.getLayout().value,x:0,y:0,dx:0,dy:0,size:0}))}(p[t]||[]),n=l-(e.length+1)*d,r=e.reduce((t,e)=>t+e.value,0),{nodes:i,valueToSizeRatio:o}=c(e,n,r,f);return o>f&&(f=o),{nodes:i,depth:t,totalValue:r,valueToSizeRatio:o}});return g.forEach((t,e)=>{!function(t,e,n,r,i,a){let s=0;t.valueToSizeRatio!==i?t.nodes.forEach(t=>{const e=Math.max(o,Math.floor(t.value/i));s+=e,t.size=e}):s=t.nodes.reduce((t,e)=>t+e.size,0);const d=n-s;let c=d/(t.nodes.length+1);t.nodes.forEach(n=>{"vertical"===a?(n.x=c,n.y=e*r):(n.x=e*r,n.y=c),c+=n.size+d/(t.nodes.length+1)})}(t,e,l,u,f,s)}),g.flatMap(t=>t.nodes)}(u,p,h,i,s,l,r);!function(t,e,n){const r=function(t){return"vertical"===t?{breadth:"x",depth:"y",breadthSize:"dx",depthSize:"dy"}:{breadth:"y",depth:"x",breadthSize:"dy",depthSize:"dx"}}(n),i="vertical"===n?"curveVertical":"curveHorizontal";(function(t,e,n){t.forEach(t=>{t[n.breadthSize]=t.size,t[n.depthSize]=e,a(t.node)||t.node.setLayout({x:t.x,y:t.y,dx:t.dx,dy:t.dy},!0)})})(t,e,r),function(t,e){t.forEach(t=>{a(t.node)||t.node.outEdges.forEach(n=>{const r=n.hostGraph.edgeData.getRawDataItem(n.dataIndex).value/t.value*t.size;n.setLayout({[e.breadthSize]:r,[e.depthSize]:0},!0)})})}(t,r),function(t,e){t.forEach(t=>{a(t.node)||(t.node.outEdges.sort((t,n)=>t.node2.getLayout()[e.breadth]-n.node2.getLayout()[e.breadth]),t.node.inEdges.sort((t,n)=>t.node1.getLayout()[e.breadth]-n.node1.getLayout()[e.breadth]))})}(t,r),t.forEach(e=>{a(e.node)||(function(t,e,n){if(a(t.node))return;let r=0;t.node.outEdges.forEach(i=>{i.setLayout({x:"vertical"===e?t.x+r:t.x+t.dx,y:"vertical"===e?t.y+t.dy:t.y+r},!0),r+=i.getLayout()[n.breadthSize]})}(e,n,r),function(t,e,n,r,i){if(a(t.node))return;let o=0;t.node.inEdges.forEach(a=>{const s=function(t,e,n,r){const i=[];return t.passThroughNodeIds.forEach(t=>{const a=e.find(e=>e.id===t);i.push({x:a.x,y:a.y,type:r}),"vertical"===n?i.push({x:a.x,y:a.y+a.dy,type:"line"}):i.push({x:a.x+a.dx,y:a.y,type:"line"})}),i}(a,e,n,i);a.setLayout({targets:[...s,{x:"vertical"===n?t.x+o:t.x,y:"vertical"===n?t.y:t.y+o,type:i}]},!0),o+=a.getLayout()[r.breadthSize]})}(e,t,n,r,i))})}(f,n,l)}(h.nodes,h.edges,n,r,l,u,t.get("orient"))})}function d(t,e){const n=t.hostGraph.data.getRawDataItem(t.dataIndex).depth||0,r=e.findIndex(t=>t===n);return{depth:n,depthIndex:r}}function c(t,e,n,r=0){let i=n/e;i<r&&(i=r);let a=0;const s=t.map(t=>{if(t.size===o)return t;let e=Math.floor(t.value/i);return e<o&&(a+=o-e,e=o),Object.assign(Object.assign({},t),{},{size:e})});return a>0?c(s,e-a,n,i):{nodes:s,valueToSizeRatio:i}}var l=n(30052);class u extends l.A{render(t,e,n){super.render(t,e,n);const r=t.getData("edge");t.getGraph().eachEdge(t=>{const e=t.getLayout(),n=t.getModel().getModel("lineStyle").get("curveness"),i=r.getItemGraphicEl(t.dataIndex);i.buildPath=t=>function(t,e,n){var r;if(null===(r=e.targets)||void 0===r||!r.length)return;t.moveTo(e.x,e.y);const i=e.targets[e.targets.length-1],a=[{x:e.x,y:e.y,type:i.type},...e.targets];for(let o=1;o<a.length;o++){const e=a[o],r=a[o-1];"curveHorizontal"===e.type?t.bezierCurveTo(r.x*(1-n)+e.x*n,r.y,e.x*(1-n)+r.x*n,e.y,e.x,e.y):"curveVertical"===e.type?t.bezierCurveTo(r.x,r.y*(1-n)+e.y*n,e.x,e.y*(1-n)+r.y*n,e.x,e.y):t.lineTo(e.x,e.y)}t.lineTo(i.x+e.dx,i.y+e.dy);for(let o=a.length-2;o>=0;o--){const r={x:a[o+1].x+e.dx,y:a[o+1].y+e.dy,type:a[o+1].type},i={x:a[o].x+e.dx,y:a[o].y+e.dy,type:r.type};"curveHorizontal"===i.type?t.bezierCurveTo(r.x*(1-n)+i.x*n,r.y,i.x*(1-n)+r.x*n,i.y,i.x,i.y):"curveVertical"===i.type?t.bezierCurveTo(r.x,r.y*(1-n)+i.y*n,i.x,i.y*(1-n)+r.y*n,i.x,i.y):t.lineTo(i.x,i.y)}t.closePath()}(t,e,n),i.dirtyShape()})}}var h=u;function p(t){(0,r.a)(t),t.registerLayout(s),t.registerChartView(h)}},84187:function(t,e,n){n.d(e,{M:function(){return r}});n(27495);const r=/(?:iphone|android|ipad)/i.test(navigator.userAgent)},3461:function(t,e,n){let r;function i(t,e,n="Roboto, Noto, sans-serif"){r||(r=document.createElement("canvas"));const i=r.getContext("2d");if(!i)return 0;i.font=`${e}px ${n}`;const a=i.measureText(t);return Math.ceil(Math.max(a.actualBoundingBoxRight+a.actualBoundingBoxLeft,a.width))}n.d(e,{W:function(){return i}})}}]);
//# sourceMappingURL=57064.fbf5c46347363950.js.map