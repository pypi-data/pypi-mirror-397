"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["65742"],{16349:function(t,e,a){a.a(t,async function(t,o){try{a.r(e);a(16280),a(23792),a(3362),a(62953),a(3296),a(27208),a(48408),a(14603),a(47566),a(98721);var n=a(40445),s=a(96196),i=a(77845),r=a(80880),c=a(89300),d=(a(55148),a(92025)),h=a(33668),l=a(81619),p=t([c]);c=(p.then?(await p)():p)[0];let u,_,w=t=>t;class b extends s.WF{connectedCallback(){super.connectedCallback(),this._attached=!0}disconnectedCallback(){super.disconnectedCallback(),this._attached=!1}render(){return this._attached&&this.stateObj?(0,s.qy)(u||(u=w` <ha-camera-stream .hass="${0}" .stateObj="${0}" allow-exoplayer controls></ha-camera-stream> <div class="actions"> <ha-progress-button @click="${0}" .progress="${0}" .disabled="${0}" appearance="filled"> ${0} </ha-progress-button> </div> `),this.hass,this.stateObj,this._downloadSnapshot,this._waiting,this.stateObj.state===d.Hh,this.hass.localize("ui.dialogs.more_info_control.camera.download_snapshot")):s.s6}async _downloadSnapshot(t){const e=t.currentTarget;this._waiting=!0;try{const t=await this.hass.callApiRaw("GET",`camera_proxy/${this.stateObj.entity_id}`);if(!t)throw new Error("No response from API");const e="image/png"===t.headers.get("content-type")?"png":"jpg",a=(new Date).toLocaleString(),o=`snapshot_${(0,r.Y)(this.stateObj.entity_id)}_${a}.${e}`,n=await t.blob(),s=window.URL.createObjectURL(n);(0,h.R)(s,o)}catch(a){return this._waiting=!1,e.actionError(),void(0,l.P)(this,{message:this.hass.localize("ui.dialogs.more_info_control.camera.failed_to_download")})}this._waiting=!1,e.actionSuccess()}constructor(...t){super(...t),this._attached=!1,this._waiting=!1}}b.styles=(0,s.AH)(_||(_=w`:host{display:block}.actions{width:100%;display:flex;flex-direction:row;flex-wrap:wrap;justify-content:flex-end;box-sizing:border-box;padding:16px;z-index:1;gap:var(--ha-space-2)}`)),(0,n.__decorate)([(0,i.MZ)({attribute:!1})],b.prototype,"hass",void 0),(0,n.__decorate)([(0,i.MZ)({attribute:!1})],b.prototype,"stateObj",void 0),(0,n.__decorate)([(0,i.wk)()],b.prototype,"_attached",void 0),(0,n.__decorate)([(0,i.wk)()],b.prototype,"_waiting",void 0),customElements.define("more-info-camera",b),o()}catch(u){o(u)}})},33668:function(t,e,a){a.d(e,{h:function(){return s},R:function(){return n}});var o=a(37177);const n=(t,e="")=>{const a=document.createElement("a");a.target="_blank",a.href=t,a.download=e,a.style.display="none",document.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),document.body.removeChild(a)},s=t=>{var e;return!(t=>!!t.auth.external&&o.n)(t)||!(null===(e=t.auth.external)||void 0===e||!e.config.downloadFileSupported)}},37177:function(t,e,a){a.d(e,{n:function(){return o}});a(27495);const o=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}]);
//# sourceMappingURL=65742.b1c4a04cf187f027.js.map