{"version":3,"file":"67518.fcb5ded044dfd5b4.js","sources":["https://raw.githubusercontent.com/home-assistant/frontend/20251203.3/src/panels/lovelace/cards/energy/hui-power-sankey-card.ts"],"names":["DEFAULT_CONFIG","group_by_floor","group_by_area","MIN_POWER_THRESHOLD","HuiPowerSankeyCard","SubscribeMixin","MobileAwareMixin","LitElement","setConfig","config","this","_config","Object","assign","hassSubscribe","_this$_config","getEnergyDataCollection","hass","key","collection_key","subscribe","data","_data","getCardSize","getGridOptions","columns","min_columns","rows","min_rows","shouldUpdate","changedProps","has","oldHass","get","_entities","size","entityId","states","render","nothing","html","_t","_","localize","prefs","powerData","_computePowerData","computedStyle","getComputedStyle","nodes","links","homeNode","id","label","value","Math","max","used_total","color","getPropertyValue","trim","index","push","from_battery","source","target","to_battery","grid_to_battery","solar_to_battery","from_grid","solar","to_grid","battery_to_grid","solar_to_grid","untrackedConsumption","deviceNodes","parentLinks","deviceMap","Map","device_consumption","forEach","device","set","stat_consumption","stat_rate","included_in_stat","renderedStatRates","Set","_getCurrentPower","add","idx","effectiveParent","includedInStat","currentParent","parentDevice","findEffectiveParent","node","name","_getEntityLabel","getGraphColorByIndex","parent","devicesWithoutParent","filter","areas","floors","_groupByFloorAndArea","keys","sort","a","b","_this$hass$floors$b$l","_this$hass$floors$b","_this$hass$floors$a$l","_this$hass$floors$a","level","Infinity","floorId","floorNodeId","areaId","targetNodeId","_this$hass$areas$area","areaNodeId","devices","deviceNode","deviceSections","_getDeviceSections","section","length","hasData","some","vertical","layout","_isMobileSize","_t2","title","classMap","_t3","_valueFormatter","_t4","clear","energy_sources","type","power","powerSource","abs","solar_remaining","grid_remaining","battery_remaining","to_battery_remaining","to_grid_remaining","used_total_remaining","used_solar","used_battery","used_grid","excess_grid_in_after_consumption","min","grid_to_battery_2","no_area","no_floor","entity","area","floor","getEntityContext","entities","area_id","floor_id","includes","unshift","parentSection","childSection","parentIds","values","remainingLinks","isChild","entries","child","_getPowerFromState","getPowerFromState","stateObj","attributes","friendly_name","args","hassSubscribeRequiredHostProps","formatNumber","locale","maximumFractionDigits","undefined","styles","css","_t5","attribute"],"mappings":"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"}