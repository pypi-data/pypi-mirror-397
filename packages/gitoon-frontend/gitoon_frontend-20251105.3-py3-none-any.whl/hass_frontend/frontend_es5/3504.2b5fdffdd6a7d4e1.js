"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["3504"],{94327:function(t,e,a){a.d(e,{Vy:function(){return o},fI:function(){return s},ux:function(){return c}});a(80178),a(45519);var n=a(65940),r=a(83510),i=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function o(t){return i[t%i.length]}function s(t,e){var a=e.getPropertyValue(`--graph-color-${t+1}`)||o(t);return(0,r.RQ)(a)}var c=(0,n.A)(t=>i.map((e,a)=>s(a,t)),(t,e)=>t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1"))},71770:function(t,e,a){var n,r,i,o,s=a(62020),c=a(31802),d=a(21101),l=a(23180),u=a(87426),h=(a(38606),a(69868)),p=a(30103),f=a(86811),_=a(49377),v=a(34800),m=a(84922),g=a(11991),y=t=>t,b=function(t){function e(){var t;(0,s.A)(this,e);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=(0,d.A)(this,e,[].concat(n))).filled=!1,t.active=!1,t}return(0,l.A)(e,t),(0,c.A)(e,[{key:"renderOutline",value:function(){return this.filled?(0,m.qy)(n||(n=y`<span class="filled"></span>`)):(0,u.A)(e,"renderOutline",this,3)([])}},{key:"getContainerClasses",value:function(){return Object.assign(Object.assign({},(0,u.A)(e,"getContainerClasses",this,3)([])),{},{active:this.active})}},{key:"renderPrimaryContent",value:function(){return(0,m.qy)(r||(r=y` <span class="leading icon" aria-hidden="true"> ${0} </span> <span class="label">${0}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${0} </span> `),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}},{key:"renderTrailingIcon",value:function(){return(0,m.qy)(i||(i=y`<slot name="trailing-icon"></slot>`))}}])}(p.k);b.styles=[_.R,v.R,f.R,(0,m.AH)(o||(o=y`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`))],(0,h.__decorate)([(0,g.MZ)({type:Boolean,reflect:!0})],b.prototype,"filled",void 0),(0,h.__decorate)([(0,g.MZ)({type:Boolean})],b.prototype,"active",void 0),b=(0,h.__decorate)([(0,g.EM)("ha-assist-chip")],b)},42029:function(t,e,a){a.d(e,{g:function(){return i}});a(39118);var n=a(83510),r=a(6788);function i(t,e,a,i,o,s){var c=t.getPropertyValue(o+"-"+s).trim(),d=c.length>0?c:t.getPropertyValue(o).trim(),l=(0,n.RQ)(d);return 0===c.length&&s&&(l=(0,n.v2)((0,n.BE)(e?(0,r.T)((0,n.Nc)((0,n.xp)(l)),s):(0,r.d)((0,n.Nc)((0,n.xp)(l)),s)))),i?l+=a?"32":"7F":a&&(l+="7F"),l}},45863:function(t,e,a){a.a(t,async function(t,n){try{a.r(e),a.d(e,{HuiEnergyDevicesDetailGraphCard:function(){return O}});var r=a(18202),i=a(73983),o=a(62020),s=a(31802),c=a(21101),d=a(23180),l=(a(38606),a(96956),a(44941),a(79827),a(44784),a(80178),a(99342),a(9724),a(35058),a(65315),a(837),a(84136),a(22416),a(37089),a(48169),a(65152),a(45519),a(67579),a(30500),a(30536),a(69868)),u=a(30765),h=a(76174),p=a(84922),f=a(11991),_=a(75907),v=a(65940),m=a(94327),g=a(42029),y=(a(70490),a(68717)),b=a(43716),k=a(63002),S=a(40328),C=a(8510),$=a(36886),w=a(20051),D=a(8868),x=t([y,D,b,$,k]);[y,D,b,$,k]=x.then?(await x)():x;var A,I,E,M=t=>t,O=function(t){function e(){var t;(0,o.A)(this,e);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=(0,c.A)(this,e,[].concat(n)))._chartData=[],t._start=(0,u.R)(),t._end=(0,h.o)(),t._hiddenStats=[],t.hassSubscribeRequiredHostProps=["_config"],t._formatTotal=e=>t.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.total_consumed",{num:(0,D.ZV)(e,t.hass.locale),unit:"kWh"}),t._createOptions=(0,v.A)((e,a,n,r,i,o,s)=>{var c=(0,$.od)(e,a,n,r,i,o,s,t._formatTotal),d=t._legendData?t._legendData.filter(e=>e.id&&t._hiddenStats.includes(t._getStatIdFromId(e.id))).reduce((t,e)=>(t[e.id]=!1,t),{}):{};return Object.assign(Object.assign({},c),{},{legend:{show:!0,type:"custom",data:t._legendData,selected:d},grid:{top:15,bottom:0,left:1,right:1,containLabel:!0}})}),t}return(0,d.A)(e,t),(0,s.A)(e,[{key:"hassSubscribe",value:function(){var t;return[(0,b.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe(t=>{this._data=t})]}},{key:"getCardSize",value:function(){return 3}},{key:"setConfig",value:function(t){this._config=t}},{key:"shouldUpdate",value:function(t){return(0,C.xP)(this,t)||t.size>1||!t.has("hass")}},{key:"willUpdate",value:function(t){(t.has("_config")||t.has("_data"))&&this._processStatistics()}},{key:"render",value:function(){return this.hass&&this._config?(0,p.qy)(A||(A=M` <ha-card> ${0} <div class="content ${0}"> <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" @dataset-hidden="${0}" @dataset-unhidden="${0}"></ha-chart-base> </div> </ha-card> `),this._config.title?(0,p.qy)(I||(I=M`<h1 class="card-header">${0}</h1>`),this._config.title):"",(0,_.H)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,"kWh",this._compareStart,this._compareEnd),this._datasetHidden,this._datasetUnhidden):p.s6}},{key:"_datasetHidden",value:function(t){this._hiddenStats=[].concat((0,i.A)(this._hiddenStats),[this._getStatIdFromId(t.detail.id)])}},{key:"_datasetUnhidden",value:function(t){this._hiddenStats=this._hiddenStats.filter(e=>e!==this._getStatIdFromId(t.detail.id))}},{key:"_processStatistics",value:function(){if(this._data){var t=this._data;this._start=t.start,this._end=t.end||(0,h.o)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare;var e=t.stats,a=t.statsCompare,n=getComputedStyle(this),r=t.prefs.device_consumption,o={};r.forEach(t=>{t.included_in_stat&&(o[t.included_in_stat]=o[t.included_in_stat]||[],o[t.included_in_stat].push(t.stat_consumption))});var s={};t.prefs.device_consumption.forEach(t=>{var a=t.stat_consumption in e&&(0,k.$j)(e[t.stat_consumption])||0;s[t.stat_consumption]=a});var c={};t.prefs.device_consumption.forEach(t=>{c[t.stat_consumption]=(o[t.stat_consumption]||[]).reduce((t,e)=>t-s[e],s[t.stat_consumption])});var d=t.prefs.device_consumption.map(t=>t.stat_consumption);d.sort((t,e)=>c[e]-c[t]);var l=[],u=(0,b.gv)(t),p=u.summedData,f=u.compareSummedData,_="from_grid"in p||"solar"in p||"from_battery"in p,v=_?(0,b.DR)(p,f):{consumption:void 0,compareConsumption:void 0},m=v.consumption,g=v.compareConsumption;if(a){var y=this._processDataSet(n,a,t.statsMetadata,t.prefs.device_consumption,d,o,!0);if(l.push.apply(l,(0,i.A)(y)),_){var S=this._processUntracked(n,y,g,!0);l.push(S)}}l.push({id:"compare-placeholder",type:"bar",stack:t.statsCompare?"devicesCompare":"devices",data:[]});var C=this._processDataSet(n,e,t.statsMetadata,t.prefs.device_consumption,d,o);if(l.push.apply(l,(0,i.A)(C)),this._legendData=C.map(t=>{var e;return{id:t.id,secondaryIds:[`compare-${t.id}`],name:t.name,itemStyle:{color:t.color,borderColor:null===(e=t.itemStyle)||void 0===e?void 0:e.borderColor}}}),_){var w,D=this._processUntracked(n,C,m,!1);l.push(D),this._legendData.push({id:D.id,secondaryIds:[`compare-${D.id}`],name:D.name,itemStyle:{color:D.color,borderColor:null===(w=D.itemStyle)||void 0===w?void 0:w.borderColor}})}(0,$.RR)(l),this._chartData=l}}},{key:"_processUntracked",value:function(t,e,a,n){var r={};e.forEach(t=>{t.data.forEach(t=>{r[t[n?2:0]]=(r[t[n?2:0]]||0)+t[1]})});var i=(0,$.ok)(this._start,this._compareStart),o=[];Object.keys(a.used_total).sort((t,e)=>Number(t)-Number(e)).forEach(t=>{var e=Number(t),s=[e,a.used_total[t]-(r[t]||0)];n&&(s[2]=s[0],s[0]=i(new Date(e)).getTime()),o.push(s)});var s=Date.now();return{type:"bar",cursor:"default",id:n?`compare-untracked-${s}`:`untracked-${s}`,name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_detail_graph.untracked_consumption"),itemStyle:{borderColor:(0,g.g)(t,this.hass.themes.darkMode,!1,n,"--history-unknown-color")},barMaxWidth:50,color:(0,g.g)(t,this.hass.themes.darkMode,!0,n,"--history-unknown-color"),data:o,stack:n?"devicesCompare":"devices"}}},{key:"_processDataSet",value:function(t,e,a,n,i,o){var s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=[],d=(0,$.ok)(this._start,this._compareStart);return n.forEach((n,l)=>{var u,h=i.indexOf(n.stat_consumption);if(null!==(u=this._config)&&void 0!==u&&u.max_devices&&h>=this._config.max_devices)console.warn(`Max devices exceeded for ${n.name} (${h} >= ${this._config.max_devices})`);else{var p=(0,m.fI)(l,t),f=null,_=[];if(n.stat_consumption in e){var v,g=e[n.stat_consumption],y=(0,r.A)(g);try{var b=function(){var t=v.value;if(null===t.change||void 0===t.change||0===t.change)return 0;if(f===t.start)return 0;var a=0;(o[n.stat_consumption]||[]).forEach(n=>{var r,i=e[n];a+=(null==i||null===(r=i.find(e=>e.start===t.start))||void 0===r?void 0:r.change)||0});var r=[t.start,t.change-a];s&&(r[2]=r[0],r[0]=d(new Date(t.start)).getTime()),_.push(r),f=t.start};for(y.s();!(v=y.n()).done;)b()}catch(C){y.e(C)}finally{y.f()}}var S=(n.name||(0,k.$O)(this.hass,n.stat_consumption,a[n.stat_consumption]))+(n.stat_consumption in o?` (${this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_detail_graph.untracked")})`:"");c.push({type:"bar",cursor:"default",id:s?`compare-${n.stat_consumption}-${h}`:`${n.stat_consumption}-${h}`,name:S,itemStyle:{borderColor:s?p+"7F":p},barMaxWidth:50,color:s?p+"32":p+"7F",data:_,stack:s?"devicesCompare":"devices"})}}),i.map(t=>c.find(e=>this._getStatIdFromId(e.id)===t)).filter(Boolean)}},{key:"_getStatIdFromId",value:function(t){return t.replace(/^compare-/,"").replace(/-\d+$/,"")}}])}((0,S.E)(p.WF));O.styles=(0,p.AH)(E||(E=M`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}`)),(0,l.__decorate)([(0,f.MZ)({attribute:!1})],O.prototype,"hass",void 0),(0,l.__decorate)([(0,f.wk)()],O.prototype,"_config",void 0),(0,l.__decorate)([(0,f.wk)()],O.prototype,"_chartData",void 0),(0,l.__decorate)([(0,f.wk)()],O.prototype,"_data",void 0),(0,l.__decorate)([(0,f.wk)()],O.prototype,"_legendData",void 0),(0,l.__decorate)([(0,f.wk)()],O.prototype,"_start",void 0),(0,l.__decorate)([(0,f.wk)()],O.prototype,"_end",void 0),(0,l.__decorate)([(0,f.wk)()],O.prototype,"_compareStart",void 0),(0,l.__decorate)([(0,f.wk)()],O.prototype,"_compareEnd",void 0),(0,l.__decorate)([(0,f.wk)(),(0,w.I)({key:"energy-devices-hidden-stats",state:!0,subscribe:!1})],O.prototype,"_hiddenStats",void 0),O=(0,l.__decorate)([(0,f.EM)("hui-energy-devices-detail-graph-card")],O),n()}catch(R){n(R)}})},74758:function(t,e,a){a.d(e,{o:function(){return o}});var n=a(48869),r=a(27554),i=a(28829);function o(t,e,a){var o=(0,i.b)(t,e)/r.Cg;return(0,n.u)(null==a?void 0:a.roundingMethod)(o)}},76174:function(t,e,a){a.d(e,{o:function(){return r}});var n=a(3313);function r(t){return(0,n.D)(Date.now(),t)}},30765:function(t,e,a){a.d(e,{R:function(){return r}});var n=a(70162);function r(t){return(0,n.o)(Date.now(),t)}}}]);
//# sourceMappingURL=3504.2b5fdffdd6a7d4e1.js.map