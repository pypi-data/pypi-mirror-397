"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["83673"],{6418:function(e,t,i){i.a(e,async function(e,a){try{i.r(t),i.d(t,{HaIconOverflowMenu:function(){return w}});var s=i(62020),o=i(31802),n=i(21101),r=i(23180),l=(i(38606),i(80178),i(65315),i(37089),i(45519),i(69868)),c=i(84922),d=i(11991),h=i(75907),u=i(50809),p=(i(19912),i(9058),i(86160),i(7245)),_=(i(92409),i(28565),e([p]));p=(_.then?(await _)():_)[0];var f,v,g,y,m,b,$,A,k=e=>e,w=function(e){function t(){var e;(0,s.A)(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=(0,n.A)(this,t,[].concat(a))).items=[],e.narrow=!1,e}return(0,r.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return 0===this.items.length?c.s6:(0,c.qy)(f||(f=k` ${0} `),this.narrow?(0,c.qy)(v||(v=k` <ha-md-button-menu @click="${0}" positioning="popover"> <ha-icon-button .label="${0}" .path="${0}" slot="trigger"></ha-icon-button> ${0} </ha-md-button-menu>`),this._handleIconOverflowMenuOpened,this.hass.localize("ui.common.overflow_menu"),"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",this.items.map(e=>e.divider?(0,c.qy)(g||(g=k`<ha-md-divider role="separator" tabindex="-1"></ha-md-divider>`)):(0,c.qy)(y||(y=k`<ha-md-menu-item ?disabled="${0}" .clickAction="${0}" class="${0}"> <ha-svg-icon slot="start" class="${0}" .path="${0}"></ha-svg-icon> ${0} </ha-md-menu-item> `),e.disabled,e.action,(0,h.H)({warning:Boolean(e.warning)}),(0,h.H)({warning:Boolean(e.warning)}),e.path,e.label))):(0,c.qy)(m||(m=k` ${0} `),this.items.map(e=>{var t;return e.narrowOnly?c.s6:e.divider?(0,c.qy)(b||(b=k`<div role="separator"></div>`)):(0,c.qy)($||($=k`<ha-tooltip .disabled="${0}" .for="icon-button-${0}">${0} </ha-tooltip><ha-icon-button .id="icon-button-${0}" @click="${0}" .label="${0}" .path="${0}" ?disabled="${0}"></ha-icon-button> `),!e.tooltip,e.label,null!==(t=e.tooltip)&&void 0!==t?t:"",e.label,e.action,e.label,e.path,e.disabled)})))}},{key:"_handleIconOverflowMenuOpened",value:function(e){e.stopPropagation()}}],[{key:"styles",get:function(){return[u.RF,(0,c.AH)(A||(A=k`:host{display:flex;justify-content:flex-end}div[role=separator]{border-right:1px solid var(--divider-color);width:1px}`))]}}])}(c.WF);(0,l.__decorate)([(0,d.MZ)({attribute:!1})],w.prototype,"hass",void 0),(0,l.__decorate)([(0,d.MZ)({type:Array})],w.prototype,"items",void 0),(0,l.__decorate)([(0,d.MZ)({type:Boolean})],w.prototype,"narrow",void 0),w=(0,l.__decorate)([(0,d.EM)("ha-icon-overflow-menu")],w),a()}catch(C){a(C)}})},36951:function(e,t,i){i.a(e,async function(e,t){try{var a=i(98735),s=i(88486),o=i(62020),n=i(31802),r=i(21101),l=i(23180),c=(i(1415),i(32203),i(38606),i(69868)),d=i(84922),h=i(11991),u=i(44017),p=(i(10547),i(56657),i(27161)),_=i(954),f=i(21829),v=e([f]);f=(v.then?(await v)():v)[0];var g,y,m,b=e=>e,$=function(e){function t(){var e;(0,o.A)(this,t);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=(0,r.A)(this,t,[].concat(a))).saving=!1,e.dirty=!1,e}return(0,l.A)(t,e),(0,n.A)(t,[{key:"_config",get:function(){return this.config}},{key:"render",value:function(){return(0,d.qy)(g||(g=b` ${0} ${0} <ha-fab slot="fab" class="${0}" .label="${0}" .disabled="${0}" extended @click="${0}"> <ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon> </ha-fab> `),this.config.description?(0,d.qy)(y||(y=b`<ha-markdown class="description" breaks .content="${0}"></ha-markdown>`),this.config.description):d.s6,this.renderCard(),this.dirty?"dirty":"",this.hass.localize("ui.common.save"),this.saving,this._saveScript,"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z")}},{key:"_saveScript",value:function(){(0,u.r)(this,"save-script")}},{key:"_getBlueprints",value:(i=(0,s.A)((0,a.A)().m(function e(){return(0,a.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,p.Xg)(this.hass,"script");case 1:this._blueprints=e.v;case 2:return e.a(2)}},e,this)})),function(){return i.apply(this,arguments)})}],[{key:"styles",get:function(){return[f.D.styles,_.T_,(0,d.AH)(m||(m=b`:host{position:relative;height:100%;min-height:calc(100vh - 85px);min-height:calc(100dvh - 85px)}ha-fab{position:fixed}`))]}}]);var i}(f.D);(0,c.__decorate)([(0,h.MZ)({attribute:!1})],$.prototype,"config",void 0),(0,c.__decorate)([(0,h.MZ)({type:Boolean})],$.prototype,"saving",void 0),(0,c.__decorate)([(0,h.MZ)({type:Boolean})],$.prototype,"dirty",void 0),$=(0,c.__decorate)([(0,h.EM)("blueprint-script-editor")],$),t()}catch(A){t(A)}})},78080:function(e,t,i){i.a(e,async function(e,a){try{i.r(t);var s=i(62020),o=i(31802),n=i(21101),r=i(23180),l=i(87426),c=(i(38606),i(96956),i(35748),i(98522),i(65315),i(12840),i(837),i(45519),i(74774),i(5934),i(95013),i(69868)),d=i(97809),h=i(11991),u=i(65940),p=i(12275),_=i(51849),f=i(32293),v=i(69134),g=i(72421),y=i(31786),m=e([g,y]);[g,y]=m.then?(await m)():m;var b=function(e){function t(){var e;(0,s.A)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=(0,n.A)(this,t,[].concat(o))).narrow=!1,e.isWide=!1,e.showAdvanced=!1,e.scripts=[],e.routerOptions={defaultPage:"dashboard",routes:{dashboard:{tag:"ha-script-picker",cache:!0},edit:{tag:"ha-script-editor"},show:{tag:"ha-script-editor"},trace:{tag:"ha-script-trace",load:()=>Promise.all([i.e("12265"),i.e("14632"),i.e("32888")]).then(i.bind(i,34667))}}},e._debouncedUpdateScripts=(0,_.s)(t=>{var i,a,s=e._getScripts(e.hass.states);i=s,a=t.scripts,i.length===a.length&&i.every((e,t)=>e===a[t])||(t.scripts=s)},10),e._getScripts=(0,u.A)(e=>Object.values(e).filter(e=>"script"===(0,p.t)(e)&&!e.attributes.restored)),e}return(0,r.A)(t,e),(0,o.A)(t,[{key:"firstUpdated",value:function(e){(0,l.A)(t,"firstUpdated",this,3)([e]),this.hass.loadBackendTranslation("device_automation")}},{key:"updatePageEl",value:function(e,t){if(e.hass=this.hass,e.narrow=this.narrow,e.isWide=this.isWide,e.route=this.routeTail,e.showAdvanced=this.showAdvanced,e.entityRegistry=this._entityReg,this.hass&&(e.scripts&&t?t.has("hass")&&this._debouncedUpdateScripts(e):e.scripts=this._getScripts(this.hass.states)),t&&!t.has("route")||"show"!==this._currentPage){if((!t||t.has("route"))&&"dashboard"!==this._currentPage){e.creatingNew=void 0;var i=this.routeTail.path.slice(1);e.scriptId="new"===i?null:i}}else{e.creatingNew=void 0;var a=this.routeTail.path.slice(1);e.entityId="new"===a?null:a}}}])}(v.a);(0,c.__decorate)([(0,h.MZ)({attribute:!1})],b.prototype,"hass",void 0),(0,c.__decorate)([(0,h.MZ)({type:Boolean})],b.prototype,"narrow",void 0),(0,c.__decorate)([(0,h.MZ)({attribute:"is-wide",type:Boolean})],b.prototype,"isWide",void 0),(0,c.__decorate)([(0,h.MZ)({attribute:!1})],b.prototype,"showAdvanced",void 0),(0,c.__decorate)([(0,h.MZ)({attribute:!1})],b.prototype,"scripts",void 0),(0,c.__decorate)([(0,h.wk)(),(0,d.Fg)({context:f.ih,subscribe:!0})],b.prototype,"_entityReg",void 0),b=(0,c.__decorate)([(0,h.EM)("ha-config-script")],b),a()}catch($){a($)}})},72421:function(e,t,i){i.a(e,async function(e,t){try{var a=i(15243),s=i(98735),o=i(88486),n=i(62020),r=i(31802),l=i(97750),c=i(21101),d=i(23180),h=i(87426),u=(i(1415),i(32203),i(46852),i(38606),i(44941),i(80178),i(65315),i(84136),i(37089),i(59023),i(29726),i(45519),i(5934),i(47849),i(69868)),p=i(97809),_=i(84922),f=i(11991),v=i(75907),g=i(44017),y=i(77240),m=i(63870),b=i(73619),$=i(54337),A=i(17372),k=(i(78918),i(10547),i(61646)),w=(i(9058),i(77510),i(86160),i(6345)),C=i(27161),H=i(40550),x=i(32293),M=i(14523),V=i(59569),S=i(42699),z=i(15241),q=i(81579),L=(i(41564),i(79370)),R=i(81061),I=i(40328),O=i(1797),E=i(50809),Z=i(40980),P=i(91197),j=i(31208),F=i(47503),U=i(31494),B=i(36951),W=i(75320),T=i(12707),D=e([A,w,B,W]);[A,w,B,W]=D.then?(await D)():D;var K,Y,N,G,X,Q,J,ee,te,ie,ae,se,oe,ne,re,le,ce,de,he,ue,pe,_e,fe,ve=e=>e,ge="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z",ye="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z",me=function(e){function t(){var e;(0,n.A)(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(e=(0,c.A)(this,t,[].concat(a))).scriptId=null,e.entityId=null,e.isWide=!1,e.narrow=!1,e._dirty=!1,e._mode="gui",e._readOnly=!1,e._saving=!1,e._undoRedoController=new O.X((0,l.A)(e),{apply:t=>e._applyUndoRedo(t),currentConfig:()=>e._config}),e._backTapped=(0,o.A)((0,s.A)().m(function t(){return(0,s.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,e._confirmUnsavedChanged();case 1:t.v&&(0,$.m)(()=>(0,y.O)("/config"));case 2:return t.a(2)}},t)})),e}return(0,d.A)(t,e),(0,r.A)(t,[{key:"willUpdate",value:function(e){if((0,h.A)(t,"willUpdate",this,3)([e]),this._entityRegCreated&&this._newScriptId&&e.has("entityRegistry")){var i=this.entityRegistry.find(e=>"script"===e.platform&&e.unique_id===this._newScriptId);i&&(this._entityRegCreated(i),this._entityRegCreated=void 0)}}},{key:"render",value:function(){var e;if(!this._config)return _.s6;var t=this._entityId?this.hass.states[this._entityId]:void 0,i="use_blueprint"in this._config,a=Z.c?(0,_.qy)(K||(K=ve`<ha-svg-icon .path="${0}"></ha-svg-icon>`),"M6,2A4,4 0 0,1 10,6V8H14V6A4,4 0 0,1 18,2A4,4 0 0,1 22,6A4,4 0 0,1 18,10H16V14H18A4,4 0 0,1 22,18A4,4 0 0,1 18,22A4,4 0 0,1 14,18V16H10V18A4,4 0 0,1 6,22A4,4 0 0,1 2,18A4,4 0 0,1 6,14H8V10H6A4,4 0 0,1 2,6A4,4 0 0,1 6,2M16,18A2,2 0 0,0 18,20A2,2 0 0,0 20,18A2,2 0 0,0 18,16H16V18M14,10H10V14H14V10M6,16A2,2 0 0,0 4,18A2,2 0 0,0 6,20A2,2 0 0,0 8,18V16H6M8,6A2,2 0 0,0 6,4A2,2 0 0,0 4,6A2,2 0 0,0 6,8H8V6M18,8A2,2 0 0,0 20,6A2,2 0 0,0 18,4A2,2 0 0,0 16,6V8H18Z"):this.hass.localize("ui.panel.config.automation.editor.ctrl");return(0,_.qy)(Y||(Y=ve` <hass-subpage .hass="${0}" .narrow="${0}" .route="${0}" .backCallback="${0}" .header="${0}"> ${0} ${0} <ha-button-menu slot="toolbar-icon"> <ha-icon-button slot="trigger" .label="${0}" .path="${0}"></ha-icon-button> ${0} <ha-list-item graphic="icon" .disabled="${0}" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> <ha-list-item graphic="icon" .disabled="${0}" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> <ha-list-item graphic="icon" .disabled="${0}" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> <ha-list-item graphic="icon" .disabled="${0}" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> ${0} ${0} <ha-list-item graphic="icon" @click="${0}" .disabled="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> ${0} <ha-list-item .disabled="${0}" graphic="icon" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> ${0} <ha-list-item graphic="icon" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> <li divider role="separator"></li> <ha-list-item .disabled="${0}" class="${0}" graphic="icon" @click="${0}"> ${0} <ha-svg-icon class="${0}" slot="graphic" .path="${0}"> </ha-svg-icon> </ha-list-item> </ha-button-menu> <div class="${0}"> ${0} </div> </hass-subpage> `),this.hass,this.narrow,this.route,this._backTapped,this._config.alias||this.hass.localize("ui.panel.config.script.editor.default_name"),"gui"!==this._mode||this.narrow?_.s6:(0,_.qy)(N||(N=ve`<ha-icon-button slot="toolbar-icon" .label="${0}" .path="${0}" @click="${0}" .disabled="${0}" id="button-undo"> </ha-icon-button> <ha-tooltip placement="bottom" for="button-undo"> ${0} <span class="shortcut"> (<span>${0}</span> <span>+</span> <span>Z</span>) </span> </ha-tooltip> <ha-icon-button slot="toolbar-icon" .label="${0}" .path="${0}" @click="${0}" .disabled="${0}" id="button-redo"> </ha-icon-button> <ha-tooltip placement="bottom" for="button-redo"> ${0} <span class="shortcut">( ${0}) </span> </ha-tooltip>`),this.hass.localize("ui.common.undo"),ye,this._undo,!this._undoRedoController.canUndo,this.hass.localize("ui.common.undo"),a,this.hass.localize("ui.common.redo"),ge,this._redo,!this._undoRedoController.canRedo,this.hass.localize("ui.common.redo"),Z.c?(0,_.qy)(G||(G=ve`<span>${0}</span> <span>+</span> <span>Shift</span> <span>+</span> <span>Z</span>`),a):(0,_.qy)(X||(X=ve`<span>${0}</span> <span>+</span> <span>Y</span>`),a)),this.scriptId&&!this.narrow?(0,_.qy)(Q||(Q=ve` <ha-button appearance="plain" @click="${0}" slot="toolbar-icon"> ${0} </ha-button> `),this._showTrace,this.hass.localize("ui.panel.config.script.editor.show_trace")):"",this.hass.localize("ui.common.menu"),"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z","gui"===this._mode&&this.narrow?(0,_.qy)(J||(J=ve`<ha-list-item graphic="icon" @click="${0}" .disabled="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> <ha-list-item graphic="icon" @click="${0}" .disabled="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item>`),this._undo,!this._undoRedoController.canUndo,this.hass.localize("ui.common.undo"),ye,this._redo,!this._undoRedoController.canRedo,this.hass.localize("ui.common.redo"),ge):_.s6,!this.scriptId,this._showInfo,this.hass.localize("ui.panel.config.script.editor.show_info"),"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z",!t,this._showSettings,this.hass.localize("ui.panel.config.automation.picker.show_settings"),"M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z",!t,this._editCategory,this.hass.localize("ui.panel.config.scene.picker."+(null!==(e=this._registryEntry)&&void 0!==e&&null!==(e=e.categories)&&void 0!==e&&e.script?"edit_category":"assign_category")),"M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M21.41,11.58L12.41,2.58C12.05,2.22 11.55,2 11,2H4C2.89,2 2,2.89 2,4V11C2,11.55 2.22,12.05 2.59,12.41L11.58,21.41C11.95,21.77 12.45,22 13,22C13.55,22 14.05,21.77 14.41,21.41L21.41,14.41C21.78,14.05 22,13.55 22,13C22,12.44 21.77,11.94 21.41,11.58Z",!this.scriptId,this._runScript,this.hass.localize("ui.panel.config.script.picker.run_script"),"M8,5.14V19.14L19,12.14L8,5.14Z",this.scriptId&&this.narrow?(0,_.qy)(ee||(ee=ve` <a href="/config/script/trace/${0}"> <ha-list-item graphic="icon"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> </a> `),this.scriptId,this.hass.localize("ui.panel.config.script.editor.show_trace"),"M15,12C15,10.7 14.16,9.6 13,9.18V6.82C14.16,6.4 15,5.3 15,4A3,3 0 0,0 12,1A3,3 0 0,0 9,4C9,5.3 9.84,6.4 11,6.82V9.19C9.84,9.6 9,10.7 9,12C9,13.3 9.84,14.4 11,14.82V17.18C9.84,17.6 9,18.7 9,20A3,3 0 0,0 12,23A3,3 0 0,0 15,20C15,18.7 14.16,17.6 13,17.18V14.82C14.16,14.4 15,13.3 15,12M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M12,21A1,1 0 0,1 11,20A1,1 0 0,1 12,19A1,1 0 0,1 13,20A1,1 0 0,1 12,21Z"):_.s6,i||"fields"in this._config?_.s6:(0,_.qy)(te||(te=ve` <ha-list-item graphic="icon" .disabled="${0}" @click="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> `),this._readOnly||"yaml"===this._mode,this._addFields,this.hass.localize("ui.panel.config.script.editor.field.add_fields"),"M17,7H22V17H17V19A1,1 0 0,0 18,20H20V22H17.5C16.95,22 16,21.55 16,21C16,21.55 15.05,22 14.5,22H12V20H14A1,1 0 0,0 15,19V5A1,1 0 0,0 14,4H12V2H14.5C15.05,2 16,2.45 16,3C16,2.45 16.95,2 17.5,2H20V4H18A1,1 0 0,0 17,5V7M2,7H13V9H4V15H13V17H2V7M20,15V9H17V15H20Z"),this._promptScriptAlias,!this.scriptId||this._readOnly||"yaml"===this._mode,this.hass.localize("ui.panel.config.script.editor.rename"),"M18,17H10.5L12.5,15H18M6,17V14.5L13.88,6.65C14.07,6.45 14.39,6.45 14.59,6.65L16.35,8.41C16.55,8.61 16.55,8.92 16.35,9.12L8.47,17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z",i?_.s6:(0,_.qy)(ie||(ie=ve` <ha-list-item graphic="icon" @click="${0}" .disabled="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> `),this._promptScriptMode,this._readOnly||"yaml"===this._mode,this.hass.localize("ui.panel.config.script.editor.change_mode"),"M12,14A2,2 0 0,1 14,16A2,2 0 0,1 12,18A2,2 0 0,1 10,16A2,2 0 0,1 12,14M23.46,8.86L21.87,15.75L15,14.16L18.8,11.78C17.39,9.5 14.87,8 12,8C8.05,8 4.77,10.86 4.12,14.63L2.15,14.28C2.96,9.58 7.06,6 12,6C15.58,6 18.73,7.89 20.5,10.72L23.46,8.86Z"),this._blueprintConfig||!this._readOnly&&!this.scriptId,this._duplicate,this.hass.localize(this._readOnly?"ui.panel.config.script.editor.migrate":"ui.panel.config.script.editor.duplicate"),"M16,8H14V11H11V13H14V16H16V13H19V11H16M2,12C2,9.21 3.64,6.8 6,5.68V3.5C2.5,4.76 0,8.09 0,12C0,15.91 2.5,19.24 6,20.5V18.32C3.64,17.2 2,14.79 2,12M15,3C10.04,3 6,7.04 6,12C6,16.96 10.04,21 15,21C19.96,21 24,16.96 24,12C24,7.04 19.96,3 15,3M15,19C11.14,19 8,15.86 8,12C8,8.14 11.14,5 15,5C18.86,5 22,8.14 22,12C22,15.86 18.86,19 15,19Z",i?(0,_.qy)(ae||(ae=ve` <ha-list-item graphic="icon" @click="${0}" .disabled="${0}"> ${0} <ha-svg-icon slot="graphic" .path="${0}"></ha-svg-icon> </ha-list-item> `),this._takeControl,this._readOnly,this.hass.localize("ui.panel.config.script.editor.take_control"),"M6 2C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H10V20.1L20 10.1V8L14 2H6M13 3.5L18.5 9H13V3.5M20.1 13C20 13 19.8 13.1 19.7 13.2L18.7 14.2L20.8 16.3L21.8 15.3C22 15.1 22 14.7 21.8 14.5L20.5 13.2C20.4 13.1 20.3 13 20.1 13M18.1 14.8L12 20.9V23H14.1L20.2 16.9L18.1 14.8Z"):_.s6,"gui"===this._mode?this._switchYamlMode:this._switchUiMode,this.hass.localize("ui.panel.config.automation.editor.edit_"+("gui"===this._mode?"yaml":"ui")),"M3 6V8H14V6H3M3 10V12H14V10H3M20 10.1C19.9 10.1 19.7 10.2 19.6 10.3L18.6 11.3L20.7 13.4L21.7 12.4C21.9 12.2 21.9 11.8 21.7 11.6L20.4 10.3C20.3 10.2 20.2 10.1 20 10.1M18.1 11.9L12 17.9V20H14.1L20.2 13.9L18.1 11.9M3 14V16H10V14H3Z",this._readOnly||!this.scriptId,(0,v.H)({warning:Boolean(this.scriptId)}),this._deleteConfirm,this.hass.localize("ui.panel.config.script.picker.delete"),(0,v.H)({warning:Boolean(this.scriptId)}),"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z","yaml"===this._mode?"yaml-mode":"","gui"===this._mode?(0,_.qy)(se||(se=ve` <div> ${0} </div> `),i?(0,_.qy)(oe||(oe=ve` <blueprint-script-editor .hass="${0}" .narrow="${0}" .isWide="${0}" .config="${0}" .disabled="${0}" .saving="${0}" .dirty="${0}" @value-changed="${0}" @save-script="${0}"></blueprint-script-editor> `),this.hass,this.narrow,this.isWide,this._config,this._readOnly,this._saving,this._dirty,this._valueChanged,this._handleSaveScript):(0,_.qy)(ne||(ne=ve` <manual-script-editor .hass="${0}" .narrow="${0}" .isWide="${0}" .config="${0}" .disabled="${0}" .dirty="${0}" .saving="${0}" @value-changed="${0}" @editor-save="${0}" @save-script="${0}"> <div class="alert-wrapper" slot="alerts"> ${0} ${0} </div> </manual-script-editor> `),this.hass,this.narrow,this.isWide,this._config,this._readOnly,this._dirty,this._saving,this._valueChanged,this._handleSaveScript,this._handleSaveScript,this._errors||(null==t?void 0:t.state)===M.Hh?(0,_.qy)(re||(re=ve`<ha-alert alert-type="error" .title="${0}"> ${0} ${0} </ha-alert>`),(null==t?void 0:t.state)===M.Hh?this.hass.localize("ui.panel.config.script.editor.unavailable"):void 0,this._errors||this._validationErrors,(null==t?void 0:t.state)===M.Hh?(0,_.qy)(le||(le=ve`<ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon>`),"M20 4H18V3H20.5C20.78 3 21 3.22 21 3.5V5.5C21 5.78 20.78 6 20.5 6H20V7H19V5H20V4M19 9H20V8H19V9M17 3H16V7H17V3M23 15V18C23 18.55 22.55 19 22 19H21V20C21 21.11 20.11 22 19 22H5C3.9 22 3 21.11 3 20V19H2C1.45 19 1 18.55 1 18V15C1 14.45 1.45 14 2 14H3C3 10.13 6.13 7 10 7H11V5.73C10.4 5.39 10 4.74 10 4C10 2.9 10.9 2 12 2S14 2.9 14 4C14 4.74 13.6 5.39 13 5.73V7H14C14.34 7 14.67 7.03 15 7.08V10H19.74C20.53 11.13 21 12.5 21 14H22C22.55 14 23 14.45 23 15M10 15.5C10 14.12 8.88 13 7.5 13S5 14.12 5 15.5 6.12 18 7.5 18 10 16.88 10 15.5M19 15.5C19 14.12 17.88 13 16.5 13S14 14.12 14 15.5 15.12 18 16.5 18 19 16.88 19 15.5M17 8H16V9H17V8Z"):_.s6):_.s6,this._blueprintConfig?(0,_.qy)(ce||(ce=ve`<ha-alert alert-type="info"> ${0} <div slot="action" style="display:flex"> <ha-button appearance="plain" @click="${0}">${0}</ha-button> <ha-button appearance="plain" @click="${0}">${0}</ha-button> </div> </ha-alert>`),this.hass.localize("ui.panel.config.script.editor.confirm_take_control"),this._takeControlSave,this.hass.localize("ui.common.yes"),this._revertBlueprint,this.hass.localize("ui.common.no")):this._readOnly?(0,_.qy)(de||(de=ve`<ha-alert alert-type="warning" dismissable>${0} <ha-button appearance="plain" slot="action" @click="${0}"> ${0} </ha-button> </ha-alert>`),this.hass.localize("ui.panel.config.script.editor.read_only"),this._duplicate,this.hass.localize("ui.panel.config.script.editor.migrate")):_.s6)):"yaml"===this._mode?(0,_.qy)(he||(he=ve`<ha-yaml-editor .hass="${0}" .defaultValue="${0}" .readOnly="${0}" disable-fullscreen @value-changed="${0}" @editor-save="${0}" .showErrors="${0}"></ha-yaml-editor> <ha-fab slot="fab" class="${0}" .label="${0}" .disabled="${0}" extended @click="${0}"> <ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon> </ha-fab>`),this.hass,this._preprocessYaml(),this._readOnly,this._yamlChanged,this._handleSaveScript,!1,!this._readOnly&&this._dirty?"dirty":"",this.hass.localize("ui.common.save"),this._saving,this._handleSaveScript,"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"):_.s6)}},{key:"updated",value:function(e){(0,h.A)(t,"updated",this,3)([e]);var i=e.get("scriptId");if(!e.has("scriptId")||!this.scriptId||this.entityId||!this.hass||i&&i===this.scriptId||this._loadConfig(),(e.has("scriptId")||e.has("entityRegistry"))&&this.scriptId&&this.entityRegistry){var a=this.entityRegistry.find(e=>"script"===e.platform&&e.unique_id===this.scriptId);this._entityId=null==a?void 0:a.entity_id}if(e.has("scriptId")&&!this.scriptId&&this.hass){var s=(0,S.NX)();this._dirty=!!s;var o={};s&&"use_blueprint"in s||(o.sequence=[]),this._config=Object.assign(Object.assign({},o),s),this._readOnly=!1}if(e.has("entityId")&&this.entityId){(0,S.R$)(this.hass,this.entityId).then(e=>{this._config=(0,S.nB)(e.config),this._checkValidation()});var n=this.entityRegistry.find(e=>e.entity_id===this.entityId);null!=n&&n.unique_id&&(this.scriptId=n.unique_id),this._entityId=this.entityId,this._dirty=!1,this._readOnly=!0}}},{key:"_checkValidation",value:(be=(0,o.A)((0,s.A)().m(function e(){var t,i;return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:if(this._validationErrors=void 0,this._entityId&&this._config){e.n=1;break}return e.a(2);case 1:if((null==(t=this.hass.states[this._entityId])?void 0:t.state)===M.Hh){e.n=2;break}return e.a(2);case 2:return e.n=3,(0,H.$)(this.hass,{actions:this._config.sequence});case 3:i=e.v,this._validationErrors=Object.entries(i).map(e=>{var t=(0,a.A)(e,2),i=t[0],s=t[1];return s.valid?"":(0,_.qy)(ue||(ue=ve`${0}: ${0}<br>`),this.hass.localize(`ui.panel.config.automation.editor.${i}.name`),s.error)});case 4:return e.a(2)}},e,this)})),function(){return be.apply(this,arguments)})},{key:"_loadConfig",value:(me=(0,o.A)((0,s.A)().m(function e(){return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:(0,S.Kq)(this.hass,this.scriptId).then(e=>{this._dirty=!1,this._readOnly=!1,this._config=(0,S.nB)(e);var t=this.entityRegistry.find(e=>"script"===e.platform&&e.unique_id===this.scriptId);this._entityId=null==t?void 0:t.entity_id,this._checkValidation()},e=>{var t=this.entityRegistry.find(e=>"script"===e.platform&&e.unique_id===this.scriptId);t?(0,y.o)(`/config/script/show/${t.entity_id}`,{replace:!0}):(alert(404===e.status_code?this.hass.localize("ui.panel.config.script.editor.load_error_not_editable"):this.hass.localize("ui.panel.config.script.editor.load_error_unknown",{err_no:e.status_code||e.code})),(0,y.O)("/config"))});case 1:return e.a(2)}},e,this)})),function(){return me.apply(this,arguments)})},{key:"_valueChanged",value:function(e){this._config&&this._undoRedoController.commit(this._config),this._config=e.detail.value,this._errors=void 0,this._dirty=!0}},{key:"_runScript",value:(D=(0,o.A)((0,s.A)().m(function e(t){return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:if(t.stopPropagation(),!(0,S.TP)(this.hass,this._entityId)){e.n=1;break}return(0,q.p)(this,{entityId:this._entityId}),e.a(2);case 1:return e.n=2,(0,S.kR)(this.hass,this.scriptId);case 2:(0,P.P)(this,{message:this.hass.localize("ui.notification_toast.triggered",{name:this._config.alias})});case 3:return e.a(2)}},e,this)})),function(e){return D.apply(this,arguments)})},{key:"_showSettings",value:function(){(0,q.p)(this,{entityId:this._entityId,view:"settings"})}},{key:"_editCategory",value:function(){this._registryEntry?(0,U.j)(this,{scope:"script",entityReg:this._registryEntry}):(0,z.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.scene.picker.no_category_support"),text:this.hass.localize("ui.panel.config.scene.picker.no_category_entity_reg")})}},{key:"_computeEntityIdFromAlias",value:function(e){for(var t=(0,m.Y)(e),i=t,a=2;this._idIsUsed(i);)i=`${t}_${a}`,a++;return i}},{key:"_idIsUsed",value:function(e){return`script.${e}`in this.hass.states||this.entityRegistry.some(t=>t.unique_id===e)}},{key:"_showInfo",value:(W=(0,o.A)((0,s.A)().m(function e(){var t;return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:if(this.scriptId){e.n=1;break}return e.a(2);case 1:if(t=this.entityRegistry.find(e=>e.unique_id===this.scriptId)){e.n=2;break}return e.a(2);case 2:(0,g.r)(this,"hass-more-info",{entityId:t.entity_id});case 3:return e.a(2)}},e,this)})),function(){return W.apply(this,arguments)})},{key:"_showTrace",value:(B=(0,o.A)((0,s.A)().m(function e(){return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:if(!this.scriptId){e.n=2;break}return e.n=1,this._confirmUnsavedChanged();case 1:e.v&&(0,y.o)(`/config/script/trace/${this.scriptId}`);case 2:return e.a(2)}},e,this)})),function(){return B.apply(this,arguments)})},{key:"_addFields",value:function(){var e;"fields"in this._config||(this._config&&this._undoRedoController.commit(this._config),null===(e=this._manualEditor)||void 0===e||e.addFields(),this._dirty=!0)}},{key:"_preprocessYaml",value:function(){return this._config}},{key:"_yamlChanged",value:function(e){e.stopPropagation(),this._dirty=!0,e.detail.isValid?(this._yamlErrors=void 0,this._config=e.detail.value,this._errors=void 0):this._yamlErrors=e.detail.errorMsg}},{key:"_confirmUnsavedChanged",value:(I=(0,o.A)((0,s.A)().m(function e(){var t=this;return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:if(this._dirty){e.n=1;break}return e.a(2,!0);case 1:return e.a(2,new Promise(e=>{var i;(0,F._)(this,{config:this._config,domain:"script",updateConfig:(i=(0,o.A)((0,s.A)().m(function i(a,o){var n;return(0,s.A)().w(function(i){for(;;)switch(i.p=i.n){case 0:return t._config=a,t._entityRegistryUpdate=o,t._dirty=!0,t.requestUpdate(),n=t.scriptId||String(Date.now()),i.p=1,i.n=2,t._saveScript(n);case 2:i.n=4;break;case 3:return i.p=3,i.v,t.requestUpdate(),e(!1),i.a(2);case 4:e(!0);case 5:return i.a(2)}},i,null,[[1,3]])})),function(e,t){return i.apply(this,arguments)}),onClose:()=>e(!1),onDiscard:()=>e(!0),entityRegistryUpdate:this._entityRegistryUpdate,entityRegistryEntry:this._registryEntry,title:this.hass.localize(this.scriptId?"ui.panel.config.script.editor.leave.unsaved_confirm_title":"ui.panel.config.script.editor.leave.unsaved_new_title"),description:this.hass.localize(this.scriptId?"ui.panel.config.script.editor.leave.unsaved_confirm_text":"ui.panel.config.script.editor.leave.unsaved_new_text"),hideInputs:null!==this.scriptId})}))}},e,this)})),function(){return I.apply(this,arguments)})},{key:"_takeControl",value:(R=(0,o.A)((0,s.A)().m(function e(){var t,i,a,o,n;return(0,s.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=this._config,e.p=1,e.n=2,(0,C.oz)(this.hass,"script",t.use_blueprint.path,t.use_blueprint.input||{});case 2:i=e.v,a=Object.assign(Object.assign({},(0,S.nB)(i.substituted_config)),{},{alias:t.alias,description:t.description}),this._blueprintConfig=t,this._config=a,"yaml"===this._mode&&(null===(o=this.renderRoot.querySelector("ha-yaml-editor"))||void 0===o||o.setValue(this._config)),this._readOnly=!0,this._errors=void 0,e.n=4;break;case 3:e.p=3,n=e.v,this._errors=n.message;case 4:return e.a(2)}},e,this,[[1,3]])})),function(){return R.apply(this,arguments)})},{key:"_revertBlueprint",value:function(){var e;(this._config=this._blueprintConfig,"yaml"===this._mode)&&(null===(e=this.renderRoot.querySelector("ha-yaml-editor"))||void 0===e||e.setValue(this._config));this._blueprintConfig=void 0,this._readOnly=!1}},{key:"_takeControlSave",value:function(){this._readOnly=!1,this._dirty=!0,this._blueprintConfig=void 0}},{key:"_duplicate",value:(L=(0,o.A)((0,s.A)().m(function e(){var t,i,a;return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:if(!this._readOnly){e.n=2;break}return e.n=1,(0,z.dk)(this,{title:this.hass.localize("ui.panel.config.script.picker.migrate_script"),text:this.hass.localize("ui.panel.config.script.picker.migrate_script_description")});case 1:a=e.v,e.n=4;break;case 2:return e.n=3,this._confirmUnsavedChanged();case 3:a=e.v;case 4:a&&(this._entityId=void 0,(0,S.AM)(Object.assign(Object.assign({},this._config),{},{alias:this._readOnly?null===(t=this._config)||void 0===t?void 0:t.alias:`${null===(i=this._config)||void 0===i?void 0:i.alias} (${this.hass.localize("ui.panel.config.script.picker.duplicate")})`})));case 5:return e.a(2)}},e,this)})),function(){return L.apply(this,arguments)})},{key:"_deleteConfirm",value:(x=(0,o.A)((0,s.A)().m(function e(){var t;return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:(0,z.dk)(this,{title:this.hass.localize("ui.panel.config.script.editor.delete_confirm_title"),text:this.hass.localize("ui.panel.config.script.editor.delete_confirm_text",{name:null===(t=this._config)||void 0===t?void 0:t.alias}),confirmText:this.hass.localize("ui.common.delete"),destructive:!0,dismissText:this.hass.localize("ui.common.cancel"),confirm:()=>this._delete()});case 1:return e.a(2)}},e,this)})),function(){return x.apply(this,arguments)})},{key:"_delete",value:(w=(0,o.A)((0,s.A)().m(function e(){return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,S.Ht)(this.hass,this.scriptId);case 1:(0,y.O)("/config");case 2:return e.a(2)}},e,this)})),function(){return w.apply(this,arguments)})},{key:"_switchUiMode",value:(k=(0,o.A)((0,s.A)().m(function e(){return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:if(!this._yamlErrors){e.n=2;break}return e.n=1,(0,z.dk)(this,{text:(0,_.qy)(pe||(pe=ve(_e||(_e=ve`${0}<br><br>${0}`))),this.hass.localize("ui.panel.config.automation.editor.switch_ui_yaml_error"),this._yamlErrors),confirmText:this.hass.localize("ui.common.continue"),destructive:!0,dismissText:this.hass.localize("ui.common.cancel")});case 1:if(e.v){e.n=2;break}return e.a(2);case 2:this._yamlErrors=void 0,this._mode="gui";case 3:return e.a(2)}},e,this)})),function(){return k.apply(this,arguments)})},{key:"_switchYamlMode",value:function(){this._mode="yaml"}},{key:"_promptScriptAlias",value:(A=(0,o.A)((0,s.A)().m(function e(){var t=this;return(0,s.A)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(e=>{var i;(0,F._)(this,{config:this._config,domain:"script",updateConfig:(i=(0,o.A)((0,s.A)().m(function i(a,o){return(0,s.A)().w(function(i){for(;;)switch(i.n){case 0:t._config=a,t._entityRegistryUpdate=o,t._dirty=!0,t.requestUpdate(),e(!0);case 1:return i.a(2)}},i)})),function(e,t){return i.apply(this,arguments)}),onClose:()=>e(!1),entityRegistryUpdate:this._entityRegistryUpdate,entityRegistryEntry:this.entityRegistry.find(e=>e.unique_id===this.scriptId)})}))},e,this)})),function(){return A.apply(this,arguments)})},{key:"_promptScriptMode",value:(f=(0,o.A)((0,s.A)().m(function e(){return(0,s.A)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(e=>{(0,j.e)(this,{config:this._config,updateConfig:t=>{this._config=t,this._dirty=!0,this.requestUpdate(),e()},onClose:()=>e()})}))},e,this)})),function(){return f.apply(this,arguments)})},{key:"_handleSaveScript",value:(p=(0,o.A)((0,s.A)().m(function e(){var t,i;return(0,s.A)().w(function(e){for(;;)switch(e.n){case 0:if(!this._yamlErrors){e.n=1;break}return(0,P.P)(this,{message:this._yamlErrors}),e.a(2);case 1:if(null===(t=this._manualEditor)||void 0===t||t.resetPastedConfig(),this.scriptId){e.n=4;break}return e.n=2,this._promptScriptAlias();case 2:if(e.v){e.n=3;break}return e.a(2);case 3:this._entityId=this._computeEntityIdFromAlias(this._config.alias);case 4:return i=this.scriptId||this._entityId||Date.now(),e.n=5,this._saveScript(i);case 5:this.scriptId||(0,y.o)(`/config/script/edit/${i}`,{replace:!0});case 6:return e.a(2)}},e,this)})),function(){return p.apply(this,arguments)})},{key:"_saveScript",value:(u=(0,o.A)((0,s.A)().m(function e(t){var i,a,o,n,r,l,c,d,h;return(0,s.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return this._saving=!0,void 0===this._entityRegistryUpdate||this.scriptId||(this._newScriptId=t.toString(),i=new Promise(e=>{this._entityRegCreated=e})),e.p=1,e.n=2,this.hass.callApi("POST","config/script/config/"+t,this._config);case 2:if(void 0===this._entityRegistryUpdate){e.n=12;break}if(a=this._entityId,!i){e.n=11;break}return e.p=3,e.n=4,(0,b.h)(5e3,i);case 4:o=e.v,a=o.entity_id,e.n=11;break;case 5:if(e.p=5,c=e.v,a=void 0,!(c instanceof Error&&"TimeoutError"===c.name)){e.n=10;break}return e.n=6,(0,T.j)(this,{savedPromise:i,type:"script"});case 6:return e.p=6,e.n=7,(0,b.h)(0,i);case 7:n=e.v,a=n.entity_id,e.n=9;break;case 8:if(e.p=8,(d=e.v)instanceof Error&&"TimeoutError"===d.name){e.n=9;break}throw d;case 9:e.n=11;break;case 10:throw c;case 11:if(!a){e.n=12;break}return e.n=12,(0,V.G_)(this.hass,a,{categories:{script:this._entityRegistryUpdate.category||null},labels:this._entityRegistryUpdate.labels||[],area_id:this._entityRegistryUpdate.area||null});case 12:this._dirty=!1,e.n=14;break;case 13:throw e.p=13,h=e.v,this._errors=(null===(r=h.body)||void 0===r?void 0:r.message)||h.error||h.body,(0,P.P)(this,{message:(null===(l=h.body)||void 0===l?void 0:l.message)||h.error||h.body}),h;case 14:return e.p=14,this._saving=!1,e.f(14);case 15:return e.a(2)}},e,this,[[6,8],[3,5],[1,13,14,15]])})),function(e){return u.apply(this,arguments)})},{key:"supportedShortcuts",value:function(){return{s:()=>this._handleSaveScript(),c:()=>this._copySelectedRow(),x:()=>this._cutSelectedRow(),Delete:()=>this._deleteSelectedRow(),Backspace:()=>this._deleteSelectedRow(),z:()=>this._undo(),Z:()=>this._redo(),y:()=>this._redo()}}},{key:"isDirty",get:function(){return this._dirty}},{key:"promptDiscardChanges",value:(i=(0,o.A)((0,s.A)().m(function e(){return(0,s.A)().w(function(e){for(;;)if(0===e.n)return e.a(2,this._confirmUnsavedChanged())},e,this)})),function(){return i.apply(this,arguments)})},{key:"_collapseAll",value:function(){var e;null===(e=this._manualEditor)||void 0===e||e.collapseAll()}},{key:"_expandAll",value:function(){var e;null===(e=this._manualEditor)||void 0===e||e.expandAll()}},{key:"_copySelectedRow",value:function(){var e;null===(e=this._manualEditor)||void 0===e||e.copySelectedRow()}},{key:"_cutSelectedRow",value:function(){var e;null===(e=this._manualEditor)||void 0===e||e.cutSelectedRow()}},{key:"_deleteSelectedRow",value:function(){var e;null===(e=this._manualEditor)||void 0===e||e.deleteSelectedRow()}},{key:"_applyUndoRedo",value:function(e){var t;null===(t=this._manualEditor)||void 0===t||t.triggerCloseSidebar(),this._config=e,this._dirty=!0}},{key:"_undo",value:function(){this._undoRedoController.undo()}},{key:"_redo",value:function(){this._undoRedoController.redo()}}],[{key:"styles",get:function(){return[E.RF,(0,_.AH)(fe||(fe=ve`:host{--ha-automation-editor-max-width:var(
            --ha-automation-editor-width,
            1540px
          );--hass-subpage-bottom-inset:0px}.yaml-mode{height:100%;display:flex;flex-direction:column;padding-bottom:0}blueprint-script-editor,manual-script-editor{margin:0 auto;max-width:1040px;padding:28px 20px 0;display:block}:not(.yaml-mode)>.error-wrapper{position:absolute;top:4px;z-index:3;width:100%;display:flex;flex-direction:column;align-items:center}:not(.yaml-mode)>.error-wrapper ha-alert{background-color:var(--card-background-color);box-shadow:0 2px 4px rgba(0,0,0,.2);border-radius:var(--ha-border-radius-sm)}.alert-wrapper{position:sticky;top:-24px;margin-top:-24px;margin-bottom:8px;z-index:1;width:100%;display:flex;flex-direction:column;align-items:center;gap:var(--ha-space-2);pointer-events:none}.alert-wrapper ha-alert{background-color:var(--card-background-color);box-shadow:0 2px 4px rgba(0,0,0,.2);border-radius:var(--ha-border-radius-sm);margin-bottom:0;pointer-events:auto}manual-script-editor{max-width:var(--ha-automation-editor-max-width);padding:0 12px}ha-yaml-editor{flex-grow:1;--actions-border-radius:var(--ha-border-radius-square);--code-mirror-height:100%;min-height:0;display:flex;flex-direction:column}p{margin-bottom:0}span[slot=introduction] a{color:var(--primary-color)}ha-fab{position:fixed;right:16px;bottom:calc(-80px - var(--safe-area-inset-bottom));transition:bottom .3s}ha-fab.dirty{bottom:calc(16px + var(--safe-area-inset-bottom,0px))}li[role=separator]{border-bottom-color:var(--divider-color)}.header{display:flex;margin:16px 0;align-items:center}.header .name{font-size:var(--ha-font-size-xl);font-weight:var(--ha-font-weight-normal);flex:1}.header a{color:var(--secondary-text-color)}ha-button-menu a{text-decoration:none;color:var(--primary-color)}ha-tooltip ha-svg-icon{width:12px}ha-tooltip .shortcut{display:inline-flex;flex-direction:row;align-items:center;gap:2px}`))]}}]);var i,u,p,f,A,k,w,x,L,R,I,B,W,D,me,be}((0,I.E)((0,R._)((0,L.b)(_.WF))));(0,u.__decorate)([(0,f.MZ)({attribute:!1})],me.prototype,"hass",void 0),(0,u.__decorate)([(0,f.MZ)({attribute:!1})],me.prototype,"scriptId",void 0),(0,u.__decorate)([(0,f.MZ)({attribute:!1})],me.prototype,"entityId",void 0),(0,u.__decorate)([(0,f.MZ)({attribute:!1})],me.prototype,"entityRegistry",void 0),(0,u.__decorate)([(0,f.MZ)({attribute:"is-wide",type:Boolean})],me.prototype,"isWide",void 0),(0,u.__decorate)([(0,f.MZ)({type:Boolean})],me.prototype,"narrow",void 0),(0,u.__decorate)([(0,f.MZ)({attribute:!1})],me.prototype,"route",void 0),(0,u.__decorate)([(0,f.wk)()],me.prototype,"_config",void 0),(0,u.__decorate)([(0,f.wk)()],me.prototype,"_dirty",void 0),(0,u.__decorate)([(0,f.wk)()],me.prototype,"_errors",void 0),(0,u.__decorate)([(0,f.wk)()],me.prototype,"_yamlErrors",void 0),(0,u.__decorate)([(0,f.wk)()],me.prototype,"_entityId",void 0),(0,u.__decorate)([(0,f.wk)()],me.prototype,"_mode",void 0),(0,u.__decorate)([(0,f.wk)()],me.prototype,"_readOnly",void 0),(0,u.__decorate)([(0,f.wk)(),(0,p.Fg)({context:x.ih,subscribe:!0}),(0,k.p)({transformer:function(e){return e.find(e=>e.entity_id===this._entityId)},watch:["_entityId"]})],me.prototype,"_registryEntry",void 0),(0,u.__decorate)([(0,f.P)("manual-script-editor")],me.prototype,"_manualEditor",void 0),(0,u.__decorate)([(0,f.wk)()],me.prototype,"_validationErrors",void 0),(0,u.__decorate)([(0,f.wk)()],me.prototype,"_blueprintConfig",void 0),(0,u.__decorate)([(0,f.wk)()],me.prototype,"_saving",void 0),customElements.define("ha-script-editor",me),t()}catch(be){t(be)}})},46263:function(e,t,i){i.a(e,async function(e,t){try{var a=i(62020),s=i(31802),o=i(97750),n=i(21101),r=i(23180),l=(i(38606),i(79827),i(69868)),c=i(84922),d=i(11991),h=i(75907),u=i(44017),p=i(72722),_=i(63211),f=(i(10366),i(70490),i(19912),i(92409),i(70053)),v=i(50809),g=i(40980),y=i(954),m=i(33926),b=i(91197),$=e([m]);m=($.then?(await $)():$)[0];var A,k,w,C,H,x,M,V=e=>e,S="M6,2A4,4 0 0,1 10,6V8H14V6A4,4 0 0,1 18,2A4,4 0 0,1 22,6A4,4 0 0,1 18,10H16V14H18A4,4 0 0,1 22,18A4,4 0 0,1 18,22A4,4 0 0,1 14,18V16H10V18A4,4 0 0,1 6,22A4,4 0 0,1 2,18A4,4 0 0,1 6,14H8V10H6A4,4 0 0,1 2,6A4,4 0 0,1 6,2M16,18A2,2 0 0,0 18,20A2,2 0 0,0 20,18A2,2 0 0,0 18,16H16V18M14,10H10V14H14V10M6,16A2,2 0 0,0 4,18A2,2 0 0,0 6,20A2,2 0 0,0 8,18V16H6M8,6A2,2 0 0,0 6,4A2,2 0 0,0 4,6A2,2 0 0,0 6,8H8V6M18,8A2,2 0 0,0 20,6A2,2 0 0,0 18,4A2,2 0 0,0 16,6V8H18Z",z="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z",q="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",L="M3 6V8H14V6H3M3 10V12H14V10H3M20 10.1C19.9 10.1 19.7 10.2 19.6 10.3L18.6 11.3L20.7 13.4L21.7 12.4C21.9 12.2 21.9 11.8 21.7 11.6L20.4 10.3C20.3 10.2 20.2 10.1 20 10.1M18.1 11.9L12 17.9V20H14.1L20.2 13.9L18.1 11.9M3 14V16H10V14H3Z",R=function(e){function t(){var e;(0,a.A)(this,t);for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(e=(0,n.A)(this,t,[].concat(s))).excludeKeys=[],e.disabled=!1,e.narrow=!1,e._yamlMode=!1,e._selected=!1,e._collapsed=!1,e._selectorRowSelected=!1,e._selectorRowCollapsed=!1,e._toggleYamlMode=t=>{e._yamlMode=!e._yamlMode,t&&e.openSidebar(t.hasAttribute("selector-row"))},e._onDelete=()=>{(0,u.r)((0,o.A)(e),"value-changed",{value:null}),(e._selected||e._selectorRowSelected)&&(0,u.r)((0,o.A)(e),"close-sidebar"),(0,b.P)((0,o.A)(e),{message:e.hass.localize("ui.common.successfully_deleted"),duration:4e3,action:{text:e.hass.localize("ui.common.undo"),action:()=>{(0,u.r)(window,"undo-change")}}})},e}return(0,r.A)(t,e),(0,s.A)(t,[{key:"render",value:function(){return(0,c.qy)(A||(A=V` <ha-card outlined> <ha-automation-row .disabled="${0}" @click="${0}" .selected="${0}" left-chevron @toggle-collapsed="${0}" .collapsed="${0}" .highlight="${0}" @delete-row="${0}"> <ha-md-button-menu quick slot="icons" @click="${0}" @keydown="${0}" @closed="${0}" positioning="fixed" anchor-corner="end-end" menu-corner="start-end"> <ha-icon-button slot="trigger" .label="${0}" .path="${0}"></ha-icon-button> <ha-md-menu-item .clickAction="${0}"> <ha-svg-icon slot="start" .path="${0}"></ha-svg-icon> <div class="overflow-label"> ${0} <span class="shortcut-placeholder ${0}"></span> </div> </ha-md-menu-item> <ha-md-menu-item .clickAction="${0}" .disabled="${0}" class="warning"> <ha-svg-icon slot="start" .path="${0}"></ha-svg-icon> <div class="overflow-label"> ${0} ${0} </div> </ha-md-menu-item> </ha-md-button-menu> <h3 slot="header">${0}</h3> <slot name="icons" slot="icons"></slot> </ha-automation-row> </ha-card> <div class="${0}"> <ha-card> <ha-automation-row .selected="${0}" @click="${0}" .collapsed="${0}" @toggle-collapsed="${0}" .leftChevron="${0}" .highlight="${0}"> <h3 slot="header"> ${0} ${0} </h3> <ha-md-button-menu quick slot="icons" @click="${0}" @keydown="${0}" @closed="${0}" positioning="fixed" anchor-corner="end-end" menu-corner="start-end"> <ha-icon-button slot="trigger" .label="${0}" .path="${0}"></ha-icon-button> <ha-md-menu-item .clickAction="${0}" selector-row> <ha-svg-icon slot="start" .path="${0}"></ha-svg-icon> <div class="overflow-label"> ${0} <span class="shortcut-placeholder ${0}"></span> </div> </ha-md-menu-item> <ha-md-menu-item .clickAction="${0}" .disabled="${0}" class="warning"> <ha-svg-icon slot="start" .path="${0}"></ha-svg-icon> <div class="overflow-label"> ${0} ${0} </div> </ha-md-menu-item> </ha-md-button-menu> </ha-automation-row> </ha-card> ${0} </div> `),this.disabled,this._toggleSidebar,this._selected,this._toggleCollapse,this._collapsed,this.highlight,this._onDelete,p.C,_.d,_.d,this.hass.localize("ui.common.menu"),q,this._toggleYamlMode,L,this.hass.localize("ui.panel.config.automation.editor.edit_"+(this._yamlMode?"ui":"yaml")),g.c?"mac":"",this._onDelete,this.disabled,z,this.hass.localize("ui.panel.config.automation.editor.actions.delete"),this.narrow?c.s6:(0,c.qy)(k||(k=V`<span class="shortcut"> <span>${0}</span> <span>+</span> <span>${0}</span> </span>`),g.c?(0,c.qy)(w||(w=V`<ha-svg-icon slot="start" .path="${0}"></ha-svg-icon>`),S):this.hass.localize("ui.panel.config.automation.editor.ctrl"),this.hass.localize("ui.panel.config.automation.editor.del")),this.key,(0,h.H)({"selector-row":!0,"parent-selected":this._selected,hidden:this._collapsed}),this._selectorRowSelected,this._toggleSelectorSidebar,this._selectorRowCollapsed,this._toggleSelectorRowCollapse,f.W.includes(Object.keys(this.field.selector)[0]),this.highlight,this.hass.localize(`ui.components.selectors.selector.types.${Object.keys(this.field.selector)[0]}`),this.hass.localize("ui.panel.config.script.editor.field.selector"),p.C,_.d,_.d,this.hass.localize("ui.common.menu"),q,this._toggleYamlMode,L,this.hass.localize("ui.panel.config.automation.editor.edit_"+(this._yamlMode?"ui":"yaml")),g.c?"mac":"",this._onDelete,this.disabled,z,this.hass.localize("ui.panel.config.automation.editor.actions.delete"),this.narrow?c.s6:(0,c.qy)(C||(C=V`<span class="shortcut"> <span>${0}</span> <span>+</span> <span>${0}</span> </span>`),g.c?(0,c.qy)(H||(H=V`<ha-svg-icon slot="start" .path="${0}"></ha-svg-icon>`),S):this.hass.localize("ui.panel.config.automation.editor.ctrl"),this.hass.localize("ui.panel.config.automation.editor.del")),"object"==typeof this.field.selector&&f.W.includes(Object.keys(this.field.selector)[0])?(0,c.qy)(x||(x=V` <ha-script-field-selector-editor class="${0}" .selected="${0}" .hass="${0}" .field="${0}" .disabled="${0}" indent @value-changed="${0}" .narrow="${0}"></ha-script-field-selector-editor> `),this._selectorRowCollapsed?"hidden":"",this._selectorRowSelected,this.hass,this.field,this.disabled,this._selectorValueChanged,this.narrow):c.s6)}},{key:"_toggleCollapse",value:function(){this._collapsed=!this._collapsed}},{key:"expand",value:function(){this._collapsed=!1}},{key:"collapse",value:function(){this._collapsed=!0}},{key:"expandSelectorRow",value:function(){this._selectorRowCollapsed=!1}},{key:"collapseSelectorRow",value:function(){this._selectorRowCollapsed=!0}},{key:"_toggleSelectorRowCollapse",value:function(){this._selectorRowCollapsed=!this._selectorRowCollapsed}},{key:"expandAll",value:function(){var e;this.expand(),this.expandSelectorRow(),null===(e=this._selectorEditor)||void 0===e||e.expandAll()}},{key:"collapseAll",value:function(){var e;this.collapse(),this.collapseSelectorRow(),null===(e=this._selectorEditor)||void 0===e||e.collapseAll()}},{key:"_toggleSidebar",value:function(e){null==e||e.stopPropagation(),this._selected?(0,u.r)(this,"request-close-sidebar"):(this._selected=!0,this._collapsed=!1,this.openSidebar())}},{key:"_toggleSelectorSidebar",value:function(e){null==e||e.stopPropagation(),this._selectorRowSelected?(0,u.r)(this,"request-close-sidebar"):(this._selectorRowSelected=!0,this._selectorRowCollapsed=!1,this.openSidebar(!0))}},{key:"_selectorValueChanged",value:function(e){e.stopPropagation(),(0,u.r)(this,"value-changed",{value:Object.assign(Object.assign({},this.field),{},{key:this.key},e.detail.value)})}},{key:"openSidebar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e||(this._selected=!0),(0,u.r)(this,"open-sidebar",{save:e=>{(0,u.r)(this,"value-changed",{value:e})},close:t=>{e?(this._selectorRowSelected=!1,t&&this.focusSelector()):(this._selected=!1,t&&this.focus()),(0,u.r)(this,"close-sidebar")},toggleYamlMode:()=>{this._toggleYamlMode(),this.openSidebar()},delete:this._onDelete,config:{field:this.field,selector:e,key:this.key,excludeKeys:this.excludeKeys},yamlMode:this._yamlMode}),this.narrow&&window.setTimeout(()=>{this.scrollIntoView({block:"start",behavior:"smooth"})},180)}},{key:"focus",value:function(){var e;null===(e=this._fieldRowElement)||void 0===e||e.focus()}},{key:"focusSelector",value:function(){var e;null===(e=this._selectorRowElement)||void 0===e||e.focus()}}],[{key:"styles",get:function(){return[v.RF,y.aM,y.Lt,(0,c.AH)(M||(M=V`.disabled{opacity:.5;pointer-events:none}.hidden{display:none}h3{margin:0;font-size:inherit;font-weight:inherit}.action-icon{display:none}@media (min-width:870px){.action-icon{display:inline-block;color:var(--secondary-text-color);opacity:.9;margin-right:8px;margin-inline-end:8px;margin-inline-start:initial}}.card-content{padding:16px}.disabled-bar{background:var(--divider-color,#e0e0e0);text-align:center;border-top-right-radius:calc(var(--ha-card-border-radius,var(--ha-border-radius-lg)) - var(--ha-card-border-width,1px));border-top-left-radius:calc(var(--ha-card-border-radius,var(--ha-border-radius-lg)) - var(--ha-card-border-width,1px))}.warning ul{margin:4px 0}.selected_menu_item{color:var(--primary-color)}li[role=separator]{border-bottom-color:var(--divider-color)}.selector-row{padding-top:12px;padding-bottom:16px;padding-inline-start:16px;padding-inline-end:0px}`))]}}])}(c.WF);(0,l.__decorate)([(0,d.MZ)({attribute:!1})],R.prototype,"hass",void 0),(0,l.__decorate)([(0,d.MZ)()],R.prototype,"key",void 0),(0,l.__decorate)([(0,d.MZ)({attribute:!1,type:Array})],R.prototype,"excludeKeys",void 0),(0,l.__decorate)([(0,d.MZ)({attribute:!1})],R.prototype,"field",void 0),(0,l.__decorate)([(0,d.MZ)({type:Boolean})],R.prototype,"disabled",void 0),(0,l.__decorate)([(0,d.MZ)({type:Boolean})],R.prototype,"narrow",void 0),(0,l.__decorate)([(0,d.MZ)({type:Boolean})],R.prototype,"highlight",void 0),(0,l.__decorate)([(0,d.wk)()],R.prototype,"_yamlMode",void 0),(0,l.__decorate)([(0,d.wk)()],R.prototype,"_selected",void 0),(0,l.__decorate)([(0,d.wk)()],R.prototype,"_collapsed",void 0),(0,l.__decorate)([(0,d.wk)()],R.prototype,"_selectorRowSelected",void 0),(0,l.__decorate)([(0,d.wk)()],R.prototype,"_selectorRowCollapsed",void 0),(0,l.__decorate)([(0,d.P)("ha-script-field-selector-editor")],R.prototype,"_selectorEditor",void 0),(0,l.__decorate)([(0,d.P)("ha-automation-row:first-of-type")],R.prototype,"_fieldRowElement",void 0),(0,l.__decorate)([(0,d.P)(".selector-row ha-automation-row")],R.prototype,"_selectorRowElement",void 0),R=(0,l.__decorate)([(0,d.EM)("ha-script-field-row")],R),t()}catch(I){t(I)}})},20233:function(e,t,i){i.a(e,async function(e,t){try{var a=i(15243),s=i(62020),o=i(31802),n=i(21101),r=i(23180),l=i(87426),c=(i(38606),i(96956),i(80178),i(65315),i(837),i(22416),i(37089),i(29726),i(45519),i(30536),i(69868)),d=i(84922),h=i(11991),u=i(44017),p=i(17372),_=(i(78918),i(86160),i(46263)),f=e([p,_]);[p,_]=f.then?(await f)():f;var v,g,y,m,b=e=>e,$=function(e){function t(){var e;(0,s.A)(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=(0,n.A)(this,t,[].concat(a))).disabled=!1,e.narrow=!1,e._focusLastActionOnChange=!1,e}return(0,r.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){return(0,d.qy)(v||(v=b` ${0} <ha-button @click="${0}" .disabled="${0}"> <ha-svg-icon .path="${0}" slot="start"></ha-svg-icon> ${0} </ha-button> `),this.fields?(0,d.qy)(g||(g=b`<div class="fields"> ${0} </div> `),Object.entries(this.fields).map(e=>{var t,i=(0,a.A)(e,2),s=i[0],o=i[1];return(0,d.qy)(y||(y=b` <ha-script-field-row .key="${0}" .excludeKeys="${0}" .field="${0}" .disabled="${0}" @value-changed="${0}" .hass="${0}" .highlight="${0}" .narrow="${0}"> </ha-script-field-row> `),s,Object.keys(this.fields).filter(e=>e!==s),o,this.disabled,this._fieldChanged,this.hass,void 0!==(null===(t=this.highlightedFields)||void 0===t?void 0:t[s]),this.narrow)})):d.s6,this._addField,this.disabled,"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z",this.hass.localize("ui.panel.config.script.editor.field.add_field"))}},{key:"updated",value:function(e){(0,l.A)(t,"updated",this,3)([e]),e.has("fields")&&this._focusLastActionOnChange&&(this._focusLastActionOnChange=!1,this.focusLastField())}},{key:"focusLastField",value:function(){var e=this.shadowRoot.querySelector("ha-script-field-row:last-of-type");e.updateComplete.then(()=>{e.openSidebar(),e.focus(),this.narrow&&window.setTimeout(()=>{e.scrollIntoView({block:"start",behavior:"smooth"})},180)})}},{key:"_addField",value:function(){var e=this._getUniqueKey(this.hass.localize("ui.panel.config.script.editor.field.field")||"field",this.fields||{}),t=Object.assign(Object.assign({},this.fields||{}),{},{[e]:{selector:{text:null}}});this._focusLastActionOnChange=!0,(0,u.r)(this,"value-changed",{value:t})}},{key:"_fieldChanged",value:function(e){e.stopPropagation();var t=e.target.key,i={};if(null===e.detail.value)delete(i=Object.assign({},this.fields))[t];else{var s=Object.assign({},e.detail.value),o=s.key;delete s.key,t!==o?Object.entries(this.fields).forEach(e=>{var n=(0,a.A)(e,2),r=n[0],l=n[1];r===t?i[o]=s:i[r]=l}):(i=Object.assign({},this.fields))[t]=s}(0,u.r)(this,"value-changed",{value:i})}},{key:"_getUniqueKey",value:function(e,t){var i=e;if(e in t){var a=2;do{i=`${e}_${a}`,a++}while(i in t)}return i}},{key:"expandAll",value:function(){var e;null===(e=this._fieldRowElements)||void 0===e||e.forEach(e=>{e.expandAll()})}},{key:"collapseAll",value:function(){var e;null===(e=this._fieldRowElements)||void 0===e||e.forEach(e=>{e.collapseAll()})}}])}(d.WF);$.styles=(0,d.AH)(m||(m=b`ha-script-field-row{display:block;margin-bottom:16px;scroll-margin-top:48px}ha-svg-icon{height:20px}`)),(0,c.__decorate)([(0,h.MZ)({attribute:!1})],$.prototype,"hass",void 0),(0,c.__decorate)([(0,h.MZ)({type:Boolean})],$.prototype,"disabled",void 0),(0,c.__decorate)([(0,h.MZ)({attribute:!1})],$.prototype,"fields",void 0),(0,c.__decorate)([(0,h.MZ)({attribute:!1})],$.prototype,"highlightedFields",void 0),(0,c.__decorate)([(0,h.MZ)({type:Boolean})],$.prototype,"narrow",void 0),(0,c.__decorate)([(0,h.YG)("ha-script-field-row")],$.prototype,"_fieldRowElements",void 0),$=(0,c.__decorate)([(0,h.EM)("ha-script-fields")],$),t()}catch(A){t(A)}})},31786:function(e,t,i){i.a(e,async function(e,t){try{var a=i(73983),s=i(15243),o=i(98735),n=i(88486),r=i(62020),l=i(31802),c=i(97750),d=i(21101),h=i(23180),u=i(87426),p=(i(38606),i(96956),i(44941),i(79827),i(35748),i(80178),i(99342),i(65315),i(12840),i(837),i(84136),i(22416),i(37089),i(59023),i(29726),i(45519),i(74774),i(5934),i(84755),i(67579),i(64587),i(88238),i(34536),i(16257),i(20152),i(44711),i(72108),i(77030),i(79566),i(30536),i(95013),i(13484),i(81071),i(92714),i(55885),i(69868)),_=i(88006),f=i(97809),v=i(41484),g=i(84922),y=i(11991),m=i(48893),b=i(65940),$=i(78412),A=i(26946),k=i(6149),w=i(94029),C=i(20051),H=i(44017),x=i(72652),M=i(77240),V=i(46244),S=(i(21977),i(10547),i(71347),i(66120),i(65508),i(76940)),z=(i(76758),i(80624),i(9058),i(6418)),q=(i(28565),i(68937),i(92409),i(73634),i(86160),i(9171)),L=i(8384),R=i(32293),I=i(48727),O=i(14523),E=i(59569),Z=i(40804),P=i(42699),j=i(54600),F=i(15241),U=i(81579),B=i(68891),W=i(40328),T=i(50809),D=i(91197),K=i(38525),Y=i(18885),N=i(31494),G=i(91168),X=i(84193),Q=i(61627),J=i(47225),ee=e([S,z,B,_,k,w]);[S,z,B,_,k,w]=ee.then?(await ee)():ee;var te,ie,ae,se,oe,ne,re,le,ce,de,he,ue,pe,_e,fe,ve,ge,ye,me,be,$e,Ae,ke,we,Ce,He,xe,Me,Ve,Se,ze,qe=e=>e,Le="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z",Re="M7,10L12,15L17,10H7Z",Ie="M5.5,7A1.5,1.5 0 0,1 4,5.5A1.5,1.5 0 0,1 5.5,4A1.5,1.5 0 0,1 7,5.5A1.5,1.5 0 0,1 5.5,7M21.41,11.58L12.41,2.58C12.05,2.22 11.55,2 11,2H4C2.89,2 2,2.89 2,4V11C2,11.55 2.22,12.05 2.59,12.41L11.58,21.41C11.95,21.77 12.45,22 13,22C13.55,22 14.05,21.77 14.41,21.41L21.41,14.41C21.78,14.05 22,13.55 22,13C22,12.44 21.77,11.94 21.41,11.58Z",Oe=function(e){function t(){var e;(0,r.A)(this,t);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=(0,d.A)(this,t,[].concat(a))).isWide=!1,e.narrow=!1,e._searchParms=new URLSearchParams(window.location.search),e._selected=[],e._filter="",e._filters={},e._sizeController=new _.P((0,c.A)(e),{callback:e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.contentRect.width}}),e._scripts=(0,b.A)((e,t,i,a,s,o)=>null===o?[]:(o?e.filter(e=>o.includes(e.entity_id)):e).map(e=>{var o,n,r=t.find(t=>t.entity_id===e.entity_id),l=null==r?void 0:r.categories.script,c=s&&(null==r?void 0:r.labels);return Object.assign(Object.assign({},e),{},{name:(0,x.u)(e),area:null!=r&&r.area_id?null===(o=i[null==r?void 0:r.area_id])||void 0===o?void 0:o.name:void 0,last_triggered:e.attributes.last_triggered||void 0,category:l?null==a||null===(n=a.find(e=>e.category_id===l))||void 0===n?void 0:n.name:void 0,labels:(c||[]).map(e=>s.find(t=>t.label_id===e)),selectable:void 0!==r})})),e._columns=(0,b.A)(t=>({icon:{title:"",showNarrow:!0,moveable:!1,label:t("ui.panel.config.script.picker.headers.icon"),type:"icon",template:t=>(0,g.qy)(te||(te=qe`<ha-state-icon .hass="${0}" .stateObj="${0}" style="${0}"></ha-state-icon>`),e.hass,t,(0,m.W)({color:t.state===O.Hh?"var(--error-color)":"unset"}))},name:{title:t("ui.panel.config.script.picker.headers.name"),main:!0,sortable:!0,filterable:!0,direction:"asc",flex:2,extraTemplate:t=>t.labels.length?(0,g.qy)(ie||(ie=qe`<ha-data-table-labels @label-clicked="${0}" .labels="${0}"></ha-data-table-labels>`),e._labelClicked,t.labels):g.s6},area:{title:t("ui.panel.config.script.picker.headers.area"),defaultHidden:!0,groupable:!0,filterable:!0,sortable:!0},category:{title:t("ui.panel.config.script.picker.headers.category"),defaultHidden:!0,groupable:!0,filterable:!0,sortable:!0},labels:{title:"",hidden:!0,filterable:!0,template:e=>e.labels.map(e=>e.name).join(" ")},last_triggered:{sortable:!0,title:t("ui.card.automation.last_triggered"),template:t=>{var i=new Date(t.last_triggered),a=new Date,s=(0,v.c)(a,i);return(0,g.qy)(ae||(ae=qe` ${0} `),t.last_triggered?s>3?(0,k.CL)(i,e.hass.locale,e.hass.config):(0,w.K)(i,e.hass.locale):e.hass.localize("ui.components.relative_time.never"))}},actions:{title:"",label:e.hass.localize("ui.panel.config.generic.headers.actions"),type:"overflow-menu",showNarrow:!0,moveable:!1,hideable:!1,template:t=>(0,g.qy)(se||(se=qe` <ha-icon-overflow-menu .hass="${0}" narrow .items="${0}"> </ha-icon-overflow-menu> `),e.hass,[{path:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z",label:e.hass.localize("ui.panel.config.script.picker.show_info"),action:()=>e._showInfo(t)},{path:"M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z",label:e.hass.localize("ui.panel.config.automation.picker.show_settings"),action:()=>e._openSettings(t)},{path:Ie,label:e.hass.localize("ui.panel.config.script.picker."+(t.category?"edit_category":"assign_category")),action:()=>e._editCategory(t)},{path:"M8,5.14V19.14L19,12.14L8,5.14Z",label:e.hass.localize("ui.panel.config.script.picker.run"),action:()=>e._runScript(t)},{path:"M15,12C15,10.7 14.16,9.6 13,9.18V6.82C14.16,6.4 15,5.3 15,4A3,3 0 0,0 12,1A3,3 0 0,0 9,4C9,5.3 9.84,6.4 11,6.82V9.19C9.84,9.6 9,10.7 9,12C9,13.3 9.84,14.4 11,14.82V17.18C9.84,17.6 9,18.7 9,20A3,3 0 0,0 12,23A3,3 0 0,0 15,20C15,18.7 14.16,17.6 13,17.18V14.82C14.16,14.4 15,13.3 15,12M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M12,21A1,1 0 0,1 11,20A1,1 0 0,1 12,19A1,1 0 0,1 13,20A1,1 0 0,1 12,21Z",label:e.hass.localize("ui.panel.config.script.picker.show_trace"),action:()=>e._showTrace(t)},{divider:!0},{path:"M11,17H4A2,2 0 0,1 2,15V3A2,2 0 0,1 4,1H16V3H4V15H11V13L15,16L11,19V17M19,21V7H8V13H6V7A2,2 0 0,1 8,5H19A2,2 0 0,1 21,7V21A2,2 0 0,1 19,23H8A2,2 0 0,1 6,21V19H8V21H19Z",label:e.hass.localize("ui.panel.config.script.picker.duplicate"),action:()=>e._duplicate(t)},{label:e.hass.localize("ui.panel.config.script.picker.delete"),path:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z",action:()=>e._deleteConfirm(t),warning:!0}])}})),e._labelClicked=t=>{var i=t.detail.label;e._filters=Object.assign(Object.assign({},e._filters),{},{"ha-filter-labels":{value:[i.label_id],items:void 0}}),e._applyFilters()},e._handleBulkCategory=t=>{var i=t.value;e._bulkAddCategory(i)},e._runScript=function(){var t=(0,n.A)((0,o.A)().m(function t(i){var a;return(0,o.A)().w(function(t){for(;;)switch(t.n){case 0:if(a=e.entityRegistry.find(e=>e.entity_id===i.entity_id)){t.n=1;break}return t.a(2);case 1:if(!(0,P.TP)(e.hass,a.unique_id)){t.n=2;break}e._showInfo(i),t.n=4;break;case 2:return t.n=3,(0,P.kR)(e.hass,a.unique_id);case 3:(0,D.P)((0,c.A)(e),{message:e.hass.localize("ui.notification_toast.triggered",{name:(0,x.u)(i)})});case 4:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}(),e._bulkCreateCategory=()=>{var t;(0,G.S)((0,c.A)(e),{scope:"script",createEntry:(t=(0,n.A)((0,o.A)().m(function t(i){var a;return(0,o.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,(0,L.s_)(e.hass,"script",i);case 1:return a=t.v,e._bulkAddCategory(a.category_id),t.a(2,a)}},t)})),function(e){return t.apply(this,arguments)})})},e._bulkCreateLabel=()=>{var t;(0,Q.f)((0,c.A)(e),{createEntry:(t=(0,n.A)((0,o.A)().m(function t(i){var a;return(0,o.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,(0,Z._9)(e.hass,i);case 1:a=t.v,e._bulkLabel(a.label_id,"add");case 2:return t.a(2)}},t)})),function(e){return t.apply(this,arguments)})})},e._handleBulkArea=t=>{var i=t.value;e._bulkAddArea(i)},e._bulkCreateArea=()=>{var t;(0,K.J)((0,c.A)(e),{createEntry:(t=(0,n.A)((0,o.A)().m(function t(i){var a;return(0,o.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,(0,q.L3)(e.hass,i);case 1:return a=t.v,e._bulkAddArea(a.area_id),t.a(2,a)}},t)})),function(e){return t.apply(this,arguments)})})},e}return(0,h.A)(t,e),(0,l.A)(t,[{key:"hassSubscribe",value:function(){return[(0,L.Ar)(this.hass.connection,"script",e=>{this._categories=e}),(0,Z.o5)(this.hass.connection,e=>{this._labels=e})]}},{key:"render",value:function(){var e,t,i,a,s,o,n,r,l,c=(0,g.qy)(oe||(oe=qe`${0} <ha-md-menu-item .value="${0}" .clickAction="${0}"> <div slot="headline"> ${0} </div> </ha-md-menu-item><ha-md-divider role="separator" tabindex="-1"></ha-md-divider> <ha-md-menu-item .clickAction="${0}"> <div slot="headline"> ${0} </div> </ha-md-menu-item>`),null===(e=this._categories)||void 0===e?void 0:e.map(e=>(0,g.qy)(ne||(ne=qe`<ha-md-menu-item .value="${0}" .clickAction="${0}"> ${0} <div slot="headline">${0}</div> </ha-md-menu-item>`),e.category_id,this._handleBulkCategory,e.icon?(0,g.qy)(re||(re=qe`<ha-icon slot="start" .icon="${0}"></ha-icon>`),e.icon):(0,g.qy)(le||(le=qe`<ha-svg-icon slot="start" .path="${0}"></ha-svg-icon>`),Ie),e.name)),null,this._handleBulkCategory,this.hass.localize("ui.panel.config.automation.picker.bulk_actions.no_category"),this._bulkCreateCategory,this.hass.localize("ui.panel.config.category.editor.add")),d=(0,g.qy)(ce||(ce=qe`${0} <ha-md-divider role="separator" tabindex="-1"></ha-md-divider> <ha-md-menu-item .clickAction="${0}"> <div slot="headline"> ${0} </div></ha-md-menu-item>`),null===(t=this._labels)||void 0===t?void 0:t.map(e=>{var t=e.color?(0,$.M)(e.color):void 0,i=this._selected.every(t=>{var i;return null===(i=this.hass.entities[t])||void 0===i?void 0:i.labels.includes(e.label_id)}),a=!i&&this._selected.some(t=>{var i;return null===(i=this.hass.entities[t])||void 0===i?void 0:i.labels.includes(e.label_id)});return(0,g.qy)(de||(de=qe`<ha-md-menu-item .value="${0}" .action="${0}" @click="${0}" keep-open reducedTouchTarget> <ha-checkbox slot="start" .checked="${0}" .indeterminate="${0}"></ha-checkbox> <ha-label style="${0}"> ${0} ${0} </ha-label> </ha-md-menu-item>`),e.label_id,i?"remove":"add",this._handleBulkLabel,i,a,t?`--color: ${t}`:"",e.icon?(0,g.qy)(he||(he=qe`<ha-icon slot="icon" .icon="${0}"></ha-icon>`),e.icon):g.s6,e.name)}),this._bulkCreateLabel,this.hass.localize("ui.panel.config.labels.add_label")),h=(0,g.qy)(ue||(ue=qe`${0} <ha-md-menu-item .value="${0}" .clickAction="${0}"> <div slot="headline"> ${0} </div> </ha-md-menu-item> <ha-md-divider role="separator" tabindex="-1"></ha-md-divider> <ha-md-menu-item .clickAction="${0}"> <div slot="headline"> ${0} </div> </ha-md-menu-item>`),Object.values(this.hass.areas).map(e=>(0,g.qy)(pe||(pe=qe`<ha-md-menu-item .value="${0}" .clickAction="${0}"> ${0} <div slot="headline">${0}</div> </ha-md-menu-item>`),e.area_id,this._handleBulkArea,e.icon?(0,g.qy)(_e||(_e=qe`<ha-icon slot="start" .icon="${0}"></ha-icon>`),e.icon):(0,g.qy)(fe||(fe=qe`<ha-svg-icon slot="start" .path="${0}"></ha-svg-icon>`),"M20 2H4C2.9 2 2 2.9 2 4V20C2 21.11 2.9 22 4 22H20C21.11 22 22 21.11 22 20V4C22 2.9 21.11 2 20 2M4 6L6 4H10.9L4 10.9V6M4 13.7L13.7 4H18.6L4 18.6V13.7M20 18L18 20H13.1L20 13.1V18M20 10.3L10.3 20H5.4L20 5.4V10.3Z"),e.name)),null,this._handleBulkArea,this.hass.localize("ui.panel.config.devices.picker.bulk_actions.no_area"),this._bulkCreateArea,this.hass.localize("ui.panel.config.devices.picker.bulk_actions.add_area")),u=this._sizeController.value&&this._sizeController.value<900||!this._sizeController.value&&"docked"===this.hass.dockedSidebar,p=u&&(!this._sizeController.value||this._sizeController.value<700),_=this._scripts(this.scripts,this._entityReg,this.hass.areas,this._categories,this._labels,this._filteredScripts),f=X.configSections.automations,v="/config";return(0,J.fe)(this.hass)||(f=f.filter(e=>{var t;return null===(t=e.component)||void 0===t?void 0:t.includes("script")}),v="/"),(0,g.qy)(ve||(ve=qe` <hass-tabs-subpage-data-table .hass="${0}" .narrow="${0}" back-path="${0}" .route="${0}" .tabs="${0}" .searchLabel="${0}" has-filters .initialGroupColumn="${0}" .initialCollapsedGroups="${0}" .initialSorting="${0}" .columnOrder="${0}" .hiddenColumns="${0}" @columns-changed="${0}" @sorting-changed="${0}" @grouping-changed="${0}" @collapsed-changed="${0}" selectable .selected="${0}" @selection-changed="${0}" .filters="${0}" .columns="${0}" .data="${0}" .empty="${0}" .activeFilters="${0}" id="entity_id" .noDataText="${0}" @clear-filter="${0}" .filter="${0}" @search-changed="${0}" has-fab clickable class="${0}" @row-click="${0}"> <ha-icon-button slot="toolbar-icon" .label="${0}" .path="${0}" @click="${0}"></ha-icon-button> <ha-filter-floor-areas .hass="${0}" .type="${0}" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-floor-areas> <ha-filter-devices .hass="${0}" .type="${0}" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-devices> <ha-filter-entities .hass="${0}" .type="${0}" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-entities> <ha-filter-labels .hass="${0}" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-labels> <ha-filter-categories .hass="${0}" scope="script" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-categories> <ha-filter-blueprints .hass="${0}" .type="${0}" .value="${0}" @data-table-filter-changed="${0}" slot="filter-pane" .expanded="${0}" .narrow="${0}" @expanded-changed="${0}"></ha-filter-blueprints> ${0} ${0} ${0} <ha-fab slot="fab" ?is-wide="${0}" ?narrow="${0}" .label="${0}" extended @click="${0}"> <ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon> </ha-fab> </hass-tabs-subpage-data-table> `),this.hass,this.narrow,v,this.route,f,this.hass.localize("ui.panel.config.script.picker.search",{number:_.length}),null!==(i=this._activeGrouping)&&void 0!==i?i:"category",this._activeCollapsed,this._activeSorting,this._activeColumnOrder,this._activeHiddenColumns,this._handleColumnsChanged,this._handleSortingChanged,this._handleGroupingChanged,this._handleCollapseChanged,this._selected.length,this._handleSelectionChanged,Object.values(this._filters).filter(e=>Array.isArray(e.value)?e.value.length:e.value&&Object.values(e.value).some(e=>Array.isArray(e)?e.length:e)).length,this._columns(this.hass.localize),_,!this.scripts.length,this._activeFilters,this.hass.localize("ui.panel.config.script.picker.no_scripts"),this._clearFilter,this._filter,this._handleSearchChange,this.narrow?"narrow":"",this._handleRowClicked,this.hass.localize("ui.common.help"),"M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z",this._showHelp,this.hass,"script",null===(a=this._filters["ha-filter-floor-areas"])||void 0===a?void 0:a.value,this._filterChanged,"ha-filter-floor-areas"===this._expandedFilter,this.narrow,this._filterExpanded,this.hass,"script",null===(s=this._filters["ha-filter-devices"])||void 0===s?void 0:s.value,this._filterChanged,"ha-filter-devices"===this._expandedFilter,this.narrow,this._filterExpanded,this.hass,"script",null===(o=this._filters["ha-filter-entities"])||void 0===o?void 0:o.value,this._filterChanged,"ha-filter-entities"===this._expandedFilter,this.narrow,this._filterExpanded,this.hass,null===(n=this._filters["ha-filter-labels"])||void 0===n?void 0:n.value,this._filterChanged,"ha-filter-labels"===this._expandedFilter,this.narrow,this._filterExpanded,this.hass,null===(r=this._filters["ha-filter-categories"])||void 0===r?void 0:r.value,this._filterChanged,"ha-filter-categories"===this._expandedFilter,this.narrow,this._filterExpanded,this.hass,"script",null===(l=this._filters["ha-filter-blueprints"])||void 0===l?void 0:l.value,this._filterChanged,"ha-filter-blueprints"===this._expandedFilter,this.narrow,this._filterExpanded,this.narrow?g.s6:(0,g.qy)(ge||(ge=qe`<ha-md-button-menu slot="selection-bar"> <ha-assist-chip slot="trigger" .label="${0}"> <ha-svg-icon slot="trailing-icon" .path="${0}"></ha-svg-icon> </ha-assist-chip> ${0} </ha-md-button-menu> ${0} ${0}`),this.hass.localize("ui.panel.config.automation.picker.bulk_actions.move_category"),Re,c,p?g.s6:(0,g.qy)(ye||(ye=qe`<ha-md-button-menu slot="selection-bar"> <ha-assist-chip slot="trigger" .label="${0}"> <ha-svg-icon slot="trailing-icon" .path="${0}"></ha-svg-icon> </ha-assist-chip> ${0} </ha-md-button-menu>`),this.hass.localize("ui.panel.config.automation.picker.bulk_actions.add_label"),Re,d),u?g.s6:(0,g.qy)(me||(me=qe`<ha-md-button-menu slot="selection-bar"> <ha-assist-chip slot="trigger" .label="${0}"> <ha-svg-icon slot="trailing-icon" .path="${0}"></ha-svg-icon> </ha-assist-chip> ${0} </ha-md-button-menu>`),this.hass.localize("ui.panel.config.devices.picker.bulk_actions.move_area"),Re,h)),this.narrow||u?(0,g.qy)(be||(be=qe` <ha-md-button-menu has-overflow slot="selection-bar"> ${0} <ha-svg-icon slot="trailing-icon" .path="${0}"></ha-svg-icon> ${0} ${0} ${0} </ha-md-button-menu>`),this.narrow?(0,g.qy)($e||($e=qe`<ha-assist-chip .label="${0}" slot="trigger"> <ha-svg-icon slot="trailing-icon" .path="${0}"></ha-svg-icon> </ha-assist-chip>`),this.hass.localize("ui.panel.config.automation.picker.bulk_action"),Re):(0,g.qy)(Ae||(Ae=qe`<ha-icon-button .path="${0}" .label="${0}" slot="trigger"></ha-icon-button>`),"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",this.hass.localize("ui.panel.config.automation.picker.bulk_action")),Re,this.narrow?(0,g.qy)(ke||(ke=qe`<ha-sub-menu> <ha-md-menu-item slot="item"> <div slot="headline"> ${0} </div> <ha-svg-icon slot="end" .path="${0}"></ha-svg-icon> </ha-md-menu-item> <ha-md-menu slot="menu">${0}</ha-md-menu> </ha-sub-menu>`),this.hass.localize("ui.panel.config.automation.picker.bulk_actions.move_category"),Le,c):g.s6,this.narrow||p?(0,g.qy)(we||(we=qe`<ha-sub-menu> <ha-md-menu-item slot="item"> <div slot="headline"> ${0} </div> <ha-svg-icon slot="end" .path="${0}"></ha-svg-icon> </ha-md-menu-item> <ha-md-menu slot="menu">${0}</ha-md-menu> </ha-sub-menu>`),this.hass.localize("ui.panel.config.automation.picker.bulk_actions.add_label"),Le,d):g.s6,this.narrow||u?(0,g.qy)(Ce||(Ce=qe`<ha-sub-menu> <ha-md-menu-item slot="item"> <div slot="headline"> ${0} </div> <ha-svg-icon slot="end" .path="${0}"></ha-svg-icon> </ha-md-menu-item> <ha-md-menu slot="menu">${0}</ha-md-menu> </ha-sub-menu>`),this.hass.localize("ui.panel.config.devices.picker.bulk_actions.move_area"),Le,h):g.s6):g.s6,this.scripts.length?g.s6:(0,g.qy)(He||(He=qe` <div class="empty" slot="empty"> <ha-svg-icon .path="${0}"></ha-svg-icon> <h1> ${0} </h1> <p> ${0} </p> </div>`),"M17.8,20C17.4,21.2 16.3,22 15,22H5C3.3,22 2,20.7 2,19V18H5L14.2,18C14.6,19.2 15.7,20 17,20H17.8M19,2C20.7,2 22,3.3 22,5V6H20V5C20,4.4 19.6,4 19,4C18.4,4 18,4.4 18,5V18H17C16.4,18 16,17.6 16,17V16H5V5C5,3.3 6.3,2 8,2H19M8,6V8H15V6H8M8,10V12H14V10H8Z",this.hass.localize("ui.panel.config.script.picker.empty_header"),this.hass.localize("ui.panel.config.script.picker.empty_text")),this.isWide,this.narrow,this.hass.localize("ui.panel.config.script.picker.add_script"),this._createNew,"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z")}},{key:"_handleSearchChange",value:function(e){this._filter=e.detail.value}},{key:"_filterExpanded",value:function(e){e.detail.expanded?this._expandedFilter=e.target.localName:this._expandedFilter===e.target.localName&&(this._expandedFilter=void 0)}},{key:"_filterChanged",value:function(e){var t=e.target.localName;this._filters=Object.assign(Object.assign({},this._filters),{},{[t]:e.detail}),this._applyFilters()}},{key:"_clearFilter",value:function(){this._filters={},this._applyFilters()}},{key:"_applyFilters",value:function(){for(var e,t=this,i=Object.entries(this._filters),o=function(){var i=(0,s.A)(r[n],2),o=i[0],l=i[1];if(l.items){if(!e)return e=l.items,0;e="intersection"in e?e.intersection(l.items):new Set((0,a.A)(e).filter(e=>l.items.has(e)))}if("ha-filter-categories"===o&&Array.isArray(l.value)&&l.value.length){var c=new Set;if(t.scripts.filter(e=>{var i;return l.value[0]===(null===(i=t._entityReg.find(t=>t.entity_id===e.entity_id))||void 0===i?void 0:i.categories.script)}).forEach(e=>c.add(e.entity_id)),!e)return e=c,0;e="intersection"in e?e.intersection(c):new Set((0,a.A)(e).filter(e=>c.has(e)))}if("ha-filter-labels"===o&&Array.isArray(l.value)&&l.value.length){var d=new Set;if(t.scripts.filter(e=>{var i;return null===(i=t._entityReg.find(t=>t.entity_id===e.entity_id))||void 0===i?void 0:i.labels.some(e=>l.value.includes(e))}).forEach(e=>d.add(e.entity_id)),!e)return e=d,0;e="intersection"in e?e.intersection(d):new Set((0,a.A)(e).filter(e=>d.has(e)))}},n=0,r=i;n<r.length;n++)o();this._filteredScripts=e?(0,a.A)(e):void 0}},{key:"updated",value:function(e){(0,u.A)(t,"updated",this,3)([e]),e.has("_entityReg")&&this._applyFilters()}},{key:"firstUpdated",value:function(){this._searchParms.has("blueprint")&&this._filterBlueprint(),this._searchParms.has("label")&&this._filterLabel()}},{key:"_filterLabel",value:function(){var e=this._searchParms.get("label");e&&(this._filters=Object.assign(Object.assign({},this._filters),{},{"ha-filter-labels":{value:[e],items:void 0}}),this._applyFilters())}},{key:"_filterBlueprint",value:(R=(0,n.A)((0,o.A)().m(function e(){var t,i;return(0,o.A)().w(function(e){for(;;)switch(e.n){case 0:if(t=this._searchParms.get("blueprint")){e.n=1;break}return e.a(2);case 1:return e.n=2,(0,j.f)(this.hass,"script_blueprint",t);case 2:i=e.v,this._filters=Object.assign(Object.assign({},this._filters),{},{"ha-filter-blueprints":{value:[t],items:new Set(i.automation||[])}}),this._applyFilters();case 3:return e.a(2)}},e,this)})),function(){return R.apply(this,arguments)})},{key:"_editCategory",value:function(e){var t=this._entityReg.find(t=>t.entity_id===e.entity_id);t?(0,N.j)(this,{scope:"script",entityReg:t}):(0,F.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.script.picker.no_category_support"),text:this.hass.localize("ui.panel.config.script.picker.no_category_entity_reg")})}},{key:"_handleSelectionChanged",value:function(e){this._selected=e.detail.value}},{key:"_bulkAddCategory",value:(z=(0,n.A)((0,o.A)().m(function e(t){var i,a,s;return(0,o.A)().w(function(e){for(;;)switch(e.n){case 0:return i=[],this._selected.forEach(e=>{i.push((0,E.G_)(this.hass,e,{categories:{script:t}}))}),e.n=1,Promise.allSettled(i);case 1:a=e.v,(0,V.$)(a)&&(s=(0,V.N)(a),(0,F.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.common.multiselect.failed",{number:s.length}),text:(0,g.qy)(xe||(xe=qe`<pre>
${0}</pre>`),s.map(e=>e.reason.message||e.reason.code||e.reason).join("\r\n"))}));case 2:return e.a(2)}},e,this)})),function(e){return z.apply(this,arguments)})},{key:"_handleBulkLabel",value:(S=(0,n.A)((0,o.A)().m(function e(t){var i,a;return(0,o.A)().w(function(e){for(;;)switch(e.n){case 0:i=t.currentTarget.value,a=t.currentTarget.action,this._bulkLabel(i,a);case 1:return e.a(2)}},e,this)})),function(e){return S.apply(this,arguments)})},{key:"_bulkLabel",value:(C=(0,n.A)((0,o.A)().m(function e(t,i){var a,s,n;return(0,o.A)().w(function(e){for(;;)switch(e.n){case 0:return a=[],this._selected.forEach(e=>{a.push((0,E.G_)(this.hass,e,{labels:"add"===i?this.hass.entities[e].labels.concat(t):this.hass.entities[e].labels.filter(e=>e!==t)}))}),e.n=1,Promise.allSettled(a);case 1:s=e.v,(0,V.$)(s)&&(n=(0,V.N)(s),(0,F.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.common.multiselect.failed",{number:n.length}),text:(0,g.qy)(Me||(Me=qe`<pre>
${0}</pre>`),n.map(e=>e.reason.message||e.reason.code||e.reason).join("\r\n"))}));case 2:return e.a(2)}},e,this)})),function(e,t){return C.apply(this,arguments)})},{key:"_handleRowClicked",value:function(e){var t=this.entityRegistry.find(t=>t.entity_id===e.detail.id);t?(0,M.o)(`/config/script/edit/${t.unique_id}`):(0,M.o)(`/config/script/show/${e.detail.id}`)}},{key:"_createNew",value:function(){(0,A.x)(this.hass,"blueprint")?(0,Y.l)(this,{mode:"script"}):(0,M.o)("/config/script/edit/new")}},{key:"_showInfo",value:function(e){(0,H.r)(this,"hass-more-info",{entityId:e.entity_id})}},{key:"_openSettings",value:function(e){(0,U.p)(this,{entityId:e.entity_id,view:"settings"})}},{key:"_showTrace",value:function(e){var t=this.entityRegistry.find(t=>t.entity_id===e.entity_id);t&&(0,M.o)(`/config/script/trace/${t.unique_id}`)}},{key:"_showHelp",value:function(){(0,F.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.script.caption"),text:(0,g.qy)(Ve||(Ve=qe` ${0} `),this.hass.localize("ui.panel.config.script.picker.introduction"))})}},{key:"_duplicate",value:(y=(0,n.A)((0,o.A)().m(function e(t){var i,a,s,n;return(0,o.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,i=this.entityRegistry.find(e=>e.entity_id===t.entity_id)){e.n=1;break}return e.a(2);case 1:return e.n=2,(0,P.Kq)(this.hass,i.unique_id);case 2:a=e.v,(0,P.AM)(Object.assign(Object.assign({},a),{},{alias:`${null==a?void 0:a.alias} (${this.hass.localize("ui.panel.config.script.picker.duplicate")})`})),e.n=6;break;case 3:if(e.p=3,404!==(n=e.v).status_code){e.n=5;break}return e.n=4,(0,P.R$)(this.hass,t.entity_id);case 4:return s=e.v,(0,P.AM)(s.config),e.a(2);case 5:return e.n=6,(0,F.showAlertDialog)(this,{text:this.hass.localize("ui.panel.config.script.editor.load_error_unknown",{err_no:n.status_code})});case 6:return e.a(2)}},e,this,[[0,3]])})),function(e){return y.apply(this,arguments)})},{key:"_deleteConfirm",value:(f=(0,n.A)((0,o.A)().m(function e(t){return(0,o.A)().w(function(e){for(;;)switch(e.n){case 0:(0,F.dk)(this,{title:this.hass.localize("ui.panel.config.script.editor.delete_confirm_title"),text:this.hass.localize("ui.panel.config.script.editor.delete_confirm_text",{name:t.name}),confirmText:this.hass.localize("ui.common.delete"),dismissText:this.hass.localize("ui.common.cancel"),confirm:()=>this._delete(t),destructive:!0});case 1:return e.a(2)}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"_delete",value:(p=(0,n.A)((0,o.A)().m(function e(t){var i,a;return(0,o.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!(i=this.entityRegistry.find(e=>e.entity_id===t.entity_id))){e.n=1;break}return e.n=1,(0,P.Ht)(this.hass,i.unique_id);case 1:e.n=3;break;case 2:return e.p=2,a=e.v,e.n=3,(0,F.showAlertDialog)(this,{text:400===a.status_code?this.hass.localize("ui.panel.config.script.editor.load_error_not_deletable"):this.hass.localize("ui.panel.config.script.editor.load_error_unknown",{err_no:a.status_code})});case 3:return e.a(2)}},e,this,[[0,2]])})),function(e){return p.apply(this,arguments)})},{key:"_bulkAddArea",value:(i=(0,n.A)((0,o.A)().m(function e(t){var i,a,s;return(0,o.A)().w(function(e){for(;;)switch(e.n){case 0:return i=[],this._selected.forEach(e=>{i.push((0,E.G_)(this.hass,e,{area_id:t}))}),e.n=1,Promise.allSettled(i);case 1:a=e.v,(0,V.$)(a)&&(s=(0,V.N)(a),(0,F.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.common.multiselect.failed",{number:s.length}),text:(0,g.qy)(Se||(Se=qe`<pre>
${0}</pre>`),s.map(e=>e.reason.message||e.reason.code||e.reason).join("\r\n"))}));case 2:return e.a(2)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_handleSortingChanged",value:function(e){this._activeSorting=e.detail}},{key:"_handleGroupingChanged",value:function(e){var t;this._activeGrouping=null!==(t=e.detail.value)&&void 0!==t?t:""}},{key:"_handleCollapseChanged",value:function(e){this._activeCollapsed=e.detail.value}},{key:"_handleColumnsChanged",value:function(e){this._activeColumnOrder=e.detail.columnOrder,this._activeHiddenColumns=e.detail.hiddenColumns}}],[{key:"styles",get:function(){return[T.RF,(0,g.AH)(ze||(ze=qe`:host{display:block;height:100%}hass-tabs-subpage-data-table{--data-table-row-height:60px}hass-tabs-subpage-data-table.narrow{--data-table-row-height:72px}a{text-decoration:none}.empty{--mdc-icon-size:80px;max-width:500px}.empty ha-button{--mdc-icon-size:24px}.empty h1{font-size:var(--ha-font-size-3xl)}ha-assist-chip{--ha-assist-chip-container-shape:10px}ha-md-button-menu ha-assist-chip{--md-assist-chip-trailing-space:8px}ha-label{--ha-label-background-color:var(--color, var(--grey-color));--ha-label-background-opacity:0.5}`))]}}]);var i,p,f,y,C,S,z,R}((0,W.E)(g.WF));(0,p.__decorate)([(0,y.MZ)({attribute:!1})],Oe.prototype,"hass",void 0),(0,p.__decorate)([(0,y.MZ)({attribute:!1})],Oe.prototype,"scripts",void 0),(0,p.__decorate)([(0,y.MZ)({attribute:"is-wide",type:Boolean})],Oe.prototype,"isWide",void 0),(0,p.__decorate)([(0,y.MZ)({type:Boolean})],Oe.prototype,"narrow",void 0),(0,p.__decorate)([(0,y.MZ)({attribute:!1})],Oe.prototype,"route",void 0),(0,p.__decorate)([(0,y.MZ)({attribute:!1})],Oe.prototype,"entityRegistry",void 0),(0,p.__decorate)([(0,y.wk)()],Oe.prototype,"_searchParms",void 0),(0,p.__decorate)([(0,y.wk)()],Oe.prototype,"_selected",void 0),(0,p.__decorate)([(0,y.wk)()],Oe.prototype,"_activeFilters",void 0),(0,p.__decorate)([(0,y.wk)()],Oe.prototype,"_filteredScripts",void 0),(0,p.__decorate)([(0,y.wk)(),(0,C.I)({storage:"sessionStorage",key:"script-table-search",state:!0,subscribe:!1})],Oe.prototype,"_filter",void 0),(0,p.__decorate)([(0,y.wk)(),(0,C.I)({storage:"sessionStorage",key:"script-table-filters-full",state:!0,subscribe:!1,serializer:I.i,deserializer:I.D})],Oe.prototype,"_filters",void 0),(0,p.__decorate)([(0,y.wk)()],Oe.prototype,"_expandedFilter",void 0),(0,p.__decorate)([(0,y.wk)()],Oe.prototype,"_categories",void 0),(0,p.__decorate)([(0,y.wk)()],Oe.prototype,"_labels",void 0),(0,p.__decorate)([(0,y.wk)(),(0,f.Fg)({context:R.ih,subscribe:!0})],Oe.prototype,"_entityReg",void 0),(0,p.__decorate)([(0,C.I)({key:"script-table-sort",state:!1,subscribe:!1})],Oe.prototype,"_activeSorting",void 0),(0,p.__decorate)([(0,C.I)({key:"script-table-grouping",state:!1,subscribe:!1})],Oe.prototype,"_activeGrouping",void 0),(0,p.__decorate)([(0,C.I)({key:"script-table-collapsed",state:!1,subscribe:!1})],Oe.prototype,"_activeCollapsed",void 0),(0,p.__decorate)([(0,C.I)({key:"script-table-column-order",state:!1,subscribe:!1})],Oe.prototype,"_activeColumnOrder",void 0),(0,p.__decorate)([(0,C.I)({key:"script-table-hidden-columns",state:!1,subscribe:!1})],Oe.prototype,"_activeHiddenColumns",void 0),Oe=(0,p.__decorate)([(0,y.EM)("ha-script-picker")],Oe),t()}catch(Ee){t(Ee)}})},75320:function(e,t,i){i.a(e,async function(e,t){try{var a=i(98735),s=i(88486),o=i(62020),n=i(31802),r=i(97750),l=i(21101),c=i(23180),d=i(87426),h=(i(1415),i(32203),i(38606),i(96956),i(79827),i(65315),i(837),i(22416),i(45519),i(5934),i(30536),i(69868)),u=(i(40075),i(84922)),p=i(90227),_=i(11991),f=i(75907),v=i(36207),g=i(11111),y=i(20051),m=i(61246),b=i(44017),$=i(15676),A=i(94372),k=(i(9058),i(56657),i(42699)),w=i(91197),C=i(8567),H=i(14466),x=i(46156),M=i(85173),V=i(954),S=i(20233),z=e([C,H,S,x]);[C,H,S,x]=z.then?(await z)():z;var q,L,R,I,O,E=e=>e,Z=(0,v.Ik)({alias:(0,v.lq)((0,v.Yj)()),description:(0,v.lq)((0,v.Yj)()),sequence:(0,v.lq)((0,v.YO)((0,v.bz)())),icon:(0,v.lq)((0,v.Yj)()),mode:(0,v.lq)((0,v.vP)([typeof k.FN])),max:(0,v.lq)((0,v.ai)()),fields:(0,v.lq)((0,v.Ik)())}),P=function(e){function t(){var e;(0,o.A)(this,t);for(var i=arguments.length,n=new Array(i),c=0;c<i;c++)n[c]=arguments[c];return(e=(0,l.A)(this,t,[].concat(n))).isWide=!1,e.narrow=!1,e.disabled=!1,e.saving=!1,e.dirty=!1,e._sidebarKey=0,e._sidebarWidthPx=x.Q,e._openFields=!1,e._handlePaste=function(){var t=(0,s.A)((0,a.A)().m(function t(i){var s,o,n,l,c,d,h;return(0,a.A)().w(function(t){for(;;)switch(t.p=t.n){case 0:if((0,m.u)(i.composedPath())){t.n=1;break}return t.a(2);case 1:if(o=null===(s=i.clipboardData)||void 0===s?void 0:s.getData("text")){t.n=2;break}return t.a(2);case 2:t.p=2,n=(0,p.Hh)(o),t.n=4;break;case 3:return t.p=3,t.v,(0,w.P)((0,r.A)(e),{message:e.hass.localize("ui.panel.config.script.editor.paste_invalid_config"),duration:4e3,dismissable:!0}),t.a(2);case 4:if(n&&"object"==typeof n){t.n=5;break}return t.a(2);case 5:"script"in(l=n)&&(l=l.script,Object.keys(l).length&&(l=l[Object.keys(l)[0]])),Array.isArray(l)&&(l=1===l.length?l[0]:{sequence:l}),["sequence","unknown"].includes((0,k.pq)(l))||(l={sequence:[l]}),t.p=6,c=(0,k.nB)(l),t.n=8;break;case 7:return t.p=7,t.v,t.a(2);case 8:t.p=8,(0,v.vA)(c,Z),t.n=10;break;case 9:return t.p=9,t.v,(0,w.P)((0,r.A)(e),{message:e.hass.localize("ui.panel.config.script.editor.paste_invalid_config"),duration:4e3,dismissable:!0}),t.a(2);case 10:if(!c){t.n=14;break}if(i.preventDefault(),1!==(h=Object.keys(c).filter(e=>(0,g.e)(c[e]).length)).length||!["sequence"].includes(h[0])){t.n=11;break}if(!e._tryInsertAfterSelected(c[h[0]])){t.n=11;break}return e._showPastedToastWithUndo(),t.a(2);case 11:if(!(e.dirty||null!==(d=(0,g.e)(e.config.sequence))&&void 0!==d&&d.length||Object.keys(e.config.fields||{}).length)){t.n=13;break}return t.n=12,new Promise(t=>{(0,M.Z)((0,r.A)(e),{domain:"script",pastedConfig:c,onClose:()=>t(!1),onAppend:()=>{e._appendToExistingConfig(c),t(!1)},onReplace:()=>t(!0)})});case 12:if(t.v){t.n=13;break}return t.a(2);case 13:e._replaceExistingConfig(c);case 14:return t.a(2)}},t,null,[[8,9],[6,7],[2,3]])}));return function(e){return t.apply(this,arguments)}}(),e}return(0,c.A)(t,e),(0,n.A)(t,[{key:"addFields",value:function(){this._openFields=!0,(0,b.r)(this,"value-changed",{value:Object.assign(Object.assign({},this.config),{},{fields:{[this.hass.localize("ui.panel.config.script.editor.field.field")||"field"]:{selector:{text:null}}}})})}},{key:"updated",value:function(e){var t;this._openFields&&e.has("config")&&(this._openFields=!1,null===(t=this._scriptFields)||void 0===t||t.updateComplete.then(()=>{var e;return null===(e=this._scriptFields)||void 0===e?void 0:e.focusLastField()}))}},{key:"_renderContent",value:function(){var e,t;return(0,u.qy)(q||(q=E` ${0} ${0} <div class="header"> <h2 id="sequence-heading" class="name"> ${0} </h2> </div> <ha-automation-action role="region" aria-labelledby="sequence-heading" .actions="${0}" .highlightedActions="${0}" @value-changed="${0}" @open-sidebar="${0}" @request-close-sidebar="${0}" @close-sidebar="${0}" .hass="${0}" .narrow="${0}" .disabled="${0}" root sidebar></ha-automation-action> `),this.config.description?(0,u.qy)(L||(L=E`<ha-markdown class="description" breaks .content="${0}"></ha-markdown>`),this.config.description):u.s6,this.config.fields?(0,u.qy)(R||(R=E`<div class="header"> <h2 id="fields-heading" class="name"> ${0} </h2> </div> <ha-script-fields role="region" aria-labelledby="fields-heading" .fields="${0}" .highlightedFields="${0}" @value-changed="${0}" .hass="${0}" .disabled="${0}" .narrow="${0}" @open-sidebar="${0}" @request-close-sidebar="${0}" @close-sidebar="${0}"></ha-script-fields>`),this.hass.localize("ui.panel.config.script.editor.field.fields"),this.config.fields,null===(e=this._pastedConfig)||void 0===e?void 0:e.fields,this._fieldsChanged,this.hass,this.disabled,this.narrow,this._openSidebar,this.triggerCloseSidebar,this._handleCloseSidebar):u.s6,this.hass.localize("ui.panel.config.script.editor.sequence"),this.config.sequence||[],null===(t=this._pastedConfig)||void 0===t?void 0:t.sequence,this._sequenceChanged,this._openSidebar,this.triggerCloseSidebar,this._handleCloseSidebar,this.hass,this.narrow,this.disabled||this.saving)}},{key:"render",value:function(){return(0,u.qy)(I||(I=E` <div class="${0}"> <div class="content-wrapper"> <div class="content ${0}"> <slot name="alerts"></slot> ${0} </div> <div class="fab-positioner"> <div class="fab-positioner"> <ha-fab slot="fab" class="${0}" .label="${0}" .disabled="${0}" extended @click="${0}"> <ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon> </ha-fab> </div> </div> </div> <div class="sidebar-positioner"> <ha-automation-sidebar .sidebarKey="${0}" tabindex="-1" class="${0}" .narrow="${0}" .isWide="${0}" .hass="${0}" .config="${0}" .disabled="${0}" @value-changed="${0}" @sidebar-resized="${0}" @sidebar-resizing-stopped="${0}"></ha-automation-sidebar> </div> </div> `),(0,f.H)({"has-sidebar":this._sidebarConfig&&!this.narrow}),this._sidebarConfig&&this.narrow?"has-bottom-sheet":"",this._renderContent(),this.dirty?"dirty":"",this.hass.localize("ui.common.save"),this.saving,this._saveScript,"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z",this._sidebarKey,(0,f.H)({hidden:!this._sidebarConfig}),this.narrow,this.isWide,this.hass,this._sidebarConfig,this.disabled,this._sidebarConfigChanged,this._resizeSidebar,this._stopResizeSidebar)}},{key:"firstUpdated",value:function(e){(0,d.A)(t,"firstUpdated",this,3)([e]),this.style.setProperty("--sidebar-dynamic-width",`${this._sidebarWidthPx}px`),"1"===(0,A.p9)("expanded")&&(this._clearParam("expanded"),this.expandAll())}},{key:"_clearParam",value:function(e){window.history.replaceState(null,"",(0,$.Z)((0,A.s8)(e)))}},{key:"_fieldsChanged",value:function(e){e.stopPropagation(),this.resetPastedConfig(),(0,b.r)(this,"value-changed",{value:Object.assign(Object.assign({},this.config),{},{fields:e.detail.value})})}},{key:"_sequenceChanged",value:function(e){e.stopPropagation(),this.resetPastedConfig(),(0,b.r)(this,"value-changed",{value:Object.assign(Object.assign({},this.config),{},{sequence:e.detail.value})})}},{key:"connectedCallback",value:function(){(0,d.A)(t,"connectedCallback",this,3)([]),window.addEventListener("paste",this._handlePaste)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("paste",this._handlePaste),(0,d.A)(t,"disconnectedCallback",this,3)([])}},{key:"_appendToExistingConfig",value:function(e){this._pastedConfig=e;var t=Object.assign({},this.config);t&&("fields"in e&&(t.fields=Object.assign(Object.assign({},t.fields),e.fields)),"sequence"in e&&(t.sequence=(0,g.e)(t.sequence||[]).concat((0,g.e)(e.sequence))),this._showPastedToastWithUndo(),(0,b.r)(this,"value-changed",{value:Object.assign({},t)}))}},{key:"_replaceExistingConfig",value:function(e){this._pastedConfig=e,this._showPastedToastWithUndo(),(0,b.r)(this,"value-changed",{value:Object.assign({},e)})}},{key:"_showPastedToastWithUndo",value:function(){(0,w.P)(this,{message:this.hass.localize("ui.panel.config.script.editor.paste_toast_message"),duration:4e3,action:{text:this.hass.localize("ui.common.undo"),action:()=>{(0,b.r)(this,"undo-change"),this._pastedConfig=void 0}}})}},{key:"resetPastedConfig",value:function(){this._pastedConfig=void 0,(0,w.P)(this,{message:"",duration:0})}},{key:"_openSidebar",value:(i=(0,s.A)((0,a.A)().m(function e(t){var i,s,o,n;return(0,a.A)().w(function(e){for(;;)switch(e.n){case 0:return null===(i=this._sidebarConfig)||void 0===i||null===(s=i.close)||void 0===s||s.call(i),this._sidebarConfig=t.detail,this._sidebarKey++,e.n=1,null===(o=this._sidebarElement)||void 0===o?void 0:o.updateComplete;case 1:null===(n=this._sidebarElement)||void 0===n||n.focus();case 2:return e.a(2)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_sidebarConfigChanged",value:function(e){e.stopPropagation(),this._sidebarConfig&&(this._sidebarConfig=Object.assign(Object.assign({},this._sidebarConfig),e.detail.value))}},{key:"triggerCloseSidebar",value:function(){if(this._sidebarConfig){var e;if(this._sidebarElement)return void this._sidebarElement.triggerCloseSidebar();null===(e=this._sidebarConfig)||void 0===e||e.close(),this._sidebarKey=0}}},{key:"_handleCloseSidebar",value:function(){this._sidebarConfig=void 0}},{key:"_saveScript",value:function(){this.triggerCloseSidebar(),(0,b.r)(this,"save-script")}},{key:"_tryInsertAfterSelected",value:function(e){return!(!this._sidebarConfig||!("insertAfter"in this._sidebarConfig))&&this._sidebarConfig.insertAfter(e)}},{key:"expandAll",value:function(){var e;null===(e=this._collapsableElements)||void 0===e||e.forEach(e=>{e.expandAll()})}},{key:"collapseAll",value:function(){var e;null===(e=this._collapsableElements)||void 0===e||e.forEach(e=>{e.collapseAll()})}},{key:"copySelectedRow",value:function(){var e;null!==(e=this._sidebarConfig)&&void 0!==e&&e.copy&&this._sidebarConfig.copy()}},{key:"cutSelectedRow",value:function(){var e;null!==(e=this._sidebarConfig)&&void 0!==e&&e.cut&&this._sidebarConfig.cut()}},{key:"deleteSelectedRow",value:function(){var e;null!==(e=this._sidebarConfig)&&void 0!==e&&e.delete&&this._sidebarConfig.delete()}},{key:"_resizeSidebar",value:function(e){e.stopPropagation();var t,i=e.detail.deltaInPx;this._prevSidebarWidthPx||(this._prevSidebarWidthPx=(null===(t=this._sidebarElement)||void 0===t?void 0:t.clientWidth)||x.Q);var a=i+this._prevSidebarWidthPx;this._sidebarWidthPx=a,this.style.setProperty("--sidebar-dynamic-width",`${this._sidebarWidthPx}px`)}},{key:"_stopResizeSidebar",value:function(e){e.stopPropagation(),this._prevSidebarWidthPx=void 0}}],[{key:"styles",get:function(){return[V.T_,V.qK,(0,u.AH)(O||(O=E`.header{display:flex;align-items:center}.header:first-child{margin-top:-16px}.header .name{font-size:var(--ha-font-size-xl);font-weight:var(--ha-font-weight-normal);flex:1}.description{margin-top:16px}`))]}}]);var i}(u.WF);(0,h.__decorate)([(0,_.MZ)({attribute:!1})],P.prototype,"hass",void 0),(0,h.__decorate)([(0,_.MZ)({attribute:"is-wide",type:Boolean})],P.prototype,"isWide",void 0),(0,h.__decorate)([(0,_.MZ)({type:Boolean})],P.prototype,"narrow",void 0),(0,h.__decorate)([(0,_.MZ)({type:Boolean})],P.prototype,"disabled",void 0),(0,h.__decorate)([(0,_.MZ)({type:Boolean})],P.prototype,"saving",void 0),(0,h.__decorate)([(0,_.MZ)({attribute:!1})],P.prototype,"config",void 0),(0,h.__decorate)([(0,_.MZ)({attribute:!1})],P.prototype,"dirty",void 0),(0,h.__decorate)([(0,_.wk)()],P.prototype,"_pastedConfig",void 0),(0,h.__decorate)([(0,_.wk)()],P.prototype,"_sidebarConfig",void 0),(0,h.__decorate)([(0,_.wk)()],P.prototype,"_sidebarKey",void 0),(0,h.__decorate)([(0,y.I)({key:"automation-sidebar-width",state:!1,subscribe:!1})],P.prototype,"_sidebarWidthPx",void 0),(0,h.__decorate)([(0,_.P)("ha-script-fields")],P.prototype,"_scriptFields",void 0),(0,h.__decorate)([(0,_.P)("ha-automation-sidebar")],P.prototype,"_sidebarElement",void 0),(0,h.__decorate)([(0,_.YG)("ha-automation-action, ha-script-fields")],P.prototype,"_collapsableElements",void 0),P=(0,h.__decorate)([(0,_.EM)("manual-script-editor")],P),t()}catch(j){t(j)}})}}]);
//# sourceMappingURL=83673.9994c91f315d056a.js.map