"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["85759"],{94327:function(t,e,a){a.d(e,{Vy:function(){return s},fI:function(){return o},ux:function(){return c}});a(80178),a(45519);var i=a(65940),n=a(83510),r=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function s(t){return r[t%r.length]}function o(t,e){var a=e.getPropertyValue(`--graph-color-${t+1}`)||s(t);return(0,n.RQ)(a)}var c=(0,i.A)(t=>r.map((e,a)=>o(a,t)),(t,e)=>t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1"))},37382:function(t,e,a){a.d(e,{D:function(){return r}});var i=a(10416),n=a.n(i),r=t=>n()(t,{whiteList:{},stripIgnoreTag:!0,stripIgnoreTagBody:!0})},71770:function(t,e,a){var i,n,r,s,o=a(62020),c=a(31802),d=a(21101),l=a(23180),u=a(87426),h=(a(38606),a(69868)),p=a(30103),_=a(86811),f=a(49377),v=a(34800),g=a(84922),m=a(11991),y=t=>t,b=function(t){function e(){var t;(0,o.A)(this,e);for(var a=arguments.length,i=new Array(a),n=0;n<a;n++)i[n]=arguments[n];return(t=(0,d.A)(this,e,[].concat(i))).filled=!1,t.active=!1,t}return(0,l.A)(e,t),(0,c.A)(e,[{key:"renderOutline",value:function(){return this.filled?(0,g.qy)(i||(i=y`<span class="filled"></span>`)):(0,u.A)(e,"renderOutline",this,3)([])}},{key:"getContainerClasses",value:function(){return Object.assign(Object.assign({},(0,u.A)(e,"getContainerClasses",this,3)([])),{},{active:this.active})}},{key:"renderPrimaryContent",value:function(){return(0,g.qy)(n||(n=y` <span class="leading icon" aria-hidden="true"> ${0} </span> <span class="label">${0}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${0} </span> `),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}},{key:"renderTrailingIcon",value:function(){return(0,g.qy)(r||(r=y`<slot name="trailing-icon"></slot>`))}}])}(p.k);b.styles=[f.R,v.R,_.R,(0,g.AH)(s||(s=y`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`))],(0,h.__decorate)([(0,m.MZ)({type:Boolean,reflect:!0})],b.prototype,"filled",void 0),(0,h.__decorate)([(0,m.MZ)({type:Boolean})],b.prototype,"active",void 0),b=(0,h.__decorate)([(0,m.EM)("ha-assist-chip")],b)},63002:function(t,e,a){a.a(t,async function(t,i){try{a.d(e,{$3:function(){return m},$O:function(){return A},$j:function(){return y},ED:function(){return c},JE:function(){return $},OQ:function(){return T},PU:function(){return D},Ph:function(){return v},Uf:function(){return w},W1:function(){return g},Wr:function(){return p},Z:function(){return u},gF:function(){return b},iY:function(){return k},jU:function(){return d},nN:function(){return C},p3:function(){return h},pJ:function(){return f},r_:function(){return l},sz:function(){return _}});var n=a(18202),r=(a(79827),a(65315),a(59023),a(45519),a(72652)),s=a(50654),o=t([s]);s=(o.then?(await o)():o)[0];var c=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({}),d=59509==a.j?["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"]:null,l=["L","gal","ft³","m³","CCF","MCF"],u=t=>t.sendMessagePromise({type:"recorder/info"}),h=(t,e)=>t.callWS({type:"recorder/list_statistic_ids",statistic_type:e}),p=(t,e)=>t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e}),_=function(t,e,a,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"hour",r=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;return t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==a?void 0:a.toISOString(),statistic_ids:i,period:n,units:r,types:s})},f=(t,e,a,i)=>t.callWS({type:"recorder/statistic_during_period",statistic_id:e,units:i,fixed_period:a.fixed_period?{start_time:a.fixed_period.start instanceof Date?a.fixed_period.start.toISOString():a.fixed_period.start,end_time:a.fixed_period.end instanceof Date?a.fixed_period.end.toISOString():a.fixed_period.end}:void 0,calendar:a.calendar?Object.assign(Object.assign({},"week"===a.calendar.period?{first_weekday:(0,s.DD)(t.locale).substring(0,3)}:{}),a.calendar):void 0,rolling_window:a.rolling_window}),v=t=>t.callWS({type:"recorder/validate_statistics"}),g=(t,e,a,i)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:a,unit_class:i}),m=(t,e)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:e}),y=t=>{var e=null;if(!t)return null;var a,i=(0,n.A)(t);try{for(i.s();!(a=i.n()).done;){var r=a.value;null!==r.change&&void 0!==r.change&&(null===e?e=r.change:e+=r.change)}}catch(s){i.e(s)}finally{i.f()}return e},b=(t,e)=>{var a,i=null,r=(0,n.A)(e);try{for(r.s();!(a=r.n()).done;){var s=a.value;if(s in t){var o=y(t[s]);null!==o&&(null===i?i=o:i+=o)}}}catch(c){r.e(c)}finally{r.f()}return i},k=(t,e)=>t.some(t=>void 0!==t[e]&&null!==t[e]),x=["mean","min","max"],S=["sum","state","change"],C=(t,e)=>!(!x.includes(e)||0===t.mean_type)||!(!S.includes(e)||!t.has_sum),w=(t,e,a,i,n)=>{var r=new Date(a).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:r,adjustment:i,adjustment_unit_of_measurement:n})},A=(t,e,a)=>{var i=t.states[e];return i?(0,r.u)(i):(null==a?void 0:a.name)||e},$=(t,e,a)=>{var i,n;e&&(i=null===(n=t.states[e])||void 0===n?void 0:n.attributes.unit_of_measurement);return void 0===i?null==a?void 0:a.statistics_unit_of_measurement:i},T=t=>t.includes(":"),D=t=>t.callWS({type:"recorder/update_statistics_issues"});i()}catch(M){i(M)}})},42029:function(t,e,a){a.d(e,{g:function(){return r}});a(39118);var i=a(83510),n=a(6788);function r(t,e,a,r,s,o){var c=t.getPropertyValue(s+"-"+o).trim(),d=c.length>0?c:t.getPropertyValue(s).trim(),l=(0,i.RQ)(d);return 0===c.length&&o&&(l=(0,i.v2)((0,i.BE)(e?(0,n.T)((0,i.Nc)((0,i.xp)(l)),o):(0,n.d)((0,i.Nc)((0,i.xp)(l)),o)))),r?l+=a?"32":"7F":a&&(l+="7F"),l}},51337:function(t,e,a){a.a(t,async function(t,i){try{a.r(e),a.d(e,{HuiEnergyDevicesGraphCard:function(){return H}});var n=a(98735),r=a(88486),s=a(73983),o=a(62020),c=a(31802),d=a(97750),l=a(21101),u=a(23180),h=(a(38606),a(96956),a(44941),a(79827),a(80178),a(99342),a(9724),a(35058),a(64654),a(65315),a(837),a(84136),a(22416),a(37089),a(48169),a(45519),a(30536),a(69868)),p=a(84922),_=a(11991),f=a(75907),v=a(65940),g=a(1570),m=a(37382),y=a(94327),b=a(8868),k=a(68717),x=a(43716),S=a(63002),C=a(40328),w=a(8510),A=(a(70490),a(44017)),$=a(35083),T=(a(9058),a(20051)),D=a(32211),M=a(42029),I=t([k,x,b,S]);[k,x,b,S]=I.then?(await I)():I;var O,V,W=t=>t,H=function(t){function e(){var t;(0,o.A)(this,e);for(var a=arguments.length,i=new Array(a),n=0;n<a;n++)i[n]=arguments[n];return(t=(0,l.A)(this,e,[].concat(i)))._chartData=[],t._legendData=[],t._chartType="bar",t._hiddenStats=[],t._isMobile=!1,t._compoundStats=[],t.hassSubscribeRequiredHostProps=["_config"],t._createOptions=(0,v.A)((e,a,i)=>{var n,r,o={grid:{top:5,left:5,right:40,bottom:0,containLabel:!0},tooltip:{show:!0,formatter:t._renderTooltip.bind((0,d.A)(t))},xAxis:{show:!1},yAxis:{show:!1},legend:{type:"custom",show:!1}};"bar"===a?(o.xAxis={show:!0,type:"value",name:"kWh"},o.yAxis={show:!0,type:"category",inverse:!0,triggerEvent:!0,data:null===(n=e[0])||void 0===n||null===(n=n.data)||void 0===n?void 0:n.map(t=>t.name),axisLabel:{formatter:t._getDeviceName.bind((0,d.A)(t)),overflow:"truncate",fontSize:12,margin:5,width:Math.min(t._isMobile?100:200,Math.max.apply(Math,(0,s.A)((null===(r=e[0])||void 0===r||null===(r=r.data)||void 0===r?void 0:r.map(e=>(0,$.W)(t._getDeviceName(e.name),12)+5))||[])))}}):o.legend={type:"custom",show:!0,data:i,selected:i.filter(e=>e.id&&t._hiddenStats.includes(e.id)).reduce((t,e)=>(t[e.id]=!1,t),{})};return o}),t}return(0,u.A)(e,t),(0,c.A)(e,[{key:"hassSubscribe",value:function(){var t;return[(0,x.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe(t=>{this._data=t,this._getStatistics(t)}),(0,D.m)("all and (max-width: 450px), all and (max-height: 500px)",t=>{this._isMobile=t})]}},{key:"getCardSize",value:function(){return 3}},{key:"setConfig",value:function(t){this._config=t}},{key:"shouldUpdate",value:function(t){return(0,w.xP)(this,t)||t.size>1||!t.has("hass")}},{key:"render",value:function(){var t;return this.hass&&this._config?(0,p.qy)(O||(O=W` <ha-card> <div class="card-header"> <span>${0}</span> <ha-icon-button .path="${0}" .label="${0}" @click="${0}"></ha-icon-button> </div> <div class="content ${0}"> <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" .height="${0}" .extraComponents="${0}" @chart-click="${0}" @dataset-hidden="${0}" @dataset-unhidden="${0}"></ha-chart-base> </div> </ha-card> `),this._config.title?this._config.title:p.s6,"pie"===this._chartType?"M22,21H2V3H4V19H6V10H10V19H12V6H16V19H18V14H22V21Z":"M13,2.05V5.08C16.39,5.57 19,8.47 19,12C19,12.9 18.82,13.75 18.5,14.54L21.12,16.07C21.68,14.83 22,13.45 22,12C22,6.82 18.05,2.55 13,2.05M12,19A7,7 0 0,1 5,12C5,8.47 7.61,5.57 11,5.08V2.05C5.94,2.55 2,6.81 2,12A10,10 0 0,0 12,22C15.3,22 18.23,20.39 20.05,17.91L17.45,16.38C16.17,18 14.21,19 12,19Z",this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.change_chart_type"),this._handleChartTypeChange,(0,f.H)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._chartData,this._chartType,this._legendData),`${Math.max(300,28*((null===(t=this._legendData)||void 0===t?void 0:t.length)||0)+50)}px`,[g.a],this._handleChartClick,this._datasetHidden,this._datasetUnhidden):p.s6}},{key:"_renderTooltip",value:function(t){var e=`<h4 style="text-align: center; margin: 0;">${(0,m.D)(this._getDeviceName(t.name))}</h4>`,a=`${(0,b.ZV)(t.value[0],this.hass.locale,t.value<.1?{maximumFractionDigits:3}:void 0)} kWh`;return`${e}${t.marker} ${t.seriesName}: ${a}`}},{key:"_getDeviceName",value:function(t){var e,a,i=this._compoundStats.includes(t)?` (${this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.untracked")})`:"";return((null===(e=this._data)||void 0===e||null===(e=e.prefs.device_consumption.find(e=>e.stat_consumption===t))||void 0===e?void 0:e.name)||(0,S.$O)(this.hass,t,null===(a=this._data)||void 0===a?void 0:a.statsMetadata[t]))+i}},{key:"_getStatistics",value:(a=(0,r.A)((0,n.A)().m(function t(e){var a,i,r,s,o,c,d,l,u,h,p,_,f,v,g,m,k,C,w,A,$,T,D;return(0,n.A)().w(function(t){for(;;)switch(t.n){case 0:i=e.stats,r=e.statsCompare,s=[],o=[],c=[{type:this._chartType,radius:[r?"50%":"40%","70%"],universalTransition:!0,name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.energy_usage"),itemStyle:{borderRadius:"bar"===this._chartType?[0,4,4,0]:4},data:s,barWidth:r?10:20,cursor:"default",minShowLabelAngle:15,label:"pie"===this._chartType?{formatter:t=>{var e=t.name;return this._getDeviceName(e)},overflow:"break",alignTo:this._isMobile?"edge":"none",edgeDistance:1}:void 0,labelLine:{length2:10}}],r&&c.push({type:this._chartType,radius:["30%","50%"],universalTransition:!0,name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.previous_energy_usage"),itemStyle:{borderRadius:"bar"===this._chartType?[0,4,4,0]:4},data:o,barWidth:10,cursor:"default",label:"pie"===this._chartType?{show:!1}:void 0,emphasis:"pie"===this._chartType?{focus:"series",blurScope:"global"}:void 0}),d=getComputedStyle(this),this._compoundStats=e.prefs.device_consumption.map(t=>t.included_in_stat).filter(Boolean),l=e.prefs.device_consumption,u={},l.forEach(t=>{u[t.stat_consumption]=t.stat_consumption in i&&(0,S.$j)(i[t.stat_consumption])||0}),h={},r&&l.forEach(t=>{h[t.stat_consumption]=t.stat_consumption in r&&(0,S.$j)(r[t.stat_consumption])||0}),l.forEach((t,e)=>{var a,i=u[t.stat_consumption];if(null!==(a=this._config)&&void 0!==a&&a.hide_compound_stats){if(this._compoundStats.includes(t.stat_consumption))return}else{var n=l.reduce((e,a)=>a.included_in_stat===t.stat_consumption?e+u[a.stat_consumption]:e,0);i-=Math.min(i,n)}var c=(0,y.fI)(e,d);if(s.push({id:t.stat_consumption,value:[i,t.stat_consumption],name:t.stat_consumption,itemStyle:{color:c+"7F",borderColor:c}}),r){var p=t.stat_consumption in r&&(0,S.$j)(r[t.stat_consumption])||0,_=l.reduce((e,a)=>a.included_in_stat===t.stat_consumption?e+h[a.stat_consumption]:e,0);p-=Math.min(p,_),o.push({id:t.stat_consumption,value:[p,t.stat_consumption],name:t.stat_consumption,itemStyle:{color:c+"32",borderColor:c+"7F"}})}}),"pie"===this._chartType&&(p=s,_=(0,x.gv)(e),f=_.summedData,v=_.compareSummedData,g=(0,x.DR)(f,v),m=g.consumption,k=g.compareConsumption,C=m.total.used_total,(w="from_grid"in f||"solar"in f||"from_battery"in f?C-p.reduce((t,e)=>t+e.value[0],0):0)>0&&(A=(0,M.g)(d,this.hass.themes.darkMode,!1,!1,"--history-unknown-color"),p.push({id:"untracked",value:[w,"untracked"],name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.untracked_consumption"),itemStyle:{color:A+"7F",borderColor:A}}),r&&($=k.total.used_total-o.reduce((t,e)=>t+e.value[0],0))>0&&o.push({id:"untracked",value:[$,"untracked"],name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.untracked_consumption"),itemStyle:{color:A+"32",borderColor:A+"7F"}})),T=p.reduce((t,e)=>this._hiddenStats.includes(e.id)?t:t+e.value[0],0),c.push({type:"pie",radius:["0%",r?"30%":"40%"],name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.total_energy_usage"),data:[T],label:{show:!0,position:"center",color:d.getPropertyValue("--secondary-text-color"),fontSize:d.getPropertyValue("--ha-font-size-l"),lineHeight:24,fontWeight:"bold",formatter:`{a}\n${(0,b.ZV)(T,this.hass.locale)} kWh`},cursor:"default",itemStyle:{color:"rgba(0, 0, 0, 0)"},tooltip:{show:!1}})),s.sort((t,e)=>e.value[0]-t.value[0]),null!==(a=this._config)&&void 0!==a&&a.max_devices&&s.length>this._config.max_devices&&s.splice(this._config.max_devices),this._legendData=s.map(t=>Object.assign(Object.assign({},t),{},{name:this._getDeviceName(t.name)}));for(D=s.length-1;D>=0;D--)this._hiddenStats.includes(s[D].id)&&s.splice(D,1);return r&&(c[1].data=s.map(t=>o.find(e=>e.id===t.id))),this._chartData=c,t.n=1,this.updateComplete;case 1:return t.a(2)}},t,this)})),function(t){return a.apply(this,arguments)})},{key:"_handleChartClick",value:function(t){var e;"axisLabel"===t.detail.targetType&&t.detail.value&&!(0,S.OQ)(t.detail.value)?(0,A.r)(this,"hass-more-info",{entityId:t.detail.value}):"pie"===t.detail.seriesType&&"tspan"===(null===(e=t.detail.event)||void 0===e||null===(e=e.target)||void 0===e?void 0:e.type)&&(0,A.r)(this,"hass-more-info",{entityId:t.detail.data.id})}},{key:"_handleChartTypeChange",value:function(){this._chartType="pie"===this._chartType?"bar":"pie",this._getStatistics(this._data)}},{key:"_datasetHidden",value:function(t){this._hiddenStats=[].concat((0,s.A)(this._hiddenStats),[t.detail.id]),this._getStatistics(this._data)}},{key:"_datasetUnhidden",value:function(t){this._hiddenStats=this._hiddenStats.filter(e=>e!==t.detail.id),this._getStatistics(this._data)}}]);var a}((0,C.E)(p.WF));H.styles=(0,p.AH)(V||(V=W`.card-header{display:flex;justify-content:space-between;align-items:center;padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}ha-chart-base{--chart-max-height:none}ha-icon-button{transform:rotate(90deg);color:var(--secondary-text-color);cursor:pointer}`)),(0,h.__decorate)([(0,_.MZ)({attribute:!1})],H.prototype,"hass",void 0),(0,h.__decorate)([(0,_.wk)()],H.prototype,"_config",void 0),(0,h.__decorate)([(0,_.wk)()],H.prototype,"_chartData",void 0),(0,h.__decorate)([(0,_.wk)()],H.prototype,"_data",void 0),(0,h.__decorate)([(0,_.wk)()],H.prototype,"_legendData",void 0),(0,h.__decorate)([(0,_.wk)(),(0,T.I)({key:"energy-devices-graph-chart-type",state:!0,subscribe:!1})],H.prototype,"_chartType",void 0),(0,h.__decorate)([(0,_.wk)(),(0,T.I)({key:"energy-devices-pie-hidden-stats",state:!0,subscribe:!1})],H.prototype,"_hiddenStats",void 0),(0,h.__decorate)([(0,_.wk)()],H.prototype,"_isMobile",void 0),H=(0,h.__decorate)([(0,_.EM)("hui-energy-devices-graph-card")],H),i()}catch(z){i(z)}})},35083:function(t,e,a){var i;function n(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Roboto, Noto, sans-serif";i||(i=document.createElement("canvas"));var n=i.getContext("2d");if(!n)return 0;n.font=`${e}px ${a}`;var r=n.measureText(t);return Math.ceil(Math.max(r.actualBoundingBoxRight+r.actualBoundingBoxLeft,r.width))}a.d(e,{W:function(){return n}})}}]);
//# sourceMappingURL=85759.808afc24c9448f4f.js.map