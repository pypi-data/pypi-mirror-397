"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["57874"],{71770:function(e,t,i){var a,r,n,o,s=i(62020),l=i(31802),c=i(21101),u=i(23180),h=i(87426),d=(i(38606),i(69868)),p=i(30103),v=i(86811),f=i(49377),y=i(34800),g=i(84922),_=i(11991),b=e=>e,m=function(e){function t(){var e;(0,s.A)(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(e=(0,c.A)(this,t,[].concat(a))).filled=!1,e.active=!1,e}return(0,u.A)(t,e),(0,l.A)(t,[{key:"renderOutline",value:function(){return this.filled?(0,g.qy)(a||(a=b`<span class="filled"></span>`)):(0,h.A)(t,"renderOutline",this,3)([])}},{key:"getContainerClasses",value:function(){return Object.assign(Object.assign({},(0,h.A)(t,"getContainerClasses",this,3)([])),{},{active:this.active})}},{key:"renderPrimaryContent",value:function(){return(0,g.qy)(r||(r=b` <span class="leading icon" aria-hidden="true"> ${0} </span> <span class="label">${0}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${0} </span> `),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}},{key:"renderTrailingIcon",value:function(){return(0,g.qy)(n||(n=b`<slot name="trailing-icon"></slot>`))}}])}(p.k);m.styles=[f.R,y.R,v.R,(0,g.AH)(o||(o=b`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`))],(0,d.__decorate)([(0,_.MZ)({type:Boolean,reflect:!0})],m.prototype,"filled",void 0),(0,d.__decorate)([(0,_.MZ)({type:Boolean})],m.prototype,"active",void 0),m=(0,d.__decorate)([(0,_.EM)("ha-assist-chip")],m)},62070:function(e,t,i){i.d(t,{J8:function(){return r},Rr:function(){return o},b9:function(){return a},iV:function(){return n}});i(89958),i(98522),i(45519),i(47849),i(24456);var a=e=>{var t=e;return"string"==typeof e&&(t=parseInt(e,16)),"0x"+t.toString(16).padStart(4,"0")},r=(e,t)=>{var i=e.user_given_name?e.user_given_name:e.name,a=t.user_given_name?t.user_given_name:t.name;return i.localeCompare(a)},n=(e,t)=>{var i=e.name,a=t.name;return i.localeCompare(a)},o=e=>`${e.name} (Endpoint id: ${e.endpoint_id}, Id: ${a(e.id)}, Type: ${e.type})`},98542:function(e,t,i){i.a(e,async function(e,a){try{i.r(t),i.d(t,{ZHANetworkVisualizationPage:function(){return w}});var r=i(98735),n=i(88486),o=i(62020),s=i(31802),l=i(21101),c=i(23180),u=i(87426),h=(i(38606),i(96956),i(44941),i(79827),i(99342),i(35058),i(65315),i(84136),i(22416),i(45519),i(67579),i(30500),i(30536),i(69868)),d=i(84922),p=i(11991),v=i(77240),f=i(52188),y=i(58811),g=(i(35320),i(62070)),_=i(36108),b=e([f,_]);[f,_]=b.then?(await b)():b;var m,k,z=e=>e,w=function(e){function t(){var e;(0,o.A)(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(e=(0,l.A)(this,t,[].concat(a))).narrow=!1,e.isWide=!1,e._networkData={nodes:[],links:[],categories:[]},e._devices=[],e._tooltipFormatter=t=>{var i=t.dataType,a=t.data,r=t.name;if("edge"===i){var n,o=a.source,s=a.target,l=a.value,c=e._networkData.nodes.find(e=>e.id===s).name,u=e._networkData.nodes.find(e=>e.id===o).name,h=`${u} → ${c}${l?` <b>LQI:</b> ${l}`:""}`,d=null===(n=e._networkData.links.find(e=>e.source===o&&e.target===s))||void 0===n?void 0:n.reverseValue;return d?`${h}<br>${c} → ${u} <b>LQI:</b> ${d}`:h}var p=e._devices.find(e=>e.ieee===a.id);if(!p)return r;var v=`<b>IEEE: </b>${p.ieee}`;if(v+=`<br><b>${e.hass.localize("ui.panel.config.zha.visualization.device_type")}: </b>${p.device_type.replace("_"," ")}`,null!=p.nwk&&(v+=`<br><b>NWK: </b>${(0,g.b9)(p.nwk)}`),null!=p.manufacturer&&null!=p.model?v+=`<br><b>${e.hass.localize("ui.panel.config.zha.visualization.device")}: </b>${p.manufacturer} ${p.model}`:v+=`<br><b>${e.hass.localize("ui.panel.config.zha.visualization.device_not_in_db")}</b>`,p.area_id){var f=e.hass.areas[p.area_id];f&&(v+=`<br><b>${e.hass.localize("ui.panel.config.zha.visualization.area")}: </b>${f.name}`)}return v},e}return(0,c.A)(t,e),(0,s.A)(t,[{key:"firstUpdated",value:function(e){(0,u.A)(t,"firstUpdated",this,3)([e]),this.hass&&this._fetchData()}},{key:"render",value:function(){return(0,d.qy)(m||(m=z` <hass-tabs-subpage .tabs="${0}" .hass="${0}" .narrow="${0}" .isWide="${0}" .route="${0}" header="${0}"> <ha-network-graph .hass="${0}" .data="${0}" .tooltipFormatter="${0}" @chart-click="${0}"> <ha-icon-button slot="button" class="refresh-button" .path="${0}" @click="${0}" label="${0}"></ha-icon-button> </ha-network-graph> </hass-tabs-subpage> `),_.zhaTabs,this.hass,this.narrow,this.isWide,this.route,this.hass.localize("ui.panel.config.zha.visualization.header"),this.hass,this._networkData,this._tooltipFormatter,this._handleChartClick,"M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z",this._refreshTopology,this.hass.localize("ui.panel.config.zha.visualization.refresh_topology"))}},{key:"_fetchData",value:(a=(0,n.A)((0,r.A)().m(function e(){return(0,r.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,y.Uc)(this.hass);case 1:this._devices=e.v,this._networkData=this._createChartData(this._devices);case 2:return e.a(2)}},e,this)})),function(){return a.apply(this,arguments)})},{key:"_refreshTopology",value:(i=(0,n.A)((0,r.A)().m(function e(){return(0,r.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,y.xU)(this.hass);case 1:return e.n=2,this._fetchData();case 2:return e.a(2)}},e,this)})),function(){return i.apply(this,arguments)})},{key:"_handleChartClick",value:function(e){if("node"===e.detail.dataType&&"pointer"===e.detail.event.target.cursor){var t=e.detail.data.id,i=this._devices.find(e=>e.ieee===t);i&&(0,v.o)(`/config/devices/device/${i.device_reg_id}`)}}},{key:"_createChartData",value:function(e){var t=getComputedStyle(this),i=t.getPropertyValue("--primary-color"),a=t.getPropertyValue("--cyan-color"),r=t.getPropertyValue("--teal-color"),n=t.getPropertyValue("--error-color"),o=[],s=[],l=[{name:this.hass.localize("ui.panel.config.zha.visualization.coordinator"),symbol:"roundRect",itemStyle:{color:i}},{name:this.hass.localize("ui.panel.config.zha.visualization.router"),symbol:"circle",itemStyle:{color:a}},{name:this.hass.localize("ui.panel.config.zha.visualization.end_device"),symbol:"circle",itemStyle:{color:r}},{name:this.hass.localize("ui.panel.config.zha.visualization.offline"),symbol:"circle",itemStyle:{color:n}}];return e.forEach(l=>{var c,u="Coordinator"===l.device_type;c=l.available?u?0:"Router"===l.device_type?1:2:3,o.push({id:l.ieee,name:l.user_given_name||l.name||l.ieee,category:c,value:u?3:"Router"===l.device_type?2:1,symbolSize:u?40:"Router"===l.device_type?30:20,symbol:u?"roundRect":"circle",itemStyle:{color:l.available?u?i:"Router"===l.device_type?a:r:n},polarDistance:0===c?0:1===c?.5:.9,fixed:u});var h=s.filter(e=>e.source===l.ieee||e.target===l.ieee);if(l.routes&&l.routes.length>0)l.routes.forEach(e=>{var a=l.neighbors.find(t=>t.nwk===e.next_hop);if(a){var r=h.find(e=>e.source===a.ieee||e.target===a.ieee);if(r){var n;if(r.source===l.ieee)r.value=Math.max(r.value,parseInt(a.lqi));else r.reverseValue=Math.max(null!==(n=r.reverseValue)&&void 0!==n?n:0,parseInt(a.lqi));var o=this._getLQIWidth(parseInt(a.lqi));r.symbolSize=o/4*6+3,r.lineStyle=Object.assign(Object.assign({},r.lineStyle),{},{width:o,color:"Active"===e.route_status?i:r.lineStyle.color,type:["Child","Parent"].includes(a.relationship)?"solid":r.lineStyle.type})}else{var c=this._getLQIWidth(parseInt(a.lqi)),u={source:l.ieee,target:a.ieee,value:parseInt(a.lqi),lineStyle:{width:c,color:"Active"===e.route_status?i:t.getPropertyValue("--disabled-color"),type:["Child","Parent"].includes(a.relationship)?"solid":"dotted"},symbolSize:c/4*6+3,ignoreForceLayout:"0x0000"!==e.dest_nwk};s.push(u),h.push(u)}}});else if(0===h.length){var d,p=null!==(d=l.neighbors)&&void 0!==d?d:[];0===p.length&&e.forEach(e=>{if(e.neighbors&&e.neighbors.length>0){var t=e.neighbors.find(e=>e.ieee===l.ieee);t&&p.push({ieee:e.ieee,lqi:t.lqi})}});var v=p.sort((e,t)=>parseInt(t.lqi)-parseInt(e.lqi))[0];v&&s.push({source:l.ieee,target:v.ieee,value:parseInt(v.lqi),symbolSize:5,lineStyle:{width:1,color:t.getPropertyValue("--disabled-color"),type:"dotted"},ignoreForceLayout:!0})}}),e.forEach(e=>{var t;"Coordinator"===e.device_type?s.forEach(t=>{t.source!==e.ieee&&t.target!==e.ieee||(t.ignoreForceLayout=!1)}):!s.some(i=>{if(i.source===e.ieee||i.target===e.ieee){var a,r;if(!i.ignoreForceLayout)return!0;i.value>(null!==(a=null===(r=t)||void 0===r?void 0:r.value)&&void 0!==a?a:-1)&&(t=i)}return!1})&&t&&(t.ignoreForceLayout=!1)}),{nodes:o,links:s,categories:l}}},{key:"_getLQIWidth",value:function(e){return e>200?3:e>100?2:1}}],[{key:"styles",get:function(){return[(0,d.AH)(k||(k=z`ha-network-graph{height:100%}`))]}}]);var i,a}(d.WF);(0,h.__decorate)([(0,p.MZ)({attribute:!1})],w.prototype,"hass",void 0),(0,h.__decorate)([(0,p.MZ)({attribute:!1})],w.prototype,"route",void 0),(0,h.__decorate)([(0,p.MZ)({type:Boolean,reflect:!0})],w.prototype,"narrow",void 0),(0,h.__decorate)([(0,p.MZ)({attribute:"is-wide",type:Boolean})],w.prototype,"isWide",void 0),(0,h.__decorate)([(0,p.wk)()],w.prototype,"_networkData",void 0),(0,h.__decorate)([(0,p.wk)()],w.prototype,"_devices",void 0),w=(0,h.__decorate)([(0,p.EM)("zha-network-visualization-page")],w),a()}catch($){a($)}})},10629:function(e,t,i){i.a(e,async function(e,t){try{i(35748),i(5934),i(95013);"function"!=typeof window.ResizeObserver&&(window.ResizeObserver=(await i.e("70997").then(i.bind(i,78567))).default),t()}catch(a){t(a)}},1)}}]);
//# sourceMappingURL=57874.9e958c07362df941.js.map