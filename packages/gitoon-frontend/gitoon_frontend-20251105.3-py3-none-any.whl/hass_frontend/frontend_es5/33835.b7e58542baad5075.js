"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["33835"],{63002:function(e,t,a){a.a(e,async function(e,r){try{a.d(t,{$3:function(){return f},$O:function(){return x},$j:function(){return b},ED:function(){return c},JE:function(){return W},OQ:function(){return R},PU:function(){return q},Ph:function(){return m},Uf:function(){return S},W1:function(){return p},Wr:function(){return h},Z:function(){return _},gF:function(){return v},iY:function(){return $},jU:function(){return i},nN:function(){return C},p3:function(){return u},pJ:function(){return g},r_:function(){return d},sz:function(){return y}});var l=a(18202),n=(a(79827),a(65315),a(59023),a(45519),a(72652)),s=a(50654),o=e([s]);s=(o.then?(await o)():o)[0];var c=function(e){return e[e.NONE=0]="NONE",e[e.ARITHMETIC=1]="ARITHMETIC",e[e.CIRCULAR=2]="CIRCULAR",e}({}),i=59509==a.j?["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"]:null,d=["L","gal","ft³","m³","CCF","MCF"],_=e=>e.sendMessagePromise({type:"recorder/info"}),u=(e,t)=>e.callWS({type:"recorder/list_statistic_ids",statistic_type:t}),h=(e,t)=>e.callWS({type:"recorder/get_statistics_metadata",statistic_ids:t}),y=function(e,t,a,r){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"hour",n=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;return e.callWS({type:"recorder/statistics_during_period",start_time:t.toISOString(),end_time:null==a?void 0:a.toISOString(),statistic_ids:r,period:l,units:n,types:s})},g=(e,t,a,r)=>e.callWS({type:"recorder/statistic_during_period",statistic_id:t,units:r,fixed_period:a.fixed_period?{start_time:a.fixed_period.start instanceof Date?a.fixed_period.start.toISOString():a.fixed_period.start,end_time:a.fixed_period.end instanceof Date?a.fixed_period.end.toISOString():a.fixed_period.end}:void 0,calendar:a.calendar?Object.assign(Object.assign({},"week"===a.calendar.period?{first_weekday:(0,s.DD)(e.locale).substring(0,3)}:{}),a.calendar):void 0,rolling_window:a.rolling_window}),m=e=>e.callWS({type:"recorder/validate_statistics"}),p=(e,t,a,r)=>e.callWS({type:"recorder/update_statistics_metadata",statistic_id:t,unit_of_measurement:a,unit_class:r}),f=(e,t)=>e.callWS({type:"recorder/clear_statistics",statistic_ids:t}),b=e=>{var t=null;if(!e)return null;var a,r=(0,l.A)(e);try{for(r.s();!(a=r.n()).done;){var n=a.value;null!==n.change&&void 0!==n.change&&(null===t?t=n.change:t+=n.change)}}catch(s){r.e(s)}finally{r.f()}return t},v=(e,t)=>{var a,r=null,n=(0,l.A)(t);try{for(n.s();!(a=n.n()).done;){var s=a.value;if(s in e){var o=b(e[s]);null!==o&&(null===r?r=o:r+=o)}}}catch(c){n.e(c)}finally{n.f()}return r},$=(e,t)=>e.some(e=>void 0!==e[t]&&null!==e[t]),w=["mean","min","max"],k=["sum","state","change"],C=(e,t)=>!(!w.includes(t)||0===e.mean_type)||!(!k.includes(t)||!e.has_sum),S=(e,t,a,r,l)=>{var n=new Date(a).toISOString();return e.callWS({type:"recorder/adjust_sum_statistics",statistic_id:t,start_time:n,adjustment:r,adjustment_unit_of_measurement:l})},x=(e,t,a)=>{var r=e.states[t];return r?(0,n.u)(r):(null==a?void 0:a.name)||t},W=(e,t,a)=>{var r,l;t&&(r=null===(l=e.states[t])||void 0===l?void 0:l.attributes.unit_of_measurement);return void 0===r?null==a?void 0:a.statistics_unit_of_measurement:r},R=e=>e.includes(":"),q=e=>e.callWS({type:"recorder/update_statistics_issues"});r()}catch(O){r(O)}})},42029:function(e,t,a){a.d(t,{g:function(){return n}});a(39118);var r=a(83510),l=a(6788);function n(e,t,a,n,s,o){var c=e.getPropertyValue(s+"-"+o).trim(),i=c.length>0?c:e.getPropertyValue(s).trim(),d=(0,r.RQ)(i);return 0===c.length&&o&&(d=(0,r.v2)((0,r.BE)(t?(0,l.T)((0,r.Nc)((0,r.xp)(d)),o):(0,l.d)((0,r.Nc)((0,r.xp)(d)),o)))),n?d+=a?"32":"7F":a&&(d+="7F"),d}},90470:function(e,t,a){a.a(e,async function(e,r){try{a.r(t),a.d(t,{HuiEnergySourcesTableCard:function(){return P}});var l=a(15243),n=a(62020),s=a(31802),o=a(21101),c=a(23180),i=(a(38606),a(96956),a(79827),a(35748),a(80178),a(65315),a(837),a(37089),a(59023),a(29726),a(52885),a(45519),a(69868)),d=a(83214),_=a(84922),u=a(11991),h=a(75907),y=a(48893),g=a(8868),m=a(42029),p=(a(70490),a(43716)),f=a(63002),b=a(40328),v=a(8510),$=a(44017),w=e([g,p,f]);[g,p,f]=w.then?(await w)():w;var k,C,S,x,W,R,q,O,j,z,I,A,D,E,T,M,V,Z,U=e=>e,N={grid_return:"--energy-grid-return-color",grid_consumption:"--energy-grid-consumption-color",battery_in:"--energy-battery-in-color",battery_out:"--energy-battery-out-color",solar:"--energy-solar-color",gas:"--energy-gas-color",water:"--energy-water-color"},P=function(e){function t(){var e;(0,n.A)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(e=(0,o.A)(this,t,[].concat(r))).hassSubscribeRequiredHostProps=["_config"],e}return(0,c.A)(t,e),(0,s.A)(t,[{key:"hassSubscribe",value:function(){var e;return[(0,p.tb)(this.hass,{key:null===(e=this._config)||void 0===e?void 0:e.collection_key}).subscribe(e=>{this._data=e})]}},{key:"getCardSize",value:function(){return 3}},{key:"setConfig",value:function(e){this._config=e}},{key:"shouldUpdate",value:function(e){return(0,v.xP)(this,e)||e.size>1||!e.has("hass")}},{key:"_renderRow",value:function(e,t,a,r,l,n,s,o,c,i,d){var u;return(0,_.qy)(k||(k=U`<tr class="mdc-data-table__row ${0}" @click="${0}" .entity="${0}"> <td class="mdc-data-table__cell cell-bullet"> <div class="bullet" style="${0}"></div> </td> <th class="mdc-data-table__cell" scope="row"> ${0} </th> ${0} <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} ${0} </td> ${0} </tr>`),(0,h.H)({clickable:!(0,f.OQ)(a)}),this._handleMoreInfo,a,(0,y.W)({borderColor:(0,m.g)(e,this.hass.themes.darkMode,!1,!1,N[t],r),backgroundColor:(0,m.g)(e,this.hass.themes.darkMode,!0,!1,N[t],r)}),(0,f.$O)(this.hass,a,null===(u=this._data)||void 0===u?void 0:u.statsMetadata[a]),d?(0,_.qy)(C||(C=U`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} ${0} </td> ${0}`),(0,g.ZV)(n,this.hass.locale),s,i?(0,_.qy)(S||(S=U`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td>`),null!==c?(0,g.ZV)(c,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):""):"",(0,g.ZV)(l,this.hass.locale),s,i?(0,_.qy)(x||(x=U` <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td>`),null!==o?(0,g.ZV)(o,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):"")}},{key:"_renderTotalRow",value:function(e,t,a,r,l,n,s,o){return(0,_.qy)(W||(W=U` <tr class="mdc-data-table__row total"> <td class="mdc-data-table__cell"></td> <th class="mdc-data-table__cell" scope="row">${0}</th> ${0} <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td> ${0} </tr>`),e,o?(0,_.qy)(R||(R=U`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td> ${0}`),null===a?"":`${(0,g.ZV)(a,this.hass.locale)} ${r}`,s?(0,_.qy)(q||(q=U`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td>`),null!==n?(0,g.ZV)(n,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):""):"",null===t?"":`${(0,g.ZV)(t,this.hass.locale)} ${r}`,s?(0,_.qy)(O||(O=U`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${0} </td>`),null!==l?(0,g.ZV)(l,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""):"")}},{key:"render",value:function(){var e,t,a,r,n,s,o,c,i;if(!this.hass||!this._config)return _.s6;if(!this._data)return(0,_.qy)(j||(j=U`${0}`),this.hass.localize("ui.panel.lovelace.cards.energy.loading"));var d=0,u=0,h=0,y=!1,g=0,m=0,b=0,v={gas:0,water:0,solar:0},$={gas:0,water:0,solar:0},w={gas:0,water:0},k={gas:0,water:0},C={gas:!1,water:!1},S=(0,p.E$)(this._data.prefs),x=null===(e=this._config)||void 0===e?void 0:e.types,W=x?Object.fromEntries(Object.entries(S).filter(e=>{var t=(0,l.A)(e,1)[0];return x.includes(t)})):S,R=getComputedStyle(this),q=!!(null!==(t=W.grid)&&void 0!==t&&t[0].flow_from.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)||null!==(a=W.grid)&&void 0!==a&&a[0].flow_to.some(e=>e.stat_compensation||e.entity_energy_price||e.number_energy_price)||null!==(r=W.gas)&&void 0!==r&&r.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)||null!==(n=W.water)&&void 0!==n&&n.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)),O={solar:"kWh",gas:this._data.gasUnit,water:this._data.waterUnit},Z=void 0!==this._data.statsCompare,N=(e,t)=>{var a=(0,f.$j)(this._data.stats[e]),r=Z&&(0,f.$j)(this._data.statsCompare[e]),l=t&&(0,f.$j)(this._data.stats[t])||0,n=Z&&t&&(0,f.$j)(this._data.statsCompare[t])||0;return null!==a||Z&&null!==r?{hasData:!0,energy:a||0,energyCompare:r||0,cost:l,costCompare:n}:{hasData:!1,energy:a||0,energyCompare:r||0,cost:l,costCompare:n}},P=e=>{var t;return(0,_.qy)(z||(z=U` ${0} ${0}`),null===(t=W[e])||void 0===t?void 0:t.map((t,a)=>{var r=e in C&&(t.stat_cost||this._data.info.cost_sensors[t.stat_energy_from]),l=N(t.stat_energy_from,r||null),n=l.hasData,s=l.energy,o=l.energyCompare,c=l.cost,i=l.costCompare;return n||c||i?(v[e]+=s,$[e]+=o,r&&(C[e]=!0,w[e]+=c,k[e]+=i),this._renderRow(R,e,t.stat_energy_from,a,s,o,O[e],r?c:null,r?i:null,q,Z)):_.s6}),W[e]?this._renderTotalRow(this.hass.localize(`ui.panel.lovelace.cards.energy.energy_sources_table.${e}_total`),v[e],$[e],O[e],C[e]?w[e]:null,C[e]?k[e]:null,q,Z):"")};return(0,_.qy)(I||(I=U` <ha-card> ${0} <div class="mdc-data-table"> <div class="mdc-data-table__table-container"> <table class="mdc-data-table__table" aria-label="Energy sources"> <thead> <tr class="mdc-data-table__header-row"> <th class="mdc-data-table__header-cell"></th> <th class="mdc-data-table__header-cell" role="columnheader" scope="col"> ${0} </th> ${0} <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${0} </th> ${0} </tr> </thead> <tbody class="mdc-data-table__content"> ${0} ${0} ${0} ${0} ${0} ${0} ${0} ${0} </tbody> </table> </div> </div> </ha-card>`),this._config.title?(0,_.qy)(A||(A=U`<h1 class="card-header">${0}</h1>`),this._config.title):"",this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.source"),Z?(0,_.qy)(D||(D=U`<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${0} </th> ${0}`),this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_energy"),q?(0,_.qy)(E||(E=U`<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${0} </th>`),this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_cost")):""):"",this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.energy"),q?(0,_.qy)(T||(T=U` <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${0} </th>`),this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.cost")):"",P("solar"),null===(s=W.battery)||void 0===s?void 0:s.map((e,t)=>{var a=N(e.stat_energy_from,null),r=a.hasData,l=a.energy,n=a.energyCompare,s=N(e.stat_energy_to,null),o=s.hasData,c=s.energy,i=s.energyCompare;return r||o?(h+=l-c,b+=n-i,(0,_.qy)(M||(M=U` ${0}${0}`),this._renderRow(R,"battery_out",e.stat_energy_from,t,l,n,"kWh",null,null,q,Z),this._renderRow(R,"battery_in",e.stat_energy_to,t,-c,-i,"kWh",null,null,q,Z))):_.s6}),W.battery?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.battery_total"),h,b,"kWh",null,null,q,Z):"",null===(o=W.grid)||void 0===o?void 0:o.map(e=>(0,_.qy)(V||(V=U`${0} ${0}`),e.flow_from.map((e,t)=>{var a=e.stat_cost||this._data.info.cost_sensors[e.stat_energy_from],r=N(e.stat_energy_from,a||null),l=r.hasData,n=r.energy,s=r.energyCompare,o=r.cost,c=r.costCompare;return l||o||c?(d+=n,g+=s,a&&(y=!0,u+=o,m+=c),this._renderRow(R,"grid_consumption",e.stat_energy_from,t,n,s,"kWh",o,c,q,Z)):_.s6}),e.flow_to.map((e,t)=>{var a=e.stat_compensation||this._data.info.cost_sensors[e.stat_energy_to],r=N(e.stat_energy_to,a||null),l=r.hasData,n=r.energy,s=r.energyCompare,o=r.cost,c=r.costCompare;return l||o||c?(d-=n,g-=s,null!==a&&(y=!0,u-=o,m-=c),this._renderRow(R,"grid_return",e.stat_energy_to,t,-n,-s,"kWh",-o,-c,q,Z)):_.s6}))),W.grid&&(null!==(c=W.grid)&&void 0!==c&&null!==(c=c[0].flow_from)&&void 0!==c&&c.length||null!==(i=W.grid)&&void 0!==i&&null!==(i=i[0].flow_to)&&void 0!==i&&i.length)?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.grid_total"),d,g,"kWh",y?u:null,y?m:null,q,Z):"",P("gas"),P("water"),[C.gas,C.water,y].filter(Boolean).length>1?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.total_costs"),null,null,"",w.gas+u+w.water,k.gas+m+k.water,q,Z):"")}},{key:"_handleMoreInfo",value:function(e){var t,a=null===(t=e.currentTarget)||void 0===t?void 0:t.entity;a&&!(0,f.OQ)(a)&&(0,$.r)(this,"hass-more-info",{entityId:a})}}],[{key:"styles",get:function(){return(0,_.AH)(Z||(Z=U`${0} .mdc-data-table{width:100%;border:0}.mdc-data-table__cell,.mdc-data-table__header-cell{color:var(--primary-text-color);border-bottom-color:var(--divider-color);text-align:var(--float-start)}.mdc-data-table__row:not(.mdc-data-table__row--selected):hover{background-color:rgba(var(--rgb-primary-text-color),.04)}.clickable{cursor:pointer}.total{--mdc-typography-body2-font-weight:var(--ha-font-weight-medium)}.total .mdc-data-table__cell{border-top:1px solid var(--divider-color)}ha-card{height:100%;overflow:hidden}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.cell-bullet{width:32px;padding-right:0;padding-inline-end:0;padding-inline-start:16px;direction:var(--direction)}.bullet{border-width:1px;border-style:solid;border-radius:var(--ha-border-radius-sm);height:16px;width:32px}.mdc-data-table__cell--numeric{direction:ltr}`),(0,_.iz)(d))}}])}((0,b.E)(_.WF));(0,i.__decorate)([(0,u.MZ)({attribute:!1})],P.prototype,"hass",void 0),(0,i.__decorate)([(0,u.wk)()],P.prototype,"_config",void 0),(0,i.__decorate)([(0,u.wk)()],P.prototype,"_data",void 0),P=(0,i.__decorate)([(0,u.EM)("hui-energy-sources-table-card")],P),r()}catch(F){r(F)}})}}]);
//# sourceMappingURL=33835.b7e58542baad5075.js.map