"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["97850"],{94327:function(e,t,a){a.d(t,{Vy:function(){return i},fI:function(){return s},ux:function(){return c}});a(80178),a(45519);var r=a(65940),n=a(83510),o=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function i(e){return o[e%o.length]}function s(e,t){var a=t.getPropertyValue(`--graph-color-${e+1}`)||i(e);return(0,n.RQ)(a)}var c=(0,r.A)(e=>o.map((t,a)=>s(a,e)),(e,t)=>e[0].getPropertyValue("--graph-color-1")===t[0].getPropertyValue("--graph-color-1"))},71770:function(e,t,a){var r,n,o,i,s=a(62020),c=a(31802),d=a(21101),l=a(23180),u=a(87426),h=(a(38606),a(69868)),f=a(30103),p=a(86811),_=a(49377),g=a(34800),y=a(84922),v=a(11991),b=e=>e,m=function(e){function t(){var e;(0,s.A)(this,t);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(e=(0,d.A)(this,t,[].concat(r))).filled=!1,e.active=!1,e}return(0,l.A)(t,e),(0,c.A)(t,[{key:"renderOutline",value:function(){return this.filled?(0,y.qy)(r||(r=b`<span class="filled"></span>`)):(0,u.A)(t,"renderOutline",this,3)([])}},{key:"getContainerClasses",value:function(){return Object.assign(Object.assign({},(0,u.A)(t,"getContainerClasses",this,3)([])),{},{active:this.active})}},{key:"renderPrimaryContent",value:function(){return(0,y.qy)(n||(n=b` <span class="leading icon" aria-hidden="true"> ${0} </span> <span class="label">${0}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${0} </span> `),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}},{key:"renderTrailingIcon",value:function(){return(0,y.qy)(o||(o=b`<slot name="trailing-icon"></slot>`))}}])}(f.k);m.styles=[_.R,g.R,p.R,(0,y.AH)(i||(i=b`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`))],(0,h.__decorate)([(0,v.MZ)({type:Boolean,reflect:!0})],m.prototype,"filled",void 0),(0,h.__decorate)([(0,v.MZ)({type:Boolean})],m.prototype,"active",void 0),m=(0,h.__decorate)([(0,v.EM)("ha-assist-chip")],m)},42029:function(e,t,a){a.d(t,{g:function(){return o}});a(39118);var r=a(83510),n=a(6788);function o(e,t,a,o,i,s){var c=e.getPropertyValue(i+"-"+s).trim(),d=c.length>0?c:e.getPropertyValue(i).trim(),l=(0,r.RQ)(d);return 0===c.length&&s&&(l=(0,r.v2)((0,r.BE)(t?(0,n.T)((0,r.Nc)((0,r.xp)(l)),s):(0,n.d)((0,r.Nc)((0,r.xp)(l)),s)))),o?l+=a?"32":"7F":a&&(l+="7F"),l}},62757:function(e,t,a){a.a(e,async function(e,r){try{a.r(t),a.d(t,{HuiEnergyUsageGraphCard:function(){return P}});var n=a(15243),o=a(98735),i=a(73983),s=a(18202),c=a(88486),d=a(62020),l=a(31802),u=a(21101),h=a(23180),f=(a(38606),a(79827),a(99342),a(35058),a(65315),a(22416),a(59023),a(29726),a(45519),a(74774),a(30536),a(69868)),p=a(30765),_=a(76174),g=a(56590),y=a(84922),v=a(11991),b=a(75907),m=a(65940),k=a(42029),A=a(8868),x=a(68717),w=(a(70490),a(43716)),O=a(63002),C=a(40328),j=a(8510),D=a(36886),E=e([x,A,w,D,O]);[x,A,w,D,O]=E.then?(await E)():E;var $,S,z,M,R=e=>e,I={to_grid:"--energy-grid-return-color",to_battery:"--energy-battery-in-color",from_grid:"--energy-grid-consumption-color",used_grid:"--energy-grid-consumption-color",used_solar:"--energy-solar-color",used_battery:"--energy-battery-out-color"},P=function(e){function t(){var e;(0,d.A)(this,t);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(e=(0,u.A)(this,t,[].concat(r)))._chartData=[],e._start=(0,p.R)(),e._end=(0,_.o)(),e.hassSubscribeRequiredHostProps=["_config"],e._formatTotal=t=>t>0?e.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.total_consumed",{num:(0,A.ZV)(t,e.hass.locale)}):e.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.total_returned",{num:(0,A.ZV)(-t,e.hass.locale)}),e._createOptions=(0,m.A)((t,a,r,n,o,i)=>{var s=(0,D.od)(t,a,r,n,"kWh",o,i,e._formatTotal);return Object.assign(Object.assign({},s),{},{tooltip:Object.assign(Object.assign({},s.tooltip),{},{formatter:e=>{var t,a;return Array.isArray(e)?(e.sort((e,t)=>{var a,r,n=null===(a=e.value)||void 0===a?void 0:a[1],o=null===(r=t.value)||void 0===r?void 0:r[1];return n>0&&o<0?-1:o>0&&n<0?1:n>0?t.componentIndex-e.componentIndex:e.componentIndex-t.componentIndex}),null===(t=s.tooltip)||void 0===t||null===(a=t.formatter)||void 0===a?void 0:a.call(t,e)):""}})})}),e}return(0,h.A)(t,e),(0,l.A)(t,[{key:"hassSubscribe",value:function(){var e;return[(0,w.tb)(this.hass,{key:null===(e=this._config)||void 0===e?void 0:e.collection_key}).subscribe(e=>this._getStatistics(e))]}},{key:"getCardSize",value:function(){return 3}},{key:"setConfig",value:function(e){this._config=e}},{key:"shouldUpdate",value:function(e){return(0,j.xP)(this,e)||e.size>1||!e.has("hass")}},{key:"render",value:function(){return this.hass&&this._config?(0,y.qy)($||($=R` <ha-card> ${0} <div class="content ${0}"> <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" chart-type="bar"></ha-chart-base> ${0} </div> </ha-card> `),this._config.title?(0,y.qy)(S||(S=R`<h1 class="card-header">${0}</h1>`),this._config.title):"",(0,b.H)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,this._compareStart,this._compareEnd),this._chartData.some(e=>e.data.length)?"":(0,y.qy)(z||(z=R`<div class="no-data"> ${0} </div>`),(0,g.c)(this._start)?this.hass.localize("ui.panel.lovelace.cards.energy.no_data"):this.hass.localize("ui.panel.lovelace.cards.energy.no_data_period"))):y.s6}},{key:"_getStatistics",value:(a=(0,c.A)((0,o.A)().m(function e(t){var a,r,n,c,d,l,u,h,f,p,g,y,v,b,m,k,A,x,O,C,j;return(0,o.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:a=[],r={},n=(0,s.A)(t.prefs.energy_sources),e.p=1,n.s();case 2:if((c=n.n()).done){e.n=7;break}if("solar"!==(d=c.value).type){e.n=3;break}return r.solar?r.solar.push(d.stat_energy_from):r.solar=[d.stat_energy_from],e.a(3,6);case 3:if("battery"!==d.type){e.n=4;break}return r.to_battery?(r.to_battery.push(d.stat_energy_to),r.from_battery.push(d.stat_energy_from)):(r.to_battery=[d.stat_energy_to],r.from_battery=[d.stat_energy_from]),e.a(3,6);case 4:if("grid"===d.type){e.n=5;break}return e.a(3,6);case 5:l=(0,s.A)(d.flow_from);try{for(l.s();!(u=l.n()).done;)h=u.value,r.from_grid?r.from_grid.push(h.stat_energy_from):r.from_grid=[h.stat_energy_from]}catch(o){l.e(o)}finally{l.f()}f=(0,s.A)(d.flow_to);try{for(f.s();!(p=f.n()).done;)g=p.value,r.to_grid?r.to_grid.push(g.stat_energy_to):r.to_grid=[g.stat_energy_to]}catch(o){f.e(o)}finally{f.f()}case 6:e.n=2;break;case 7:e.n=9;break;case 8:e.p=8,j=e.v,n.e(j);case 9:return e.p=9,n.f(),e.f(9);case 10:y=getComputedStyle(this),v={},Object.keys(I).forEach(e=>{v[e]={},"used_grid"!==e&&"used_solar"!==e&&"used_battery"!==e&&r[e]&&Object.values(r[e]).forEach((t,a)=>{v[e][t]=a})}),b={used_grid:this.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.combined_from_grid"),used_solar:this.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.consumed_solar"),used_battery:this.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.consumed_battery")},this._start=t.start,this._end=t.end||(0,_.o)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,m=(0,w.gv)(t),k=m.summedData,A=m.compareSummedData,x=(0,w.DR)(k,A),O=x.consumption,C=x.compareConsumption,t.statsCompare&&a.push.apply(a,(0,i.A)(this._processDataSet(t.statsCompare,t.statsMetadata,A,C,r,v,y,b,!0))),a.push({id:"compare-placeholder",type:"bar",stack:t.statsCompare?"compare":"usage",data:[],order:0}),a.push.apply(a,(0,i.A)(this._processDataSet(t.stats,t.statsMetadata,k,O,r,v,y,b,!1))),a.sort((e,t)=>e.order-t.order),(0,D.RR)(a),this._chartData=a;case 11:return e.a(2)}},e,this,[[1,8,9,10]])})),function(e){return a.apply(this,arguments)})},{key:"_processDataSet",value:function(e,t,a,r,o,i,c,d){var l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],u=[],h={};if(Object.entries(o).forEach(t=>{var a=(0,n.A)(t,2),r=a[0],o=a[1];if(["to_grid","from_grid","to_battery"].includes(r)){var i={};o.forEach(t=>{var a=e[t];if(a){var r={};a.forEach(e=>{if(null!==e.change&&void 0!==e.change){var t=e.change;e.start in r||(r[e.start]=t)}}),i[t]=r}}),h[r]=i}}),h.used_solar={used_solar:r.used_solar},h.used_battery={used_battery:r.used_battery},h.from_grid&&a.to_battery){for(var f={},p=function(){var e=(0,n.A)(g[_],2),t=e[0];if(!e[1])return 1;for(var a,o=0,i=0,s=Object.entries(h.from_grid);i<s.length;i++){var c=(0,n.A)(s[i],2),d=c[0];if(c[1][t]&&(a=d,o++),o>1)break}1===o?h.from_grid[a][t]=r.used_grid[t]:(Object.values(h.from_grid).forEach(e=>{delete e[t]}),f[t]=r.used_grid[t])},_=0,g=Object.entries(r.grid_to_battery);_<g.length;_++)p();h.used_grid={used_grid:f}}var y=a.timestamps,v=(0,D.ok)(this._start,this._compareStart);return Object.entries(h).forEach((e,a)=>{var r=(0,n.A)(e,2),o=r[0],f=r[1];Object.entries(f).forEach(e=>{var r,f,p,_=(0,n.A)(e,2),g=_[0],b=_[1],m=[],A=(0,s.A)(y);try{for(A.s();!(p=A.n()).done;){var x=p.value,w=b[x]||0,C=[new Date(x),w&&["to_grid","to_battery"].includes(o)?-1*w:w];l&&(C[2]=C[0],C[0]=v(C[0])),m.push(C)}}catch(j){A.e(j)}finally{A.f()}u.push({id:`${l?"compare-":""}${g}-${o}`,type:"bar",cursor:"default",name:o in d?d[o]:(0,O.$O)(this.hass,g,t[g]),order:"used_solar"===o?1:"to_battery"===o?Object.keys(h).length:a+2,barMaxWidth:50,itemStyle:{borderColor:(0,k.g)(c,this.hass.themes.darkMode,!1,l,I[o],null===(r=i[o])||void 0===r?void 0:r[g])},color:(0,k.g)(c,this.hass.themes.darkMode,!0,l,I[o],null===(f=i[o])||void 0===f?void 0:f[g]),stack:l?"compare":"usage",data:m})})}),u}}]);var a}((0,C.E)(y.WF));P.styles=(0,y.AH)(M||(M=R`ha-card{height:100%}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.no-data{position:absolute;height:100%;top:0;left:0;right:0;display:flex;justify-content:center;align-items:center;padding:20%;margin-left:32px;margin-inline-start:32px;margin-inline-end:initial;box-sizing:border-box}`)),(0,f.__decorate)([(0,v.MZ)({attribute:!1})],P.prototype,"hass",void 0),(0,f.__decorate)([(0,v.wk)()],P.prototype,"_config",void 0),(0,f.__decorate)([(0,v.wk)()],P.prototype,"_chartData",void 0),(0,f.__decorate)([(0,v.wk)()],P.prototype,"_start",void 0),(0,f.__decorate)([(0,v.wk)()],P.prototype,"_end",void 0),(0,f.__decorate)([(0,v.wk)()],P.prototype,"_compareStart",void 0),(0,f.__decorate)([(0,v.wk)()],P.prototype,"_compareEnd",void 0),P=(0,f.__decorate)([(0,v.EM)("hui-energy-usage-graph-card")],P),r()}catch(V){r(V)}})},43328:function(e,t,a){a.d(t,{A:function(){return n}});var r=a(67874);function n(e){return(0,r.w)(e,Date.now())}},74758:function(e,t,a){a.d(t,{o:function(){return i}});var r=a(48869),n=a(27554),o=a(28829);function i(e,t,a){var i=(0,o.b)(e,t)/n.Cg;return(0,r.u)(null==a?void 0:a.roundingMethod)(i)}},76174:function(e,t,a){a.d(t,{o:function(){return n}});var r=a(3313);function n(e){return(0,r.D)(Date.now(),e)}},87527:function(e,t,a){a.d(t,{r:function(){return i}});var r=a(15243),n=a(90298),o=a(70162);function i(e,t,a){var i=(0,n.x)(null==a?void 0:a.in,e,t),s=(0,r.A)(i,2),c=s[0],d=s[1];return+(0,o.o)(c)===+(0,o.o)(d)}},56590:function(e,t,a){a.d(t,{c:function(){return i}});var r=a(67874),n=a(43328),o=a(87527);function i(e,t){return(0,o.r)((0,r.w)((null==t?void 0:t.in)||e,e),(0,n.A)((null==t?void 0:t.in)||e))}},30765:function(e,t,a){a.d(t,{R:function(){return n}});var r=a(70162);function n(e){return(0,r.o)(Date.now(),e)}}}]);
//# sourceMappingURL=97850.3e8bbaf9abf24e63.js.map