export const __webpack_id__="33835";export const __webpack_ids__=["33835"];export const __webpack_modules__={63002:function(e,t,a){a.d(t,{$3:()=>y,$O:()=>C,$j:()=>m,ED:()=>l,JE:()=>x,OQ:()=>S,PU:()=>k,Ph:()=>u,Uf:()=>v,W1:()=>g,Wr:()=>d,Z:()=>n,gF:()=>p,iY:()=>b,jU:()=>c,nN:()=>w,p3:()=>i,pJ:()=>h,r_:()=>o,sz:()=>_});a(65315),a(59023);var r=a(72652),s=a(50654),l=function(e){return e[e.NONE=0]="NONE",e[e.ARITHMETIC=1]="ARITHMETIC",e[e.CIRCULAR=2]="CIRCULAR",e}({});const c=59509==a.j?["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"]:null,o=["L","gal","ft³","m³","CCF","MCF"],n=e=>e.sendMessagePromise({type:"recorder/info"}),i=(e,t)=>e.callWS({type:"recorder/list_statistic_ids",statistic_type:t}),d=(e,t)=>e.callWS({type:"recorder/get_statistics_metadata",statistic_ids:t}),_=(e,t,a,r,s="hour",l,c)=>e.callWS({type:"recorder/statistics_during_period",start_time:t.toISOString(),end_time:a?.toISOString(),statistic_ids:r,period:s,units:l,types:c}),h=(e,t,a,r)=>e.callWS({type:"recorder/statistic_during_period",statistic_id:t,units:r,fixed_period:a.fixed_period?{start_time:a.fixed_period.start instanceof Date?a.fixed_period.start.toISOString():a.fixed_period.start,end_time:a.fixed_period.end instanceof Date?a.fixed_period.end.toISOString():a.fixed_period.end}:void 0,calendar:a.calendar?{..."week"===a.calendar.period?{first_weekday:(0,s.DD)(e.locale).substring(0,3)}:{},...a.calendar}:void 0,rolling_window:a.rolling_window}),u=e=>e.callWS({type:"recorder/validate_statistics"}),g=(e,t,a,r)=>e.callWS({type:"recorder/update_statistics_metadata",statistic_id:t,unit_of_measurement:a,unit_class:r}),y=(e,t)=>e.callWS({type:"recorder/clear_statistics",statistic_ids:t}),m=e=>{let t=null;if(!e)return null;for(const a of e)null!==a.change&&void 0!==a.change&&(null===t?t=a.change:t+=a.change);return t},p=(e,t)=>{let a=null;for(const r of t){if(!(r in e))continue;const t=m(e[r]);null!==t&&(null===a?a=t:a+=t)}return a},b=(e,t)=>e.some(e=>void 0!==e[t]&&null!==e[t]),f=["mean","min","max"],$=["sum","state","change"],w=(e,t)=>!(!f.includes(t)||0===e.mean_type)||!(!$.includes(t)||!e.has_sum),v=(e,t,a,r,s)=>{const l=new Date(a).toISOString();return e.callWS({type:"recorder/adjust_sum_statistics",statistic_id:t,start_time:l,adjustment:r,adjustment_unit_of_measurement:s})},C=(e,t,a)=>{const s=e.states[t];return s?(0,r.u)(s):a?.name||t},x=(e,t,a)=>{let r;return t&&(r=e.states[t]?.attributes.unit_of_measurement),void 0===r?a?.statistics_unit_of_measurement:r},S=e=>e.includes(":"),k=e=>e.callWS({type:"recorder/update_statistics_issues"})},42029:function(e,t,a){a.d(t,{g:()=>l});var r=a(83510),s=a(6788);function l(e,t,a,l,c,o){const n=e.getPropertyValue(c+"-"+o).trim(),i=n.length>0?n:e.getPropertyValue(c).trim();let d=(0,r.RQ)(i);return 0===n.length&&o&&(d=(0,r.v2)((0,r.BE)(t?(0,s.T)((0,r.Nc)((0,r.xp)(d)),o):(0,s.d)((0,r.Nc)((0,r.xp)(d)),o)))),l?d+=a?"32":"7F":a&&(d+="7F"),d}},90470:function(e,t,a){a.a(e,async function(e,r){try{a.r(t),a.d(t,{HuiEnergySourcesTableCard:()=>f});a(65315),a(837),a(37089),a(59023);var s=a(69868),l=a(83214),c=a(84922),o=a(22019),n=a(75907),i=a(48893),d=a(8868),_=a(42029),h=(a(70490),a(43716)),u=a(63002),g=a(40328),y=a(8510),m=a(44017),p=e([d,h]);[d,h]=p.then?(await p)():p;const b={grid_return:"--energy-grid-return-color",grid_consumption:"--energy-grid-consumption-color",battery_in:"--energy-battery-in-color",battery_out:"--energy-battery-out-color",solar:"--energy-solar-color",gas:"--energy-gas-color",water:"--energy-water-color"};class f extends((0,g.E)(c.WF)){hassSubscribe(){return[(0,h.tb)(this.hass,{key:this._config?.collection_key}).subscribe(e=>{this._data=e})]}getCardSize(){return 3}setConfig(e){this._config=e}shouldUpdate(e){return(0,y.xP)(this,e)||e.size>1||!e.has("hass")}_renderRow(e,t,a,r,s,l,o,h,g,y,m){return c.qy`<tr class="mdc-data-table__row ${(0,n.H)({clickable:!(0,u.OQ)(a)})}" @click="${this._handleMoreInfo}" .entity="${a}"> <td class="mdc-data-table__cell cell-bullet"> <div class="bullet" style="${(0,i.W)({borderColor:(0,_.g)(e,this.hass.themes.darkMode,!1,!1,b[t],r),backgroundColor:(0,_.g)(e,this.hass.themes.darkMode,!0,!1,b[t],r)})}"></div> </td> <th class="mdc-data-table__cell" scope="row"> ${(0,u.$O)(this.hass,a,this._data?.statsMetadata[a])} </th> ${m?c.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${(0,d.ZV)(l,this.hass.locale)} ${o} </td> ${y?c.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==g?(0,d.ZV)(g,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""}`:""} <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${(0,d.ZV)(s,this.hass.locale)} ${o} </td> ${y?c.qy` <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==h?(0,d.ZV)(h,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""} </tr>`}_renderTotalRow(e,t,a,r,s,l,o,n){return c.qy` <tr class="mdc-data-table__row total"> <td class="mdc-data-table__cell"></td> <th class="mdc-data-table__cell" scope="row">${e}</th> ${n?c.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null===a?"":`${(0,d.ZV)(a,this.hass.locale)} ${r}`} </td> ${o?c.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==l?(0,d.ZV)(l,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""}`:""} <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null===t?"":`${(0,d.ZV)(t,this.hass.locale)} ${r}`} </td> ${o?c.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==s?(0,d.ZV)(s,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""} </tr>`}render(){if(!this.hass||!this._config)return c.s6;if(!this._data)return c.qy`${this.hass.localize("ui.panel.lovelace.cards.energy.loading")}`;let e=0,t=0,a=0,r=!1,s=0,l=0,o=0;const n={gas:0,water:0,solar:0},i={gas:0,water:0,solar:0},d={gas:0,water:0},_={gas:0,water:0},g={gas:!1,water:!1},y=(0,h.E$)(this._data.prefs),m=this._config?.types,p=m?Object.fromEntries(Object.entries(y).filter(([e])=>m.includes(e))):y,b=getComputedStyle(this),f=!!(p.grid?.[0].flow_from.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)||p.grid?.[0].flow_to.some(e=>e.stat_compensation||e.entity_energy_price||e.number_energy_price)||p.gas?.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)||p.water?.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)),$={solar:"kWh",gas:this._data.gasUnit,water:this._data.waterUnit},w=void 0!==this._data.statsCompare,v=(e,t)=>{const a=(0,u.$j)(this._data.stats[e]),r=w&&(0,u.$j)(this._data.statsCompare[e]),s=t&&(0,u.$j)(this._data.stats[t])||0,l=w&&t&&(0,u.$j)(this._data.statsCompare[t])||0;return null!==a||w&&null!==r?{hasData:!0,energy:a||0,energyCompare:r||0,cost:s,costCompare:l}:{hasData:!1,energy:a||0,energyCompare:r||0,cost:s,costCompare:l}},C=e=>c.qy` ${p[e]?.map((t,a)=>{const r=e in g&&(t.stat_cost||this._data.info.cost_sensors[t.stat_energy_from]),{hasData:s,energy:l,energyCompare:o,cost:h,costCompare:u}=v(t.stat_energy_from,r||null);return s||h||u?(n[e]+=l,i[e]+=o,r&&(g[e]=!0,d[e]+=h,_[e]+=u),this._renderRow(b,e,t.stat_energy_from,a,l,o,$[e],r?h:null,r?u:null,f,w)):c.s6})} ${p[e]?this._renderTotalRow(this.hass.localize(`ui.panel.lovelace.cards.energy.energy_sources_table.${e}_total`),n[e],i[e],$[e],g[e]?d[e]:null,g[e]?_[e]:null,f,w):""}`;return c.qy` <ha-card> ${this._config.title?c.qy`<h1 class="card-header">${this._config.title}</h1>`:""} <div class="mdc-data-table"> <div class="mdc-data-table__table-container"> <table class="mdc-data-table__table" aria-label="Energy sources"> <thead> <tr class="mdc-data-table__header-row"> <th class="mdc-data-table__header-cell"></th> <th class="mdc-data-table__header-cell" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.source")} </th> ${w?c.qy`<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_energy")} </th> ${f?c.qy`<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_cost")} </th>`:""}`:""} <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.energy")} </th> ${f?c.qy` <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.cost")} </th>`:""} </tr> </thead> <tbody class="mdc-data-table__content"> ${C("solar")} ${p.battery?.map((e,t)=>{const{hasData:r,energy:s,energyCompare:l}=v(e.stat_energy_from,null),{hasData:n,energy:i,energyCompare:d}=v(e.stat_energy_to,null);return r||n?(a+=s-i,o+=l-d,c.qy` ${this._renderRow(b,"battery_out",e.stat_energy_from,t,s,l,"kWh",null,null,f,w)}${this._renderRow(b,"battery_in",e.stat_energy_to,t,-i,-d,"kWh",null,null,f,w)}`):c.s6})} ${p.battery?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.battery_total"),a,o,"kWh",null,null,f,w):""} ${p.grid?.map(a=>c.qy`${a.flow_from.map((a,o)=>{const n=a.stat_cost||this._data.info.cost_sensors[a.stat_energy_from],{hasData:i,energy:d,energyCompare:_,cost:h,costCompare:u}=v(a.stat_energy_from,n||null);return i||h||u?(e+=d,s+=_,n&&(r=!0,t+=h,l+=u),this._renderRow(b,"grid_consumption",a.stat_energy_from,o,d,_,"kWh",h,u,f,w)):c.s6})} ${a.flow_to.map((a,o)=>{const n=a.stat_compensation||this._data.info.cost_sensors[a.stat_energy_to],{hasData:i,energy:d,energyCompare:_,cost:h,costCompare:u}=v(a.stat_energy_to,n||null);return i||h||u?(e-=d,s-=_,null!==n&&(r=!0,t-=h,l-=u),this._renderRow(b,"grid_return",a.stat_energy_to,o,-d,-_,"kWh",-h,-u,f,w)):c.s6})}`)} ${p.grid&&(p.grid?.[0].flow_from?.length||p.grid?.[0].flow_to?.length)?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.grid_total"),e,s,"kWh",r?t:null,r?l:null,f,w):""} ${C("gas")} ${C("water")} ${[g.gas,g.water,r].filter(Boolean).length>1?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.total_costs"),null,null,"",d.gas+t+d.water,_.gas+l+_.water,f,w):""} </tbody> </table> </div> </div> </ha-card>`}_handleMoreInfo(e){const t=e.currentTarget?.entity;t&&!(0,u.OQ)(t)&&(0,m.r)(this,"hass-more-info",{entityId:t})}static get styles(){return c.AH`${(0,c.iz)(l)} .mdc-data-table{width:100%;border:0}.mdc-data-table__cell,.mdc-data-table__header-cell{color:var(--primary-text-color);border-bottom-color:var(--divider-color);text-align:var(--float-start)}.mdc-data-table__row:not(.mdc-data-table__row--selected):hover{background-color:rgba(var(--rgb-primary-text-color),.04)}.clickable{cursor:pointer}.total{--mdc-typography-body2-font-weight:var(--ha-font-weight-medium)}.total .mdc-data-table__cell{border-top:1px solid var(--divider-color)}ha-card{height:100%;overflow:hidden}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.cell-bullet{width:32px;padding-right:0;padding-inline-end:0;padding-inline-start:16px;direction:var(--direction)}.bullet{border-width:1px;border-style:solid;border-radius:var(--ha-border-radius-sm);height:16px;width:32px}.mdc-data-table__cell--numeric{direction:ltr}`}constructor(...e){super(...e),this.hassSubscribeRequiredHostProps=["_config"]}}(0,s.__decorate)([(0,o.MZ)({attribute:!1})],f.prototype,"hass",void 0),(0,s.__decorate)([(0,o.wk)()],f.prototype,"_config",void 0),(0,s.__decorate)([(0,o.wk)()],f.prototype,"_data",void 0),f=(0,s.__decorate)([(0,o.EM)("hui-energy-sources-table-card")],f),r()}catch(e){r(e)}})}};
//# sourceMappingURL=33835.e5c0afb875c67d8c.js.map