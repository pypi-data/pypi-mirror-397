"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from enum import Enum
from finance_dev.types import BaseModel
from typing import Optional
from typing_extensions import NotRequired, TypedDict


class GrantType(str, Enum):
    r"""OAuth2 grant type"""

    AUTHORIZATION_CODE = "authorization_code"
    REFRESH_TOKEN = "refresh_token"


class Oauth2TokenRequestTypedDict(TypedDict):
    grant_type: GrantType
    r"""OAuth2 grant type"""
    client_id: str
    r"""OAuth2 client identifier"""
    code: NotRequired[str]
    r"""Authorization code from /v1/oauth2/authorize/confirm (required for authorization_code grant)"""
    client_secret: NotRequired[str]
    r"""Client secret (required for confidential clients and refresh_token grant)"""
    code_verifier: NotRequired[str]
    r"""PKCE code verifier (required for PKCE flow, replaces client_secret)"""
    redirect_uri: NotRequired[str]
    r"""Redirect URI (required for authorization_code grant, must match authorization request)"""
    refresh_token: NotRequired[str]
    r"""Refresh token (required for refresh_token grant)"""


class Oauth2TokenRequest(BaseModel):
    grant_type: GrantType
    r"""OAuth2 grant type"""

    client_id: str
    r"""OAuth2 client identifier"""

    code: Optional[str] = None
    r"""Authorization code from /v1/oauth2/authorize/confirm (required for authorization_code grant)"""

    client_secret: Optional[str] = None
    r"""Client secret (required for confidential clients and refresh_token grant)"""

    code_verifier: Optional[str] = None
    r"""PKCE code verifier (required for PKCE flow, replaces client_secret)"""

    redirect_uri: Optional[str] = None
    r"""Redirect URI (required for authorization_code grant, must match authorization request)"""

    refresh_token: Optional[str] = None
    r"""Refresh token (required for refresh_token grant)"""


class TokenType(str, Enum):
    r"""Token type (always Bearer)"""

    BEARER = "Bearer"


class Oauth2TokenResponseTypedDict(TypedDict):
    r"""Tokens generated successfully"""

    access_token: str
    r"""Bearer token for API authentication"""
    token_type: TokenType
    r"""Token type (always Bearer)"""
    expires_in: int
    r"""Access token expiration time in seconds (typically 3600 = 1 hour)"""
    refresh_token: NotRequired[str]
    r"""Token to refresh the access token"""
    refresh_token_expires_in: NotRequired[int]
    r"""Refresh token expiration time in seconds (typically 2592000 = 30 days)"""
    scope: NotRequired[str]
    r"""Space-separated list of granted scopes"""


class Oauth2TokenResponse(BaseModel):
    r"""Tokens generated successfully"""

    access_token: str
    r"""Bearer token for API authentication"""

    token_type: TokenType
    r"""Token type (always Bearer)"""

    expires_in: int
    r"""Access token expiration time in seconds (typically 3600 = 1 hour)"""

    refresh_token: Optional[str] = None
    r"""Token to refresh the access token"""

    refresh_token_expires_in: Optional[int] = None
    r"""Refresh token expiration time in seconds (typically 2592000 = 30 days)"""

    scope: Optional[str] = None
    r"""Space-separated list of granted scopes"""
