"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from enum import Enum
from finance_dev.types import BaseModel
from typing import List, Optional
from typing_extensions import NotRequired, TypedDict


class CodeChallengeMethod(str, Enum):
    r"""PKCE challenge method"""

    S256 = "S256"
    PLAIN = "plain"


class Oauth2AuthorizeRequestTypedDict(TypedDict):
    email: str
    r"""User's email address"""
    password: str
    r"""User's password"""
    client_id: str
    r"""OAuth2 client identifier"""
    redirect_uri: str
    r"""Redirect URI registered with the client"""
    response_type: NotRequired[str]
    r"""OAuth2 response type"""
    scope: NotRequired[str]
    r"""Space-separated list of requested scopes"""
    state: NotRequired[str]
    r"""Opaque value to maintain state between request and callback (CSRF protection)"""
    code_challenge: NotRequired[str]
    r"""PKCE code challenge (base64url encoded)"""
    code_challenge_method: NotRequired[CodeChallengeMethod]
    r"""PKCE challenge method"""
    sid: NotRequired[str]
    r"""Session ID for RSA encryption"""


class Oauth2AuthorizeRequest(BaseModel):
    email: str
    r"""User's email address"""

    password: str
    r"""User's password"""

    client_id: str
    r"""OAuth2 client identifier"""

    redirect_uri: str
    r"""Redirect URI registered with the client"""

    response_type: Optional[str] = "code"
    r"""OAuth2 response type"""

    scope: Optional[str] = None
    r"""Space-separated list of requested scopes"""

    state: Optional[str] = None
    r"""Opaque value to maintain state between request and callback (CSRF protection)"""

    code_challenge: Optional[str] = None
    r"""PKCE code challenge (base64url encoded)"""

    code_challenge_method: Optional[CodeChallengeMethod] = None
    r"""PKCE challenge method"""

    sid: Optional[str] = None
    r"""Session ID for RSA encryption"""


class Oauth2AuthorizeResponseTypedDict(TypedDict):
    r"""Authorization initiated successfully"""

    next_step_auth_id: NotRequired[str]
    r"""Authorization session ID for next step"""
    is_mfa: NotRequired[bool]
    r"""Whether MFA is required"""
    consent_required: NotRequired[bool]
    r"""Whether user consent is required"""
    client_name: NotRequired[str]
    r"""Name of the OAuth2 client"""
    scopes: NotRequired[List[str]]
    r"""List of requested scopes"""


class Oauth2AuthorizeResponse(BaseModel):
    r"""Authorization initiated successfully"""

    next_step_auth_id: Optional[str] = None
    r"""Authorization session ID for next step"""

    is_mfa: Optional[bool] = None
    r"""Whether MFA is required"""

    consent_required: Optional[bool] = None
    r"""Whether user consent is required"""

    client_name: Optional[str] = None
    r"""Name of the OAuth2 client"""

    scopes: Optional[List[str]] = None
    r"""List of requested scopes"""
