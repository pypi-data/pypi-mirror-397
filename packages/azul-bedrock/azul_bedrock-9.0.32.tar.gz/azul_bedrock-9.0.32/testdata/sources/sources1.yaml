# Sample grouping definitions.
sources:
  # a source called 'testing'
  testing:
    # how indexes are divided in opensearch by timestamp - year | month | week | day
    partition_unit: year
    # How many partions to keep before deleting.
    expire_events_after: 7 days
    # description used in user interface for the source
    description: Files submitted during testing of Azul
    exclude_from_backup: true
    # settings for OpenSearch indices
    elastic:
      number_of_replicas: 2
      number_of_shards: 3

    # Font Awesome icon name to display in web interface.
    icon_class: trash-alt
    # Descriptive fields to group entries in this source.
    # define available keys for key-value pairs attached to each submissions to the source
    references:
      # A brief description of this field name.
      - description: Local submitter or point of contact for samples
        # The name of this field
        name: user
        # Is this field require to be provided on all samples submitted into this source.
        required: true
        # Highlight this field.
        highlight: true
    # configure kafka settings for topics related to the source
    kafka:
      # number of independent partitions available (max dispatcher concurrency)
      # numpartitions: 3
      # number of copies of each event within the kafka cluster
      # replicationfactor: 1
      # generic topic options, check kafka documentation for more information
      config:
        # size of the working set before being created as a segment
        segment.bytes: "1073741824"
  incidents:
    expire_events_after: "0"
    partition_unit: year
    description: Incident response and samples collected during investigations
    elastic:
      number_of_replicas: 2
      number_of_shards: 3
    icon_class: ambulance
    references:
      - description: Task tracking identifier for incident or request
        name: task_id
        required: true
        highlight: true
      - description: Short description of what/why samples collected
        name: description
        required: true
      - description: Investigation/operation name the samples were collected under
        name: operation
        required: false
      - description: Local submitter or point of contact for samples
        name: user
        required: false
  reporting:
    partition_unit: year
    description: Malware reports and blogs from public, partner and commercial sources
    elastic:
      number_of_replicas: 2
      number_of_shards: 3
    icon_class: book
    references:
      - description: How widely the report was distributed, eg. public, commercial, partner
        name: distribution
        required: true
      - description: The company or agency that authored the report
        name: publisher
        required: true
      - description: The report's title
        name: title
        required: true
      - description: Website the report was published to if applicable
        name: site
        required: false
  samples:
    partition_unit: year
    description: Generic source for miscellaneous or uncategorised samples
    elastic:
      number_of_replicas: 2
      number_of_shards: 3
    icon_class: bug
    references:
      - description: Short description of what/why samples collected
        name: description
        required: true
      - description: Submitter or point of contact for samples
        name: user
        required: false
        highlight: true
      - description: Internal team who are the data owners of the samples
        name: team
        required: false
      - description: Any investigation/operation name the samples are collected under
        name: operation
        required: false
  tasking:
    partition_unit: year
    description: Malware Analysis tasking and activities
    elastic:
      number_of_replicas: 2
      number_of_shards: 3
    icon_class: search
    references:
      - description: Malware analysis task tracking identifier
        name: task_id
        required: true
        highlight: true
      - description: Short description of the task or samples
        name: description
        required: true
      - description: Local submitter or point of contact for samples
        name: user
        required: false
  virustotal:
    partition_unit: month
    expire_events_after: 3 months
    description: Recent full take metadata and selected content from virustotal.com
    exclude_from_backup: true
    elastic:
      number_of_replicas: 2
      number_of_shards: 30
    icon_class: cloud-download-alt
    references:
      - description: Anonymised id of VirusTotal submitter
        name: submitter_id
        required: false
      - description: Submission interface used to submit to VirusTotal
        name: interface
        required: false
      - description: Region within country the submission originated from
        name: submitter_region
        required: false
      - description: Country the submission originated from
        name: submitter_country
        required: false
      - description: City within region the submission originated from
        name: submitter_city
        required: false
  watch:
    partition_unit: year
    description: 24/7 Operations Watch Tasking
    elastic:
      number_of_replicas: 2
      number_of_shards: 3
    icon_class: heartbeat
    references:
      - description: Task tracking identifier for samples/activity
        name: task_id
        required: true
        highlight: true
      - description: Short description of why samples were obtained
        name: description
        required: true
      - description: Local submitter or point of contact for task
        name: user
        required: false
