# 修复目录对齐问题

文件: `{file_path}`

## 诊断
首先调用 `analyze_toc("{file_path}")` 查看具体问题。

## 问题类型与修复方法

### 1. level_mismatch（层级不匹配）
**问题**：标题的 `#` 数量与目录中的层级不一致

**修复方法**：
```bash
# 使用 sed 修改指定行的标题层级
# 例如：将第 29 行的 ### 改为 ##
sed -i '29s/^### /## /' "{file_path}"
```

**注意**：
- 根据诊断报告中的 `suggested_level` 确定正确的 `#` 数量
- 一级标题用 `#`，二级用 `##`，以此类推

### 2. text_typo（文本差异）
**问题**：标题文本与目录条目有细微差异（可能是 OCR 错误）

**修复方法**：
- 比较 `toc_text` 和 `matched_header`
- 判断哪个是正确的（通常目录更可靠）
- 使用 sed 或直接编辑修正文本

### 3. missing（缺失标题）
**问题**：目录中有条目，但正文中找不到对应标题

**修复方法**：
- 检查是否是 OCR 漏识别
- 可能需要手动添加标题
- 或者标题被错误合并到其他行

### 4. extra（多余标题）
**问题**：正文中有标题，但目录中没有

**修复方法**：
- 判断是否应该添加到目录
- 或者这个"标题"实际上不应该是标题（去掉 `#`）

## 批量修复示例

```bash
# 修复多个层级问题
sed -i '29s/^### /## /' "{file_path}"
sed -i '45s/^#### /### /' "{file_path}"
sed -i '67s/^## /# /' "{file_path}"
```

## 验证
修复后调用 `analyze_toc("{file_path}")` 确认问题已解决。
