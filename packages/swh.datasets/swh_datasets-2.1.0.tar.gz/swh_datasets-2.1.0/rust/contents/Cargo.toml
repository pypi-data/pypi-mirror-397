[package]
name = "swh-contents"
edition = "2021"
repository.workspace = true
license.workspace = true
version.workspace = true

[dependencies]
anyhow = {version="1.0.71", features=["backtrace"]}
bytemuck = { version = "1.20.0", features = ["derive"] }
dashmap = "6.1.0"
derive_more = { version = "2.0.1", features = ["add"] }
either = "1.9.0"
itertools.workspace = true
num_cpus = "1.16.0"
mimalloc = { version = "0.1" }
mmap-rs = "0.6.1"
rapidhash = "1.4.0"
rdst = { version = "0.20.14", features = ["rayon"] }
sux = "0.7.4"
swh-graph.workspace = true
swh-graph-stdlib.workspace = true
tempfile = "3.12.0"
thiserror = ">=1.0.69, <3.0"
imara-diff = "0.2.0"

# HTTP
async-trait = "0.1.89"
bytes = "1.10.1"
http = "1.3.1"
reqwest = "0.12.23"
reqwest-middleware = "0.4.2"
reqwest-retry = "0.7.0"

# other I/O
csv = "1.3.0"
futures = "0.3.31"
flate2 = { version = "1.1.2", features = ["zlib-rs"], default-features = false }
rocksdb = "0.24.0"
rocksdb-rayon = "1.0.0"
serde = { version = "1.0", features = ["derive"] }
tokio = { version = "1.47.1", features = ["rt-multi-thread", "macros"] }
thread_local = "1.1.9"
zstd = "0.12"

# Interface
clap = { version = "4.1.6", features = ["derive"] }
dsi-progress-logger.workspace = true
env_logger = "0.11.5"
log = "0.4.17"

#Â Building the SHA1 table
ar_row.workspace = true
ar_row_derive.workspace = true
crossbeam = { version = "0.8.4", optional = true }
rayon = { version = "1.9.0" }
orc-rust = { workspace = true, optional = true, default-features = false }
faster-hex = "0.8.1"

[features]
#Â Enables creating the node-id -> SHA1 table
build = ["orc-rust", "crossbeam"]

[[bin]]
name = "build-sha1-table"
required-features = ["build"]
