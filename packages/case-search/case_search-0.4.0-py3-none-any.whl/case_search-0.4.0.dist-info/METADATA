Metadata-Version: 2.4
Name: case-search
Version: 0.4.0
Summary: A Model Context Protocol (MCP) server built with FastMCP for business tax information search (by BAN) and web search via Serper API
Project-URL: Homepage, https://github.com/plion818/case-search
Project-URL: Repository, https://github.com/plion818/case-search
Author-email: plion818 <patrick89818pp@gmail.com>
License: MIT
License-File: LICENSE
Keywords: case-search,csv,fastmcp,mcp,model-context-protocol,query,serper,web-search
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.10
Requires-Dist: mcp[cli]>=1.24.0
Requires-Dist: pandas>=2.0.0
Description-Content-Type: text/markdown

# Case Search MCP Server

é€™æ˜¯ä¸€å€‹åŸºæ–¼ **FastMCP** æ¡†æ¶é–‹ç™¼çš„ Model Context Protocol (MCP) serverï¼Œæä¾›æ¡ˆä»¶æŸ¥è©¢å’Œç¶²è·¯æœå°‹åŠŸèƒ½ã€‚

## âœ¨ åŠŸèƒ½

- ğŸ“‹ **ç‡Ÿæ¥­äººç¨…å‹™è³‡è¨ŠæŸ¥è©¢**ï¼šæ ¹æ“šçµ±ä¸€ç·¨è™Ÿ (ban) æŸ¥è©¢ CSV æª”æ¡ˆä¸­çš„ç‡Ÿæ¥­äººç¨…å‹™è³‡è¨Š
- âš ï¸ **é¢¨éšªè¦å‰‡æŸ¥è©¢**ï¼šæ ¹æ“šç¨…å‹™é¡å‹ï¼ˆç‡Ÿæ¥­ç¨…ã€è²¨ç‰©ç¨…ã€æ‰€å¾—ç¨…ï¼‰å–å¾—å°æ‡‰çš„é¢¨éšªç¨½æ ¸è¦å‰‡
- ğŸ” **ç¶²è·¯æœå°‹**ï¼šé€é Serper API é€²è¡Œ Google ç¶²è·¯æœå°‹
- ğŸ“Š ä»¥ JSON æ ¼å¼å›å‚³å®Œæ•´çš„è³‡æ–™
- ğŸ”Œ æ”¯æ´é€é stdio èˆ‡ MCP å®¢æˆ¶ç«¯é€šè¨Š

## å®‰è£

### å¾ PyPI å®‰è£ï¼ˆæ¨è–¦ï¼‰

```bash
# ä½¿ç”¨ uvx ç›´æ¥åŸ·è¡Œï¼ˆä¸éœ€è¦å®‰è£ï¼‰
uvx case-search

# æˆ–å®‰è£åˆ°æœ¬åœ°ç’°å¢ƒ
pip install case-search
```

### å¾åŸå§‹ç¢¼å®‰è£

```bash
# è¤‡è£½å°ˆæ¡ˆ
git clone https://github.com/plion818/case-search.git
cd case-search

# ä½¿ç”¨ uv å®‰è£ç›¸ä¾å¥—ä»¶
uv pip install -e .
```

## ä½¿ç”¨æ–¹å¼

### æ–¹å¼ä¸€ï¼šé€é uvx åŸ·è¡Œï¼ˆæ¨è–¦ï¼‰

æœ€ç°¡å–®çš„æ–¹å¼ï¼Œä¸éœ€è¦äº‹å…ˆå®‰è£ï¼š

```bash
uvx case-search
```

### æ–¹å¼äºŒï¼šæœ¬åœ°å®‰è£å¾ŒåŸ·è¡Œ

```bash
# å®‰è£å¾ŒåŸ·è¡Œ
pip install case-search
case-search
```

### æ–¹å¼ä¸‰ï¼šåœ¨ Claude Desktop ä¸­ä½¿ç”¨

ç·¨è¼¯ Claude Desktop è¨­å®šæª”ï¼ŒåŠ å…¥ä»¥ä¸‹å…§å®¹ï¼š

**Windows:** `%APPDATA%\Claude\claude_desktop_config.json`

**macOS:** `~/Library/Application Support/Claude/claude_desktop_config.json`

**ä½¿ç”¨å·²ç™¼ä½ˆçš„å¥—ä»¶ï¼ˆæ¨è–¦ï¼‰ï¼š**

```json
{
  "mcpServers": {
    "case-search": {
      "command": "uvx",
      "args": ["case-search"],
      "env": {
        "SERPER_API_KEY": "your-serper-api-key-here"
      }
    }
  }
}
```

**ä½¿ç”¨æœ¬åœ°é–‹ç™¼ç‰ˆæœ¬ï¼š**

```json
{
  "mcpServers": {
    "case-search": {
      "command": "uvx",
      "args": [
        "--from",
        "c:\\Users\\plion818\\2. Learn\\MCP\\case_search",
        "case-search"
      ],
      "env": {
        "SERPER_API_KEY": "your-serper-api-key-here"
      }
    }
  }
}
```

æˆ–ä½¿ç”¨çµ•å°è·¯å¾‘æŒ‡å®š Python åŸ·è¡Œæª”ï¼š

```json
{
  "mcpServers": {
    "case-search": {
      "command": "uv",
      "args": [
        "--directory",
        "c:\\Users\\plion818\\2. Learn\\MCP\\case_search",
        "run",
        "case-search"
      ],
      "env": {
        "SERPER_API_KEY": "your-serper-api-key-here"
      }
    }
  }
}
```

> **ğŸ“Œ æ³¨æ„**ï¼š
> - ç¶²è·¯æœå°‹åŠŸèƒ½éœ€è¦è¨­å®š `SERPER_API_KEY` ç’°å¢ƒè®Šæ•¸
> - å¯åœ¨ [https://serper.dev](https://serper.dev) å…è²»è¨»å†Šä¸¦å–å¾— API Key
> - å…è²»æ–¹æ¡ˆæä¾›æ¯æœˆ 2,500 æ¬¡æœå°‹é¡åº¦

## å·¥å…·èªªæ˜

### search_case

æ ¹æ“šçµ±ä¸€ç·¨è™ŸæŸ¥è©¢ç‡Ÿæ¥­äººç¨…å‹™è³‡è¨Šï¼ˆä¸å€åˆ†å¤§å°å¯«ï¼‰ã€‚

**è¼¸å…¥åƒæ•¸ï¼š**
- `ban` (string, å¿…å¡«): çµ±ä¸€ç·¨è™Ÿï¼ˆä¸å€åˆ†å¤§å°å¯«ï¼‰ï¼Œä¾‹å¦‚ "BAN1111", "ban1112", "Ban1113"

**è¼¸å‡ºæ¬„ä½èªªæ˜ï¼š**
| æ¬„ä½åç¨± | èªªæ˜ |
|---------|------|
| ban | çµ±ä¸€ç·¨è™Ÿ (Key) |
| company_name | ç‡Ÿæ¥­äººåç¨± |
| industry_type | è¡Œæ¥­åˆ¥ |
| yr111_sales | 111å¹´éŠ·é …é‡‘é¡ |
| yr111_purchases | 111å¹´é€²é …é‡‘é¡ |
| yr111_inventory | 111å¹´æœŸæœ«å­˜è²¨ |
| yr111_inv_sales_ratio | 111å¹´å­˜è²¨/éŠ·é …æ¯” |
| yr111_inv_purch_ratio | 111å¹´å­˜è²¨/é€²é …æ¯” |
| yr111_vat_rate | 111å¹´åŠ å€¼ç‡ |
| yr111_tax_paid | 111å¹´å¯¦ç¹³ç¨…é¡ |
| yr112_sales | 112å¹´éŠ·é …é‡‘é¡ |
| yr112_purchases | 112å¹´é€²é …é‡‘é¡ |
| yr112_inventory | 112å¹´æœŸæœ«å­˜è²¨ |
| yr112_inv_sales_ratio | 112å¹´å­˜è²¨/éŠ·é …æ¯” |
| yr112_inv_purch_ratio | 112å¹´å­˜è²¨/é€²é …æ¯” |
| yr112_vat_rate | 112å¹´åŠ å€¼ç‡ |
| yr112_tax_paid | 112å¹´å¯¦ç¹³ç¨…é¡ |
| tax_method | èª²ç¨…æ–¹å¼ |

**è¼¸å‡ºç¯„ä¾‹ï¼š**

```json
{
  "ban": "BAN1111",
  "company_name": "ç”²éª¨æ–‡äº”é‡‘æ‰¹ç™¼æœ‰é™å…¬å¸",
  "industry_type": "æ‰¹ç™¼æ¥­",
  "yr111_sales": 20000000,
  "yr111_purchases": 18000000,
  "yr111_inventory": 45000000,
  "yr111_inv_sales_ratio": 2.25,
  "yr111_inv_purch_ratio": 2.50,
  "yr111_vat_rate": 0.10,
  "yr111_tax_paid": 100000,
  "yr112_sales": 10000000,
  "yr112_purchases": 500000,
  "yr112_inventory": 60000000,
  "yr112_inv_sales_ratio": 6.00,
  "yr112_inv_purch_ratio": 120.00,
  "yr112_vat_rate": 0.95,
  "yr112_tax_paid": 475000,
  "tax_method": "1(ä¸€èˆ¬èª²ç¨…)"
}
```

å¦‚æœæ‰¾ä¸åˆ°ç‡Ÿæ¥­äººï¼Œæœƒå›å‚³éŒ¯èª¤è¨Šæ¯ï¼š

```json
{
  "error": "æ‰¾ä¸åˆ°çµ±ä¸€ç·¨è™Ÿ BAN9999 çš„è³‡æ–™"
}
```

### get_risk_rules

å–å¾—æŒ‡å®šç¨…å‹™é¡å‹çš„é¢¨éšªç¨½æ ¸è¦å‰‡ã€‚

**è¼¸å…¥åƒæ•¸ï¼š**
- `tax_type` (ä¸‹æ‹‰é¸å–®, å¿…å¡«): ç¨…å‹™é¡å‹
  - ç‡Ÿæ¥­ç¨…
  - è²¨ç‰©ç¨…
  - æ‰€å¾—ç¨…

**è¦å‰‡æ¬„ä½èªªæ˜ï¼š**
| æ¬„ä½åç¨± | èªªæ˜ |
|---------|------|
| rule_id | è¦å‰‡ç·¨è™Ÿ |
| tax_type | ç¨…å‹™é¡å‹ |
| rule_name | è¦å‰‡åç¨± |
| description | è¦å‰‡æè¿° |
| risk_category | é¢¨éšªç­‰ç´š (High/Medium/Low) |
| logic_condition | é‚è¼¯åˆ¤æ–·æ¢ä»¶ |
| suggested_action | å»ºè­°ç¨½æ ¸è¡Œå‹• |

**è¼¸å‡ºç¯„ä¾‹ï¼ˆè¦å‰‡å·²å»ºç«‹ï¼‰ï¼š**

```json
{
  "status": "success",
  "tax_type": "ç‡Ÿæ¥­ç¨…",
  "rule_count": 7,
  "rules": [
    {
      "rule_id": "R001",
      "tax_type": "ç‡Ÿæ¥­ç¨…",
      "rule_name": "å­˜è²¨ç©å£“ç•°å¸¸ (Phantom Inventory)",
      "description": "é€£çºŒå…©å¹´å­˜è²¨å°éŠ·é …æ¯”ç‡å¤§æ–¼200%...",
      "risk_category": "High",
      "logic_condition": "(yr111_inv_sales_ratio > 2.0 AND yr112_inv_sales_ratio > 2.0) AND (yr112_inv_purch_ratio > 0.7)",
      "suggested_action": "å¯¦åœ°ç›¤é»å­˜è²¨ã€èª¿é–±é€²éŠ·å­˜æ˜ç´°å¸³ã€æŸ¥æ ¸å€‰å„²ç©ºé–“æ˜¯å¦è¶³å¤ "
    }
  ]
}
```

**è¼¸å‡ºç¯„ä¾‹ï¼ˆè¦å‰‡å°šæœªå»ºç«‹ï¼‰ï¼š**

```json
{
  "status": "not_available",
  "message": "è²¨ç‰©ç¨…è¦å‰‡å…§å®¹å°šæœªå»ºç«‹ï¼Œè«‹å…ˆå»ºç«‹ç›¸é—œè¦å‰‡",
  "tax_type": "è²¨ç‰©ç¨…",
  "rules": []
}
```

### web_search

ä½¿ç”¨ Serper API é€²è¡Œ Google ç¶²è·¯æœå°‹ã€‚

**è¼¸å…¥åƒæ•¸ï¼š**
- `query` (string, å¿…å¡«): æœå°‹é—œéµå­—
- `num_results` (integer, å¯é¸): è¿”å›çµæœæ•¸é‡ï¼Œé è¨­ç‚º 10ï¼Œæœ€å¤§ç‚º 100

**è¼¸å‡ºç¯„ä¾‹ï¼š**

```json
{
  "searchParameters": {
    "q": "FastMCP Python",
    "type": "search",
    "engine": "google"
  },
  "organic": [
    {
      "title": "FastMCP - GitHub",
      "link": "https://github.com/jlowin/fastmcp",
      "snippet": "FastMCP is a high-level framework for building MCP servers...",
      "position": 1
    },
    {
      "title": "Model Context Protocol Documentation",
      "link": "https://modelcontextprotocol.io",
      "snippet": "The Model Context Protocol (MCP) is an open protocol...",
      "position": 2
    }
  ],
  "knowledgeGraph": {
    "title": "Python",
    "type": "Programming language",
    "description": "Python is a high-level programming language..."
  }
}
```

**éŒ¯èª¤è™•ç†ï¼š**

å¦‚æœæœªè¨­å®š API Keyï¼š
```json
{
  "error": "è«‹åœ¨ç’°å¢ƒè®Šæ•¸ä¸­è¨­å®š SERPER_API_KEYã€‚å¯åœ¨ https://serper.dev å–å¾— API Key"
}
```

å¦‚æœ API Key ç„¡æ•ˆï¼š
```json
{
  "error": "SERPER_API_KEY ç„¡æ•ˆï¼Œè«‹ç¢ºèª API Key æ˜¯å¦æ­£ç¢º"
}
```

å¦‚æœè¶…é API è«‹æ±‚é™åˆ¶ï¼š
```json
{
  "error": "API è«‹æ±‚æ¬¡æ•¸è¶…éé™åˆ¶ï¼Œè«‹ç¨å¾Œå†è©¦"
}
```

## è³‡æ–™æª”æ¡ˆ

ç‡Ÿæ¥­äººç¨…å‹™è³‡æ–™å„²å­˜åœ¨ `src/case_search/case_data.csv` æª”æ¡ˆä¸­ï¼ŒåŒ…å«ä»¥ä¸‹æ¬„ä½ï¼š

| æ¬„ä½åç¨± | èªªæ˜ |
|---------|------|
| ban | çµ±ä¸€ç·¨è™Ÿ (Key) |
| company_name | ç‡Ÿæ¥­äººåç¨± |
| industry_type | è¡Œæ¥­åˆ¥ |
| yr111_sales | 111å¹´éŠ·é …é‡‘é¡ |
| yr111_purchases | 111å¹´é€²é …é‡‘é¡ |
| yr111_inventory | 111å¹´æœŸæœ«å­˜è²¨ |
| yr111_inv_sales_ratio | 111å¹´å­˜è²¨/éŠ·é …æ¯” |
| yr111_inv_purch_ratio | 111å¹´å­˜è²¨/é€²é …æ¯” |
| yr111_vat_rate | 111å¹´åŠ å€¼ç‡ |
| yr111_tax_paid | 111å¹´å¯¦ç¹³ç¨…é¡ |
| yr112_sales | 112å¹´éŠ·é …é‡‘é¡ |
| yr112_purchases | 112å¹´é€²é …é‡‘é¡ |
| yr112_inventory | 112å¹´æœŸæœ«å­˜è²¨ |
| yr112_inv_sales_ratio | 112å¹´å­˜è²¨/éŠ·é …æ¯” |
| yr112_inv_purch_ratio | 112å¹´å­˜è²¨/é€²é …æ¯” |
| yr112_vat_rate | 112å¹´åŠ å€¼ç‡ |
| yr112_tax_paid | 112å¹´å¯¦ç¹³ç¨…é¡ |
| tax_method | èª²ç¨…æ–¹å¼ |

### tax_rules.csv

ç¨…å‹™é¢¨éšªè¦å‰‡å„²å­˜åœ¨ `src/case_search/tax_rules.csv` æª”æ¡ˆä¸­ï¼ŒåŒ…å«ä»¥ä¸‹æ¬„ä½ï¼š

| æ¬„ä½åç¨± | èªªæ˜ |
|---------|------|
| rule_id | è¦å‰‡ç·¨è™Ÿ |
| tax_type | ç¨…å‹™é¡å‹ï¼ˆç‡Ÿæ¥­ç¨…/è²¨ç‰©ç¨…/æ‰€å¾—ç¨…ï¼‰|
| rule_name | è¦å‰‡åç¨± |
| description | è¦å‰‡æè¿° |
| risk_category | é¢¨éšªç­‰ç´š (High/Medium/Low) |
| logic_condition | é‚è¼¯åˆ¤æ–·æ¢ä»¶ |
| suggested_action | å»ºè­°ç¨½æ ¸è¡Œå‹• |

**ç›®å‰ç‹€æ…‹ï¼š**
- âœ… ç‡Ÿæ¥­ç¨…ï¼š7 æ¢è¦å‰‡å·²å»ºç«‹
- â³ è²¨ç‰©ç¨…ï¼šè¦å‰‡å°šæœªå»ºç«‹
- â³ æ‰€å¾—ç¨…ï¼šè¦å‰‡å°šæœªå»ºç«‹

## é–‹ç™¼

### æŠ€è¡“æ£§

æœ¬å°ˆæ¡ˆä½¿ç”¨ Python 3.10+ å’Œä»¥ä¸‹ä¸»è¦æŠ€è¡“ï¼š

- **FastMCP æ¡†æ¶**ï¼šåŸºæ–¼å®˜æ–¹ MCP SDK çš„é«˜å±¤æŠ½è±¡ï¼Œç°¡åŒ– MCP server é–‹ç™¼
- **mcp[cli]** >= 1.24.0ï¼šModel Context Protocol æ ¸å¿ƒå¥—ä»¶ï¼ˆå·²åŒ…å« httpxï¼‰
- **pandas** >= 2.0.0ï¼šè³‡æ–™è™•ç†
- **httpx**ï¼šHTTP å®¢æˆ¶ç«¯ï¼ˆé€é mcp[cli] é–“æ¥ä¾è³´ï¼‰

### å°ˆæ¡ˆçµæ§‹

```
case_search/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ case_search/
â”‚       â”œâ”€â”€ __init__.py      # FastMCP server ä¸»ç¨‹å¼
â”‚       â”œâ”€â”€ case_data.csv    # ç‡Ÿæ¥­äººç¨…å‹™è³‡æ–™æª”æ¡ˆ
â”‚       â””â”€â”€ tax_rules.csv    # ç¨…å‹™é¢¨éšªè¦å‰‡æª”æ¡ˆ
â”œâ”€â”€ pyproject.toml           # å°ˆæ¡ˆè¨­å®šå’Œä¾è³´ç®¡ç†
â”œâ”€â”€ uv.lock                  # ä¾è³´é–å®šæª”æ¡ˆï¼ˆç¢ºä¿å¯é‡ç¾å»ºç½®ï¼‰
â”œâ”€â”€ MANIFEST.in              # æ‰“åŒ…æ™‚åŒ…å«çš„é¡å¤–æª”æ¡ˆ
â””â”€â”€ README.md

```

### é—œéµæ¦‚å¿µ

#### pyproject.toml ä¸­çš„ keywords
- **ç›®çš„**ï¼šå¹«åŠ©ä½¿ç”¨è€…åœ¨ PyPI æœå°‹æ™‚æ‰¾åˆ°æ‚¨çš„å¥—ä»¶
- **å½±éŸ¿**ï¼šæå‡å¥—ä»¶åœ¨ PyPI çš„æœå°‹æ’åå’Œå¯è¦‹åº¦
- **ç®¡ç†**ï¼šæ‰‹å‹•ç·¨è¼¯ï¼Œç²¾å¿ƒæŒ‘é¸ç›¸é—œé—œéµå­—

#### uv.lock çš„ä½œç”¨
- **ç›®çš„**ï¼šé–å®šæ‰€æœ‰ä¾è³´çš„ç²¾ç¢ºç‰ˆæœ¬ï¼ˆåŒ…å«é–“æ¥ä¾è³´ï¼‰
- **å„ªå‹¢**ï¼š
  - âœ… ç¢ºä¿åœ˜éšŠæˆå“¡ä½¿ç”¨ç›¸åŒç‰ˆæœ¬
  - âœ… æä¾›å¯é‡ç¾çš„å»ºç½®ç’°å¢ƒ
  - âœ… é¿å…æ„å¤–å‡ç´šå°è‡´çš„å•é¡Œ
- **ç®¡ç†**ï¼šç”± `uv` è‡ªå‹•ç”Ÿæˆï¼Œä¸è¦æ‰‹å‹•ç·¨è¼¯

### å¸¸ç”¨æŒ‡ä»¤

```bash
# å®‰è£ä¾è³´
uv sync

# åŸ·è¡Œ server
uv run case-search

# ä½¿ç”¨ MCP Inspector æ¸¬è©¦
npx @modelcontextprotocol/inspector uv run case-search

# æ‰“åŒ…
uv build

# ç™¼å¸ƒåˆ° PyPI
uv publish
```

## æˆæ¬Š

æ­¤å°ˆæ¡ˆç”± plion818 é–‹ç™¼ç¶­è­·ã€‚
