{"id":"MCP-fq5","content_hash":"5c31335d231e5c83beeae07b70e4120c5a1d8cee207a5df85c33421984def7f2","title":"CRITICAL: Database session bug in _ensure_project() blocks agent registration","description":"Location: app.py:674-702 in _ensure_project()\n\nSymptom: InvalidRequestError: Could not refresh instance\n\nRoot Cause: _ensure_project() opens a database session and calls _ensure_global_inbox_agent(project) which opens a NESTED session. The project object becomes detached from the inner session causing SQLAlchemy errors.\n\nImpact: PRODUCTION BLOCKING - Prevents agent registration in multi-agent scenarios\n\nIntroduced: Commit 8ec673f (2025-11-09) 'Add global inbox with TTL auto-deletion'\n\nEvidence: Test 3 Agent 2 failure in /tmp/real_claude_multiagent_20251118_193652/outputs/agent2_output.txt\n\nFix Required:\n1. Pass session to _ensure_global_inbox_agent() OR\n2. Accept project_id instead of project object to avoid detached instance\n\nPriority: URGENT - Blocks Test 3 completion and production use","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-18T20:20:22.634052-08:00","updated_at":"2025-11-18T20:38:11.023347-08:00","closed_at":"2025-11-18T20:38:11.023347-08:00","source_repo":".","labels":["bug","critical","production-blocking"]}
{"id":"MCP-ods","content_hash":"c6dbe0ad14c4640c69a28f652cfffce5e95f7459390fe36296730ed3c326d453","title":"Inbound Slack thread mapping not persisted to SlackClient","description":"Webhook handler creates MCP messages with thread_id like slack_{channel}_{thread_ts} but does not call SlackClient.map_thread(), so outbound replies won’t land in the original Slack thread. Add mapping when processing inbound Slack events.","status":"open","priority":1,"issue_type":"bug","created_at":"2025-11-28T23:34:49.47293-08:00","updated_at":"2025-11-28T23:34:49.47293-08:00","source_repo":"."}
{"id":"MCP-szt","content_hash":"538060f0c47013c56ec4a90cdeb9283af3ea7e75ffb2b0063fdaa1a46b6b9cb1","title":"SlackClient methods unreachable (mis-indented in slack_integration.py)","description":"SlackClient’s core methods (_check_client, _call_api, post_message, upload_file, add_reaction, list_channels, get_channel_info, get_permalink, map_thread, get_slack_thread, get_mcp_thread_id, verify_signature) are currently nested inside mirror_message_to_slack after a return. They’re unreachable at runtime, so Slack API calls will raise AttributeError. Fix by re-indenting methods into the SlackClient class and ensuring imports/usage are correct.","status":"open","priority":1,"issue_type":"bug","created_at":"2025-11-28T23:34:45.970741-08:00","updated_at":"2025-11-28T23:34:45.970741-08:00","source_repo":"."}
{"id":"MCP-xr3","content_hash":"50116f6a729bd94c4f5d9b4601d319a66b4374e5c209266a745b87003e5d7637","title":"Build Slack bot integration for MCP Mail (bidirectional)","description":"Implement a Slack app (bot) integration for MCP Mail to support Slack -\u003e MCP ingest and MCP -\u003e Slack messaging.\n\nScope:\n- Use Slack Web API + Events API with bot token and signing secret.\n- Verify Slack requests (signing secret) and handle `message.*` events (channels, groups, im, mpim), including threads via `thread_ts`, mapping to MCP `thread_id`.\n- Outbound: use bot token to post messages and thread replies to Slack channels; plan migration away from incoming webhook.\n- Optional slash command `/mcp-mail` to send MCP messages from Slack with project/thread/recipients.\n- Config: env vars `SLACK_BOT_TOKEN`, `SLACK_SIGNING_SECRET`, channel allowlist, event endpoint URL; support public tunnel (ngrok/Cloudflare) or deployed URL.\n- Tests: integration-style tests for Slack event ingestion and outbound posting (mock Slack API).","status":"open","priority":2,"issue_type":"feature","created_at":"2025-11-28T21:43:32.388709-08:00","updated_at":"2025-11-28T21:43:32.388709-08:00","source_repo":"."}
