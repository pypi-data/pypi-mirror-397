var Q=Object.defineProperty;var t=(k,i)=>Q(k,"name",{value:i,configurable:!0});import{h as X,a7 as Z}from"./vendor-primevue-D1bWBpUY.js";import{u as ee}from"./vendor-vue-C5v91m9x.js";import{w as I,bY as oe,aH as te,a as ae,c as C,d as se}from"./index-DkaQAqNW.js";import{i as le}from"./nodeFilterUtil-D49mCu4H.js";import{g as ne,f as R}from"./audioUtils-QoxrmmY1.js";import{bs as ue,r as u,E as r,w as re,n as ie,bP as ce,c as l,d as n,u as de,bq as p,e as a,t as _,G as ve,s as z,A as L,q as pe}from"./vendor-other-BuYjBaXg.js";import"./vendor-xterm-DV1MVhAx.js";import"./vendor-three-zdhtZbSm.js";import"./vendor-tiptap-wbntxnQl.js";const me={class:"relative"},fe={class:"relative flex shrink-0 items-center justify-start gap-2"},be=["aria-label"],he={key:0,class:"text-secondary icon-[lucide--play] size-4"},ye={key:1,class:"text-secondary icon-[lucide--pause] size-4"},ge={class:"text-sm font-normal text-nowrap text-base-foreground"},_e={class:"relative h-0.5 flex-1 rounded-full bg-interface-stroke"},ke=["value","aria-label"],xe={class:"relative flex shrink-0 items-center justify-start gap-2"},we=["aria-label"],Ce={key:0,class:"text-secondary icon-[lucide--volume-2] size-4"},ze={key:1,class:"text-secondary icon-[lucide--volume-1] size-4"},Oe={key:2,class:"text-secondary icon-[lucide--volume-x] size-4"},Pe=["aria-label"],Ae={key:0,class:"w-48 px-4 py-2"},Be={class:"mb-2 block text-xs text-base-foreground"},Ie=["onClick"],Re={class:"text-base-foreground"},Le={key:0,class:"ml-auto icon-[lucide--check] size-4 text-base-foreground"},Ne=ue({__name:"AudioPreviewPlayer",props:{readonly:{type:Boolean},hideWhenEmpty:{type:Boolean,default:!0},showOptionsButton:{type:Boolean},modelValue:{},nodeId:{},audioUrl:{}},setup(k){const{t:i}=ee(),h=k,o=u(),O=u(),N=u(),m=u(!1),c=u(!1),f=u(1),b=u(0),d=u(0),P=u(!1),y=u(1),A=r(()=>!d.value||d.value===0?0:b.value/d.value*100),T=r(()=>!c.value&&f.value>.5),U=r(()=>c.value&&f.value>0),g=r(()=>!h.nodeId||!I.rootGraph?null:I.rootGraph.getNodeById(h.nodeId)),V=r(()=>g.value?g.value.constructor?.comfyClass==="LoadAudio"&&!!h.nodeId:!1),S=r(()=>{const e=g.value;return!!e&&le(e)}),B=r(()=>{const e=g.value;return e?oe(e):null}),$=te(),j=r(()=>{if(!S.value||!B.value)return"";const e=$.nodeOutputs[B.value];if(!e?.audio||e.audio.length===0)return"";const s=e.audio[0];return s.filename?ae.apiURL(ne(s.subfolder||"",s.filename,s.type||"output")):""}),E=r(()=>j.value||h.audioUrl||""),M=t(()=>{!o.value||!o.value.src||(m.value?o.value.pause():o.value.play(),m.value=!m.value)},"togglePlayPause"),F=t(()=>{o.value&&(c.value=!c.value,o.value.muted=c.value)},"toggleMute"),G=t(e=>{const s=e.target,v=parseFloat(s.value);if(o.value&&d.value>0){const w=v/100*d.value;o.value.currentTime=w,b.value=w}},"handleSeek"),q=t(()=>{o.value&&(d.value=o.value.duration)},"handleLoadedMetadata"),D=t(()=>{o.value&&(b.value=o.value.currentTime)},"handleTimeUpdate"),W=t(()=>{m.value=!1,b.value=0},"handleEnded"),H=t(e=>{O.value?.toggle(e)},"toggleOptionsMenu"),x=t(e=>{y.value=e,o.value&&(o.value.playbackRate=e)},"setPlaybackSpeed"),Y=t(e=>{const s=Array.isArray(e)?e[0]:e;f.value=s/10,o.value&&(o.value.volume=f.value,f.value>0&&c.value&&(c.value=!1,o.value.muted=!1))},"handleVolumeChange"),J=r(()=>[{label:i("g.playbackSpeed"),items:[{label:i("g.halfSpeed"),onClick:t(()=>x(.5),"onClick"),selected:y.value===.5},{label:i("g.1x"),onClick:t(()=>x(1),"onClick"),selected:y.value===1},{label:i("g.2x"),onClick:t(()=>x(2),"onClick"),selected:y.value===2}]},{label:i("g.volume"),key:"volume"}]),K=t(e=>{o.value&&(m.value=!1,o.value.pause(),o.value.src=e,o.value.load(),P.value=!!e)},"loadAudioFromUrl");return re(E,e=>{e&&ie(()=>{K(e)})},{immediate:!0}),ce(()=>{o.value&&(o.value.pause(),o.value.src="")}),(e,s)=>(l(),n("div",me,[V.value?z("",!0):(l(),n("div",{key:0,class:de(p(C)("bg-component-node-widget-background box-border flex gap-4 items-center justify-start relative rounded-lg w-full h-16 px-4 py-0",{hidden:e.hideWhenEmpty&&!P.value}))},[a("audio",{ref_key:"audioRef",ref:o,onLoadedmetadata:q,onTimeupdate:D,onEnded:W},null,544),a("div",fe,[a("div",{role:"button",tabindex:0,"aria-label":e.$t("g.playPause"),class:"flex size-6 cursor-pointer items-center justify-center rounded hover:bg-interface-menu-component-surface-hovered",onClick:M},[m.value?(l(),n("i",ye)):(l(),n("i",he))],8,be),a("div",ge,_(p(R)(b.value))+" / "+_(p(R)(d.value)),1)]),a("div",_e,[a("div",{class:"absolute top-0 left-0 h-full rounded-full bg-button-icon transition-all",style:ve({width:`${A.value}%`})},null,4),a("input",{type:"range",value:A.value,min:"0",max:"100",step:"0.1","aria-label":e.$t("g.audioProgress"),class:"absolute inset-0 w-full cursor-pointer opacity-0",onInput:G},null,40,ke)]),a("div",xe,[a("div",{role:"button",tabindex:0,"aria-label":e.$t("g.volume"),class:"flex size-6 cursor-pointer items-center justify-center rounded hover:bg-interface-menu-component-surface-hovered",onClick:F},[T.value?(l(),n("i",Ce)):U.value?(l(),n("i",ze)):(l(),n("i",Oe))],8,we),e.showOptionsButton?(l(),n("div",{key:0,ref_key:"optionsButtonRef",ref:N,role:"button",tabindex:0,"aria-label":e.$t("g.moreOptions"),class:"flex size-6 cursor-pointer items-center justify-center rounded hover:bg-interface-menu-component-surface-hovered",onClick:H},s[0]||(s[0]=[a("i",{class:"text-secondary icon-[lucide--more-vertical] size-4"},null,-1)]),8,Pe)):z("",!0)]),L(p(Z),{ref_key:"optionsMenu",ref:O,model:J.value,popup:"",class:"audio-player-menu","pt:root:class":p(C)("bg-component-node-widget-background border-component-node-border"),"pt:submenu:class":p(C)("bg-component-node-widget-background")},{item:pe(({item:v})=>[v.key==="volume"?(l(),n("div",Ae,[a("label",Be,_(v.label),1),L(p(X),{"model-value":f.value*10,min:0,max:10,step:1,class:"w-full","onUpdate:modelValue":Y},null,8,["model-value"])])):(l(),n("div",{key:1,class:"flex cursor-pointer items-center px-4 py-2 text-xs hover:bg-white/10",onClick:t(w=>v.onClick?.(),"onClick")},[a("span",Re,_(v.label),1),v.selected?(l(),n("i",Le)):z("",!0)],8,Ie))]),_:1},8,["model","pt:root:class","pt:submenu:class"])],2))]))}}),qe=se(Ne,[["__scopeId","data-v-d92d87c0"]]);export{qe as default};
//# sourceMappingURL=AudioPreviewPlayer-ZApySOMe.js.map
