{"version":3,"mappings":"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","names":["props","__props","modelValue","_useModel","filteredProps","computed","filterWidgetProps","INPUT_EXCLUDED_PROPS","precision","p","stepValue","useGrouping","buttonsDisabled","currentValue","buttonTooltip","pressed","ref","setPressed","__name","val","emits","__emit","delegatedProps","reactiveOmit","forwarded","useForwardPropsEmits","useNumberStepCalculation","options","precisionArg","returnUndefinedForDefault","toValue","step","sharedButtonClasses","cn","useNumberWidgetButtonPt","roundedLeft","roundedRight","increment","decrement","timesEmptied","updateLocalValue","newValue","handleNumberInputUpdate","STANDARD_EXCLUDED_PROPS","sliderNumberPt","NumberControlMode","convertToEnum","str","useControlButtonIcon","controlMode","useStepperControl","defaultValue","controlId","applyControl","min","max","step2","onChange","safeMax","safeMin","actualStep","onMounted","numberControlRegistry","onUnmounted","controlButtonIcon","NumberControlPopover","defineAsyncComponent","__vitePreload","popover","handleControlChange","watch","togglePopover","event","hasControlAfterGenerate"],"ignoreList":[],"sources":["../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumberInput.vue","../../src/components/ui/slider/Slider.vue","../../src/renderer/extensions/vueNodes/widgets/composables/useNumberStepCalculation.ts","../../src/renderer/extensions/vueNodes/widgets/composables/useNumberWidgetButtonPt.ts","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumberSlider.vue","../../src/renderer/extensions/vueNodes/widgets/composables/useStepperControl.ts","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumberWithControl.vue","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumber.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport InputNumber from 'primevue/inputnumber'\nimport { computed } from 'vue'\n\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport { cn } from '@/utils/tailwindUtil'\nimport {\n  INPUT_EXCLUDED_PROPS,\n  filterWidgetProps\n} from '@/utils/widgetPropFilter'\n\nimport { WidgetInputBaseClass } from './layout'\nimport WidgetLayoutField from './layout/WidgetLayoutField.vue'\n\nconst props = defineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst modelValue = defineModel<number>({ default: 0 })\n\nconst filteredProps = computed(() =>\n  filterWidgetProps(props.widget.options, INPUT_EXCLUDED_PROPS)\n)\n\n// Get the precision value for proper number formatting\nconst precision = computed(() => {\n  const p = props.widget.options?.precision\n  // Treat negative or non-numeric precision as undefined\n  return typeof p === 'number' && p >= 0 ? p : undefined\n})\n\n// Calculate the step value based on precision or widget options\nconst stepValue = computed(() => {\n  // Use step2 (correct input spec value) instead of step (legacy 10x value)\n  if (props.widget.options?.step2 !== undefined) {\n    return Number(props.widget.options.step2)\n  }\n  // Otherwise, derive from precision\n  if (precision.value !== undefined) {\n    if (precision.value === 0) {\n      return 1\n    }\n    // For precision > 0, step = 1 / (10^precision)\n    // precision 1 → 0.1, precision 2 → 0.01, etc.\n    return Number((1 / Math.pow(10, precision.value)).toFixed(precision.value))\n  }\n  // Default to 'any' for unrestricted stepping\n  return 0\n})\n\n// Disable grouping separators by default unless explicitly enabled by the node author\nconst useGrouping = computed(() => {\n  return props.widget.options?.useGrouping === true\n})\n\n// Check if increment/decrement buttons should be disabled due to precision limits\nconst buttonsDisabled = computed(() => {\n  const currentValue = modelValue.value ?? 0\n  return (\n    !Number.isFinite(currentValue) ||\n    Math.abs(currentValue) > Number.MAX_SAFE_INTEGER\n  )\n})\n\nconst buttonTooltip = computed(() => {\n  if (buttonsDisabled.value) {\n    return 'Increment/decrement disabled: value exceeds JavaScript precision limit (±2^53)'\n  }\n  return null\n})\n</script>\n\n<template>\n  <WidgetLayoutField :widget>\n    <InputNumber\n      v-model=\"modelValue\"\n      v-tooltip=\"buttonTooltip\"\n      v-bind=\"filteredProps\"\n      fluid\n      button-layout=\"horizontal\"\n      size=\"small\"\n      variant=\"outlined\"\n      :step=\"stepValue\"\n      :min-fraction-digits=\"precision\"\n      :max-fraction-digits=\"precision\"\n      :use-grouping=\"useGrouping\"\n      :class=\"cn(WidgetInputBaseClass, 'grow text-xs')\"\n      :aria-label=\"widget.name\"\n      :show-buttons=\"!buttonsDisabled\"\n      :pt=\"{\n        root: {\n          class: cn(\n            '[&>input]:bg-transparent [&>input]:border-0',\n            '[&>input]:truncate [&>input]:min-w-[4ch]',\n            $slots.default && '[&>input]:pr-7'\n          )\n        },\n        decrementButton: {\n          class: 'w-8 border-0'\n        },\n        incrementButton: {\n          class: 'w-8 border-0'\n        }\n      }\"\n    >\n      <template #incrementicon>\n        <span class=\"pi pi-plus text-sm\" />\n      </template>\n      <template #decrementicon>\n        <span class=\"pi pi-minus text-sm\" />\n      </template>\n    </InputNumber>\n    <div class=\"absolute top-5 right-8 h-4 w-7 -translate-y-4/5 flex\">\n      <slot />\n    </div>\n  </WidgetLayoutField>\n</template>\n\n<style scoped>\n:deep(.p-inputnumber-input) {\n  height: 1.625rem;\n  margin: 1px 0;\n  box-shadow: none;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { reactiveOmit } from '@vueuse/core'\nimport type { SliderRootEmits, SliderRootProps } from 'reka-ui'\nimport {\n  SliderRange,\n  SliderRoot,\n  SliderThumb,\n  SliderTrack,\n  useForwardPropsEmits\n} from 'reka-ui'\nimport { ref } from 'vue'\nimport type { HTMLAttributes } from 'vue'\n\nimport { cn } from '@/utils/tailwindUtil'\n\nconst props = defineProps<\n  // eslint-disable-next-line vue/no-unused-properties\n  SliderRootProps & { class?: HTMLAttributes['class'] }\n>()\n\nconst pressed = ref(false)\nconst setPressed = (val: boolean) => {\n  pressed.value = val\n}\n\nconst emits = defineEmits<SliderRootEmits>()\n\nconst delegatedProps = reactiveOmit(props, 'class')\n\nconst forwarded = useForwardPropsEmits(delegatedProps, emits)\n</script>\n\n<template>\n  <SliderRoot\n    v-slot=\"{ modelValue }\"\n    data-slot=\"slider\"\n    :class=\"\n      cn(\n        'relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50',\n        'data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col',\n        props.class\n      )\n    \"\n    v-bind=\"forwarded\"\n    @slide-start=\"() => setPressed(true)\"\n    @slide-move=\"() => setPressed(true)\"\n    @slide-end=\"() => setPressed(false)\"\n  >\n    <SliderTrack\n      data-slot=\"slider-track\"\n      :class=\"\n        cn(\n          'bg-node-stroke relative grow overflow-hidden rounded-full',\n          'cursor-pointer overflow-visible',\n          `before:absolute before:-inset-2 before:block before:bg-transparent`,\n          'data-[orientation=horizontal]:h-0.5 data-[orientation=horizontal]:w-full',\n          'data-[orientation=vertical]:h-full data-[orientation=vertical]:w-0.5'\n        )\n      \"\n    >\n      <SliderRange\n        data-slot=\"slider-range\"\n        class=\"absolute bg-node-component-surface-highlight data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full\"\n      />\n    </SliderTrack>\n\n    <SliderThumb\n      v-for=\"(_, key) in modelValue\"\n      :key=\"key\"\n      data-slot=\"slider-thumb\"\n      :class=\"\n        cn(\n          'bg-node-component-surface-highlight ring-node-component-surface-selected block size-3.5 shrink-0 rounded-full shadow-sm transition-[color,box-shadow]',\n          'cursor-grab',\n          'before:absolute before:-inset-1 before:block before:bg-transparent before:rounded-full',\n          'hover:ring-2 focus-visible:ring-2 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50',\n          { 'cursor-grabbing': pressed }\n        )\n      \"\n    />\n  </SliderRoot>\n</template>\n","import { computed, toValue } from 'vue'\nimport type { MaybeRefOrGetter } from 'vue'\n\ninterface NumberWidgetOptions {\n  step2?: number\n  precision?: number\n}\n\n/**\n * Shared composable for calculating step values in number input widgets\n * Handles both explicit step2 values and precision-derived steps\n */\nexport function useNumberStepCalculation(\n  options: NumberWidgetOptions | undefined,\n  precisionArg: MaybeRefOrGetter<number | undefined>,\n  returnUndefinedForDefault = false\n) {\n  return computed(() => {\n    const precision = toValue(precisionArg)\n    // Use step2 (correct input spec value) instead of step (legacy 10x value)\n    if (options?.step2 !== undefined) {\n      return Number(options.step2)\n    }\n\n    if (precision === undefined) {\n      return returnUndefinedForDefault ? undefined : 0\n    }\n\n    if (precision === 0) return 1\n\n    // For precision > 0, step = 1 / (10^precision)\n    const step = 1 / Math.pow(10, precision)\n    return returnUndefinedForDefault ? step : Number(step.toFixed(precision))\n  })\n}\n","import { cn } from '@comfyorg/tailwind-utils'\n\nconst sharedButtonClasses = cn(\n  'inline-flex items-center justify-center border-0 bg-transparent text-inherit transition-colors duration-150 ease-in-out ',\n  'hover:bg-node-component-surface-hovered active:bg-node-component-surface-selected',\n  'disabled:bg-node-component-disabled disabled:text-node-icon-disabled disabled:cursor-not-allowed'\n)\n\nexport function useNumberWidgetButtonPt(options?: {\n  roundedLeft?: boolean\n  roundedRight?: boolean\n}) {\n  const { roundedLeft = false, roundedRight = false } = options ?? {}\n\n  const increment = cn(sharedButtonClasses, roundedRight && 'rounded-r-lg')\n  const decrement = cn(sharedButtonClasses, roundedLeft && 'rounded-l-lg')\n\n  return {\n    incrementButton: {\n      class: increment\n    },\n    decrementButton: {\n      class: decrement\n    }\n  }\n}\n","<template>\n  <WidgetLayoutField :widget=\"widget\">\n    <div :class=\"cn(WidgetInputBaseClass, 'flex items-center gap-2 pl-3 pr-2')\">\n      <Slider\n        :model-value=\"[modelValue]\"\n        v-bind=\"filteredProps\"\n        class=\"flex-grow text-xs\"\n        :step=\"stepValue\"\n        :aria-label=\"widget.name\"\n        @update:model-value=\"updateLocalValue\"\n      />\n      <InputNumber\n        :key=\"timesEmptied\"\n        :model-value=\"modelValue\"\n        v-bind=\"filteredProps\"\n        :step=\"stepValue\"\n        :min-fraction-digits=\"precision\"\n        :max-fraction-digits=\"precision\"\n        :aria-label=\"widget.name\"\n        size=\"small\"\n        pt:pc-input-text:root=\"min-w-[4ch] bg-transparent border-none text-center truncate\"\n        class=\"w-16\"\n        :pt=\"sliderNumberPt\"\n        @update:model-value=\"handleNumberInputUpdate\"\n      />\n    </div>\n  </WidgetLayoutField>\n</template>\n\n<script setup lang=\"ts\">\nimport InputNumber from 'primevue/inputnumber'\nimport { computed, ref } from 'vue'\n\nimport Slider from '@/components/ui/slider/Slider.vue'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport { cn } from '@/utils/tailwindUtil'\nimport {\n  STANDARD_EXCLUDED_PROPS,\n  filterWidgetProps\n} from '@/utils/widgetPropFilter'\n\nimport { useNumberStepCalculation } from '../composables/useNumberStepCalculation'\nimport { useNumberWidgetButtonPt } from '../composables/useNumberWidgetButtonPt'\nimport { WidgetInputBaseClass } from './layout'\nimport WidgetLayoutField from './layout/WidgetLayoutField.vue'\n\nconst { widget } = defineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst modelValue = defineModel<number>({ default: 0 })\n\nconst timesEmptied = ref(0)\n\nconst updateLocalValue = (newValue: number[] | undefined): void => {\n  if (newValue?.length) modelValue.value = newValue[0]\n}\n\nconst handleNumberInputUpdate = (newValue: number | undefined) => {\n  if (newValue !== undefined) {\n    updateLocalValue([newValue])\n    return\n  }\n  timesEmptied.value += 1\n}\n\nconst filteredProps = computed(() =>\n  filterWidgetProps(widget.options, STANDARD_EXCLUDED_PROPS)\n)\n\nconst p = widget.options?.precision\nconst precision = typeof p === 'number' && p >= 0 ? p : undefined\n\n// Calculate the step value based on precision or widget options\nconst stepValue = useNumberStepCalculation(widget.options, precision, true)\n\nconst sliderNumberPt = useNumberWidgetButtonPt({\n  roundedLeft: true,\n  roundedRight: true\n})\n</script>\n\n<style scoped>\n:deep(.p-inputnumber-button.p-disabled .pi),\n:deep(.p-inputnumber-button.p-disabled .p-icon) {\n  color: var(--color-node-icon-disabled) !important;\n}\n</style>\n","import { computed, onMounted, onUnmounted, ref } from 'vue'\nimport type { Ref } from 'vue'\n\nimport type { ControlOptions } from '@/types/simplifiedWidget'\n\nimport { numberControlRegistry } from '../services/NumberControlRegistry'\n\nexport enum NumberControlMode {\n  FIXED = 'fixed',\n  INCREMENT = 'increment',\n  DECREMENT = 'decrement',\n  RANDOMIZE = 'randomize',\n  LINK_TO_GLOBAL = 'linkToGlobal'\n}\n\ninterface StepperControlOptions {\n  min?: number\n  max?: number\n  step?: number\n  step2?: number\n  onChange?: (value: number) => void\n}\n\nfunction convertToEnum(str?: ControlOptions): NumberControlMode {\n  switch (str) {\n    case 'fixed':\n      return NumberControlMode.FIXED\n    case 'increment':\n      return NumberControlMode.INCREMENT\n    case 'decrement':\n      return NumberControlMode.DECREMENT\n    case 'randomize':\n      return NumberControlMode.RANDOMIZE\n  }\n  return NumberControlMode.RANDOMIZE\n}\n\nfunction useControlButtonIcon(controlMode: Ref<NumberControlMode>) {\n  return computed(() => {\n    switch (controlMode.value) {\n      case NumberControlMode.INCREMENT:\n        return 'pi pi-plus'\n      case NumberControlMode.DECREMENT:\n        return 'pi pi-minus'\n      case NumberControlMode.FIXED:\n        return 'icon-[lucide--pencil-off]'\n      case NumberControlMode.LINK_TO_GLOBAL:\n        return 'pi pi-link'\n      default:\n        return 'icon-[lucide--shuffle]'\n    }\n  })\n}\n\nexport function useStepperControl(\n  modelValue: Ref<number>,\n  options: StepperControlOptions,\n  defaultValue?: ControlOptions\n) {\n  const controlMode = ref<NumberControlMode>(convertToEnum(defaultValue))\n  const controlId = Symbol('numberControl')\n\n  const applyControl = () => {\n    const { min = 0, max = 1000000, step2, step = 1, onChange } = options\n    const safeMax = Math.min(2 ** 50, max)\n    const safeMin = Math.max(-(2 ** 50), min)\n    // Use step2 if available (widget context), otherwise use step as-is (direct API usage)\n    const actualStep = step2 !== undefined ? step2 : step\n\n    let newValue: number\n    switch (controlMode.value) {\n      case NumberControlMode.FIXED:\n        // Do nothing - keep current value\n        return\n      case NumberControlMode.INCREMENT:\n        newValue = Math.min(safeMax, modelValue.value + actualStep)\n        break\n      case NumberControlMode.DECREMENT:\n        newValue = Math.max(safeMin, modelValue.value - actualStep)\n        break\n      case NumberControlMode.RANDOMIZE:\n        newValue = Math.floor(Math.random() * (safeMax - safeMin + 1)) + safeMin\n        break\n      default:\n        return\n    }\n\n    if (onChange) {\n      onChange(newValue)\n    } else {\n      modelValue.value = newValue\n    }\n  }\n\n  // Register with singleton registry\n  onMounted(() => {\n    numberControlRegistry.register(controlId, applyControl)\n  })\n\n  // Cleanup on unmount\n  onUnmounted(() => {\n    numberControlRegistry.unregister(controlId)\n  })\n  const controlButtonIcon = useControlButtonIcon(controlMode)\n\n  return {\n    applyControl,\n    controlButtonIcon,\n    controlMode\n  }\n}\n","<script setup lang=\"ts\">\nimport Button from 'primevue/button'\nimport { defineAsyncComponent, ref, watch } from 'vue'\n\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\n\nimport { useStepperControl } from '../composables/useStepperControl'\nimport WidgetInputNumberInput from './WidgetInputNumberInput.vue'\n\nconst NumberControlPopover = defineAsyncComponent(\n  () => import('./NumberControlPopover.vue')\n)\n\nconst props = defineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst modelValue = defineModel<number>({ default: 0 })\nconst popover = ref()\n\nconst handleControlChange = (newValue: number) => {\n  modelValue.value = newValue\n}\n\nconst { controlMode, controlButtonIcon } = useStepperControl(\n  modelValue,\n  {\n    ...props.widget.options,\n    onChange: handleControlChange\n  },\n  props.widget.controlWidget!.value\n)\n\nwatch(controlMode, props.widget.controlWidget!.update)\n\nconst togglePopover = (event: Event) => {\n  popover.value.toggle(event)\n}\n</script>\n\n<template>\n  <div class=\"relative grid grid-cols-subgrid\">\n    <WidgetInputNumberInput\n      v-model=\"modelValue\"\n      :widget\n      class=\"grid grid-cols-subgrid col-span-2\"\n    >\n      <Button\n        variant=\"link\"\n        size=\"small\"\n        class=\"h-4 w-7 self-center rounded-xl bg-blue-100/30 p-0\"\n        @click=\"togglePopover\"\n      >\n        <i :class=\"`${controlButtonIcon} text-blue-100 text-xs`\" />\n      </Button>\n    </WidgetInputNumberInput>\n    <NumberControlPopover ref=\"popover\" v-model=\"controlMode\" />\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\n\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\n\nimport WidgetInputNumberInput from './WidgetInputNumberInput.vue'\nimport WidgetInputNumberSlider from './WidgetInputNumberSlider.vue'\nimport WidgetInputNumberWithControl from './WidgetInputNumberWithControl.vue'\n\nconst props = defineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst modelValue = defineModel<number>({ default: 0 })\n\nconst hasControlAfterGenerate = computed(() => {\n  return !!props.widget.controlWidget\n})\n</script>\n\n<template>\n  <component\n    :is=\"\n      hasControlAfterGenerate\n        ? WidgetInputNumberWithControl\n        : widget.type === 'slider'\n          ? WidgetInputNumberSlider\n          : WidgetInputNumberInput\n    \"\n    v-model=\"modelValue\"\n    :widget=\"widget\"\n    v-bind=\"$attrs\"\n  />\n</template>\n"],"file":"WidgetInputNumber.vue_vue_type_script_setup_true_lang-DewItMqV.js"}