[build-system]
# Python 3.7 compatible setuptools (newer versions require Python 3.8+)
requires = ["setuptools>=50.0,<70.0", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "omnipkg"
version = "2.0.2"
authors = [
  { name = "1minds3t", email = "1minds3t@proton.me" },
]
description = "The Ultimate Python Dependency Resolver. One environment. Infinite packages. Zero conflicts."
readme = "README.md"
requires-python = ">=3.7, <3.15"

# Use old-style license for Python 3.7 compatibility
license = { text = "AGPL-3.0-only OR LicenseRef-Proprietary" }

classifiers = [
    "Development Status :: 5 - Production/Stable",
    "Intended Audience :: Developers",
    "Intended Audience :: Science/Research",
    "License :: OSI Approved :: GNU Affero General Public License v3 or later (AGPLv3+)",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.7",
    "Programming Language :: Python :: 3.8",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Programming Language :: Python :: 3.14",
    "Environment :: Console",
    "Topic :: Software Development :: Build Tools",
    "Topic :: System :: Software Distribution",
]

dependencies = [
    "requests>=2.20",
    "filelock>=3.9",
    "psutil>=5.9.0",
    "typer>=0.4.0",
    "rich>=10.0.0",
    
    # Python 3.7-3.9: Need older packaging + backports
    "packaging>=20.0,<21.0; python_version < '3.8'",
    "packaging>=21.0,<22.0; python_version >= '3.8' and python_version < '3.10'",
    "packaging>=23.0; python_version >= '3.10'",
    
    # Python 3.7-3.10 need tomli (tomllib is built-in for 3.11+)
    "tomli>=1.0.0; python_version < '3.11'",
    
    # Python 3.7-3.9: Need typing extensions backports
    "typing-extensions>=4.0.0; python_version < '3.10'",
    
    # importlib-metadata backport for Python < 3.8
    "importlib-metadata>=1.0; python_version < '3.8'",
    
    # dataclasses backport for Python 3.7
    "dataclasses>=0.8; python_version == '3.7'",
    
    # authlib with Python 3.7 compatibility
    "authlib>=1.2.0; python_version >= '3.7'",
    
    # aiohttp 3.13+ requires Python 3.8+, use older version for 3.7
    "aiohttp>=3.7.0,<3.9.0; python_version == '3.7'",
    "aiohttp>=3.13.1; python_version >= '3.8'",
    
    # Safety: different versions for different Python versions
    "safety>=2.0.0,<3.0; python_version < '3.10'",
    "safety>=3.0; python_version >= '3.10' and python_version < '3.14'",
    
    # pip-audit only for 3.14+
    "pip-audit>=2.6.0; python_version >= '3.14'",
    
    # uv: Check minimum Python version
    "uv>=0.9.6; python_version >= '3.8'",
]

[project.optional-dependencies]
full = [
    "tqdm>=4.50.0",
    "python-magic>=0.4.18",
    # Redis 5.0 requires Python 3.8+
    "redis>=4.0.0,<5.0; python_version == '3.7'",
    "redis>=5.0; python_version >= '3.8'",
]

dev = [
    "pytest>=6.0",
    "pytest-cov>=2.0",
    "black>=22.0; python_version >= '3.8'",
    "ruff>=0.1.0; python_version >= '3.8'",
]

[project.urls]
Homepage = "https://github.com/1minds3t/omnipkg"
"Bug Tracker" = "https://github.com/1minds3t/omnipkg/issues"
PyPi = "https://pypi.org/project/omnipkg/"
Conda-Forge = "https://anaconda.org/conda-forge/omnipkg"
Docs = "https://github.com/1minds3t/omnipkg/tree/main/docs"

[project.scripts]
omnipkg = "omnipkg.cli:main"
8pkg = "omnipkg.cli:main"
OMNIPKG = "omnipkg.cli:main"
8PKG = "omnipkg.cli:main"

[tool.setuptools.packages.find]
where = ["src"]
include = ["omnipkg*", "omnipkg.*", "tests*"]
exclude = [
    "build*",
    "dist*",
    "*.egg-info*",
    "dev_tools*",
]

[tool.setuptools.package-data]
omnipkg = [
    "locale/**/*.mo",
    "locale/**/*.pot",
]

[tool.setuptools]
# Old setuptools format (compatible with setuptools 50.x)
license-files = ["LICENSE", "COMMERCIAL_LICENSE.md"]
include-package-data = true