{% extends 'generic/object.html' %}
{% load helpers %}
{% load i18n %}

{% block title %}License Assignment ID {{ object.pk }}{% endblock %}

{% block breadcrumbs %}
  {{ block.super }}
  {% if object.license.license_type %}
    <li class="breadcrumb-item">
      <a href="{% url 'plugins:netbox_license:licenseassignment_list' %}?license__license_type_id={{ object.license.license_type.pk }}">
      {{ object.license.license_type }}
      </a>
    </li>
  {% endif %}
{% endblock %}
{% block content %}
<div class="row">
  <div class="col-md-6">
    <div class="card">
      <h5 class="card-header">License Details</h5>
      <table class="table table-hover attr-table">
        <tr>
          <th scope="row">License Type</th>
          <td>{{ object.license.license_type|linkify }}</td>
        </tr>
        <tr>
          <th scope="row">Product Code</th>
          <td class="font-monospace">{{ object.license.license_type.product_code|linkify|placeholder }}</td>
        </tr>
        <tr>
          <th scope="row">License Manufacturer</th>
          <td>{{ object.license.license_type.manufacturer|linkify|placeholder }}</td>
        </tr>
        <tr>
          <th>License Key</th>
          <td class="font-monospace">{{ object.license }}</td>
        </tr>
        <tr>
          <th scope="row">Serial Number</th>
          <td class="font-monospace">{{ object.license.serial_number|placeholder }}</td>
        </tr>
        <tr>
          <th scope="row">Volume Type</th>
          <td>{{ object.license.license_type.get_volume_type_display }}</td>
        </tr>
        <tr>
          <th scope="row">Volume Limit</th>
          <td>
            {% if object.license.volume_type == 'UNLIMITED' %}
              Unlimited
            {% else %}
              {{ object.license.volume_limit }}
            {% endif %}
          </td>
        </tr>
        <tr>
          <th scope="row">Current Usage</th>
          <td>{{ object.license.usage_display }}</td>
        </tr>
        {% if object.license.parent_license %}
        <tr>
          <th scope="row">Parent License</th>
          <td>{{ object.license.parent_license|linkify }}</td>
        </tr>
        {% endif %}

        {% if object.license.purchase_date %}
        <tr>
          <th scope="row">Purchase Date</th>
          <td>{{ object.license.purchase_date|date:"Y-m-d" }}</td>
        </tr>
        {% endif %}

        {% if object.license.expiry_date %}
        <tr>
          <th scope="row">Expiry Date</th>
          <td>{{ object.license.expiry_date|date:"Y-m-d" }}</td>
        </tr>
        {% endif %}

        <tr>
          <th scope="row">Expiry Status</th>
          <td>
            {% include "netbox_license/inc/license_progressbar.html" with record=object.license %}
          </td>
        </tr>
        <tr>
          <th scope="row">{% trans "Support Status" %}</th>
          <td>{% badge object.license.get_support_status_display bg_color=object.license.get_support_status_color %}</td>
        </tr>
        <tr>
          <th scope="row">Description</th>
          <td>{{ object.license.description|placeholder }}</td>
        </tr>
        <tr>
          <th scope="row">{% trans "Status" %}</th>
          <td>{% badge object.license.get_status_display bg_color=object.license.get_status_color %}</td>
        </tr>
      </table>
    </div>
  </div>

  <!-- Assignment Details -->
  <div class="col-md-6">
    <div class="card">
      <h5 class="card-header">Assignment Details</h5>
      <table class="table table-hover attr-table">
        {% if object.device %}
        <tr>
          <th scope="row">Device</th>
          <td>{{ object.device|linkify }}</td>
        </tr>
        <tr>
          <th scope="row">Device Manufacturer</th>
          <td>{{ object.device.device_type.manufacturer|linkify|placeholder }}</td>
          {# Alternatively: <td>{{ object.device_manufacturer|linkify|placeholder }}</td> #}
        </tr>
        {% endif %}

        {% if object.virtual_machine %}
        <tr>
          <th scope="row">Virtual Machine</th>
          <td>{{ object.virtual_machine|linkify }}</td>
        </tr>
        {% endif %}

        <tr>
          <th scope="row">Assigned On</th>
          <td>{{ object.assigned_on|date:"Y-m-d" }}</td>
        </tr>
        <tr>
          <th scope="row">Volume</th>
          <td>{{ object.volume }}</td>
        </tr>
        <tr>
          <th scope="row">Description</th>
          <td>{{ object.description|placeholder }}</td>
        </tr>
      </table>
    </div>
  </div>
</div>
{% endblock %}
