# This file was auto-generated by Fern from our API Definition.

import typing

from ..billing_commons.types.reward_id import RewardId
from ..billing_commons.types.rewards_filter_options import RewardsFilterOptions
from ..billing_commons.types.transaction_id import TransactionId
from ..commons.types.issuer_id import IssuerId
from ..commons.types.page import Page
from ..commons.types.user_id import UserId
from ..core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ..core.request_options import RequestOptions
from .raw_client import AsyncRawBillingAgentClient, RawBillingAgentClient
from .types.create_issuer_reward_response_object import CreateIssuerRewardResponseObject
from .types.eom_update_payload import EomUpdatePayload
from .types.get_issuer_matched_transaction_info_response_object import GetIssuerMatchedTransactionInfoResponseObject
from .types.get_issuer_reward_response_object import GetIssuerRewardResponseObject
from .types.get_issuer_rewards_response_object import GetIssuerRewardsResponseObject
from .types.revert_issuer_reward_response_object import RevertIssuerRewardResponseObject
from .types.update_matched_transaction_payload import UpdateMatchedTransactionPayload

# this is used as the default value for optional parameters
OMIT = typing.cast(typing.Any, ...)


class BillingAgentClient:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._raw_client = RawBillingAgentClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> RawBillingAgentClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        RawBillingAgentClient
        """
        return self._raw_client

    def create_issuer_reward(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        *,
        transaction_ids: typing.Sequence[TransactionId],
        description: str,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> CreateIssuerRewardResponseObject:
        """
        Call this endpoint to create a new reward entry in the ledger.<br/>
        <b>Required scopes:</b> `reward:write`

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        transaction_ids : typing.Sequence[TransactionId]
            TransactionIds is a list of transactions related to the reward payout

        description : str
            Description of the payout

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        CreateIssuerRewardResponseObject

        Examples
        --------
        from kard import KardApi

        client = KardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.billing_agent.create_issuer_reward(
            issuer_id="5e27318c9b346f00087fbb32",
            user_id="5e27318c9b346f00087fbb32",
            transaction_ids=["billing.TransactionId.Sample"],
            description="Reward payout for transaction",
        )
        """
        _response = self._raw_client.create_issuer_reward(
            issuer_id,
            user_id,
            transaction_ids=transaction_ids,
            description=description,
            request_options=request_options,
        )
        return _response.data

    def revert_issuer_reward(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        reward_id: RewardId,
        *,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> RevertIssuerRewardResponseObject:
        """
        Call this endpoint to revert a reward for the issuer

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        reward_id : RewardId
            ID of the reward entry

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        RevertIssuerRewardResponseObject

        Examples
        --------
        import uuid

        from kard import KardApi

        client = KardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.billing_agent.revert_issuer_reward(
            issuer_id="5e27318c9b346f00087fbb32",
            user_id="5e27318c9b346f00087fbb32",
            reward_id=uuid.UUID(
                "82ed6e40-f2f6-4f66-be17-52c03ad64414",
            ),
        )
        """
        _response = self._raw_client.revert_issuer_reward(
            issuer_id, user_id, reward_id, request_options=request_options
        )
        return _response.data

    def get_issuer_reward(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        reward_id: RewardId,
        *,
        entries: typing.Optional[bool] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> GetIssuerRewardResponseObject:
        """
        Call this endpoint to get a reward.<br/>
        <b>Required scopes:</b> `rewards:read`

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        reward_id : RewardId
            ID of the reward entry

        entries : typing.Optional[bool]
            Include reward entries in the response

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetIssuerRewardResponseObject

        Examples
        --------
        import uuid

        from kard import KardApi

        client = KardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.billing_agent.get_issuer_reward(
            issuer_id="5e27318c9b346f00087fbb32",
            user_id="5e27318c9b346f00087fbb32",
            reward_id=uuid.UUID(
                "82ed6e40-f2f6-4f66-be17-52c03ad64414",
            ),
        )
        """
        _response = self._raw_client.get_issuer_reward(
            issuer_id, user_id, reward_id, entries=entries, request_options=request_options
        )
        return _response.data

    def get_issuer_rewards(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        *,
        page: typing.Optional[Page] = None,
        filter: typing.Optional[RewardsFilterOptions] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> GetIssuerRewardsResponseObject:
        """
        Call this endpoint to list rewards. MUST BE FILTERED<br/>
        <b>Required scopes:</b> `rewards:read`

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        page : typing.Optional[Page]

        filter : typing.Optional[RewardsFilterOptions]

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetIssuerRewardsResponseObject

        Examples
        --------
        from kard import KardApi

        client = KardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.billing_agent.get_issuer_rewards(
            issuer_id="5e27318c9b346f00087fbb32",
            user_id="5e27318c9b346f00087fbb32",
        )
        """
        _response = self._raw_client.get_issuer_rewards(
            issuer_id, user_id, page=page, filter=filter, request_options=request_options
        )
        return _response.data

    def get_issuer_matched_transaction_info(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        *,
        transaction_ids: str,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> GetIssuerMatchedTransactionInfoResponseObject:
        """
        Call this endpoint to get information on a list of matched transactions

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        transaction_ids : str
            Comma-separated list of transactions IDs to fetch info for

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetIssuerMatchedTransactionInfoResponseObject

        Examples
        --------
        from kard import KardApi

        client = KardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.billing_agent.get_issuer_matched_transaction_info(
            issuer_id="5e27318c9b346f00087fbb32",
            user_id="5e27318c9b346f00087fbb32",
            transaction_ids="123456,876543",
        )
        """
        _response = self._raw_client.get_issuer_matched_transaction_info(
            issuer_id, user_id, transaction_ids=transaction_ids, request_options=request_options
        )
        return _response.data

    def eom_updates(
        self,
        issuer_id: IssuerId,
        *,
        data: typing.Sequence[EomUpdatePayload],
        request_options: typing.Optional[RequestOptions] = None,
    ) -> None:
        """
        Call this endpoint to get information on a list of matched transactions

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        data : typing.Sequence[EomUpdatePayload]

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        None

        Examples
        --------
        from kard import KardApi
        from kard.billing_agent import EomUpdatePayload

        client = KardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.billing_agent.eom_updates(
            issuer_id="issuerId",
            data=[
                EomUpdatePayload(
                    id="id",
                    attributes={"attributes": {"key": "value"}},
                ),
                EomUpdatePayload(
                    id="id",
                    attributes={"attributes": {"key": "value"}},
                ),
            ],
        )
        """
        _response = self._raw_client.eom_updates(issuer_id, data=data, request_options=request_options)
        return _response.data

    def update_matched_transaction(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        transaction_id: TransactionId,
        *,
        data: UpdateMatchedTransactionPayload,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> None:
        """
        Call this endpoint to update a matched transaction with adjusted commission

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        transaction_id : TransactionId
            The ID of the transaction

        data : UpdateMatchedTransactionPayload

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        None

        Examples
        --------
        from kard import KardApi
        from kard.billing_agent import UpdateMatchedTransactionPayload

        client = KardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.billing_agent.update_matched_transaction(
            issuer_id="5e27318c9b346f00087fbb32",
            user_id="5e27318c9b346f00087fbb32",
            transaction_id="123456",
            data=UpdateMatchedTransactionPayload(
                issuer_amount=100,
                cardholder_amount=100,
                kard_fee=100,
            ),
        )
        """
        _response = self._raw_client.update_matched_transaction(
            issuer_id, user_id, transaction_id, data=data, request_options=request_options
        )
        return _response.data


class AsyncBillingAgentClient:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._raw_client = AsyncRawBillingAgentClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> AsyncRawBillingAgentClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        AsyncRawBillingAgentClient
        """
        return self._raw_client

    async def create_issuer_reward(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        *,
        transaction_ids: typing.Sequence[TransactionId],
        description: str,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> CreateIssuerRewardResponseObject:
        """
        Call this endpoint to create a new reward entry in the ledger.<br/>
        <b>Required scopes:</b> `reward:write`

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        transaction_ids : typing.Sequence[TransactionId]
            TransactionIds is a list of transactions related to the reward payout

        description : str
            Description of the payout

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        CreateIssuerRewardResponseObject

        Examples
        --------
        import asyncio

        from kard import AsyncKardApi

        client = AsyncKardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.billing_agent.create_issuer_reward(
                issuer_id="5e27318c9b346f00087fbb32",
                user_id="5e27318c9b346f00087fbb32",
                transaction_ids=["billing.TransactionId.Sample"],
                description="Reward payout for transaction",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.create_issuer_reward(
            issuer_id,
            user_id,
            transaction_ids=transaction_ids,
            description=description,
            request_options=request_options,
        )
        return _response.data

    async def revert_issuer_reward(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        reward_id: RewardId,
        *,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> RevertIssuerRewardResponseObject:
        """
        Call this endpoint to revert a reward for the issuer

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        reward_id : RewardId
            ID of the reward entry

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        RevertIssuerRewardResponseObject

        Examples
        --------
        import asyncio
        import uuid

        from kard import AsyncKardApi

        client = AsyncKardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.billing_agent.revert_issuer_reward(
                issuer_id="5e27318c9b346f00087fbb32",
                user_id="5e27318c9b346f00087fbb32",
                reward_id=uuid.UUID(
                    "82ed6e40-f2f6-4f66-be17-52c03ad64414",
                ),
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.revert_issuer_reward(
            issuer_id, user_id, reward_id, request_options=request_options
        )
        return _response.data

    async def get_issuer_reward(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        reward_id: RewardId,
        *,
        entries: typing.Optional[bool] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> GetIssuerRewardResponseObject:
        """
        Call this endpoint to get a reward.<br/>
        <b>Required scopes:</b> `rewards:read`

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        reward_id : RewardId
            ID of the reward entry

        entries : typing.Optional[bool]
            Include reward entries in the response

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetIssuerRewardResponseObject

        Examples
        --------
        import asyncio
        import uuid

        from kard import AsyncKardApi

        client = AsyncKardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.billing_agent.get_issuer_reward(
                issuer_id="5e27318c9b346f00087fbb32",
                user_id="5e27318c9b346f00087fbb32",
                reward_id=uuid.UUID(
                    "82ed6e40-f2f6-4f66-be17-52c03ad64414",
                ),
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.get_issuer_reward(
            issuer_id, user_id, reward_id, entries=entries, request_options=request_options
        )
        return _response.data

    async def get_issuer_rewards(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        *,
        page: typing.Optional[Page] = None,
        filter: typing.Optional[RewardsFilterOptions] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> GetIssuerRewardsResponseObject:
        """
        Call this endpoint to list rewards. MUST BE FILTERED<br/>
        <b>Required scopes:</b> `rewards:read`

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        page : typing.Optional[Page]

        filter : typing.Optional[RewardsFilterOptions]

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetIssuerRewardsResponseObject

        Examples
        --------
        import asyncio

        from kard import AsyncKardApi

        client = AsyncKardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.billing_agent.get_issuer_rewards(
                issuer_id="5e27318c9b346f00087fbb32",
                user_id="5e27318c9b346f00087fbb32",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.get_issuer_rewards(
            issuer_id, user_id, page=page, filter=filter, request_options=request_options
        )
        return _response.data

    async def get_issuer_matched_transaction_info(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        *,
        transaction_ids: str,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> GetIssuerMatchedTransactionInfoResponseObject:
        """
        Call this endpoint to get information on a list of matched transactions

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        transaction_ids : str
            Comma-separated list of transactions IDs to fetch info for

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        GetIssuerMatchedTransactionInfoResponseObject

        Examples
        --------
        import asyncio

        from kard import AsyncKardApi

        client = AsyncKardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.billing_agent.get_issuer_matched_transaction_info(
                issuer_id="5e27318c9b346f00087fbb32",
                user_id="5e27318c9b346f00087fbb32",
                transaction_ids="123456,876543",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.get_issuer_matched_transaction_info(
            issuer_id, user_id, transaction_ids=transaction_ids, request_options=request_options
        )
        return _response.data

    async def eom_updates(
        self,
        issuer_id: IssuerId,
        *,
        data: typing.Sequence[EomUpdatePayload],
        request_options: typing.Optional[RequestOptions] = None,
    ) -> None:
        """
        Call this endpoint to get information on a list of matched transactions

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        data : typing.Sequence[EomUpdatePayload]

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        None

        Examples
        --------
        import asyncio

        from kard import AsyncKardApi
        from kard.billing_agent import EomUpdatePayload

        client = AsyncKardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.billing_agent.eom_updates(
                issuer_id="issuerId",
                data=[
                    EomUpdatePayload(
                        id="id",
                        attributes={"attributes": {"key": "value"}},
                    ),
                    EomUpdatePayload(
                        id="id",
                        attributes={"attributes": {"key": "value"}},
                    ),
                ],
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.eom_updates(issuer_id, data=data, request_options=request_options)
        return _response.data

    async def update_matched_transaction(
        self,
        issuer_id: IssuerId,
        user_id: UserId,
        transaction_id: TransactionId,
        *,
        data: UpdateMatchedTransactionPayload,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> None:
        """
        Call this endpoint to update a matched transaction with adjusted commission

        Parameters
        ----------
        issuer_id : IssuerId
            The id of the issuer

        user_id : UserId
            The ID of the user

        transaction_id : TransactionId
            The ID of the transaction

        data : UpdateMatchedTransactionPayload

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        None

        Examples
        --------
        import asyncio

        from kard import AsyncKardApi
        from kard.billing_agent import UpdateMatchedTransactionPayload

        client = AsyncKardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.billing_agent.update_matched_transaction(
                issuer_id="5e27318c9b346f00087fbb32",
                user_id="5e27318c9b346f00087fbb32",
                transaction_id="123456",
                data=UpdateMatchedTransactionPayload(
                    issuer_amount=100,
                    cardholder_amount=100,
                    kard_fee=100,
                ),
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.update_matched_transaction(
            issuer_id, user_id, transaction_id, data=data, request_options=request_options
        )
        return _response.data
