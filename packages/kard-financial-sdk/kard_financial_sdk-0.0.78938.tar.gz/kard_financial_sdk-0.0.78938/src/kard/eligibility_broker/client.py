# This file was auto-generated by Fern from our API Definition.

import typing

from ..core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ..core.request_options import RequestOptions
from .raw_client import AsyncRawEligibilityBrokerClient, RawEligibilityBrokerClient
from .types.ingestion_events import IngestionEvents

# this is used as the default value for optional parameters
OMIT = typing.cast(typing.Any, ...)


class EligibilityBrokerClient:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._raw_client = RawEligibilityBrokerClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> RawEligibilityBrokerClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        RawEligibilityBrokerClient
        """
        return self._raw_client

    def ingest(
        self, *, data: typing.Sequence[IngestionEvents], request_options: typing.Optional[RequestOptions] = None
    ) -> None:
        """
        Send events to be ingested by the eligibility broker to change a user's eligibility.

        Parameters
        ----------
        data : typing.Sequence[IngestionEvents]
            Discriminated union representing the request body for submitting an eligibility event.
            Use `type` to distinguish between the two:
            - `segmentUser`: For segmentation events that change eligibility.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        None

        Examples
        --------
        import datetime

        from kard import KardApi
        from kard.eligibility_broker import (
            IngestionEvents_SegmentUser,
            SegmentationIngestionEventAttributes,
        )

        client = KardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.eligibility_broker.ingest(
            data=[
                IngestionEvents_SegmentUser(
                    attributes=SegmentationIngestionEventAttributes(
                        user_id="6FHt5b6Fnp0qdomMEy5AN6PXcSJIeX69",
                        issuer_id="00073100",
                        segment_id="5eb2d4a39ce24e00081488c4",
                        status="ACTIVE",
                        event_time=datetime.datetime.fromisoformat(
                            "2021-07-02 17:47:06+00:00",
                        ),
                    ),
                )
            ],
        )
        """
        _response = self._raw_client.ingest(data=data, request_options=request_options)
        return _response.data


class AsyncEligibilityBrokerClient:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._raw_client = AsyncRawEligibilityBrokerClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> AsyncRawEligibilityBrokerClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        AsyncRawEligibilityBrokerClient
        """
        return self._raw_client

    async def ingest(
        self, *, data: typing.Sequence[IngestionEvents], request_options: typing.Optional[RequestOptions] = None
    ) -> None:
        """
        Send events to be ingested by the eligibility broker to change a user's eligibility.

        Parameters
        ----------
        data : typing.Sequence[IngestionEvents]
            Discriminated union representing the request body for submitting an eligibility event.
            Use `type` to distinguish between the two:
            - `segmentUser`: For segmentation events that change eligibility.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        None

        Examples
        --------
        import asyncio
        import datetime

        from kard import AsyncKardApi
        from kard.eligibility_broker import (
            IngestionEvents_SegmentUser,
            SegmentationIngestionEventAttributes,
        )

        client = AsyncKardApi(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.eligibility_broker.ingest(
                data=[
                    IngestionEvents_SegmentUser(
                        attributes=SegmentationIngestionEventAttributes(
                            user_id="6FHt5b6Fnp0qdomMEy5AN6PXcSJIeX69",
                            issuer_id="00073100",
                            segment_id="5eb2d4a39ce24e00081488c4",
                            status="ACTIVE",
                            event_time=datetime.datetime.fromisoformat(
                                "2021-07-02 17:47:06+00:00",
                            ),
                        ),
                    )
                ],
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.ingest(data=data, request_options=request_options)
        return _response.data
