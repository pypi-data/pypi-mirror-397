To use a model generated by the FeynRules package
:cite:`Christensen2008py`, :cite:`Christensen2009jx`, :cite:`Darme:2023jdn`, the model must be
made available to Sherpa by running

.. code-block:: shell-session

   $ <prefix>/bin/Sherpa-generate-model <path-to-ufo-model>

where ``<path-to-ufo-model>`` specifies the location of the directory
where the UFO model can be found. UFO support must be enabled using
the :option:`-DSHERPA_ENABLE_UFO=ON` option of the configure script, as
described in :ref:`Installation`. This requires Python version 3.5 or
later.

The above command generates source code for the UFO model, compiles
it, and installs the corresponding library, making it available for
event generation. Python and the UFO model directory are not
required for event generation once the above command has
finished. Note that the installation directory for the created library
and the paths to Sherpa libraries and headers are predetermined
automatically during the installation of Sherpa. If the Sherpa
installation is moved afterwards or if the user does not have the
necessary permissions to install the new library in the predetermined
location, these paths can be set manually.

Please run

.. code-block:: shell-session

   $ <prefix>/bin/Sherpa-generate-model --help

for information on the relevant command line arguments.

An example configuration file and parameter card will be written
to the working directory while the model is generated with
``Sherpa-generate-model``. This config file shows the syntax for the
respective model parameters and can be used as a template. It is also
possible to use an external parameter file by specifying the path to
the file with the switch :option:`UFO_PARAM_CARD` in the configuration
file or on the command line. Relative and absolute file paths are allowed.
This option allows it to use the native UFO parameter cards, produced by FeynRules and
as used by MadGraph for example.

Note that the use of the SM :option:`PARTICLE_DATA` switches
:option:`Mass`, :option:`Massive`, :option:`Width`, and
:option:`Stable` is discouraged when using UFO models as the UFO model
completely defines all particle properties and their relation to the
independent model parameters. These model parameters should be set
using the standard UFO parameter syntax as shown in the example run
card generated by the ``Sherpa-generate-model`` command.

For parts of the simulation other than the hard process (hadronisation,
underlying event, running of the SM couplings) Sherpa uses internal
default values for the Standard Model fermion masses if they are
massless in the UFO model. This is necessary for a meaningful
simulation. In the hard process however, the UFO model masses are always
respected.

If your UFO model adds particles which should be treated like hadrons, e.g.
decaying through the hadron decay module similar to the tau lepton, then you
have to list them with their PDG IDs using the
:option:`UFO_HADRONS=[<int>, <int>, ...]` option.

For an example UFO setup, see :ref:`BSM/UFO_SMEFTsim`. Further models are shipped
with Sherpa, residing in the ``<prefix>/share/SHERPA-MC/Examples/BSM``
directory. Note, if you want to use an extremely complex model with many
high-multiplicity vertices, the ``Sherpa-generate-model`` step might require a lot of CPU time and memory
even though not all vertices might be necessary for the scattering processes
you plan to study. In such a case it is advised to restrict the number of
external particles in Lorentz and color functions to the default of
``--nmax 4``. Of course you can increase that number if higher-point vertices
are needed.

Extending Sherpa to include partial support for UFO2.0 :cite:`Darme:2023jdn`, Sherpa now has the ability to
handle models that include form factors in the vertices. Currently, the interface
does not support form factors that are directly defined in the model file. Instead,
they need to be defined in a separate file, compiled into a shared library, and
loaded at runtime.

For more details on the
Sherpa interface to FeynRules please consult
:cite:`Christensen2009jx`, :cite:`Hoeche2014kca`.

Please note that AMEGIC can only be used for the built-in models (SM
and HEFT). The use of UFO models is only supported by Comix.

.. .. _MSSM:

.. Minimal Supersymmetric Standard Model
.. =====================================


.. The MSSM is implemented via UFO, cf.
.. @uref{https://feynrules.irmp.ucl.ac.be/wiki/MSSM}.
.. In order to use this model, Sherpa must be installed with python support,
.. using :option:`-DSHERPA_ENABLE_PYTHON=ON`, as described in @xref{Installation}.
.. Once installed, the model is made available to Sherpa by running
..
.. .. code-block::

   ..   Sherpa-generate-model MODEL/MSSM
