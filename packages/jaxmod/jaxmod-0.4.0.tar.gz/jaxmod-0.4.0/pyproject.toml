[project]
name = "jaxmod"
version = "0.4.0"
description = "Lightweight utility functions for JAX arrays, batching, and pytrees"
readme = "README.md"
requires-python = ">=3.11,<=4.0"
license = "GPL-3.0-or-later"
authors = [
    {name = "Dan J Bower", email = "dbower@eaps.ethz.ch"},
]
keywords = [
  "jax",
  "equinox",
  "optimistix",
]
classifiers = [
    "Development Status :: 5 - Production/Stable",
    "Intended Audience :: Developers",
    "Intended Audience :: Science/Research",
    "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
    "Natural Language :: English",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Topic :: Scientific/Engineering :: Astronomy",
    "Topic :: Scientific/Engineering :: Atmospheric Science",
    "Topic :: Scientific/Engineering :: Physics",
    "Topic :: Scientific/Engineering :: Chemistry",
]
dependencies = [
    # JAX pinned for Intel macOS
    "jax==0.4.38; sys_platform == 'darwin' and platform_machine == 'x86_64'",
    # JAX for all other platforms
    "jax>0.4.38,!=0.7.0,!=0.7.1; sys_platform != 'darwin' or platform_machine != 'x86_64'",
    "pandas>=2.3.0",
    "equinox>=0.13.2",
    "molmass>=2025.9.4",
    "optimistix>=0.0.11",
]

[project.urls]
homepage = "https://planetology.ethz.ch"
documentation = "https://jaxmod.readthedocs.io/en/latest"
repository = "https://github.com/ExPlanetology/jaxmod"
issues = "https://github.com/ExPlanetology/jaxmod/issues"

[project.optional-dependencies]
docs = [
    "sphinx-rtd-theme>=3.0.2",
    "sphinx>=8.2.3",
    "sphinxcontrib-bibtex>=2.6.5",
    "setuptools>=80.9.0",
    "doc8>=2.0.0",
    "nbsphinx>=0.9.6",
    "pypandoc>=1.15",
    "nbsphinx-link>=1.3.1",
]

[dependency-groups]
dev = [
    "beartype>=0.21.0,<0.22.0",
    "jaxtyping>=0.3.2,<0.4.0",
    "pre-commit>=4.2.0",
    "pytest>=8.4.1",
    "pytest-beartype>=0.2.0,<0.3.0",
    "pytest-cov>=6.2.1",
]

[tool.pytest.ini_options]
beartype_packages = "jaxmod"

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"