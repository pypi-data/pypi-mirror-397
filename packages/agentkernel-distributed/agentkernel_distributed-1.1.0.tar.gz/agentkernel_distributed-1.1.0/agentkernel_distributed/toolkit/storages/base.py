"""Abstract base class for asynchronous database adapters."""

from __future__ import annotations

from abc import ABC, abstractmethod
from typing import Any, Dict, Optional


class DatabaseAdapter(ABC):
    """Common interface implemented by all database adapters."""

    @abstractmethod
    async def connect(self, config: Dict[str, Any], pool: Optional[Any] = None) -> None:
        """
        Establish a connection to the underlying data store.

        Args:
            config (Dict[str, Any]): Adapter-specific configuration dictionary.
            pool (Optional[Any]): Optional connection pool or shared resource provided by the caller.
        """
        raise NotImplementedError

    @abstractmethod
    async def disconnect(self) -> None:
        """Close any open connections and release resources."""
        raise NotImplementedError

    @abstractmethod
    async def is_connected(self) -> bool:
        """
        Determine whether the adapter currently holds an active connection.

        Returns:
            bool: True when a connection is active.
        """
        raise NotImplementedError

    @abstractmethod
    async def import_data(self, data: Any) -> None:
        """
        Import a dataset into the backing store.

        Args:
            data (Any): Adapter-defined data structure (dict, list, DataFrame, etc.).
        """
        raise NotImplementedError

    @abstractmethod
    async def export_data(self, *args: Any, **kwargs: Any) -> Any:
        """
        Export data from the backing store.

        Args:
            *args (Any): Positional arguments for the export operation.
            **kwargs (Any): Keyword arguments for the export operation.

        Returns:
            Any: Adapter-defined data structure representing the exported data.
        """
        raise NotImplementedError

    @abstractmethod
    async def clear(self) -> bool:
        """
        Remove all data from the backing store managed by this adapter.

        Returns:
            bool: True when data was cleared successfully.
        """
        raise NotImplementedError

    @abstractmethod
    async def undo(self, timestamp: str) -> bool:
        """Restores the key-value state to a snapshot at or before the given
        timestamp.

        Args:
            timestamp (str): The ISO 8601 timestamp to restore to. This
                identifier should correspond to the one generated by `snapshot`.

        Returns:
            bool: True if the restoration was successful, False otherwise.
        """
        raise NotImplementedError
