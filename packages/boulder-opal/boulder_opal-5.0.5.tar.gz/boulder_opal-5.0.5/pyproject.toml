[tool.poetry]
name = "boulder-opal"
version = "5.0.5"
description = "Boulder Opal Client"
license = "https://q-ctrl.com/terms"
authors = ["Q-CTRL <support@q-ctrl.com>"]
maintainers = ["Q-CTRL <support@q-ctrl.com>"]
readme = "README.md"
homepage = "https://q-ctrl.com"
documentation = "https://docs.q-ctrl.com/boulder-opal"
keywords = [
    "black opal",
    "boulder opal",
    "fire opal",
    "nisq",
    "open controls",
    "q control",
    "q ctrl",
    "q-control",
    "q-ctrl",
    "qcontrol",
    "qctrl",
    "quantum",
    "quantum algorithms",
    "quantum circuits",
    "quantum coding",
    "quantum coding software",
    "quantum computing",
    "quantum control",
    "quantum control software",
    "quantum control theory",
    "quantum engineering",
    "quantum error correction",
    "quantum firmware",
    "quantum fundamentals",
    "quantum sensing",
    "qubit",
    "qudit"
]
classifiers = [
    "Development Status :: 5 - Production/Stable",
    "Environment :: Console",
    "Intended Audience :: Developers",
    "Intended Audience :: Education",
    "Intended Audience :: Science/Research",
    "Natural Language :: English",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Topic :: Internet :: WWW/HTTP",
    "Topic :: Scientific/Engineering :: Physics",
    "Topic :: Scientific/Engineering :: Visualization",
    "Topic :: Software Development :: Embedded Systems",
    "Topic :: System :: Distributed Computing"
]
packages = [
    { include = "boulderopal" },
]
include = ["boulderopal/py.typed"]

[tool.poetry.urls]
LinkedIn = "https://www.linkedin.com/company/q-ctrl/"
Facebook = "https://www.facebook.com/qctrl"
X = "https://x.com/qctrlHQ"
YouTube = "https://www.youtube.com/qctrl"
GitHub = "https://github.com/qctrl"

[[tool.poetry.source]]
name = "PyPI"
priority = "primary"

[[tool.poetry.source]]
name = 'Artifactory'
url = 'https://qctrl.jfrog.io/artifactory/api/pypi/qctrl/simple/'
priority = "supplemental"

[tool.poetry.dependencies]
python = ">=3.10, <3.13"
numpy = "^2.0.2"
pydantic = { version = ">=2.6.4,<2.12", source = "PyPI" }
rich = "^14.1.0"
typing-extensions = "^4.8.0"
qctrl-commons = { version = "^25.1.3", source = "PyPI" }
qctrl-workflow-client = { version = "^8.0.1", source = "PyPI" }
qctrl-client = { version = "^14.0.0", source = "PyPI" }

[tool.poetry.group.dev.dependencies]
lemminflect = "^0.2.3"
mypy = "^1.6.1"
numpydoc = "^1.5.0"
pre-commit = "^3.4.0"
pytest = "^7.4.2"
pytest-cov = "^4.1.0"
pytest-mock = "^3.11.1"
pytest-xdist = "^3.3.1"
ruff = "^0.6.0"
sphinx = "5.3.0"
tomli = "^2.0.1"
types-requests= "^2.31.0"
boulder-opal-core = "^51.0.9"
qctrl-core-workflow-manager = "^6.0.0"
sphinx-markdown-builder = "0.6.8"  # Pin for compatibility with Sphinx 5.3.0


[tool.mypy]
files = ["boulderopal/**/*.py", "tests/**/*.py"]
check_untyped_defs = true
ignore_missing_imports = true
no_implicit_optional = true
warn_unused_ignores = true
disallow_untyped_defs = true

[[tool.mypy.overrides]]
module = ["tests/*"]
disallow_untyped_defs = false

[tool.ruff]
line-length = 100

[tool.ruff.lint]
select = ["ALL"]
exclude = ["docs/*"]

ignore = [
  "D",       # Docstrings
  "ANN",     # Type annotations
  "EM101",   # Exception must not use a string literal
  "EM102",   # Exception must not use an f-string literal
  "TRY003",  # Avoid long messages outside exception class
  "PERF203", # try/except in loop
  "RUF005",  # Iterable unpacking
  "S101",    # Assertions in code
  "FBT",     # Boolean positional arguments
  "FA102",   # Future annotations
  "RUF001",  # Ambiguous character
  "RUF002",  # Ambiguous character
  "RUF003",  # Ambiguous character
  "RET504",  # Unnecessary assignment before return
  "PYI024",  # Use typing.NamedTuple instead of collections.namedtuple
  "ERA001",  # Commented-out code
  "PYI041",  # Use complex instead of int | complex or float | complex
  "PD011",   # Use to_numpy instead of values
  "PGH003",  # Use specific rule codes when ignoring type issues
  "TCH",     # Type-checking blocks
  "ARG001",  # Unused function argument
  "ARG005",  # Unused lambda argument
  "SLF001",  # Private member accessed
  "BLE001",  # Do not catch blind exception
  "A002",    # Argument is shadowing a Python builtin
  "C401",    # Unnecessary generator
  "C901",    # Function is too complex
  "PLR2004", # Magic values
  "PLR09",   # Too many arguments, statements, branches
  "UP",      # Python 3.11 type annotations
  "FA100",   # Future annotations
  "B018",    # Useless expression
  "T201",    # Print statements
  "E731",    # Do not assign a lambda expression, use a def
  "C405",    # Unnecessary list literal
  "SIM108",  # Ternary operator
  "SIM102",  # Single if statement
  "SIM118",  # Use key in dict
]

[tool.ruff.lint.per-file-ignores]
"tests/**.py" = [
  "T20",    # Print statements
  "NPY002", # Replace np.random with Generator
  "E741",   # Ambiguous variable name
  "PT011",  # pytest.raises is too broad
  "PT007",  # Wrong values type in pytest.mark.parametrize
  "PT012",  # pytest.raises block should contain a single simple statement
]

[tool.pytest.ini_options]
addopts = "--cov=boulderopal --cov-fail-under=90 --cov-report=term-missing:skip-covered"

[build-system]
requires = ["poetry-core"]
build-backend = "poetry.core.masonry.api"
