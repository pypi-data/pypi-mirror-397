[tox]
requires =
    tox>=4.0
    tox-uv>=1.0
env_list = lint, fmt, static, unit

[vars]
src = src/gundog
tst = tests

[testenv]
runner = uv-venv-lock-runner
extras = dev
uv_resolution = highest
set_env =
    PYTHONPATH = {toxinidir}/src

[testenv:lint]
description = Run linter
commands = ruff check {[vars]src} {[vars]tst}

[testenv:fmt]
description = Run formatter
commands = ruff format --check {[vars]src} {[vars]tst}

[testenv:static]
description = Run static type checker
extras = dev
commands = pyright {[vars]src}

[testenv:unit]
description = Run unit tests with coverage
commands =
    pytest --cov={[vars]src} --cov-report=term-missing --cov-report=html {[vars]tst}

[testenv:lock]
description = Update uv.lock
runner = uv-venv-runner
commands = uv lock --upgrade
