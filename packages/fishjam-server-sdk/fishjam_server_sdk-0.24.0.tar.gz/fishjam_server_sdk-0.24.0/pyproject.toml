[project]
name = "fishjam-server-sdk"
version = "0.24.0"
description = "Python server SDK for the Fishjam"
authors = [{ name = "Fishjam Team", email = "contact@fishjam.io" }]
requires-python = ">=3.11"
readme = "README.md"
license = "Apache-2.0"
dependencies = [
    "websockets~=15.0",
    "urllib3>=1.25.3,<2",
    "aenum>=3.1.15,<4",
    "python-dateutil>=2.8.2,<3",
    "betterproto==2.0.0b6",
    "httpx>=0.28.0,<0.29.0",
    "attrs>=21.3.0",
    "flask-cors>=6.0.1,<7",
]

[project.urls]
Homepage = "https://github.com/fishjam-cloud/python-server-sdk"
Documentation = "https://fishjam-cloud.github.io/python-server-sdk/fishjam"

[project.scripts]
ci_test = "scripts:run_tests"
local_test = "scripts:run_local_test"
format = "scripts:run_formatter"
format_check = "scripts:run_format_check"
lint = "scripts:run_linter"
fix_lint = "scripts:run_linter_fix"
generate_docs = "scripts:generate_docs"
generate_docusaurus = "scripts:generate_docusaurus"
update_client = "scripts:update_client"
room_manager = "scripts:start_room_manager"

[project.optional-dependencies]
gemini = ["google-genai>=1.43.0"]

[dependency-groups]
dev = [
    "betterproto[compiler]== 2.0.0b6",
    "pdoc>=15.0.0,<16",
    "mkdocs>=1.5.3,<2",
    "mike>=2.0.0,<3",
    "openapi-python-client>=0.25.0,<0.26",
    "ruff==0.12",
    "flask>=3.0.3,<4",
    "pyright>=1.1.383,<2",
    "pre-commit==4.5.0",
]
test = [
    "pytest>=7.4.2,<8",
    "pytest-asyncio>=0.21.1,<0.22",
    "requests>=2.31.0,<3",
    "flask>=3.0.3,<4",
]

[tool.uv]
default-groups = ["dev", "test"]

[tool.uv.workspace]
members = [
    "examples/transcription",
    ".",
    "examples/poet_chat",
    "examples/selective_subscription",
]

[tool.hatch.build.targets.sdist]
include = ["fishjam"]

[tool.hatch.build.targets.wheel]
include = ["fishjam"]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.ruff]
preview = true

[tool.ruff.lint]
select = ["W", "I", "F", "E", "D", "DOC"]
ignore = ["D100", "D101", "D102", "D103", "D104", "D105", "D107", "DOC502"]

[tool.ruff.lint.pydocstyle]
convention = "google"

[tool.ruff.lint.extend-per-file-ignores]
"fishjam/_openapi_client/**" = ["E501", "D", "DOC"]
"fishjam/events/_protos/**" = ["D", "DOC"]
"fishjam/errors.py" = ["D415", "D419", "DOC501", "DOC201"]
"**/__init__.py" = ["D415", "DOC"]
"tests/**" = ["D"]
"scripts.py" = ["D"]


[tool.pytest.ini_options]
markers = [
    "file_component_sources: Tests requiring files uploaded for File Component",
]

[tool.pyright]
exclude = [
    "**/.venv",
    "**/__pycache__",
    ".pytest_cache",
    ".ruff_cache",
    "lib",
    "fishjam/_openapi_client",
    "tests",
]
typeCheckingMode = "basic"
venv = ".venv"
venvPath = "."
