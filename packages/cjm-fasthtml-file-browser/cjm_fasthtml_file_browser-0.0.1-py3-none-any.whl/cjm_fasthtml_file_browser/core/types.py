"""File type definitions, icon registry, and extension mapping for the file browser"""

# AUTOGENERATED! DO NOT EDIT! File to edit: ../../nbs/core/types.ipynb.

# %% auto 0
__all__ = ['DEFAULT_TYPE_CONFIGS', 'DEFAULT_EXTENSION_MAP', 'ICON_REGISTRY', 'FILE_TYPE_BADGE_COLORS', 'FileType',
           'FileTypeConfig', 'build_extension_map', 'get_file_type', 'video_icon', 'audio_icon', 'image_icon',
           'document_icon', 'other_icon', 'get_file_icon', 'get_badge_color']

# %% ../../nbs/core/types.ipynb 3
from enum import Enum
from dataclasses import dataclass, field
from typing import Dict, List, Set, Optional, Callable
from fasthtml.common import FT
from fasthtml.svg import Svg, Path as SvgPath, Circle, Rect, Polyline, Line

# %% ../../nbs/core/types.ipynb 5
class FileType(str, Enum):
    """Supported file type categories."""
    AUDIO = "audio"
    VIDEO = "video"
    IMAGE = "image"
    DOCUMENT = "document"
    OTHER = "other"

# %% ../../nbs/core/types.ipynb 7
@dataclass
class FileTypeConfig:
    """Configuration for a file type category."""
    file_type: FileType  # The file type this config is for
    extensions: List[str]  # File extensions (without dot)
    label: str  # Display label (e.g., "Audio", "Video")
    preview_supported: bool = True  # Whether preview is supported
    enabled: bool = True  # Whether this type is enabled for scanning

# %% ../../nbs/core/types.ipynb 9
DEFAULT_TYPE_CONFIGS: Dict[FileType, FileTypeConfig] = {
    FileType.AUDIO: FileTypeConfig(
        file_type=FileType.AUDIO,
        extensions=["mp3", "wav", "flac", "m4a", "ogg", "wma", "aac", "opus"],
        label="Audio",
        preview_supported=True
    ),
    FileType.VIDEO: FileTypeConfig(
        file_type=FileType.VIDEO,
        extensions=["mp4", "mkv", "avi", "mov", "webm", "wmv", "flv", "m4v"],
        label="Video",
        preview_supported=True
    ),
    FileType.IMAGE: FileTypeConfig(
        file_type=FileType.IMAGE,
        extensions=["jpg", "jpeg", "png", "gif", "webp", "svg", "bmp", "ico"],
        label="Image",
        preview_supported=True
    ),
    FileType.DOCUMENT: FileTypeConfig(
        file_type=FileType.DOCUMENT,
        extensions=["pdf", "doc", "docx", "txt", "md", "rtf", "odt"],
        label="Document",
        preview_supported=False
    ),
    FileType.OTHER: FileTypeConfig(
        file_type=FileType.OTHER,
        extensions=[],
        label="Other",
        preview_supported=False
    )
}

# %% ../../nbs/core/types.ipynb 11
def build_extension_map(
    type_configs: Dict[FileType, FileTypeConfig]  # Type configurations to build map from
) -> Dict[str, FileType]:  # Mapping of extension to FileType
    """Build a mapping from file extensions to file types."""
    ext_map = {}
    for file_type, config in type_configs.items():
        for ext in config.extensions:
            ext_map[ext.lower()] = file_type
    return ext_map

# %% ../../nbs/core/types.ipynb 12
DEFAULT_EXTENSION_MAP: Dict[str, FileType] = build_extension_map(DEFAULT_TYPE_CONFIGS)

# %% ../../nbs/core/types.ipynb 13
def get_file_type(
    extension: str,  # File extension (with or without dot)
    extension_map: Optional[Dict[str, FileType]] = None  # Custom extension map
) -> FileType:  # The corresponding FileType
    """Get the FileType for a given extension."""
    if extension_map is None:
        extension_map = DEFAULT_EXTENSION_MAP
    ext = extension.lstrip(".").lower()
    return extension_map.get(ext, FileType.OTHER)

# %% ../../nbs/core/types.ipynb 15
def _create_icon_svg(
    *children,  # SVG child elements
    cls: str = ""  # Additional CSS classes
) -> FT:  # SVG element
    """Create a base SVG icon with consistent styling."""
    return Svg(
        *children,
        xmlns="http://www.w3.org/2000/svg",
        width="24",
        height="24",
        viewBox="0 0 24 24",
        fill="none",
        stroke="currentColor",
        stroke_width="2",
        stroke_linecap="round",
        stroke_linejoin="round",
        cls=cls
    )

# %% ../../nbs/core/types.ipynb 16
def video_icon(cls: str = "") -> FT:  # SVG icon element
    """Video file icon."""
    return _create_icon_svg(
        SvgPath(d="M4 12V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.706.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2"),
        SvgPath(d="M14 2v5a1 1 0 0 0 1 1h5"),
        SvgPath(d="m10 17.843 3.033-1.755a.64.64 0 0 1 .967.56v4.704a.65.65 0 0 1-.967.56L10 20.157"),
        Rect(width="7", height="6", x="3", y="16", rx="1"),
        cls=cls
    )

# %% ../../nbs/core/types.ipynb 17
def audio_icon(cls: str = "") -> FT:  # SVG icon element
    """Audio file icon."""
    return _create_icon_svg(
        SvgPath(d="M11.65 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v10.35"),
        SvgPath(d="M14 2v5a1 1 0 0 0 1 1h5"),
        SvgPath(d="M8 20v-7l3 1.474"),
        Circle(cx="6", cy="20", r="2"),
        cls=cls
    )

# %% ../../nbs/core/types.ipynb 18
def image_icon(cls: str = "") -> FT:  # SVG icon element
    """Image file icon."""
    return _create_icon_svg(
        Rect(width="18", height="18", x="3", y="3", rx="2", ry="2"),
        Circle(cx="9", cy="9", r="2"),
        SvgPath(d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"),
        cls=cls
    )

# %% ../../nbs/core/types.ipynb 19
def document_icon(cls: str = "") -> FT:  # SVG icon element
    """Document file icon."""
    return _create_icon_svg(
        SvgPath(d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"),
        Polyline(points="14 2 14 8 20 8"),
        Line(x1="16", y1="13", x2="8", y2="13"),
        Line(x1="16", y1="17", x2="8", y2="17"),
        Line(x1="10", y1="9", x2="8", y2="9"),
        cls=cls
    )

# %% ../../nbs/core/types.ipynb 20
def other_icon(cls: str = "") -> FT:  # SVG icon element
    """Generic file icon for unknown types."""
    return _create_icon_svg(
        SvgPath(d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"),
        Polyline(points="14 2 14 8 20 8"),
        cls=cls
    )

# %% ../../nbs/core/types.ipynb 21
ICON_REGISTRY: Dict[FileType, Callable[[str], FT]] = {
    FileType.AUDIO: audio_icon,
    FileType.VIDEO: video_icon,
    FileType.IMAGE: image_icon,
    FileType.DOCUMENT: document_icon,
    FileType.OTHER: other_icon
}

# %% ../../nbs/core/types.ipynb 22
def get_file_icon(
    file_type: FileType,  # The file type to get icon for
    cls: str = ""  # CSS classes to apply
) -> FT:  # SVG icon element
    """Get the icon for a file type."""
    icon_func = ICON_REGISTRY.get(file_type, other_icon)
    return icon_func(cls)

# %% ../../nbs/core/types.ipynb 24
from cjm_fasthtml_daisyui.components.data_display.badge import badge_colors, badge_styles

FILE_TYPE_BADGE_COLORS: Dict[FileType, str] = {
    FileType.AUDIO: str(badge_colors.secondary),
    FileType.VIDEO: str(badge_colors.primary),
    FileType.IMAGE: str(badge_colors.accent),
    FileType.DOCUMENT: str(badge_colors.info),
    FileType.OTHER: str(badge_styles.ghost)
}

# %% ../../nbs/core/types.ipynb 25
def get_badge_color(
    file_type: FileType  # The file type
) -> str:  # Badge color class string
    """Get the badge color class for a file type."""
    return FILE_TYPE_BADGE_COLORS.get(file_type, str(badge_styles.ghost))
