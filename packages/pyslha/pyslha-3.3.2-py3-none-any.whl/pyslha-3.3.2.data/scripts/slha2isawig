#!python

"""\
Usage: %(prog)s IN.slha [OUT.isa]

Convert an SLHA model/decay spectrum file to a HERWIG/ISAWIG SUSY spectrum input
file, in the format written by ISAWIG. The intention of this script is to allow
HERWIG to be used with spectra generated by codes other than ISAWIG,
e.g. SoftSUSY, SPheno, etc. And fundamentally because the author was fed up with
having to make ISASUSY compile with gfortran on platforms where CERNLIB wasn't
available!

Conversion based on the HERWIG SUSY specification format, from
http://www.hep.phy.cam.ac.uk/~richardn/HERWIG/ISAWIG/file.html
"""

import pyslha
import sys, argparse
parser = argparse.ArgumentParser(usage=__doc__)
parser.add_argument("INFILE")
parser.add_argument("OUTFILE", nargs="?", default=None)
parser.add_argument("--version", action="version", version="%(prog)s " + pyslha.__version__)
args = parser.parse_args()

## Choose output file
import os
if not args.OUTFILE:
    o = os.path.basename(args.INFILE)
    if "." in o:
        o = o[:o.rindex(".")]
    args.OUTFILE = o + ".isa"

## Read spectrum file
doc = pyslha.readSLHAFile(args.INFILE)

## And write it out again!
if args.OUTFILE == "-":
    sys.stdout.write(pyslha.writeISAWIG(doc))
else:
    pyslha.writeISAWIGFile(args.OUTFILE, doc)
