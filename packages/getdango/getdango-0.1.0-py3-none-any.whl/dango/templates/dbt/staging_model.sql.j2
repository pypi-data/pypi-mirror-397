{{- "-- Auto-generated by Dango on " ~ generated_at -}}
{{- "\n-- Source: " ~ source_type ~ " - " ~ source_name -}}
{{- "\n-- Raw table: " ~ schema_name ~ "." ~ table_name -}}
{{- "\n--" -}}
{{- "\n-- This file is auto-generated and will be regenerated when:" -}}
{{- "\n--   - Schema changes are detected during sync" -}}
{{- "\n--   - You run: dango generate" -}}
{{- "\n--" -}}
{{- "\n-- To customize this model:" -}}
{{- "\n--   - Remove this comment block to prevent regeneration, OR" -}}
{{- "\n--   - Create a new model in marts/ or intermediate/ with your custom logic" -}}
{{- "\n--" -}}
{% if source_type == 'csv' -%}
{{- "\n-- Available metadata columns:" -}}
{{- "\n--   _dango_filename      - Which CSV file this row came from" -}}
{{- "\n--   _dango_file_mtime    - File modification time" -}}
{{- "\n--   _dango_loaded_at     - When loaded to DuckDB" -}}
{% elif source_type in ['stripe', 'shopify', 'facebook_ads', 'google_sheets'] or dlt_source -%}
{{- "\n-- Available metadata columns:" -}}
{{- "\n--   _dlt_load_id         - dlt load identifier" -}}
{{- "\n--   _dlt_id              - dlt row identifier" -}}
{% endif -%}

{{- "\n\n" -}}

{{ "{{ config(" }}
    materialized='table',
    schema='staging'
{{ ") }}" }}

SELECT * FROM {{ "{{ source('" ~ source_name ~ "', '" ~ table_name ~ "') }}" }}
