# Room Schema Documentation
# Reference for content creators defining new rooms
# Database Model: Room (backend/app/models.py)

# Required Fields
# ===============
id: string
  # Unique identifier for the room
  # Example: "room_0_0_0", "room_entrance_hall"

name: string
  # Display name of the room
  # Example: "An Ethereal Cloud Chamber", "Entrance Hall"

description: string
  # Detailed flavor text describing what the player sees
  # Supports multi-line text with proper YAML formatting (use | or >)
  # Example: "A lower pocket in the southern western region of the clouds."

room_type: string (default: "ethereal")
  # Type of room (affects default emoji/icon in UI)
  # Options: "ethereal", "forest", "cave", "urban", "chamber", "corridor", "outdoor"
  # Example: "ethereal"

# Area Association (Optional but Recommended)
# ==========================================
area_id: string | null (optional)
  # ID of the area this room belongs to
  # If null, room exists independently (not recommended for new rooms)
  # Example: "area_ethereal_nexus"

# Vertical Layer (Optional)
# =========================
z_level: integer (default: 0)
  # Vertical layer for multi-level dungeons/buildings
  # Used by Room Builder for layer visualization
  # 0 = ground floor, positive = upper floors, negative = basement/underground
  # For rooms with coordinate IDs (room_X_Y_Z), this is auto-extracted from Z
  # Example: -1 (basement), 0 (ground), 1 (first floor), 2 (second floor)

# Exit Connections (All Optional)
# ===============================
exits: dictionary (optional)
  # Dictionary of exits to other rooms
  # Keys: direction names (north, south, east, west, up, down, or custom)
  # Values: room IDs
  # Example:
  #   north: room_0_1_0
  #   east: room_1_0_0
  #   up: room_0_0_1
  #   secret: room_hidden_chamber

# Hidden Exits (Optional)
# =======================
hidden_exits: dictionary (optional)
  # Dictionary of secret/hidden exits that are not shown to players
  # until revealed via trigger actions (reveal_exit).
  # Keys: direction names (typically "secret", "hidden", or custom names)
  # Values: room IDs
  # Hidden exits:
  #   - Are NOT shown in the "Exits:" list
  #   - Cannot be traversed until revealed
  #   - Use reveal_exit trigger action to make visible
  #   - Use hide_exit trigger action to hide again
  # Example:
  #   secret: room_hidden_vault
  #   hidden: room_treasure_room

# Door States (Optional)
# ======================
doors: dictionary (optional)
  # Dictionary of door states for exits (visible doors that can be opened/closed/locked)
  # Keys: direction names matching exits
  # Values: door state object with the following properties:
  #   is_open: bool (default: true) - Whether the door is open (passable)
  #   is_locked: bool (default: false) - Whether the door requires unlocking
  #   key_item_id: string (optional) - Item template ID that can unlock this door
  #   door_name: string (optional) - Custom display name (e.g., "iron gate", "wooden door")
  #
  # Doors vs Hidden Exits:
  #   - Doors are VISIBLE but may block passage (shown as "north [closed]" or "north [locked]")
  #   - Hidden exits are INVISIBLE until revealed
  #   - A hidden exit can also have a door (revealed but locked/closed)
  #
  # Example:
  #   north:
  #     is_open: false
  #     is_locked: true
  #     key_item_id: item_rusty_key
  #     door_name: "iron gate"
  #   east:
  #     is_open: false
  #     is_locked: false
  #     door_name: "wooden door"

# Movement Effects (Optional)
# ===========================
on_enter_effect: string | null (optional)
  # Message shown when player enters this room
  # Example: "You feel a chill as you enter."

on_exit_effect: string | null (optional)
  # Message shown when player exits this room
  # Example: "The ethereal clouds part and swirl around you as you pass."

# Phase 11: Lighting Override (Optional)
# ======================================
lighting_override: string | null (optional)
  # Override area's ambient lighting for this specific room
  # Useful for dark caves in bright areas, or bright chambers in dark areas
  # Options: "pitch_black", "dim", "normal", "bright", "prismatic"
  # If null, uses area's ambient_lighting
  # Example: "pitch_black" (for a deep cave in a normally bright area)

# Phase 17.1: Temperature Override (Optional)
# ==========================================
temperature_override: int | null (optional)
  # Override area's calculated temperature for this specific room
  # Useful for forges (hot), ice caves (cold), magic-heated rooms, etc.
  # Temperature is in Fahrenheit
  # If null, uses area's base_temperature with biome/time modifiers
  # Range: -100 to 200 (realistic range: 0-120)
  # Example: 120 (blacksmith's forge), 20 (ice cave), 70 (magically climate-controlled)

# Room Type Customization (Optional)
# ==================================
room_type_emoji: string | null (optional)
  # Custom emoji/icon for this specific room (overrides room_type default)
  # Example: "ðŸ°" (castle), "ðŸŒ²" (forest), "â›°ï¸" (mountain)

# Content Management (Optional)
# =============================
yaml_managed: bool (default: true)
  # Whether this room is managed by YAML files or created via API
  # true = YAML managed (most common)
  # false = API created (dynamic rooms)
  # Example: true

# Triggers (Optional)
# ==================
triggers: array (optional, default: [])
  # Room-specific triggers that fire based on events
  # Each trigger is a dictionary with structure defined in triggers/_schema.yaml
  # Example:
  #   - id: newcomer_welcome
  #     event: on_enter
  #     conditions:
  #       - type: flag_set
  #         flag: visited_origin
  #         expected: false
  #     actions:
  #       - type: message_player
  #         message: "Welcome message here"
  #       - type: set_flag
  #         flag: visited_origin
  #         value: true
  #     max_fires: 1

# Database Mapping Notes
# ======================
# This YAML schema maps to the Room SQLAlchemy model in backend/app/models.py
# All fields are stored in the 'rooms' database table
# Exits are stored as separate foreign key fields (north_id, south_id, etc.)
# Custom/secret exits may require special handling
#
# Direction mapping:
#   north -> north_id (foreign key to rooms.id)
#   south -> south_id
#   east -> east_id
#   west -> west_id
#   up -> up_id
#   down -> down_id
#
# Runtime-only fields (not stored in database, set via triggers):
#   dynamic_exits - Exits added/removed at runtime
#   hidden_exits - Secret exits not shown until revealed
#   door_states - Door open/closed/locked states

# Complete Example
# ===============
# id: room_forest_clearing
# area_id: area_sunlit_forest
# name: A Peaceful Forest Clearing
# description: |
#   Sunlight filters through the canopy above, illuminating a small clearing
#   carpeted with soft moss. Butterflies dance between wildflowers.
# room_type: forest
# exits:
#   north: room_forest_path_1
#   south: room_forest_path_2
#   east: room_deep_woods
# on_enter_effect: "The peaceful atmosphere calms your spirit."
# on_exit_effect: null
# lighting_override: "bright"
# triggers:
#   - id: forest_rest_spot
#     event: on_command
#     command_pattern: "rest*"
#     actions:
#       - type: heal_player
#         amount: 20
#       - type: message_player
#         message: "You rest in the clearing and feel refreshed."

# Example with Doors and Hidden Exits
# ===================================
# id: room_dungeon_entrance
# area_id: area_ancient_dungeon
# name: Dungeon Entrance
# description: |
#   A heavy iron gate blocks the passage north. Ancient runes
#   are carved into the stone walls around you.
# room_type: underground
# exits:
#   north: room_dungeon_hall
#   south: room_forest_path
# hidden_exits:
#   secret: room_hidden_treasury
# doors:
#   north:
#     is_open: false
#     is_locked: true
#     key_item_id: item_dungeon_key
#     door_name: "iron gate"
# triggers:
#   - id: examine_runes
#     event: on_command
#     command_pattern: "examine runes*"
#     conditions:
#       - type: has_item
#         item_id: item_ancient_tome
#     actions:
#       - type: message_player
#         params:
#           text: "The runes reveal a hidden passage!"
#       - type: reveal_exit
#         params:
#           direction: secret
