{
  "schema_version": "1.1.0",
  "server": {
    "name": "foundry-mcp",
    "version": "0.2.0",
    "description": "MCP server for SDD spec management with tools, resources, and prompts"
  },
  "tools": {
    "unified": [
      {
        "name": "health",
        "description": "Health checks and diagnostics.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "liveness",
              "readiness",
              "check"
            ],
            "description": "Health action to run"
          },
          {
            "name": "include_details",
            "type": "boolean",
            "required": false,
            "default": true,
            "description": "When action=check, include dependency details"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: health action=liveness",
            "input": {
              "action": "liveness"
            }
          }
        ]
      },
      {
        "name": "plan",
        "description": "Planning helpers (create/list/review plans).",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "create",
              "list",
              "review"
            ],
            "description": "Planning action"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: plan action=create",
            "input": {
              "action": "create"
            }
          }
        ]
      },
      {
        "name": "pr",
        "description": "PR workflows with spec context.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "create",
              "get-context"
            ],
            "description": "PR workflow action"
          },
          {
            "name": "spec_id",
            "type": "string",
            "required": false,
            "description": "Spec ID for context/PR creation"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: pr action=create",
            "input": {
              "action": "create"
            }
          }
        ]
      },
      {
        "name": "error",
        "description": "Error collection query and cleanup.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "list",
              "get",
              "stats",
              "patterns",
              "cleanup"
            ],
            "description": "Error action"
          },
          {
            "name": "error_id",
            "type": "string",
            "required": false,
            "description": "Error ID (required for action=get)"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: error action=list",
            "input": {
              "action": "list"
            }
          }
        ]
      },
      {
        "name": "metrics",
        "description": "Metrics query, stats, and cleanup.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "query",
              "list",
              "summary",
              "stats",
              "cleanup"
            ],
            "description": "Metrics action"
          },
          {
            "name": "metric_name",
            "type": "string",
            "required": false,
            "description": "Metric name (required for some actions)"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: metrics action=query",
            "input": {
              "action": "query"
            }
          }
        ]
      },
      {
        "name": "journal",
        "description": "Journaling add/list helpers.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "add",
              "list",
              "list-unjournaled"
            ],
            "description": "Journal action"
          },
          {
            "name": "spec_id",
            "type": "string",
            "required": false,
            "description": "Spec ID filter"
          },
          {
            "name": "task_id",
            "type": "string",
            "required": false,
            "description": "Task ID filter"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: journal action=add",
            "input": {
              "action": "add"
            }
          }
        ]
      },
      {
        "name": "authoring",
        "description": "Spec authoring mutations (create/templates/frontmatter, phases, assumptions, revisions).",
        "auth_required": false,
        "rate_limit": null,
        "feature_flag": "authoring_tools",
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "spec-create",
              "spec-template",
              "spec-update-frontmatter",
              "phase-add",
              "phase-remove",
              "assumption-add",
              "assumption-list",
              "revision-add"
            ],
            "description": "Authoring action"
          },
          {
            "name": "spec_id",
            "type": "string",
            "required": false,
            "description": "Target spec ID (required for most actions)"
          },
          {
            "name": "name",
            "type": "string",
            "required": false,
            "description": "Spec name (required for action=spec-create)"
          },
          {
            "name": "template",
            "type": "string",
            "required": false,
            "description": "Template name (used by spec-create/spec-template)"
          },
          {
            "name": "category",
            "type": "string",
            "required": false,
            "description": "Default task category for spec-create"
          },
          {
            "name": "template_action",
            "type": "string",
            "required": false,
            "description": "Template operation (list|show|apply) for action=spec-template"
          },
          {
            "name": "template_name",
            "type": "string",
            "required": false,
            "description": "Template name for template_action=show|apply"
          },
          {
            "name": "key",
            "type": "string",
            "required": false,
            "description": "Frontmatter key (required for action=spec-update-frontmatter)"
          },
          {
            "name": "value",
            "type": "string",
            "required": false,
            "description": "Frontmatter value (required for action=spec-update-frontmatter)"
          },
          {
            "name": "dry_run",
            "type": "boolean",
            "required": false,
            "default": false,
            "description": "Preview changes without saving"
          },
          {
            "name": "path",
            "type": "string",
            "required": false,
            "description": "Workspace path override"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: authoring action=spec-create",
            "input": {
              "action": "spec-create"
            }
          }
        ]
      },
      {
        "name": "provider",
        "description": "LLM provider discovery and execution.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "list",
              "status",
              "execute"
            ],
            "description": "Provider action"
          },
          {
            "name": "provider_id",
            "type": "string",
            "required": false,
            "description": "Provider identifier (required for some actions)"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: provider action=list",
            "input": {
              "action": "list"
            }
          }
        ]
      },
      {
        "name": "environment",
        "description": "Workspace init + environment verification.",
        "auth_required": false,
        "rate_limit": null,
        "feature_flag": "environment_tools",
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "init",
              "verify-env",
              "verify-toolchain",
              "setup",
              "detect"
            ],
            "description": "Environment action"
          },
          {
            "name": "path",
            "type": "string",
            "required": false,
            "description": "Workspace path (default: current)"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: environment action=init",
            "input": {
              "action": "init"
            }
          }
        ]
      },
      {
        "name": "lifecycle",
        "description": "Spec lifecycle transitions.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "move",
              "activate",
              "complete",
              "archive",
              "state"
            ],
            "description": "Lifecycle action"
          },
          {
            "name": "spec_id",
            "type": "string",
            "required": false,
            "description": "Target spec ID"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: lifecycle action=move",
            "input": {
              "action": "move"
            }
          }
        ]
      },
      {
        "name": "verification",
        "description": "Verification definition + execution.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "add",
              "execute"
            ],
            "description": "Verification action"
          },
          {
            "name": "spec_id",
            "type": "string",
            "required": false,
            "description": "Target spec ID"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: verification action=add",
            "input": {
              "action": "add"
            }
          }
        ]
      },
      {
        "name": "task",
        "description": "Task preparation, mutation, and listing.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "prepare",
              "next",
              "info",
              "check-deps",
              "start",
              "complete",
              "update-status",
              "block",
              "unblock",
              "list-blocked",
              "add",
              "remove",
              "update-estimate",
              "update-metadata",
              "progress",
              "list",
              "query",
              "hierarchy"
            ],
            "description": "Task action"
          },
          {
            "name": "spec_id",
            "type": "string",
            "required": false,
            "description": "Target spec ID (required for most actions)"
          },
          {
            "name": "task_id",
            "type": "string",
            "required": false,
            "description": "Target task ID (required for some actions)"
          },
          {
            "name": "dry_run",
            "type": "boolean",
            "required": false,
            "default": false,
            "description": "Preview changes without saving (supported for update-estimate/update-metadata/add/remove)"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: task action=prepare",
            "input": {
              "action": "prepare"
            }
          }
        ]
      },
      {
        "name": "spec",
        "description": "Spec discovery, validation, and analysis.",
        "auth_required": false,
        "rate_limit": null,
        "feature_flag": "spec_helpers",
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "find",
              "list",
              "validate",
              "fix",
              "stats",
              "validate-fix",
              "analyze",
              "analyze-deps"
            ],
            "description": "Spec action"
          },
          {
            "name": "spec_id",
            "type": "string",
            "required": false,
            "description": "Target spec ID (required for most actions)"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: spec action=find",
            "input": {
              "action": "find"
            }
          }
        ]
      },
      {
        "name": "review",
        "description": "LLM-assisted review workflows.",
        "auth_required": false,
        "rate_limit": null,
        "feature_flag": "llm_tools",
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "spec",
              "fidelity",
              "parse-feedback",
              "list-tools",
              "list-plan-tools"
            ],
            "description": "Review action"
          },
          {
            "name": "spec_id",
            "type": "string",
            "required": false,
            "description": "Target spec ID (required for spec/fidelity actions)"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: review action=spec",
            "input": {
              "action": "spec"
            }
          }
        ]
      },
      {
        "name": "code",
        "description": "Repo-local code navigation helpers.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "find-class",
              "find-function",
              "callers",
              "callees",
              "trace",
              "impact"
            ],
            "description": "Code navigation action"
          },
          {
            "name": "symbol",
            "type": "string",
            "required": false,
            "description": "Symbol name (required for most actions)"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: code action=find-class",
            "input": {
              "action": "find-class"
            }
          }
        ]
      },
      {
        "name": "server",
        "description": "Tool discovery, schemas, context, and capabilities.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "tools",
              "schema",
              "capabilities",
              "context",
              "llm-status"
            ],
            "description": "Server action"
          },
          {
            "name": "tool_name",
            "type": "string",
            "required": false,
            "description": "Tool name (required for action=schema)"
          },
          {
            "name": "category",
            "type": "string",
            "required": false,
            "description": "Filter tools by category (action=tools)"
          },
          {
            "name": "tag",
            "type": "string",
            "required": false,
            "description": "Filter tools by tag (action=tools)"
          },
          {
            "name": "include_deprecated",
            "type": "boolean",
            "required": false,
            "default": false
          },
          {
            "name": "cursor",
            "type": "string",
            "required": false
          },
          {
            "name": "limit",
            "type": "integer",
            "required": false,
            "default": 100
          },
          {
            "name": "include_llm",
            "type": "boolean",
            "required": false,
            "default": true
          },
          {
            "name": "include_workflow",
            "type": "boolean",
            "required": false,
            "default": true
          },
          {
            "name": "include_workspace",
            "type": "boolean",
            "required": false,
            "default": true
          },
          {
            "name": "include_capabilities",
            "type": "boolean",
            "required": false,
            "default": true
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: server action=tools",
            "input": {
              "action": "tools"
            }
          }
        ]
      },
      {
        "name": "test",
        "description": "Pytest discovery and execution.",
        "auth_required": false,
        "rate_limit": null,
        "parameters": [
          {
            "name": "action",
            "type": "string",
            "required": true,
            "enum": [
              "run",
              "discover"
            ],
            "description": "Test action"
          },
          {
            "name": "preset",
            "type": "string",
            "required": false,
            "enum": [
              "quick",
              "unit",
              "full"
            ],
            "description": "Preset for action=run"
          }
        ],
        "version": "1.0.0",
        "deprecated": false,
        "tags": [
          "unified"
        ],
        "examples": [
          {
            "description": "Example: test action=run",
            "input": {
              "action": "run"
            }
          }
        ]
      }
    ]
  },
  "resources": [
    {
      "uri_template": "foundry://specs/",
      "description": "List all specifications",
      "auth_required": false,
      "rate_limit": null
    },
    {
      "uri_template": "foundry://specs/{status}/",
      "description": "List specs by status (active, pending, completed, archived)",
      "auth_required": false,
      "rate_limit": null
    },
    {
      "uri_template": "foundry://specs/{status}/{spec_id}",
      "description": "Get specific spec with full hierarchy",
      "auth_required": false,
      "rate_limit": null
    },
    {
      "uri_template": "foundry://specs/{spec_id}/journal",
      "description": "Get journal entries for a spec",
      "auth_required": false,
      "rate_limit": null
    },
    {
      "uri_template": "foundry://templates/",
      "description": "List available spec templates",
      "auth_required": false,
      "rate_limit": null
    },
    {
      "uri_template": "foundry://templates/{template_id}",
      "description": "Get specific template",
      "auth_required": false,
      "rate_limit": null
    },
    {
      "uri_template": "specs://list",
      "description": "Legacy: List all specifications",
      "auth_required": false,
      "rate_limit": null,
      "deprecated": true
    },
    {
      "uri_template": "specs://{spec_id}",
      "description": "Legacy: Get specification by ID",
      "auth_required": false,
      "rate_limit": null,
      "deprecated": true
    }
  ],
  "prompts": [
    {
      "name": "start_feature",
      "description": "Guide new feature setup with template selection",
      "parameters": [
        {
          "name": "feature_name",
          "type": "string",
          "required": true
        },
        {
          "name": "description",
          "type": "string",
          "required": false
        },
        {
          "name": "template",
          "type": "string",
          "required": false,
          "default": "feature"
        }
      ]
    },
    {
      "name": "debug_test",
      "description": "Systematic test debugging workflow",
      "parameters": [
        {
          "name": "test_name",
          "type": "string",
          "required": false
        },
        {
          "name": "error_message",
          "type": "string",
          "required": false
        },
        {
          "name": "spec_id",
          "type": "string",
          "required": false
        }
      ]
    },
    {
      "name": "complete_phase",
      "description": "Phase completion checklist and guidance",
      "parameters": [
        {
          "name": "spec_id",
          "type": "string",
          "required": true
        },
        {
          "name": "phase_id",
          "type": "string",
          "required": false
        }
      ]
    },
    {
      "name": "review_spec",
      "description": "Comprehensive spec status review",
      "parameters": [
        {
          "name": "spec_id",
          "type": "string",
          "required": true
        }
      ]
    }
  ],
  "feature_flags": {
    "_documentation": "Feature flags control gradual rollouts, A/B testing, and experimental features. See docs/mcp_best_practices/14-feature-flags.md for guidance.",
    "schema_version": "1.0.0",
    "flags": {
      "environment_tools": {
        "description": "Environment setup and verification tools for SDD workflows",
        "state": "beta",
        "default_enabled": true,
        "percentage_rollout": 100,
        "owner": "platform-team",
        "dependencies": [],
        "created_at": "2025-11-27T00:00:00Z",
        "expires_at": null
      },
      "env_auto_fix": {
        "description": "Automatic fix capability for environment verification issues",
        "state": "experimental",
        "default_enabled": false,
        "percentage_rollout": 0,
        "owner": "platform-team",
        "dependencies": [
          "environment_tools"
        ],
        "created_at": "2025-11-27T00:00:00Z",
        "expires_at": null
      },
      "spec_helpers": {
        "description": "Spec helper tools for discovery, validation, and analysis",
        "state": "beta",
        "default_enabled": true,
        "percentage_rollout": 100,
        "owner": "spec-team",
        "dependencies": [],
        "created_at": "2025-11-27T00:00:00Z",
        "expires_at": null
      },
      "authoring_tools": {
        "description": "Spec authoring tools for creating specs, managing phases and tasks, managing assumptions, and revisions",
        "state": "beta",
        "default_enabled": true,
        "percentage_rollout": 100,
        "owner": "spec-team",
        "dependencies": [],
        "created_at": "2025-11-27T00:00:00Z",
        "expires_at": null
      },
      "llm_tools": {
        "description": "LLM-powered review tools",
        "state": "stable",
        "default_enabled": true,
        "percentage_rollout": 100,
        "owner": "platform-team",
        "dependencies": [],
        "created_at": "2025-11-26T00:00:00Z",
        "expires_at": null
      },
      "llm_multi_provider": {
        "description": "Multi-provider AI tool support",
        "state": "stable",
        "default_enabled": true,
        "percentage_rollout": 100,
        "owner": "platform-team",
        "dependencies": [],
        "created_at": "2025-11-26T00:00:00Z",
        "expires_at": null
      },
      "llm_fidelity_review": {
        "description": "AI-powered fidelity review",
        "state": "stable",
        "default_enabled": true,
        "percentage_rollout": 100,
        "owner": "platform-team",
        "dependencies": [],
        "created_at": "2025-11-26T00:00:00Z",
        "expires_at": null
      },
      "llm_data_only_fallback": {
        "description": "Graceful degradation when LLM unavailable",
        "state": "stable",
        "default_enabled": true,
        "percentage_rollout": 100,
        "owner": "platform-team",
        "dependencies": [],
        "created_at": "2025-11-26T00:00:00Z",
        "expires_at": null
      },
      "unified_tools_phase2": {
        "description": "Enable unified routers for medium tool families",
        "state": "beta",
        "default_enabled": false,
        "percentage_rollout": 0,
        "owner": "foundry-mcp core",
        "dependencies": [],
        "created_at": "2025-12-10T00:00:00Z",
        "expires_at": null
      },
      "unified_tools_phase3": {
        "description": "Enable unified routers for large tool families",
        "state": "beta",
        "default_enabled": false,
        "percentage_rollout": 0,
        "owner": "foundry-mcp core",
        "dependencies": [],
        "created_at": "2025-12-10T00:00:00Z",
        "expires_at": null
      },
      "unified_manifest": {
        "description": "Expose only the 17 unified tools for discovery/token reduction",
        "state": "beta",
        "default_enabled": false,
        "percentage_rollout": 0,
        "owner": "foundry-mcp core",
        "dependencies": [],
        "created_at": "2025-12-10T00:00:00Z",
        "expires_at": null
      }
    }
  },
  "server_capabilities": {
    "_documentation": "Server capabilities returned by capability_get for client negotiation",
    "response_version": {
      "current": "response-v2",
      "supported": [
        "response-v2"
      ],
      "description": "Response envelope contract version"
    },
    "features": {
      "pagination": {
        "supported": true,
        "default_page_size": 100,
        "max_page_size": 1000,
        "cursor_format": "opaque_base64",
        "description": "Cursor-based pagination for list operations"
      },
      "feature_flags": {
        "supported": true,
        "description": "Feature flag system for gradual rollouts"
      },
      "unified_tools": {
        "supported": true,
        "description": "Action-based unified tool surface (17 tools)",
        "tools": [
          "health",
          "plan",
          "pr",
          "error",
          "metrics",
          "journal",
          "authoring",
          "provider",
          "environment",
          "lifecycle",
          "verification",
          "task",
          "spec",
          "review",
          "code",
          "server",
          "test"
        ],
        "feature_flags": [
          "unified_manifest",
          "unified_tools_phase2",
          "unified_tools_phase3"
        ]
      },
      "environment_readiness": {
        "supported": true,
        "description": "Environment verification and workspace initialization",
        "tools": [
          "environment"
        ]
      },
      "spec_helpers": {
        "supported": true,
        "description": "Spec discovery and analysis",
        "tools": [
          "spec"
        ]
      }
    }
  }
}
