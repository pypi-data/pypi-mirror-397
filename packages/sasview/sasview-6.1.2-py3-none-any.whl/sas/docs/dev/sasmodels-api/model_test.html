<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>24. Unit test support &#8212; SasView 6.1.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css?v=2bf1fcf8" />
    
    <script src="../../_static/documentation_options.js?v=f0c0c503"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="25. Parameter and model definitions" href="modelinfo.html" />
    <link rel="prev" title="23. Mixture model evaluator" href="mixture.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modelinfo.html" title="25. Parameter and model definitions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mixture.html" title="23. Mixture model evaluator"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 6.1.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../dev.html" >Developer Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">24. </span>Unit test support</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="unit-test-support">
<h1><span class="section-number">24. </span>Unit test support<a class="headerlink" href="#unit-test-support" title="Link to this heading">¶</a></h1>
<section id="module-sasmodels.model_test">
<span id="sasmodels-model-test"></span><h2><a class="reference internal" href="#module-sasmodels.model_test" title="sasmodels.model_test"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sasmodels.model_test</span></code></a><a class="headerlink" href="#module-sasmodels.model_test" title="Link to this heading">¶</a></h2>
<p>Run model unit tests.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">sasmodels</span><span class="o">.</span><span class="n">model_test</span> <span class="p">[</span><span class="n">opencl</span><span class="o">|</span><span class="n">cuda</span><span class="o">|</span><span class="n">dll</span><span class="o">|</span><span class="nb">all</span><span class="p">]</span> <span class="n">model1</span> <span class="n">model2</span> <span class="o">...</span>
</pre></div>
</div>
<p>If model1 is ‘all’, then all except the remaining models will be tested.
Subgroups are also possible, such as ‘py’, ‘single’ or ‘1d’.  See
<a class="reference internal" href="core.html#sasmodels.core.list_models" title="sasmodels.core.list_models"><code class="xref py py-func docutils literal notranslate"><span class="pre">core.list_models()</span></code></a> for details.</p>
<p>Each model is tested using the default parameters at q=0.1, (qx, qy)=(0.1, 0.1),
and Fq is called to make sure R_eff, volume and volume ratio are computed.
The return values at these points are not considered.  The test is only to
verify that the models run to completion, and do not produce inf or NaN.</p>
<p>Tests are defined with the <em>tests</em> attribute in the model.py file.  <em>tests</em>
is a list of individual tests to run, where each test consists of the
parameter values for the test, the q-values and the expected results.  For
the effective radius test and volume ratio tests, use the extended output
form, which checks each output of kernel.Fq. For 1-D tests, either specify
the q value or a list of q-values, and the corresponding I(q) value, or
list of I(q) values.</p>
<p>That is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tests</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="n">q</span><span class="p">,</span> <span class="n">I</span><span class="p">(</span><span class="n">q</span><span class="p">)],</span>
    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="p">[</span><span class="n">q</span><span class="p">],</span> <span class="p">[</span><span class="n">I</span><span class="p">(</span><span class="n">q</span><span class="p">)]</span> <span class="p">],</span>
    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="p">[</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="p">[</span><span class="n">I</span><span class="p">(</span><span class="n">q1</span><span class="p">),</span> <span class="n">I</span><span class="p">(</span><span class="n">q2</span><span class="p">),</span> <span class="o">...</span><span class="p">]],</span>

    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="p">(</span><span class="n">qx</span><span class="p">,</span> <span class="n">qy</span><span class="p">),</span> <span class="n">I</span><span class="p">(</span><span class="n">qx</span><span class="p">,</span> <span class="n">Iqy</span><span class="p">)],</span>
    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="p">[(</span><span class="n">qx1</span><span class="p">,</span> <span class="n">qy1</span><span class="p">),</span> <span class="p">(</span><span class="n">qx2</span><span class="p">,</span> <span class="n">qy2</span><span class="p">),</span> <span class="o">...</span><span class="p">],</span>
                    <span class="p">[</span><span class="n">I</span><span class="p">(</span><span class="n">qx1</span><span class="p">,</span> <span class="n">qy1</span><span class="p">),</span> <span class="n">I</span><span class="p">(</span><span class="n">qx2</span><span class="p">,</span> <span class="n">qy2</span><span class="p">),</span> <span class="o">...</span><span class="p">]],</span>

    <span class="p">[</span> <span class="p">{</span><span class="n">parameters</span><span class="p">},</span> <span class="n">q</span><span class="p">,</span> <span class="n">F</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">F</span><span class="o">^</span><span class="mi">2</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">R_eff</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">V_r</span> <span class="p">],</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Parameters are <em>key:value</em> pairs, where key is one of the parameters of the
model and value is the value to use for the test.  Any parameters not given
in the parameter list will take on the default parameter value.</p>
<p>Precision defaults to 5 digits (relative).</p>
<dl class="py function">
<dt class="sig sig-object py" id="sasmodels.model_test._add_model_to_suite">
<span class="sig-prename descclassname"><span class="pre">sasmodels.model_test.</span></span><span class="sig-name descname"><span class="pre">_add_model_to_suite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sasmodels.model_test._add_model_to_suite" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sasmodels.model_test._hide_model_case_from_nose">
<span class="sig-prename descclassname"><span class="pre">sasmodels.model_test.</span></span><span class="sig-name descname"><span class="pre">_hide_model_case_from_nose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">type</span></span></span><a class="headerlink" href="#sasmodels.model_test._hide_model_case_from_nose" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sasmodels.model_test.check_model">
<span class="sig-prename descclassname"><span class="pre">sasmodels.model_test.</span></span><span class="sig-name descname"><span class="pre">check_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="modelinfo.html#sasmodels.modelinfo.ModelInfo" title="sasmodels.modelinfo.ModelInfo"><span class="pre">ModelInfo</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sasmodels.model_test.check_model" title="Link to this definition">¶</a></dt>
<dd><p>Run the tests for a single model, capturing the output.</p>
<p>Returns success status and the output string.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sasmodels.model_test.invalid_pars">
<span class="sig-prename descclassname"><span class="pre">sasmodels.model_test.</span></span><span class="sig-name descname"><span class="pre">invalid_pars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">partable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="modelinfo.html#sasmodels.modelinfo.ParameterTable" title="sasmodels.modelinfo.ParameterTable"><span class="pre">ParameterTable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sasmodels.model_test.invalid_pars" title="Link to this definition">¶</a></dt>
<dd><p>Return a list of parameter names that are not part of the model.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sasmodels.model_test.is_near">
<span class="sig-prename descclassname"><span class="pre">sasmodels.model_test.</span></span><span class="sig-name descname"><span class="pre">is_near</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">digits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#sasmodels.model_test.is_near" title="Link to this definition">¶</a></dt>
<dd><p>Returns true if <em>actual</em> is within <em>digits</em> significant digits of <em>target</em>.</p>
<p><em>taget</em> zero and inf should match <em>actual</em> zero and inf.  If you want to
accept eps for zero, choose a value such as 1e-10, which must match up to
+/- 1e-15 when <em>digits</em> is the default value of 5.</p>
<p>If <em>target</em> is None, then just make sure that <em>actual</em> is not NaN.</p>
<p>If <em>target</em> is NaN, make sure <em>actual</em> is NaN.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sasmodels.model_test.main">
<span class="sig-prename descclassname"><span class="pre">sasmodels.model_test.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#sasmodels.model_test.main" title="Link to this definition">¶</a></dt>
<dd><p>Run tests given is models.</p>
<p>Returns 0 if success or 1 if any tests fail.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sasmodels.model_test.make_suite">
<span class="sig-prename descclassname"><span class="pre">sasmodels.model_test.</span></span><span class="sig-name descname"><span class="pre">make_suite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loaders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">TestSuite</span></span></span><a class="headerlink" href="#sasmodels.model_test.make_suite" title="Link to this definition">¶</a></dt>
<dd><p>Construct the pyunit test suite.</p>
<p><em>loaders</em> is the list of kernel drivers to use (dll, opencl or cuda).
For python model the python driver is always used.</p>
<p><em>models</em> is the list of models to test, or <em>[“all”]</em> to test all models.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sasmodels.model_test.model_tests">
<span class="sig-prename descclassname"><span class="pre">sasmodels.model_test.</span></span><span class="sig-name descname"><span class="pre">model_tests</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sasmodels.model_test.model_tests" title="Link to this definition">¶</a></dt>
<dd><p>Test runner visible to nosetests.</p>
<p>Run “nosetests sasmodels” on the command line to invoke it.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sasmodels.model_test.run_one">
<span class="sig-prename descclassname"><span class="pre">sasmodels.model_test.</span></span><span class="sig-name descname"><span class="pre">run_one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#sasmodels.model_test.run_one" title="Link to this definition">¶</a></dt>
<dd><p>[Deprecated] Run the tests associated with <em>model_name</em>.</p>
<p>Use the following instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">succss</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">check_model</span><span class="p">(</span><span class="n">load_model_info</span><span class="p">(</span><span class="n">model_name</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">24. Unit test support</a><ul>
<li><a class="reference internal" href="#module-sasmodels.model_test"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sasmodels.model_test</span></code></a><ul>
<li><a class="reference internal" href="#sasmodels.model_test._add_model_to_suite"><code class="docutils literal notranslate"><span class="pre">_add_model_to_suite()</span></code></a></li>
<li><a class="reference internal" href="#sasmodels.model_test._hide_model_case_from_nose"><code class="docutils literal notranslate"><span class="pre">_hide_model_case_from_nose()</span></code></a></li>
<li><a class="reference internal" href="#sasmodels.model_test.check_model"><code class="docutils literal notranslate"><span class="pre">check_model()</span></code></a></li>
<li><a class="reference internal" href="#sasmodels.model_test.invalid_pars"><code class="docutils literal notranslate"><span class="pre">invalid_pars()</span></code></a></li>
<li><a class="reference internal" href="#sasmodels.model_test.is_near"><code class="docutils literal notranslate"><span class="pre">is_near()</span></code></a></li>
<li><a class="reference internal" href="#sasmodels.model_test.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li><a class="reference internal" href="#sasmodels.model_test.make_suite"><code class="docutils literal notranslate"><span class="pre">make_suite()</span></code></a></li>
<li><a class="reference internal" href="#sasmodels.model_test.model_tests"><code class="docutils literal notranslate"><span class="pre">model_tests()</span></code></a></li>
<li><a class="reference internal" href="#sasmodels.model_test.run_one"><code class="docutils literal notranslate"><span class="pre">run_one()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="mixture.html"
                          title="previous chapter"><span class="section-number">23. </span>Mixture model evaluator</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="modelinfo.html"
                          title="next chapter"><span class="section-number">25. </span>Parameter and model definitions</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/dev/sasmodels-api/model_test.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modelinfo.html" title="25. Parameter and model definitions"
             >next</a> |</li>
        <li class="right" >
          <a href="mixture.html" title="23. Mixture model evaluator"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 6.1.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../dev.html" >Developer Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">24. </span>Unit test support</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, The SasView Project.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>