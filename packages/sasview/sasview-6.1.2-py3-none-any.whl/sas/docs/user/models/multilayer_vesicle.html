<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>multilayer_vesicle &#8212; SasView 6.1.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css?v=2bf1fcf8" />
    
    <script src="../../_static/documentation_options.js?v=f0c0c503"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="onion" href="onion.html" />
    <link rel="prev" title="micromagnetic_FF_3D" href="micromagnetic_FF_3D.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="onion.html" title="onion"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="micromagnetic_FF_3D.html" title="micromagnetic_FF_3D"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 6.1.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../user.html" >SasView User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qtgui/Perspectives/Fitting/models/index.html" >Model Functions</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../qtgui/Perspectives/Fitting/models/shape-sphere.html" accesskey="U">Sphere Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">multilayer_vesicle</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="multilayer-vesicle">
<span id="id1"></span><h1>multilayer_vesicle<a class="headerlink" href="#multilayer-vesicle" title="Link to this heading">¶</a></h1>
<p>Calculate form factor for a multi-lamellar vesicle</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Default value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>scale</p></td>
<td><p>Scale factor or Volume fraction</p></td>
<td><p>None</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>background</p></td>
<td><p>Source background</p></td>
<td><p>cm<sup>-1</sup></p></td>
<td><p>0.001</p></td>
</tr>
<tr class="row-even"><td><p>volfraction</p></td>
<td><p>volume fraction of vesicles</p></td>
<td><p>None</p></td>
<td><p>0.05</p></td>
</tr>
<tr class="row-odd"><td><p>radius</p></td>
<td><p>radius of solvent filled core</p></td>
<td><p>Å</p></td>
<td><p>60</p></td>
</tr>
<tr class="row-even"><td><p>thick_shell</p></td>
<td><p>thickness of one shell</p></td>
<td><p>Å</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p>thick_solvent</p></td>
<td><p>solvent thickness between shells</p></td>
<td><p>Å</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>sld_solvent</p></td>
<td><p>solvent scattering length density</p></td>
<td><p>10<sup>-6</sup>Å<sup>-2</sup></p></td>
<td><p>6.4</p></td>
</tr>
<tr class="row-odd"><td><p>sld</p></td>
<td><p>Shell scattering length density</p></td>
<td><p>10<sup>-6</sup>Å<sup>-2</sup></p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-even"><td><p>n_shells</p></td>
<td><p>Number of shell plus solvent layer pairs (must be integer)</p></td>
<td><p>None</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<p>The returned value is scaled to units of cm<sup>-1</sup> sr<sup>-1</sup>, absolute scale.</p>
<p><strong>Definition</strong></p>
<p>This model is a trivial extension of the core_shell_sphere function where the
core is filled with solvent and is surrounded by <span class="math notranslate nohighlight">\(N\)</span> shells of material
(such as lipids) interleaved with <span class="math notranslate nohighlight">\(N - 1\)</span> layers of solvent. For <span class="math notranslate nohighlight">\(N = 1\)</span>, this
returns the same as the vesicle model, except for the normalisation, which here
is to outermost volume. The shell thicknesses and SLD are constant for all
shells as expected for a multilayer vesicle.</p>
<figure class="align-default" id="id2">
<img alt="../../_images/multi_shell_geometry.jpg" src="../../_images/multi_shell_geometry.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 85 </span><span class="caption-text">Geometry of the multilayer_vesicle model.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>See the <a class="reference internal" href="core_shell_sphere.html#core-shell-sphere"><span class="std std-ref">core_shell_sphere</span></a> model for more documentation.</p>
<p>The 1D scattering intensity is calculated in the following way (Guinier, 1955)</p>
<div class="math notranslate nohighlight">
\[P(q) = \text{scale} \cdot \frac{\phi}{V(R_N)} F^2(q) + \text{background}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[F(q) = (\rho_\text{shell}-\rho_\text{solv}) \sum_{i=1}^{N} \left[
3V(r_i)\frac{\sin(qr_i) - qr_i\cos(qr_i)}{(qr_i)^3}
- 3V(R_i)\frac{\sin(qR_i) - qR_i\cos(qR_i)}{(qR_i)^3}
\right]\]</div>
<p>for</p>
<div class="math notranslate nohighlight">
\[\begin{split}r_i &amp;= r_c + (i-1)(t_s + t_w) \text{ solvent radius before shell } i \\
R_i &amp;= r_i + t_s \text{ shell radius for shell } i\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\phi\)</span> is the volume fraction of particles, <span class="math notranslate nohighlight">\(V(r)\)</span> is the volume of a sphere
of radius <span class="math notranslate nohighlight">\(r\)</span>, <span class="math notranslate nohighlight">\(r_c\)</span> is the radius of the core, <span class="math notranslate nohighlight">\(t_s\)</span> is the thickness of
the shell, <span class="math notranslate nohighlight">\(t_w\)</span> is the thickness of the solvent layer between the shells,
<span class="math notranslate nohighlight">\(\rho_\text{shell}\)</span> is the scattering length density of a shell, and
<span class="math notranslate nohighlight">\(\rho_\text{solv}\)</span> is the scattering length density of the solvent.</p>
<p>USAGE NOTES</p>
<ul>
<li><p>The outer-most shell radius <span class="math notranslate nohighlight">\(R_N\)</span> is used as the effective radius
for <span class="math notranslate nohighlight">\(P(Q)\)</span> when <span class="math notranslate nohighlight">\(P(Q) * S(Q)\)</span> is applied.
calculations rather slow.</p></li>
<li><p>The number of shells is always rounded to an integer value as a non integer
number of layers is not physical.</p></li>
<li><p>Thus polydispersity should only be applied to number of shells <strong>VERY
CAREFULLY</strong>.  A possible legitimate use would be for mixed systems in which
some vesicles have 1 shell, some have 2, etc. A polydispersity on <span class="math notranslate nohighlight">\(N\)</span> can be
used to model the data by using the “array distribution” feature. First
create a file such as <em>shell_dist.txt</em> containing the relative portion
of each vesicle size:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="mi">20</span>
<span class="mi">2</span>  <span class="mi">4</span>
<span class="mi">3</span>  <span class="mi">1</span>
</pre></div>
</div>
<p>Turn on polydispersity and select an array distribution for the <em>n_shells</em>
parameter.  Choose the above <em>shell_dist.txt</em> file, and the model will be
computed with 80% 1-shell vesicles, 16% 2-shell vesicles and 4%
3-shell vesicles.</p>
</li>
<li><p>This is a highly non-linear, highly oscillatory (especially around the
q-values that correspond to the repeat distance of the layers), model
function complicated by the fact that the number of water/shell pairs must
physically be an integer value, although the optimization treats it as a
floating point value. Thus it may be that the resolution interpolation is not
sufficiently fine grained in certain cases. Please report any such occurrences
to the SasView team. Generally, for the best possible experience:</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>Start with the best possible guess</p></li>
<li><p>Using a priori knowledge, hold as many parameters fixed as possible</p></li>
<li><p>if N=1, tw (water thickness) must by definition be zero. Both N and tw should
be fixed during fitting.</p></li>
<li><p>If N&gt;1, use constraints to keep N &gt; 1</p></li>
<li><p>Because N only really moves in integer steps, it may get “stuck” if the
optimizer step size is too small so care should be taken
If you experience problems with this please contact the SasView team and let
them know the issue preferably with example data and model which fail to
converge.</p></li>
</ul>
</div></blockquote>
<p>The 2D scattering intensity is the same as 1D, regardless of the orientation
of the q vector which is defined as:</p>
<div class="math notranslate nohighlight">
\[q = \sqrt{q_x^2 + q_y^2}\]</div>
<p>For information about polarised and magnetic scattering, see
the <a class="reference internal" href="../qtgui/Perspectives/Fitting/magnetism/magnetism.html#magnetism"><span class="std std-ref">Polarisation/Magnetic Scattering</span></a> documentation.</p>
<figure class="align-default" id="id3">
<img alt="../../_images/multilayer_vesicle_autogenfig.png" src="../../_images/multilayer_vesicle_autogenfig.png" />
<figcaption>
<p><span class="caption-number">Fig. 86 </span><span class="caption-text">1D plot corresponding to the default parameters of the model.</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p><strong>Source</strong></p>
<p><a class="reference download internal" download="" href="../../_downloads/6805c304ef894b857d580dcbf2eac3d3/multilayer_vesicle.py"><code class="xref download docutils literal notranslate"><span class="pre">multilayer_vesicle.py</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/0e22a72eb24a3bf7537981e671155c4a/multilayer_vesicle.c"><code class="xref download docutils literal notranslate"><span class="pre">multilayer_vesicle.c</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/5224eea2106a0533fa82ac542ccf5579/sas_3j1x_x.c"><code class="xref download docutils literal notranslate"><span class="pre">sas_3j1x_x.c</span></code></a></p>
<p><strong>References</strong></p>
<ol class="arabic simple">
<li><p>B Cabane, <em>Small Angle Scattering Methods</em>, in <em>Surfactant Solutions:
New Methods of Investigation</em>, Ch.2, Surfactant Science Series Vol. 22, Ed.
R Zana and M Dekker, New York, (1987).</p></li>
</ol>
<p><strong>Authorship and Verification</strong></p>
<ul class="simple">
<li><p><strong>Author:</strong> NIST IGOR/DANSE <strong>Date:</strong> pre 2010</p></li>
<li><p><strong>Converted to sasmodels by:</strong> Piotr Rozyczko <strong>Date:</strong> Feb 24, 2016</p></li>
<li><p><strong>Last Modified by:</strong> Paul Kienzle <strong>Date:</strong> Feb 7, 2017</p></li>
<li><p><strong>Last Reviewed by:</strong> Steve King <strong>Date:</strong> March 28, 2019</p></li>
</ul>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="micromagnetic_FF_3D.html"
                          title="previous chapter">micromagnetic_FF_3D</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="onion.html"
                          title="next chapter">onion</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user/models/multilayer_vesicle.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="onion.html" title="onion"
             >next</a> |</li>
        <li class="right" >
          <a href="micromagnetic_FF_3D.html" title="micromagnetic_FF_3D"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 6.1.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../user.html" >SasView User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qtgui/Perspectives/Fitting/models/index.html" >Model Functions</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../qtgui/Perspectives/Fitting/models/shape-sphere.html" >Sphere Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">multilayer_vesicle</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, The SasView Project.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>