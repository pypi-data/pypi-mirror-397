<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>onion &#8212; SasView 6.1.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css?v=2bf1fcf8" />
    
    <script src="../../_static/documentation_options.js?v=f0c0c503"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="polymer_micelle" href="polymer_micelle.html" />
    <link rel="prev" title="multilayer_vesicle" href="multilayer_vesicle.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="polymer_micelle.html" title="polymer_micelle"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="multilayer_vesicle.html" title="multilayer_vesicle"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 6.1.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../user.html" >SasView User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qtgui/Perspectives/Fitting/models/index.html" >Model Functions</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../qtgui/Perspectives/Fitting/models/shape-sphere.html" accesskey="U">Sphere Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">onion</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="onion">
<span id="id1"></span><h1>onion<a class="headerlink" href="#onion" title="Link to this heading">¶</a></h1>
<p>Onion shell model with constant, linear or exponential density</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Default value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>scale</p></td>
<td><p>Scale factor or Volume fraction</p></td>
<td><p>None</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>background</p></td>
<td><p>Source background</p></td>
<td><p>cm<sup>-1</sup></p></td>
<td><p>0.001</p></td>
</tr>
<tr class="row-even"><td><p>sld_core</p></td>
<td><p>Core scattering length density</p></td>
<td><p>10<sup>-6</sup>Å<sup>-2</sup></p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>radius_core</p></td>
<td><p>Radius of the core</p></td>
<td><p>Å</p></td>
<td><p>200</p></td>
</tr>
<tr class="row-even"><td><p>sld_solvent</p></td>
<td><p>Solvent scattering length density</p></td>
<td><p>10<sup>-6</sup>Å<sup>-2</sup></p></td>
<td><p>6.4</p></td>
</tr>
<tr class="row-odd"><td><p>n_shells</p></td>
<td><p>number of shells (must be integer)</p></td>
<td><p>None</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>sld_in[n_shells]</p></td>
<td><p>scattering length density at the inner radius of shell k</p></td>
<td><p>10<sup>-6</sup>Å<sup>-2</sup></p></td>
<td><p>1.7</p></td>
</tr>
<tr class="row-odd"><td><p>sld_out[n_shells]</p></td>
<td><p>scattering length density at the outer radius of shell k</p></td>
<td><p>10<sup>-6</sup>Å<sup>-2</sup></p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>thickness[n_shells]</p></td>
<td><p>Thickness of shell k</p></td>
<td><p>Å</p></td>
<td><p>40</p></td>
</tr>
<tr class="row-odd"><td><p>A[n_shells]</p></td>
<td><p>Decay rate of shell k</p></td>
<td><p>None</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>The returned value is scaled to units of cm<sup>-1</sup> sr<sup>-1</sup>, absolute scale.</p>
<p>This model provides the form factor, <span class="math notranslate nohighlight">\(P(q)\)</span>, for a multi-shell sphere where
the scattering length density (SLD) of each shell is described by an
exponential, linear, or constant function. The form factor is normalized by
the volume of the sphere where the SLD is not identical to the SLD of the
solvent. We currently provide up to 9 shells with this model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>radius</em> represents the core radius <span class="math notranslate nohighlight">\(r_0\)</span> and <em>thickness[k]</em> represents
the thickness of the shell, <span class="math notranslate nohighlight">\(r_{k+1} - r_k\)</span>.</p>
</div>
<p><strong>Definition</strong></p>
<p>The 1D scattering intensity is calculated in the following way</p>
<div class="math notranslate nohighlight">
\[P(q) = [f]^2 / V_\text{particle}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\begin{align*}
f &amp;= f_\text{core}
        + \left(\sum_{\text{shell}=1}^N f_\text{shell}\right)
        + f_\text{solvent}
\end{align*}</div><p>The shells are spherically symmetric with particle density <span class="math notranslate nohighlight">\(\rho(r)\)</span> and
constant SLD within the core and solvent, so</p>
<div class="math notranslate nohighlight">
\begin{align*}
f_\text{core}
    &amp;= 4\pi\int_0^{r_\text{core}} \rho_\text{core}
        \frac{\sin(qr)}{qr}\, r^2\,\mathrm{d}r
    &amp;= 3\rho_\text{core} V(r_\text{core})
        \frac{j_1(qr_\text{core})}{qr_\text{core}} \\
f_\text{shell}
    &amp;= 4\pi\int_{r_{\text{shell}-1}}^{r_\text{shell}}
        \rho_\text{shell}(r)\frac{\sin(qr)}{qr}\,r^2\,\mathrm{d}r \\
f_\text{solvent}
    &amp;= 4\pi\int_{r_N}^\infty
        \rho_\text{solvent}\frac{\sin(qr)}{qr}\,r^2\,\mathrm{d}r
    &amp;= -3\rho_\text{solvent}V(r_N)\frac{j_1(q r_N)}{q r_N}
\end{align*}</div><p>where the spherical Bessel function <span class="math notranslate nohighlight">\(j_1\)</span> is</p>
<div class="math notranslate nohighlight">
\[j_1(x) = \frac{\sin(x)}{x^2} - \frac{\cos(x)}{x}\]</div>
<p>and the volume is <span class="math notranslate nohighlight">\(V(r) = \frac{4\pi}{3}r^3\)</span>.</p>
<p>The volume of the particle is determined by the radius of the outer
shell, so <span class="math notranslate nohighlight">\(V_\text{particle} = V(r_N)\)</span>.</p>
<p>Now consider the SLD of a shell defined by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\rho_\text{shell}(r) = \begin{cases}
    B\exp\left(A(r-r_{\text{shell}-1})/\Delta t_\text{shell}\right)
        + C &amp; \mbox{for } A \neq 0 \\
    \rho_\text{in} = \text{constant} &amp; \mbox{for } A = 0
\end{cases}\end{split}\]</div>
<p>An example of a possible SLD profile is shown below where
<span class="math notranslate nohighlight">\(\rho_\text{in}\)</span> and <span class="math notranslate nohighlight">\(\Delta t_\text{shell}\)</span> stand for the
SLD of the inner side of the <span class="math notranslate nohighlight">\(k^\text{th}\)</span> shell and the
thickness of the <span class="math notranslate nohighlight">\(k^\text{th}\)</span> shell in the equation above, respectively.</p>
<figure class="align-default" id="id2">
<img alt="../../_images/onion_geometry.png" src="../../_images/onion_geometry.png" />
<figcaption>
<p><span class="caption-number">Fig. 87 </span><span class="caption-text">Example of an onion model profile.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p><strong>Exponential SLD profiles</strong> (<span class="math notranslate nohighlight">\(A &gt; 0\)</span> or <span class="math notranslate nohighlight">\(A &lt; 0\)</span>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}f_\text{shell} &amp;= 4 \pi \int_{r_{\text{shell}-1}}^{r_\text{shell}}
    \left[ B\exp
        \left(A (r - r_{\text{shell}-1}) / \Delta t_\text{shell} \right) + C
    \right] \frac{\sin(qr)}{qr}\,r^2\,\mathrm{d}r \\
&amp;= 3BV(r_\text{shell}) e^A h(\alpha_\text{out},\beta_\text{out})
    - 3BV(r_{\text{shell}-1}) h(\alpha_\text{in},\beta_\text{in})
    + 3CV(r_{\text{shell}}) \frac{j_1(\beta_\text{out})}{\beta_\text{out}}
    - 3CV(r_{\text{shell}-1}) \frac{j_1(\beta_\text{in})}{\beta_\text{in}}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\begin{align*}
B&amp;=\frac{\rho_\text{out} - \rho_\text{in}}{e^A-1}
     &amp; C &amp;= \frac{\rho_\text{in}e^A - \rho_\text{out}}{e^A-1} \\
\alpha_\text{in} &amp;= A\frac{r_{\text{shell}-1}}{\Delta t_\text{shell}}
     &amp; \alpha_\text{out} &amp;= A\frac{r_\text{shell}}{\Delta t_\text{shell}} \\
\beta_\text{in} &amp;= qr_{\text{shell}-1}
    &amp; \beta_\text{out} &amp;= qr_\text{shell}
\end{align*}</div><p>and</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[h(x,y) = \frac{x \sin(y) - y\cos(y)}{(x^2+y^2)y}
          - \frac{(x^2-y^2)\sin(y) - 2xy\cos(y)}{(x^2+y^2)^2y}\]</div>
</div></blockquote>
<p><strong>Linear SLD profile</strong> (<span class="math notranslate nohighlight">\(A \sim 0\)</span>):</p>
<p>For small <span class="math notranslate nohighlight">\(A\)</span>, say, <span class="math notranslate nohighlight">\(A = -0.0001\)</span>, the function converges to that of of a linear
SLD profile with</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\rho_\text{shell}(r) \approx A(r-r_{\text{shell}-1})/\Delta t_\text{shell})+B\)</span>,</p>
</div></blockquote>
<p>which is equivalent to</p>
<div class="math notranslate nohighlight">
\begin{align*}
f_\text{shell}
&amp;=
  3 V(r_\text{shell}) \frac{\Delta\rho_\text{shell}}{\Delta t_\text{shell}}
    \left[\frac{
            2 \cos(qr_\text{out})
                + qr_\text{out} \sin(qr_\text{out})
        }{
            (qr_\text{out})^4
        }\right] \\
 &amp;{}
  -3 V(r_\text{shell}) \frac{\Delta\rho_\text{shell}}{\Delta t_\text{shell}}
    \left[\frac{
                2\cos(qr_\text{in})
            +qr_\text{in}\sin(qr_\text{in})
        }{
            (qr_\text{in})^4
        }\right] \\
&amp;{}
  +3\rho_\text{out}V(r_\text{shell}) \frac{j_1(qr_\text{out})}{qr_\text{out}}
  -3\rho_\text{in}V(r_{\text{shell}-1}) \frac{j_1(qr_\text{in})}{qr_\text{in}}
\end{align*}</div><p><strong>Constant SLD</strong> (<span class="math notranslate nohighlight">\(A = 0\)</span>):</p>
<p>When <span class="math notranslate nohighlight">\(A = 0\)</span> the exponential function has no dependence on the radius (meaning
<span class="math notranslate nohighlight">\(\rho_\text{out}\)</span> is ignored in this case) and becomes flat. We set the constant
to <span class="math notranslate nohighlight">\(\rho_\text{in}\)</span> for convenience, and thus the form factor contributed by
the shells is</p>
<div class="math notranslate nohighlight">
\[f_\text{shell} =
    3\rho_\text{in}V(r_\text{shell})
       \frac{j_1(qr_\text{out})}{qr_\text{out}}
    - 3\rho_\text{in}V(r_{\text{shell}-1})
        \frac{j_1(qr_\text{in})}{qr_\text{in}}\]</div>
<p>The 2D scattering intensity is the same as <span class="math notranslate nohighlight">\(P(q)\)</span> above, regardless of the
orientation of the <span class="math notranslate nohighlight">\(q\)</span> vector which is defined as</p>
<div class="math notranslate nohighlight">
\[q = \sqrt{q_x^2 + q_y^2}\]</div>
<p>NB: The outer most radius is used as the effective radius for <span class="math notranslate nohighlight">\(S(q)\)</span>
when <span class="math notranslate nohighlight">\(P(q) S(q)\)</span> is applied.</p>
<figure class="align-default" id="id3">
<img alt="../../_images/onion_autogenfig.png" src="../../_images/onion_autogenfig.png" />
<figcaption>
<p><span class="caption-number">Fig. 88 </span><span class="caption-text">1D plot corresponding to the default parameters of the model.</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p><strong>Source</strong></p>
<p><a class="reference download internal" download="" href="../../_downloads/a275b652f3257e2a80c2e7c74adf6a70/onion.py"><code class="xref download docutils literal notranslate"><span class="pre">onion.py</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/cdab76e912ba2d906055ae4a48bd237e/onion.c"><code class="xref download docutils literal notranslate"><span class="pre">onion.c</span></code></a>
<span class="math notranslate nohighlight">\(\ \star\ \)</span> <a class="reference download internal" download="" href="../../_downloads/5224eea2106a0533fa82ac542ccf5579/sas_3j1x_x.c"><code class="xref download docutils literal notranslate"><span class="pre">sas_3j1x_x.c</span></code></a></p>
<p><strong>References</strong></p>
<ol class="arabic simple">
<li><p>L A Feigin and D I Svergun, <em>Structure Analysis by Small-Angle X-Ray and
Neutron Scattering</em>, Plenum Press, New York, 1987.</p></li>
</ol>
<p><strong>Authorship and Verification</strong></p>
<ul class="simple">
<li><p><strong>Author:</strong></p></li>
<li><p><strong>Last Modified by:</strong></p></li>
<li><p><strong>Last Reviewed by:</strong> Steve King <strong>Date:</strong> March 28, 2019</p></li>
</ul>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="multilayer_vesicle.html"
                          title="previous chapter">multilayer_vesicle</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="polymer_micelle.html"
                          title="next chapter">polymer_micelle</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user/models/onion.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="polymer_micelle.html" title="polymer_micelle"
             >next</a> |</li>
        <li class="right" >
          <a href="multilayer_vesicle.html" title="multilayer_vesicle"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SasView 6.1.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../user.html" >SasView User Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../qtgui/Perspectives/Fitting/models/index.html" >Model Functions</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../qtgui/Perspectives/Fitting/models/shape-sphere.html" >Sphere Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">onion</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, The SasView Project.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>