import{j as s}from"./@radix-DGuLZ9Nd.js";import{S as g}from"./refresh-DNxZUtB4.js";import{P as j}from"./Pagination-2lWLXiuP.js";import{S as f}from"./SearchField-DS1lx7M6.js";import{u as v}from"./all-pipeline-runs-query-DamZvJQw.js";import{V as l,a3 as S,X as N,r as d,Y as b,Z as y,_ as R,$ as k,a0 as w,a1 as m,T as C,aK as P,aJ as T,B as A,a4 as F,e as u}from"./index-DHfBZI1k.js";import{a as _,u as I,b as B}from"./ButtonGroup-Dke8GZ9p.js";import{P as D}from"./pipeline-link-A-4bNAsN.js";import{R as E}from"./run-name-B1DU_O7E.js";import{A as z}from"./action-cell-Biol8Lia.js";import{S as L}from"./schedule-tag-DvMBMSL7.js";import{L as p,f as $}from"./@react-router-edahAHd8.js";import{z as o}from"./@zod-2qqdh1cM.js";const q=[{id:"select",meta:{width:"1%"},header:({table:e})=>s.jsx(l,{id:"check-all",checked:e.getIsAllRowsSelected(),onCheckedChange:a=>e.toggleAllRowsSelected(a==="indeterminate"?!0:a)}),cell:({row:e})=>s.jsx(l,{id:`check-${e.id}`,checked:e.getIsSelected(),onCheckedChange:e.getToggleSelectedHandler()})},{id:"name",header:"Run",accessorFn:e=>({id:e.id,name:e.name,status:e.body?.status}),cell:({row:e})=>{const{name:a,id:t}=e.original,r=e.original.body?.status,n=e.original.body?.index;return s.jsxs("div",{className:"group/copybutton flex min-w-[10rem] items-center gap-2",children:[s.jsx(S,{className:`h-5 w-5 shrink-0 ${N(r)}`}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(p,{to:d.projects.runs.detail(t),className:"grid grid-cols-1 items-center gap-1",children:s.jsx("span",{className:"truncate text-text-md font-semibold text-theme-text-primary",children:s.jsx(E,{name:a,index:n})})}),s.jsx(b,{children:s.jsxs(y,{children:[s.jsx(R,{className:"hover:text-theme-text-brand hover:underline",children:s.jsx(k,{status:r})}),s.jsx(w,{className:"z-20 capitalize",children:r})]})}),s.jsx(m,{copyText:a})]}),s.jsxs(p,{to:d.projects.runs.detail(t),className:"flex items-center gap-1",children:[s.jsx("p",{className:"text-text-xs text-theme-text-secondary",children:t.split("-")[0]}),s.jsx(m,{copyText:t})]})]})]})}},{id:"pipeline",header:"Pipeline",accessorFn:e=>e.resources?.pipeline?.name,cell:({row:e})=>{const a=e.original.resources?.pipeline?.name,t=e.original.resources?.pipeline?.id;return!a||!t?null:s.jsx(D,{pipelineId:t,pipelineName:a})}},{id:"stack",header:"Stack",accessorFn:e=>({name:e.resources?.stack?.name,id:e.resources?.stack?.id}),cell:({getValue:e})=>{const{name:a,id:t}=e();return!a||!t?null:s.jsx(C,{rounded:!1,className:"inline-block whitespace-nowrap",color:"turquoise",emphasis:"subtle",children:a})}},{id:"trigger",header:"Trigger",accessorFn:e=>e.resources?.schedule?.name,cell:({row:e})=>e.original.resources?.schedule?s.jsx(L,{}):null},{id:"created-at",header:"Created at",accessorFn:e=>({date:e.body?.created}),cell:({getValue:e})=>{const{date:a}=e();return s.jsx("span",{className:"whitespace-nowrap",children:s.jsx(P,{dateString:a})})}},{id:"author",header:"Author",accessorFn:e=>({name:e.resources?.user?.name}),cell:({row:e})=>{const a=e.original.resources?.user;return a?s.jsx(T,{avatarUrl:a.body?.avatar_url??void 0,username:a.name,isServiceAccount:!!a.body?.is_service_account}):null}},{id:"admin_actions",header:"",meta:{width:"5%"},cell:({row:e})=>s.jsx(z,{children:s.jsx(_,{id:e.original.id})})}],c=1,G=o.object({page:o.coerce.number().min(c).optional().default(c).catch(c),name:o.string().optional(),operator:o.enum(["and","or"]).optional(),status:o.enum(["pending","running","completed"]).optional()});function U(){const[e]=$(),{page:a,name:t,operator:r,status:n}=G.parse({page:e.get("page")||void 0,name:e.get("name")||void 0,operator:e.get("operator")||void 0,status:e.get("status")||void 0});return{page:a,name:t,logical_operator:r,status:n}}function ae({fixedQueryParams:e={}}){const{selectedRowCount:a,rowSelection:t,setRowSelection:r}=I(),n=U(),{data:i,refetch:h}=v({params:{...n,sort_by:"desc:updated",...e}});return s.jsxs("div",{className:"flex flex-col gap-5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[a?s.jsx(B,{}):s.jsx(f,{searchParams:n}),s.jsx("div",{className:"flex justify-between",children:s.jsxs(A,{intent:"primary",emphasis:"subtle",size:"md",onClick:()=>h(),children:[s.jsx(g,{className:"h-5 w-5 fill-theme-text-brand"}),"Refresh"]})})]}),s.jsxs("div",{className:"flex flex-col items-center gap-5",children:[s.jsx("div",{className:"w-full",children:i?s.jsx(F,{rowSelection:t,onRowSelectionChange:r,columns:q,getRowId:x=>x.id,data:i.items}):s.jsx(u,{className:"h-[500px] w-full"})}),i?i.total_pages>1&&s.jsx(j,{searchParams:n,paginate:i}):s.jsx(u,{className:"h-[36px] w-[300px]"})]})]})}export{ae as R};
