# splineops/pyproject.toml
# https://learn.scientific-python.org/development/guides/packaging-simple/

[build-system]
requires = [
    "scikit-build-core>=0.10",
    "pybind11>=2.11",
    "numpy>=1.26",          # build-time headers available if needed
]
build-backend = "scikit_build_core.build"

[project]
name = "splineops"
version = "1.2.1"
description = "Spline signal processing in N-D with support for GPU computing."
readme = "README.md"
license = { file = "LICENSE" }
authors = [
    { name = "Pablo Garcia-Amorena" },
    { name = "Philippe Thévenaz" },
    { name = "Arrate Muñoz Barrutia" },
    { name = "Daniel Sage" },
    { name = "Dimitris Perdios" },
    { name = "Thomas Debarre" },
    { name = "Michael Unser" },
]
requires-python = ">=3.11"
dependencies = [
    "numpy >=1.26",
    "scipy >=1.15",
    "matplotlib >=3.8",
]
classifiers = [
    "Topic :: Scientific/Engineering :: Image Processing",
    "Topic :: Scientific/Engineering :: Mathematics",
    "Topic :: Software Development :: Libraries :: Python Modules",
    "Intended Audience :: Science/Research",
    "Intended Audience :: Developers",
    "Development Status :: 5 - Production/Stable",
    "License :: OSI Approved :: BSD License",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
]

[project.urls]
Homepage = "https://splineops.github.io/"
Source = "https://github.com/splineops/splineops"
Issues = "https://github.com/splineops/splineops/issues"
Download = "https://github.com/splineops/splineops.git"

[project.optional-dependencies]
visualization = [
    "pooch >= 1.8",
    "IPython >= 8.26",
]
tests = [
    "tox >=4.13",
    "pytest >=6.0",
]
dev = [
    "splineops[visualization,tests]",
    "black >=23.10",
    "mypy >=1.8",
    "build",  # local wheel/source builds: python -m build
]
dev_cupy = [
    "splineops[dev]",
    "cupy >=12.2",
]
docs = [
    "splineops[visualization]",
    "sphinx >=7.3",
    "sphinx-gallery >=0.17",
    "sphinx-prompt >=1.8",
    "sphinx-copybutton >=0.5",
    "sphinx-remove-toctrees >=1.0",
    "sphinx-design >=0.6",
    "pydata-sphinx-theme >=0.15",
    "myst-parser >=3.0",

    # Runtime deps needed for the benchmarking example(s)
    "Pillow >=10.0",
    "scikit-image >=0.25",
    "opencv-python-headless >=4.8",
    "torch >=2.0",

    # ffmpeg binary (pip)
    "imageio-ffmpeg >=0.5",
]

# scikit-build-core configuration
[tool.scikit-build]
wheel.packages = ["src/splineops"]
editable.mode = "redirect"
sdist.include = [
  "src/splineops/**",
  "splineops/cpp/**",
  "splineops/CMakeLists.txt",
  "README.md",
  "LICENSE",
]

cmake.build-type = "Release"

# You can uncomment/tweak these if you want to force options:
# cmake.minimum-version = "3.20"
# cmake.args = ["-DLSRESIZE_USE_OPENMP=ON"]

# pytest defaults (so `pytest -q` works everywhere)
[tool.pytest.ini_options]
minversion = "6.0"
addopts = ["-ra", "--showlocals", "--strict-markers", "--strict-config"]
xfail_strict = true
filterwarnings = ["error"]
log_cli_level = "info"
testpaths = ["tests"]
