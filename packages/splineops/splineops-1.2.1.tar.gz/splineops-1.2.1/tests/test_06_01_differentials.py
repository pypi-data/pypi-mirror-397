# splineops/tests/test_06_01_differentials.py

import numpy as np
import pytest
from splineops.differentials.differentials import differentials

##############################################################################
# 1) Subclass to skip final normalization
##############################################################################

class differentialsNoNorm(differentials):
    """
    Subclass of `differentials` that overrides the `run()` method to
    skip the final normalization step. This allows us to compare
    raw (unnormalized) results with the Java ground-truth arrays.
    """
    def run(self, operation=None):
        if operation is not None:
            self.operation = operation

        # All the same operation selection...
        if self.operation == self.GRADIENT_MAGNITUDE:
            self.image = self.gradient_magnitude()
        elif self.operation == self.GRADIENT_DIRECTION:
            self.image = self.gradient_direction()
        elif self.operation == self.LAPLACIAN:
            self.image = self.laplacian()
        elif self.operation == self.LARGEST_HESSIAN:
            self.image = self.largest_hessian()
        elif self.operation == self.SMALLEST_HESSIAN:
            self.image = self.smallest_hessian()
        elif self.operation == self.HESSIAN_ORIENTATION:
            self.image = self.hessian_orientation()

        # DO NOT normalize here:
        # self.image -= self.image.min()
        # self.image /= self.image.max()

        print("Completed (no norm).")

##############################################################################
# 2) Input test images
##############################################################################

noise_width_10_by_height_15 = [
    [-0.458,  0.073,  1.180, -1.867, -0.586, -0.539, -0.089, -0.530, -1.062,  0.481],
    [ 1.442,  1.315,  2.608,  0.018,  2.344, -0.336, -0.039,  0.592,  1.290,  1.199],
    [-0.206, -0.636, -0.007, -0.559,  0.098,  1.132,  0.028, -0.595,  0.915,  1.022],
    [-2.105,  0.852,  0.735, -1.323, -0.526, -0.047, -0.594,  0.475,  0.445, -1.949],
    [ 1.915,  1.502,  0.321,  0.793,  0.232, -0.737,  1.636, -0.608,  0.001,  0.276],
    [-1.814, -1.782,  1.415, -0.264,  0.152,  1.254,  0.210, -0.977,  0.960,  0.179],
    [-0.538, -0.141,  0.693,  0.126, -0.250, -0.814, -0.916, -0.670, -1.775,  1.318],
    [ 1.143, -1.869, -0.266, -0.023, -0.171, -0.498,  0.478,  0.511,  0.056,  0.750],
    [ 1.480,  0.226,  0.875, -0.003,  0.319, -1.243,  0.568, -0.086,  0.121,  0.406],
    [-0.250,  0.053, -0.672,  0.233,  1.308, -0.284,  0.299,  1.785,  0.715, -0.801],
    [ 0.398,  0.091, -1.290,  0.261, -0.296,  2.190, -0.559,  0.117, -2.331, -2.219],
    [-1.722, -1.553, -2.098, -0.189,  0.125,  0.762, -0.940,  1.955,  1.013,  0.528],
    [-0.170,  0.406,  0.306,  0.188, -0.289, -0.952, -0.352, -0.169, -0.750, -0.111],
    [-0.586,  1.542,  0.540,  0.057,  0.256,  0.113,  0.681, -0.383,  0.448,  0.747],
    [-0.093,  0.868, -0.903, -0.208,  1.184, -0.259,  0.962,  0.175, -1.367, -0.639]
]

column_width_2_by_height_5 = [[1.03725, 1.02459], [0.93563, 0.13392], [-0.69445, -0.53387], [-0.29972, 0.05411], [0.00213, 1.24979]]

row_width_3_by_height_1 = [
	[0.1, 0.5, -0.7]
]

smooth_width_19_by_height_20 = [
	[-0.037, -0.117, -0.168, -0.163, -0.083, 0.065, 0.233, 0.347, 0.357, 0.267, 0.127, 0.010, -0.025, 0.034, 0.148, 0.259, 0.335, 0.382, 0.419],
	[0.005, -0.096, -0.161, -0.162, -0.087, 0.044, 0.188, 0.291, 0.315, 0.261, 0.165, 0.080, 0.048, 0.078, 0.148, 0.228, 0.311, 0.400, 0.496],
	[0.036, -0.083, -0.160, -0.160, -0.085, 0.033, 0.154, 0.243, 0.276, 0.251, 0.189, 0.126, 0.095, 0.098, 0.124, 0.169, 0.246, 0.361, 0.499],
	[0.043, -0.086, -0.164, -0.156, -0.074, 0.038, 0.142, 0.217, 0.254, 0.245, 0.203, 0.156, 0.126, 0.113, 0.108, 0.120, 0.178, 0.294, 0.442],
	[0.016, -0.111, -0.180, -0.157, -0.063, 0.049, 0.144, 0.212, 0.250, 0.250, 0.221, 0.188, 0.169, 0.156, 0.134, 0.117, 0.144, 0.233, 0.361],
	[-0.030, -0.147, -0.201, -0.164, -0.062, 0.051, 0.144, 0.211, 0.251, 0.258, 0.241, 0.226, 0.228, 0.228, 0.203, 0.160, 0.144, 0.183, 0.263],
	[-0.049, -0.156, -0.202, -0.163, -0.064, 0.045, 0.135, 0.200, 0.239, 0.248, 0.240, 0.242, 0.266, 0.285, 0.264, 0.202, 0.141, 0.117, 0.130],
	[-0.002, -0.104, -0.153, -0.126, -0.045, 0.049, 0.127, 0.181, 0.208, 0.208, 0.196, 0.203, 0.240, 0.277, 0.266, 0.197, 0.100, 0.016, -0.038],
	[0.094, -0.002, -0.056, -0.046, 0.010, 0.079, 0.136, 0.168, 0.167, 0.138, 0.108, 0.110, 0.151, 0.198, 0.200, 0.134, 0.020, -0.103, -0.208],
	[0.175, 0.097, 0.052, 0.054, 0.089, 0.132, 0.162, 0.162, 0.123, 0.059, 0.007, 0.001, 0.042, 0.092, 0.100, 0.041, -0.072, -0.208, -0.335],
	[0.183, 0.140, 0.123, 0.136, 0.165, 0.190, 0.193, 0.159, 0.086, -0.004, -0.069, -0.076, -0.036, 0.009, 0.015, -0.040, -0.143, -0.272, -0.398],
	[0.101, 0.101, 0.126, 0.170, 0.213, 0.233, 0.217, 0.158, 0.063, -0.037, -0.098, -0.101, -0.062, -0.025, -0.025, -0.075, -0.166, -0.279, -0.390],
	[-0.053, -0.009, 0.064, 0.150, 0.221, 0.250, 0.227, 0.156, 0.057, -0.035, -0.084, -0.079, -0.042, -0.010, -0.011, -0.053, -0.129, -0.222, -0.312],
	[-0.230, -0.151, -0.037, 0.088, 0.190, 0.238, 0.222, 0.158, 0.072, -0.002, -0.036, -0.025, 0.011, 0.043, 0.049, 0.020, -0.039, -0.111, -0.178],
	[-0.351, -0.260, -0.132, 0.011, 0.132, 0.200, 0.205, 0.165, 0.105, 0.054, 0.033, 0.045, 0.078, 0.112, 0.129, 0.115, 0.070, 0.013, -0.041],
	[-0.347, -0.284, -0.181, -0.055, 0.062, 0.144, 0.178, 0.172, 0.146, 0.120, 0.109, 0.116, 0.138, 0.168, 0.191, 0.188, 0.151, 0.093, 0.034],
	[-0.214, -0.212, -0.172, -0.097, -0.008, 0.075, 0.132, 0.161, 0.170, 0.171, 0.169, 0.166, 0.168, 0.183, 0.202, 0.202, 0.163, 0.094, 0.019],
	[-0.013, -0.081, -0.117, -0.112, -0.069, -0.004, 0.065, 0.121, 0.162, 0.189, 0.198, 0.182, 0.155, 0.141, 0.145, 0.140, 0.097, 0.018, -0.067],
	[0.178, 0.057, -0.043, -0.104, -0.115, -0.078, -0.011, 0.063, 0.130, 0.181, 0.198, 0.166, 0.104, 0.055, 0.036, 0.020, -0.029, -0.109, -0.190],
	[0.308, 0.163, 0.025, -0.085, -0.142, -0.133, -0.071, 0.014, 0.102, 0.172, 0.190, 0.136, 0.037, -0.047, -0.090, -0.122, -0.179, -0.258, -0.327]
]

tiny_width_1_by_height_1 = [
	[0.1]
]

##############################################################################
# 3) Ground-truth arrays (UNNORMALIZED)
##############################################################################

gradient_magnitude_of_noise_width_10_by_height_15 = [
    [0., 1.6137871994080653, 1.5411487976322606, 1.2691920088790234, 1.3199168331483537, 0.02647532371439154, 0.2769844617092122, 1.054462523122457, 1.0218656307806144, 0.], 
    [1.0717174463806676, 1.2365540903455645, 1.3955541161480551, 1.4002118106852917, 1.1896925417966577, 2.408778272679367, 1.0969863470691872, 0.6592490721483252, 1.729169340421345, 1.0404431950591333], 
    [3.5308697855226683, 0.8845759786739116, 1.4088499448975136, 1.6948368883391365, 2.928542086489688, 0.39518319764587, 1.6804340350906768, 0.8001509461441951, 1.349793156340066, 2.538772780236532], 
    [2.410761695710004, 3.5994526330333523, 2.1824330025057708, 1.4579407592580842, 1.3940046834829452, 1.9102958490578594, 1.1968501239977516, 1.3092668088980801, 2.2440137198583887, 0.3293520741130056], 
    [0.2508230026826528, 2.6573058707276673, 0.4245743400375906, 0.7966453676697581, 1.6741813929218876, 2.0448179529752513, 0.8795594335365678, 1.9082033161553669, 1.3804663442078615, 1.6181810766885543], 
    [2.541053706440616, 2.273625521036993, 1.1604937801532884, 1.7494430556036424, 1.5529534618527754, 0.17976401575245227, 2.97187236307069, 0.8853550352691846, 1.529360658464215, 0.2406277673587891], 
    [2.554391823079809, 0.8990522954908653, 1.5571411636078267, 0.7751359575494629, 0.44814354410197327, 1.4277054292902236, 0.7446735153314505, 1.6869582783954395, 1.9260089858133045, 0.5453078538762886], 
    [1.1944864141213802, 1.5224416354942503, 1.9174255904163944, 0.3892009898814718, 0.41352826753352256, 0.4008292700001205, 1.3280689541300095, 0.6109602691846009, 1.46506398473273, 0.7088591828639429], 
    [1.2783374795653304, 1.5914019662723307, 0.10312112015989826, 0.26719168993184395, 1.521067658692278, 0.5247856761120914, 1.0383197875592691, 1.2449267409891205, 0.864188581468806, 0.44587112242051663], 
    [0.2601364958600587, 0.3290756263810929, 1.37640317124428, 1.692940202463935, 0.7800568971826488, 2.7105589889531183, 1.8112897603790936, 0.41147209870131013, 2.9377443856009853, 2.16065632745399], 
    [0.9271165369944343, 1.7748783565279058, 1.0358285730223535, 0.4683328538359808, 1.64523843525906, 0.8291333140355258, 1.5777758297052276, 0.5966752431914605, 1.6645428490361156, 1.2134964322364756], 
    [0.44739735616220555, 0.49426823525690744, 1.22538278113208, 1.2919229810301738, 0.7345535623438652, 2.8144875708175086, 0.782480346736283, 1.662326432449808, 1.9311474919146643, 1.2936705985080865], 
    [1.0127059616432548, 2.4403015248534707, 2.121143953398629, 0.34348008567375127, 0.8421228831481289, 0.038416998654811435, 1.2398175520001686, 2.076872666824675, 0.6819092448490124, 0.06417882626882299], 
    [0.19542649041081372, 1.2364352866345465, 2.047711323104621, 0.4104884252767239, 1.1762552152751082, 0.6825489294719842, 0.8401607787719892, 0.8187640621454918, 0.9702376159287525, 0.3799552934327943], 
    [0., 0.3001501294857565, 1.2293994820569738, 1.9897480577136517, 0.46859274879763246, 0.2683770625231223, 0.8761009988901225, 1.934026933037366, 0.12699326674065836, 0.]
]

gradient_magnitude_of_column_width_2_by_height_5 = [[0., 0.], [1.08951, 1.1396785714285713], [0.83706, 0.11666571428571437], [0.7317000000000001, 1.3669114285714286], [0., 0.]]

gradient_magnitude_of_row_width_3_by_height_1 = [[0., 0.6000000000000003, 0.]]

gradient_magnitude_of_smooth_width_19_by_height_20 = [
    [0., 0.09298039470031323, 0.02107842119874717, 0.03929407949530189, 0.11890210321753963, 0.16909750763453957, 0.15270786624430216, 0.06607102738825174, 0.044991975797309264, 0.1261031241990146, 0.14059552740663228, 0.08251476617445633, 0.014654592104457551, 0.09589639775662613, 0.12075981686903797, 0.09606433476722198, 0.055982844062074155, 0.04900428898448145, 0.], 
    [0.050200741439775584, 0.1197271543647219, 0.029753544488416793, 0.035506351365291476, 0.10919292822816501, 0.1478664521364915, 0.14274970164193565, 0.09634568108767676, 0.05653303307744189, 0.08364416599735307, 0.10813991228779876, 0.10153919589471372, 0.08272244485588022, 0.0720007214692525, 0.07863292988250847, 0.09831484416016016, 0.09207013497742111, 0.11914565695299915, 0.07003897094170147], 
    [0.018197034240897598, 0.13891618492589583, 0.032701081214543, 0.038655515605651954, 0.10394074923690408, 0.12578145172889, 0.11203115745690781, 0.07214179021215901, 0.029326199614003852, 0.04945181282761302, 0.07048565239133865, 0.058182257806448825, 0.03172098189355139, 0.018395629362553102, 0.04360502101835858, 0.0861156483458019, 0.11394347458113425, 0.17941839427869555, 0.04015588376680562], 
    [0.008988878403366003, 0.14900740739006263, 0.028937648082786344, 0.04809558224703031, 0.10610457655812902, 0.1132226500501002, 0.09172290498049074, 0.05945047313362409, 0.018810669017335746, 0.029424371596335385, 0.051589731830788965, 0.05027861599408678, 0.040204564200863484, 0.027393292496114628, 0.0017167812514138142, 0.044920760650235717, 0.09484571018697861, 0.19077558629780952, 0.07141543587447902], 
    [0.04224152062743358, 0.1475730856546992, 0.025791514728881793, 0.06357113521993901, 0.11216199672096443, 0.10706425300077757, 0.0821031922661668, 0.05414326031414441, 0.0194799421555715, 0.02010648414631257, 0.04121204546305003, 0.04547130443689359, 0.05518309236870024, 0.06344633798402215, 0.058018559985348196, 0.024654557623363577, 0.05072724125631388, 0.15966474658525961, 0.08818237273527826], 
    [0.04104503908689965, 0.13179315417847626, 0.016411256754229903, 0.07541065561713411, 0.11617069772245067, 0.10552822964536615, 0.08020783724022039, 0.0545127773854527, 0.023969478916203, 0.008600181397243618, 0.02472534006422505, 0.03392057225867306, 0.05705950486809446, 0.0746170629349685, 0.08499159985677597, 0.06259524103965437, 0.006997528489865838, 0.10285674547637942, 0.11285507318440784], 
    [0.011421676975032196, 0.11758090717908233, 0.02157147668890363, 0.07575482852231487, 0.1120766221793068, 0.10194548399028977, 0.07843052803633424, 0.05531843095075021, 0.0323708237275245, 0.02405964707992274, 0.021328240908810723, 0.01650226884088886, 0.029752265225700552, 0.03026255893286698, 0.058889690724226895, 0.07294764891972673, 0.05093809011853202, 0.08340347989623753, 0.15339733452709037], 
    [0.07935833118677087, 0.139927036573897, 0.07672741725480955, 0.08352053424841506, 0.1014207081030546, 0.09009943731395113, 0.06659277046800062, 0.04456331840547528, 0.03958205081483144, 0.05774872754134362, 0.0690796722533963, 0.07349893271060957, 0.07640856563356481, 0.05096480525357426, 0.05437577043639758, 0.09755620061793334, 0.11245268206368023, 0.14011026848157054, 0.1765555887072306], 
    [0.10014499827788434, 0.15501784671689986, 0.1113691213354952, 0.1022700754305712, 0.09830835056950286, 0.07897253873776328, 0.049946287300777076, 0.01836704361520492, 0.04727994083274764, 0.086484056484367, 0.10266619057799732, 0.11183393382999594, 0.1199701093788205, 0.10638273717532706, 0.09625907301617874, 0.12917313764134933, 0.14929116906718298, 0.18378474323541938, 0.1543803106439871], 
    [0.05106167570169172, 0.11797388585633817, 0.09802835299945302, 0.09949333124313439, 0.09302237913557856, 0.07105401782120514, 0.03539134838092, 0.020031772692444178, 0.07018548098289983, 0.09867319660326761, 0.09951327460949384, 0.10139407559078707, 0.11371875559531516, 0.10748396257736655, 0.10249605509899053, 0.13179924186721936, 0.14966287938859374, 0.18859376045673767, 0.09692316871682105], 
    [0.037391701084651244, 0.045760783905320936, 0.03941842102044391, 0.06535097644726419, 0.07199386406750624, 0.05580677998272196, 0.032209827730117616, 0.055027175729172415, 0.09251396818261008, 0.09827080418745318, 0.0659254515275736, 0.05617738691033257, 0.07295946768145255, 0.06807673535058906, 0.06965466187015742, 0.1047907233724304, 0.12284644366774179, 0.16747963974977903, 0.02792701448872878], 
    [0.12349487136308665, 0.07928835384353779, 0.0494792335972872, 0.047639368985041564, 0.04501532789912003, 0.03128691502752854, 0.04112517520176888, 0.08007980093301269, 0.10569591002962374, 0.08790704503471838, 0.03285472233790636, 0.02371620624912422, 0.04546745894014988, 0.023972535014525887, 0.027633361759719394, 0.07538052265700965, 0.09858754878814037, 0.14553740256837197, 0.043631226671736356], 
    [0.17662881346300213, 0.15108768230064937, 0.11964966023165648, 0.09516817956624747, 0.05460572703479518, 0.004259929851691393, 0.048978147842834566, 0.08975709924000694, 0.10215004986033072, 0.07728910675498682, 0.038936729734299826, 0.0486837230492696, 0.05634677437915262, 0.041074115475435026, 0.04510106918395905, 0.08041557835530087, 0.105766081963625, 0.14630843333286636, 0.11140210780178343], 
    [0.16298987478490495, 0.1781718261623449, 0.16042646394733737, 0.1416269839653165, 0.09152736442008907, 0.030205854449273508, 0.04534066539052114, 0.08026257836305667, 0.08924157440816133, 0.07331424902070158, 0.06143701508324868, 0.07025896514447202, 0.07421494032131802, 0.06894897696947389, 0.07653672695399161, 0.10220822777246955, 0.12471811254610676, 0.15428833437469244, 0.14676034212112982], 
    [0.065411687397378, 0.14896565630346503, 0.15584781815939497, 0.1583592741930469, 0.11830053533023834, 0.060060311588492614, 0.03030276871967673, 0.055342093746191624, 0.07224459027000485, 0.07473187040062865, 0.07576605411435096, 0.07792669496971526, 0.07665822447510512, 0.07300330122725408, 0.07718843071039765, 0.09662465427180418, 0.11470650318691532, 0.13097342460464254, 0.11455652371369725], 
    [0.07363662437441705, 0.09902308999230687, 0.117704143248701, 0.1390347772051471, 0.1252496626231191, 0.08567585262146919, 0.036660050402198247, 0.019577538570911216, 0.04677915689871708, 0.06589569188242377, 0.07168243656788023, 0.06576982056443507, 0.0560670882613679, 0.049888314586498846, 0.04373790479818707, 0.0536937861794517, 0.06981886425316124, 0.08784838863113069, 0.031013563024081117], 
    [0.1818651898997097, 0.11272961730917627, 0.07108036048528436, 0.08986982079560538, 0.11195218229331293, 0.10492186955360062, 0.07182164756493115, 0.03115369431345087, 0.009083755823086282, 0.03558687325438673, 0.04578006887575205, 0.03349880209413325, 0.011535463324699603, 0.024961712984300426, 0.028903550534752916, 0.03325730790682336, 0.06078234652375294, 0.10434094381054766, 0.058610775810021734], 
    [0.20090261602674403, 0.15606698788633058, 0.06583319655303695, 0.024519777882831613, 0.07821225257672278, 0.10358346800317945, 0.09623290948107226, 0.06947358055268513, 0.04071394047231274, 0.019506872966805835, 0.013164904108707264, 0.025401370972829636, 0.037992944219429975, 0.06084633555636991, 0.07929257963422913, 0.08901122015698008, 0.10760495146619511, 0.14449875026716325, 0.0995704597839942], 
    [0.19052434599331397, 0.2093477159755343, 0.11678238788984184, 0.04464097383853411, 0.04424030325818472, 0.09558629252298784, 0.11188430049229632, 0.0988676819533783, 0.07272908193345982, 0.039816852913116284, 0.011726155766322494, 0.06348322578089764, 0.10187207559134921, 0.1300571847976505, 0.1568230371110661, 0.17761147173708056, 0.19488481029399804, 0.21107507371290504, 0.1701073850540015], 
    [0., 0.1827961873946236, 0.11781525042150529, 0.08994281091935524, 0.02341350590107375, 0.03959683452365024, 0.07802616780647278, 0.08929849425045856, 0.08377985519169287, 0.049582084982769926, 0.018108195122772508, 0.08514930449167979, 0.10029458691050835, 0.06267234786628686, 0.030016021624344184, 0.042263565636336375, 0.06792971583031028, 0.09401757104242245, 0.]
]

gradient_magnitude_of_tiny_width_1_by_height_1 = [[0.]]

# Gradient Direction
gradient_direction_of_noise_width_10_by_height_15 = [
    [0., -1.5707963267948966, 1.5707963267948966, 1.5707963267948966, -1.5707963267948966, 1.5707963267948966, -1.5707963267948966, 1.5707963267948966, -1.5707963267948966, 0.], 
    [3.141592653589793, -1.3150339304795748, 1.174360805113121, -3.097336447602268, -2.9320009601131427, 2.0706591917003685, -1.8322252924937006, -1.5599073342851717, -2.972823233527633, 3.141592653589793], 
    [0., -0.14185374330042008, -0.06873421932179989, 0.16662658170162772, -0.476269337489556, 3.0999329491161176, 1.0860106542069023, -1.3614518772746222, -0.853381377640435, 0.], 
    [3.141592653589793, -2.310617151869107, 1.821751577728653, 2.6193649000619015, -2.0452533592314253, 0.21355430319107166, -2.9945044564870393, -1.8187519990151735, 1.2582594733996302, 0.], 
    [3.141592653589793, 0.4288490119976951, 2.1201184113175695, -2.576774774904639, 1.8473949350718413, -2.370025825690109, -3.0053388926830222, 0.918694719057325, -2.2860349001852, 3.141592653589793], 
    [0., -1.2753992183148815, -2.125620603600207, 1.1097683012068034, -1.2891426703783748, -1.0260314814377836, 0.708035148309555, -1.5196204825356543, -0.43605476542303545, 3.141592653589793], 
    [3.141592653589793, -1.7218202987218172, -0.08856276724803737, 2.1731463950310985, 1.1656083373408812, 0.38323882031565365, -2.3120599974783724, 2.3234476861819076, -1.205342929451541, 3.141592653589793], 
    [3.141592653589793, 1.4786069620045923, -1.8616242228709854, 0.8548850548342701, 1.9924707496610055, -1.9108891558061754, -2.482965641358303, 1.4007858667562796, -2.9145455061988863, 0.], 
    [0., 2.8546912481015227, 0.13275625405299044, 2.391924821019408, 2.486986592807447, -0.3227551636076817, -1.3257046106851664, 2.5203442206381252, -2.451495904852194, 0.], 
    [0., 0.9203786382348883, 0.15938158529918306, -1.713749631797802, 0.7721720373932821, 2.7439269381774327, -1.2451281742158498, -1.2649589563966477, 0.7664627665524014, 0.], 
    [0., 0.8774811257738091, -0.39276721754096994, -0.6657797896266765, -1.051610932118367, 2.878019092575733, 1.030917978553018, 1.7260227661618335, 1.8399238435347647, 3.141592653589793], 
    [0., 1.4051356545206326, -2.4062844639456835, -1.5445271281584707, -1.9547006552053194, 0.42591485593594763, -1.707473187307555, -1.7308322287313496, 2.2679798538598868, 3.141592653589793], 
    [3.141592653589793, -2.972104827993244, 3.038400954391892, 2.5496981925470332, 1.2529694666753222, 2.3028728797726377, -2.5167625233172948, 0.25475945368256026, -0.2585494726946138, 0.], 
    [0., -1.36320491995713, 0.7948398643413036, -0.45756264434938015, 3.0429873720631346, -2.422006414363593, 2.6336980928401705, 2.761930709483561, -1.2586747230261728, 0.], 
    [0., 1.5707963267948966, 1.5707963267948966, -1.5707963267948966, 1.5707963267948966, 1.5707963267948966, -1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 0.]
]

gradient_direction_of_column_width_2_by_height_5 = [[0., 0.], [0., 0.], [0., 0.], [3.141592653589793, 3.141592653589793], [0., 0.]]

gradient_direction_of_row_width_3_by_height_1 = [[0., 1.5707963267948966, 0.]]

gradient_direction_of_smooth_width_19_by_height_20 = [
    [0., 1.5707963267948966, 1.5707963267948966, -1.5707963267948966, -1.5707963267948966, -1.5707963267948966, -1.5707963267948966, -1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, -1.5707963267948966, -1.5707963267948966, -1.5707963267948966, -1.5707963267948966, -1.5707963267948966, -1.5707963267948966, 0.], 
    [3.141592653589793, 1.7752007874641025, 1.7869322057089188, -1.6094674801526603, -1.5402709611161611, -1.409703212013213, -1.1811579888149795, -0.7667949755118424, 0.3322700241991225, 1.4551664675976084, 1.9798749569571177, 2.471695577137689, -3.1367336986972965, -2.262797252215936, -1.4290443897938, -1.008632906771221, -1.0192480745804173, -1.5702402915027578, 3.141592653589793], 
    [3.141592653589793, 1.6052785312601543, 1.5241930601449363, -1.6616997860502742, -1.6413811210296645, -1.561808373529878, -1.3903699472748967, -1.0726182343631867, -0.078312862747591, 1.3795671419888202, 1.7699269962752167, 2.1049145417066963, 2.7333482665333766, -2.034723443730238, -0.8865079214672418, -0.7936941157054112, -0.8637275937296274, -1.2135907286227563, 0.], 
    [0., 1.48034564362189, 1.2440779633926333, -1.6246930680080527, -1.6937248495206325, -1.661355889712548, -1.5341513342551572, -1.3203680837153209, -0.8358240013038089, 1.545189650127912, 1.870124770008712, 2.208331466466569, 2.618185489522945, 2.836998757246682, 2.4888172953545307, -0.8378852449092606, -0.9563354004980595, -1.211981109182465, 0.], 
    [0., 1.3316831169779642, 0.5971579268357844, -1.4940692350114273, -1.629920667809747, -1.6472076609884343, -1.6139946391823061, -1.5782397802506893, -1.657741072724605, 2.057978884407661, 2.111285791241577, 2.509048183613257, 2.9013137612631104, 2.8770535778466026, 2.686303303791995, -3.0751399664164034, -1.3063195589874501, -1.230504575629323, 0.], 
    [0., 1.343218066851303, -0.035337312070851744, -1.4765113180649336, -1.5404826809523489, -1.5335347370782848, -1.5106408340865678, -1.4811728342931185, -1.4388979900425565, 1.8178229290000556, 2.17093043542934, 2.9625281628820286, -3.043800510300315, 3.00388677698633, 2.65690875244181, 2.541337038300072, -2.5281164962278373, -1.0312074565985994, 0.], 
    [3.141592653589793, 1.7321636699758503, -2.8974942639652133, -1.7737730791142172, -1.610569172825139, -1.527151261932843, -1.4267643510931318, -1.2605819444497075, -0.8200852826411181, 0.1399717113687774, 0.34648505690913894, -1.051706464477946, -1.9226828205196205, -3.0437955169987343, 2.251938988068482, 1.9029634302220875, 1.196458211002779, -0.04320894274710608, 0.], 
    [3.141592653589793, 2.2072842709975244, 3.103926823077807, -2.3725368852988886, -1.9410078528659647, -1.7462045055180944, -1.5535560320456991, -1.1654180085711097, -0.3242483261270422, 0.18097988725060646, 0.10198822010762686, -0.32583233071477485, -0.6285450018716748, -0.3771700512909633, 0.8827699298567319, 1.1950075018616722, 0.9737822188731241, 0.6098719267345201, 0.], 
    [3.141592653589793, 2.3636847233280003, 3.0079470176737613, -2.78031906354498, -2.3743111299068476, -2.1549821843931634, -1.957780059002829, -1.0701384838862664, 0.3838051326291376, 0.4204033658160853, 0.1773192685267855, -0.21385538178132057, -0.44989776413103516, -0.3013785312987169, 0.33321946242617667, 0.85697978303141, 0.9110624804938877, 0.878798021845212, 0.], 
    [3.141592653589793, 2.2943221612961726, 2.984610953630864, -2.9317943704934053, -2.6556840325425966, -2.5519770213758792, -2.6236681480590813, 1.3615631355538438, 0.9271416671977727, 0.7169554638120264, 0.3327815734286813, -0.20731984467278075, -0.4950534767849751, -0.3418095644056784, 0.2377211588320489, 0.7777565734720314, 0.9523036581023987, 1.0849013321880385, 0.], 
    [0., 1.6398677803926718, -3.0754160902632024, -2.778263080877885, -2.7042257786118657, -2.835784965360053, 2.702295727907824, 1.5427959461726724, 1.2327678654400842, 1.0426334123215857, 0.6180797351774451, -0.39634956583803244, -0.7635734736264078, -0.48112828091658943, 0.34367519045212896, 0.9399915766139393, 1.148086550163808, 1.3453535485286847, 0.], 
    [0., -0.11816887819880074, -0.8634773392442253, -1.7044691548126043, -2.267224860567005, -3.024544344234896, 2.0142205787116625, 1.5498546738683492, 1.4268764139668384, 1.3932477164637664, 1.3861762464041496, -1.592390336280324, -1.5461794826863806, -1.2154156958217421, 1.0785113401287776, 1.4794745744503486, 1.6353367023546215, 1.7422127350971384, 3.141592653589793], 
    [0., -0.46246702992009836, -0.7477935945735228, -1.0844519618239779, -1.335634140084543, -2.1953896334457506, 1.6171989343279902, 1.562419218309031, 1.6130737010819551, 1.8141957333987926, 2.5750697891827286, -2.5635387692633613, -2.3396926812830063, -2.6765921214257133, 2.653003298713792, 2.246606010512843, 2.2563642070440575, 2.217299466503041, 3.141592653589793], 
    [0., -0.698911736609999, -0.8494566303541184, -1.0175038042132496, -1.031734663702752, -0.5316161502087425, 1.309072121416775, 1.6291937664895613, 1.8534496254539057, 2.249371332239507, 2.977957275195089, -2.7300282354794847, -2.594897905090128, -2.823473814762189, 2.999412137575834, 2.6617400641977187, 2.598828338455534, 2.533498268551817, 3.141592653589793], 
    [0., -1.064875209719282, -1.0577379162117015, -1.0786791184609041, -0.9754591773990323, -0.6352872858430699, 0.7892333509289114, 1.7344036866990167, 2.1596143987373844, 2.6068752839447358, 3.094208654785467, -2.8090601235693695, -2.6403443693481345, -2.744720908611625, -3.098946660237013, 2.7998534193902263, 2.6831369741126783, 2.572668705396102, 3.141592653589793], 
    [3.141592653589793, -1.8381629052691288, -1.3994658466286478, -1.1618850178525229, -0.9617830746832101, -0.7516365714332355, -0.3121534898784805, 1.6351694726299193, 2.4699151723392077, 2.832894412051458, 3.1163680861799166, -2.9075592561101526, -2.6228148701733547, -2.5076222640713657, -2.839907361485816, 2.7289155278340345, 2.405862464825385, 2.095379968075549, 3.141592653589793], 
    [3.141592653589793, -2.9965617386135293, -2.114461185933291, -1.253379954723699, -0.9285597356160055, -0.7567211105940452, -0.6284042912720921, -0.5804261120538132, -2.7528441792542053, 3.117532099870478, 3.075612341034279, 3.079751800438719, -2.3385450468790654, -0.9208427306730956, -0.5140159391013261, 0.6346194913653523, 1.0375060900483206, 1.1424579075622832, 0.], 
    [3.141592653589793, 2.6375009300105865, 2.9818626981279017, -1.4267360047332935, -0.8241921006981971, -0.7433802979077704, -0.7300620816911205, -0.7663316710636358, -0.9928686901921971, -1.6690177659567755, 2.852485591206144, 1.5819794951947013, 0.6718319767961499, 0.04948593781373305, -0.07178131191153639, 0.25830881663851923, 0.5774086941076003, 0.8474530806203491, 0.], 
    [3.141592653589793, 2.361648910457188, 2.454061621010203, 2.0638665790514756, -0.3557296645882062, -0.6219738006857745, -0.7205669110319863, -0.8160202840187846, -0.9976466981011918, -1.2321327544015104, 0.6750075081593938, 0.9949208274979481, 0.6505320648863654, 0.25635373124141253, 0.06635652344333227, 0.1721724653228556, 0.3285605804339315, 0.5208168132969876, 0.], 
    [0., 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, -1.5707963267948966, -1.5707963267948966, -1.5707963267948966, -1.5707963267948966, -1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 0.]
]

gradient_direction_of_tiny_width_1_by_height_1 = [[0.]]

# Laplacian
laplacian_of_noise_width_10_by_height_15 = [
    [9.214990708422539, 11.346803317869078, 0.06671757100079034, 18.635252771588988, 10.307968816395537, 1.1608525318886873, -1.912069675300584, 5.728475663626688, 15.873334135341507, -4.98715512855704], 
    [-10.267789925909078, -3.1559896176101416, -21.238094705449605, 7.498515692486111, -25.767363011999365, 11.518975217391702, -0.9371563948668338, -5.79044862655045, -9.001383328026694, 0.9806677857859221], 
    [-4.922164264127711, 10.657821671254435, 5.8533284354072945, 1.95534920134486, 6.259157075479078, -8.504113519842461, -2.3235381155613517, 10.337612442279143, -1.3167418517215999, -5.620045500343217], 
    [26.400272361628204, -8.080947825824165, -7.532441381721562, 11.506627642718993, -0.19020350671310138, -1.617308411421783, 10.075396167508089, -6.453563110749615, -7.537488702748766, 21.524433934417875], 
    [-18.563239795777612, -10.655401141172728, 7.882234797731268, -9.32767982401514, -3.668860547701775, 14.565237213624304, -18.435089247774744, 10.144920725839556, 2.3866164555394365, -7.101650133739648], 
    [8.553136987963924, 20.7316520575517, -14.561346643831698, 10.354387324817704, 0.005311846243835128, -12.400600709446113, 0.10913574035002638, 6.510140806725477, -16.758194433504435, 10.758775257588447], 
    [-1.916177856411054, -9.455467688368122, -3.3249361247352383, -1.0172572665986142, 0.17325223042898408, 7.349997144692889, 5.993581136541115, -2.622454873940129, 22.247010113106473, -19.131875313928216], 
    [-15.239317312227229, 22.0860021957358, -0.45115110657992563, 1.7918272391720194, -1.3588205089882583, -1.2905744028067607, -5.006214411560727, -6.174118277298672, -3.8079040285403734, -1.8412449970661255], 
    [-11.369701988279756, -1.0222429073756603, -11.004503104142993, 4.663824743502848, -3.775432273647247, 10.932272349627015, -5.9511489434983575, 10.46465791284254, 4.640111735424243, -1.7468975649918992], 
    [9.12455619394409, 0.42810757657113774, 6.594180023336865, 0.7756696432723886, -11.031650322430902, 7.511488851875488, 0.058994721255224425, -13.61125536445254, -11.641759487333434, 2.7284435441221415], 
    [-7.228509320977913, -8.782214331946259, 4.303877276426323, -8.51485344607816, 14.875339815683093, -19.56710263689219, 11.39336332521812, 1.0084653577681983, 22.904325695966467, 5.159423647474844], 
    [11.06518053502861, 4.305350861091796, 12.15220698638516, -2.8164414305468912, 0.36513723061975556, -7.194277416404421, 12.0775022553418, -19.039208064400512, -11.207085582880918, -8.931366990847277], 
    [-3.5232189604609747, -4.105176829772018, -3.6177482112381325, -1.6852211572984765, 1.260515553365828, 7.524435461962321, -0.04866927592307868, 3.493331457732465, 13.557455333300467, 2.679324967042622], 
    [14.08792749327478, -10.953107914922708, -0.33558883621619673, 0.5832892117940679, -0.4086773575125877, -1.8595159297800494, -5.393141244879228, 4.659198104724819, -11.597683142107837, -6.743459181429758], 
    [3.017447278149887, -3.432268092113195, 10.897671591619016, 2.183668749633857, -9.473791916878188, 9.905966991897056, -4.576134889954024, -3.088986029794892, 15.170094993177488, 2.9341028796530972]
]

laplacian_of_column_width_2_by_height_5 = [[1.4933400000000001, -2.988702857142856], [-8.558580000000003, 5.5955657142857165], [5.216700000000003, 0.2972399999999982], [1.0072800000000002, -0.41654571428571474], [7.138260000000004, -11.926217142857148]]

laplacian_of_row_width_3_by_height_1 = [[3.6000000000000023, -4.8000000000000025, 6.0000000000000036]]

laplacian_of_smooth_width_19_by_height_20 = [
    [-0.1424406934789249, 0.18547301474141556, 0.064963812993304, 0.08827401687188863, 0.05686184476101355, -0.052371014321085596, -0.22052546202638978, -0.3115357647756523, -0.2529440074996873, -0.07109599798649066, 0.16738328107822636, 0.35155965840646514, 0.3761458993841321, 0.2310104622981086, 0.013050221261584005, -0.12141587930420225, -0.08744925126042935, 0.13411534243558831, 0.1979306360855605], 
    [-0.4227276749800054, 0.10827209439287891, 0.022808940448407783, 0.08928757664045073, 0.06819730250604673, 0.047222450145647944, 0.00920824601079881, -0.028038179784251216, -0.04583046961642123, -0.04782435622827666, -0.04298266873562455, -0.04223853829498435, -0.03959880626087517, -0.03767367314371885, -0.04218244084055016, -0.015187499574565083, -0.06694246642988039, -0.008847550885251076, -0.5195528391640835], 
    [-0.4491431683984133, 0.14842773128178766, 0.05433849263154944, 0.09343428329765004, 0.05237645087094741, 0.016512584382559745, -0.018460510249216328, -0.048730933801762966, -0.05190345494453541, -0.036509795746351936, -0.0036703906420247068, 0.04116885144460693, 0.035369683481125125, 0.027428442318605445, 0.023582336111504953, 0.0508104895170705, 0.004737875310631939, 0.13855521586807956, -0.5303594568105597], 
    [-0.5187648776276453, 0.15414743288257723, 0.04538050561627141, 0.08267117140283488, 0.025969952483742335, -0.0016609028040873303, -0.013486802974711387, -0.008167578037383244, -0.02791714052991584, -0.02156124805971582, 0.0007248103218023549, 0.02074560371764317, 0.03032960851394985, 0.035939287957911015, 0.05572602386249839, 0.11247444754579702, 0.07000241356132936, 0.18205198787751248, -0.554721983825969], 
    [-0.5001950531676636, 0.1717780013412195, 0.06135536036675829, 0.07822206508412047, -0.0028362722417505856, -0.03388996141598551, -0.03292831341700353, -0.025233623538666372, -0.036552469410887356, -0.02611239662447737, 0.004364374268672505, 0.03434301863908132, 0.03374151773217415, 0.02460157981909586, 0.05193523729201992, 0.11381787091632399, 0.07872619912420134, 0.18481576728468574, -0.4765420752169727], 
    [-0.41787329309575494, 0.2155773285406536, 0.08726936915831499, 0.08331853650609455, -0.0042080527400036385, -0.03532446288432768, -0.03903590872458243, -0.03740885498636162, -0.05159330774558388, -0.0485969345877684, -0.01803090489586759, 0.0038844808689263988, -0.021455718514850175, -0.043707610088374454, -0.03785892254205367, 0.035183869688889785, 0.03776553585340847, 0.10906415843758996, -0.343299323033064], 
    [-0.3322966564157777, 0.2478824484290878, 0.12167298923475475, 0.11411072001948817, 0.02513493245504466, -0.012284915187809546, -0.026503588373523193, -0.03535608161935461, -0.05659826250405117, -0.05117888833188558, -0.034000698558182635, -0.03116214331542655, -0.07703389499723501, -0.12002893296711242, -0.11835312179328955, -0.04888125749243366, -0.00662313658614859, 0.02059468297875934, -0.11209417465767466], 
    [-0.3286679806000239, 0.22034867646077416, 0.11194337839044097, 0.11316396674707432, 0.05006208510756478, 0.00996369155348479, -0.003341771640740232, -0.01709825101647694, -0.03789587845776882, -0.05122713472619936, -0.027925574085805288, -0.02285919210809545, -0.06595629027830407, -0.1383630184139232, -0.14043556001969837, -0.09864460040876702, -0.015622977015456924, -0.02305717963644384, 0.15848316630567044], 
    [-0.37512320902950824, 0.1369064214185782, 0.05991098228581195, 0.07761989697212791, 0.03571330611271328, 0.011657349001888376, -0.006134704173605177, -0.02745659790239885, -0.03699011020413995, -0.012019343018588799, 0.02330196246175793, 0.02830981176166227, -0.011583511505319236, -0.07845962292796574, -0.11169955230906416, -0.08942005459713936, 0.004428813727687539, -0.04874132702718725, 0.3963491907320947], 
    [-0.3726260660862683, 0.053599403473562776, -0.008095487163961218, 0.020815398276853872, 0.0017570584220946706, -0.007741512395529004, -0.026198080307389404, -0.04161225796923551, -0.021917409701891086, 0.030936323300739275, 0.07996418721425316, 0.09300227665934357, 0.04951454693251274, -0.020077664003837828, -0.05287374485848232, -0.050965950615300806, 0.027178313869644644, -0.05176910990193262, 0.4940158695895134], 
    [-0.26214011689544175, -0.013768854772783473, -0.05390216552012714, -0.0329241430589485, -0.036197795993310966, -0.03882362167149028, -0.04708742939774713, -0.03990422876530225, -0.006086362008812636, 0.05706835244234299, 0.12041018919490204, 0.10861117691956165, 0.06223604198720291, 0.010997310776980726, -0.018424313803595868, -0.00446779258896339, 0.05148337492954708, -0.044932360261030146, 0.5019623943578271], 
    [-0.09545813857186354, -0.03723463990263021, -0.048808556434828246, -0.05635734780366605, -0.06749908171912813, -0.06359265007479528, -0.06040439820620408, -0.04433339339494101, 0.007465319543266118, 0.08154298613077658, 0.10618171739646275, 0.0966536509002259, 0.041352082777087046, 0.008744595024453107, 0.0041355059003018516, 0.009922923532872448, 0.06498047033785859, -0.025956387318431112, 0.44986202211142245], 
    [0.09967724591571298, -0.03270173508233032, -0.020931585610838188, -0.06196540877963838, -0.0864621280468959, -0.08386183130919939, -0.06641451374123136, -0.02522800051988479, 0.029207831259347908, 0.07929451620510174, 0.09574094111344202, 0.06672740673220352, 0.027664877999578612, 0.0028341174920189158, 0.007333805640010807, 0.014160228340172394, 0.06160670875060019, -0.01267408047427003, 0.37130551220099617], 
    [0.3015167288014896, 0.020506432446996042, 0.03390791612552513, -0.04173793828220073, -0.08419773852294882, -0.09682177376534482, -0.060945218091460224, -0.018862170398225783, 0.031141290172757366, 0.06763477590786199, 0.06999327596017196, 0.04152586407030352, 0.00849307981682118, -0.011188905260763153, -0.013544041979630266, -0.011162742548186798, 0.023061630797524796, -0.03262412968099948, 0.23155434853284876], 
    [0.423764502601823, 0.06765867784736077, 0.08786056717318186, -0.014308094902350327, -0.06640653668258575, -0.08698734153352361, -0.051599923455240476, -0.018005811733858373, 0.02275229299852071, 0.0467477342145046, 0.045435253892754435, 0.025990587547990114, -0.0060722983593786695, -0.031159542640312815, -0.05239835186358749, -0.0634653553876877, -0.026788128837551606, -0.09113371597406061, 0.1126292512537733], 
    [0.3267135294283515, 0.10828231888929793, 0.09766769564166233, 0.011475333326205608, -0.03521405694503712, -0.06358210674184979, -0.062204159324093344, -0.03856505107898847, -0.018799517279734557, 0.0014209760983446423, 0.0007280081248050435, -0.007384101750467428, -0.021082636082487005, -0.04676203787705918, -0.07762734606654423, -0.10132754019989082, -0.08173750275148016, -0.13317575290728348, 0.10509601969432111], 
    [0.05614995883021179, 0.11967488830456602, 0.08884870427825205, 0.04242370381607552, 0.0038149415704600287, -0.04690988214852792, -0.05523301375830923, -0.056910035261044684, -0.04320044412623014, -0.04067070631043579, -0.03574479533511635, -0.03462507707100135, -0.03351606226800888, -0.06394578949722765, -0.1005594243297924, -0.14320235832874437, -0.10688320163299034, -0.16170003197495927, 0.1777550497580192], 
    [-0.29589459389618367, 0.0901805861864086, 0.026868883216430307, 0.06594180923111836, 0.039575063405592456, 0.02162658654475351, -0.018104363220232504, -0.027237448775374665, -0.0373875650436139, -0.04534007464498491, -0.06235227280253794, -0.04109988210435089, -0.00831250027198463, 0.003367029710822117, -0.03196290656718867, -0.07537306051837465, -0.04886160463068505, -0.08998642950312911, 0.2938649364287271], 
    [-0.41365424944302753, 0.1777680993449011, 0.05609709947317171, 0.08995838039576991, 0.052866183644749834, 0.012328699482876036, -0.019031566251789644, -0.03133720158670298, -0.023779135011299912, -0.03465260591243635, -0.06758183093149953, -0.07734891380171212, -0.05900414200681581, -0.07006798860489102, -0.12363610700336782, -0.19857110993126456, -0.18056038090832516, -0.22752853542279394, 0.13437234723220748], 
    [-0.9033589332241244, -0.19951193378117374, -0.23635095535605619, -0.0071416836112807025, 0.14751928745067844, 0.2321886265797442, 0.21115149856811288, 0.161772762703297, 0.07483720442365005, -0.02656840662572768, -0.051577883124466484, 0.05804436084366674, 0.2623912538223811, 0.4131073590837422, 0.4556354115575243, 0.4649427579609741, 0.5168340204169551, 0.4898917448648847, 0.7077500878071528]
]

laplacian_of_tiny_width_1_by_height_1 = [[0.]]

# Largest Hessian
largest_hessian_of_noise_width_10_by_height_15 = [
    [9.25656510723867, 8.077654520236816, 9.645738362713704, 10.122934369219386, 15.25268550156017, 2.2519323714391435, -0.26705687470864836, 6.7463568326980905, 10.702796658463962, 2.2271136098817337], 
    [-3.1546597114317425, 5.716802879939343, -9.193695268624085, 13.267132063025798, -12.518396920305477, 8.137007343819434, 1.238538956076944, 1.1586846808118283, -1.6667868125450853, 1.1268950055493892], 
    [-2.092044249329337, 8.201234934863649, 9.039161538020467, 2.751424679386071, 5.855717469376318, -2.875182750072137, 0.8461079195489069, 6.587691232191454, 2.7192592437407135, 1.3921592304846477], 
    [13.975307211794682, -0.7471885106039882, -2.2086367973614593, 6.855008831839098, 2.8874529519000505, 0.5390733318922392, 7.744740255208377, -0.29395616876557995, -1.7146592507106122, 11.431046143074918], 
    [-0.2680551979282282, -1.8736612340434062, 6.635589688071381, -1.7812243301994264, -1.1400077197380136, 8.517571136714873, -6.477494398050593, 7.636735282634158, 5.443652030150734, 0.43432970773215046], 
    [12.711431179602847, 13.464921960368462, -3.6452226466509323, 6.313763528580808, 1.2414566294495437, -2.563807625872836, 1.3143009113604394, 6.835835158149057, -7.267142428233764, 5.977902034776178], 
    [0.6043622641509436, 2.0135301489247905, -0.4192468603741207, 1.5698519269565072, 1.9927570875082798, 6.952422471277675, 5.4436889356011475, 2.9156592133027845, 11.385990324524597, -4.171513049777268], 
    [-0.19927069735485947, 12.13799065126645, 4.852974615723636, 1.29273291152021, -0.11369626019977429, 2.7984328076458094, -1.6792220741738453, -0.9087064436172805, 2.8817571674376805, 1.6631789762968057], 
    [-4.746377090018562, 5.8590105802669115, -3.666621684184366, 5.0123751125093685, 2.2676755324407716, 8.46539310787772, 0.7768683432343894, 7.529271194452663, 5.402304964652048, -0.609694709581946], 
    [6.782779057429105, 3.441126103539472, 3.9555143680036826, 0.8377269527578546, -3.825917191804379, 4.266319573364581, 2.295651741729514, -3.8971286993049183, -0.7349521538965841, 5.020811098779135], 
    [0.8882298187199421, -3.59353407641735, 7.190725161720858, -1.1432605901233426, 9.837330922885283, -6.643568258721058, 10.707277298090197, 10.179250167842072, 15.854257924244251, 9.040673074037926], 
    [9.076177501362313, 7.381861957708597, 6.6275786281490285, 1.8280509454406313, 3.9195853617701735, -0.0777496276945328, 11.428850322442363, -9.22461150754037, 3.0437054287895733, -0.05104224935257373], 
    [2.6327519052904185, -0.8158941787565404, 1.0179090983029642, 0.5398463193510556, 1.9974241354804756, 5.806208123904328, 1.6871143460925397, 5.471788148827933, 10.835343855735339, 6.164625891940884], 
    [10.348221531631523, -2.8857464368985077, 2.610097429081793, 2.304145854497858, 0.9264645988762259, 2.4669994741101307, -1.1664609754047681, 4.480986161560663, -1.8418575659873828, 0.052719644839068325], 
    [6.366300258971515, 3.5343324258298328, 5.789569778818422, 1.3301932667406584, -3.2269170371149607, 6.647306252312247, -0.21778476046826678, -1.2619057343692197, 10.294121926214853, 7.556089413134416]
]

largest_hessian_of_column_width_2_by_height_5 = [[1.5693000000000008, 0.0759600000000007], [-3.748320000000001, 4.810260000000002], [4.2532200000000016, 1.2607199999999996], [2.122980000000001, 1.7064342857142862], [7.485960000000004, -4.440257142857143]]

largest_hessian_of_row_width_3_by_height_1 = [[3.6000000000000023, 0., 6.0000000000000036]]

largest_hessian_of_smooth_width_19_by_height_20 = [
    [0.15159851712044875, 0.1080784211987472, 0.03572552580438493, 0.0850194755837132, 0.07419657186076228, 0.026194236973237556, -0.058973519753712345, -0.11430015795838849, -0.10782584841273352, -0.016699549595813545, 0.14197163910278465, 0.26080977791755494, 0.27255706331521456, 0.17211568706268898, 0.022218158272179933, -0.040223027193036054, -0.0399399542172596, 0.10813249837351413, 0.3219220581165976], 
    [-0.051197034240897575, 0.14253434225440864, 0.0406942876498515, 0.08985372496591831, 0.06001688089633833, 0.05324940798135539, 0.0600728238621232, 0.05847418286755249, 0.046052619018446504, 0.03255108654484563, 0.03785801531403674, 0.06237136357462803, 0.06930784774276585, 0.06160112327409432, 0.03941830236637907, 0.0178501960604013, -0.0053274313527506825, 0.12841382302452053, -0.18184411623319463], 
    [-0.012810380156858404, 0.16000040224997503, 0.05369483333012312, 0.08918258067718246, 0.04177634192340082, 0.024604257256935443, 0.022176865844004922, 0.01176700607496948, 0.012897953807543319, 0.013508280774821482, 0.019371887827484342, 0.0414176635690128, 0.03839489148646467, 0.04544116787580497, 0.04940778151095782, 0.05601712397535773, 0.007693718604202094, 0.15942763722827685, -0.03854559318381956], 
    [-0.041561445131668796, 0.18043886398532843, 0.06269419782413733, 0.0910605179181154, 0.02620335242842725, 0.012803855541495667, 0.022484203382042683, 0.028546606429665125, 0.023951833190871435, 0.01818630759253299, 0.017550352566513792, 0.02614290163943736, 0.01902696144364715, 0.03953026194661674, 0.063408737628218, 0.08629101200566973, 0.05427632748488623, 0.17388329358405136, -0.023973511031527228], 
    [-0.024943839316466355, 0.1891717459521211, 0.0723465266440754, 0.08895766940992339, 0.01233884828967521, -0.011983966704063475, -0.003607866437517398, 0.0022060362627723093, 0.005972103340417172, 0.008638623638640774, 0.016671387130750837, 0.03475321085025304, 0.03365503402534904, 0.039221724541190495, 0.06068623009171023, 0.0917324152823772, 0.07747162841222124, 0.17952570998085815, -0.009560362690071267], 
    [0.027336802397534207, 0.18992012471869896, 0.07194096583455102, 0.08002568428015758, 0.002727092046243257, -0.011287354422388082, -0.012172172524876514, -0.012675999804576094, -0.014797582907589741, -0.015425330153946664, 0.011230907077425618, 0.03429764384188418, 0.013034522675722516, -0.008396294225523489, -0.004723248109944598, 0.05961594043249728, 0.07371590569437306, 0.15987816164721025, -0.03978503820818788], 
    [0.07759662972632948, 0.1783378523499814, 0.0654080809341148, 0.07561701616842431, 0.027291444343483223, 0.012025891897955197, 0.0006896891144312615, -0.009174224218140055, -0.021397707759146345, -0.02005720917592545, 0.013308188331621708, 0.03336469201289, 0.0022257425180505397, -0.03955177290878874, -0.05096743373960849, 0.016405816551164746, 0.06266937728018544, 0.11343736554321557, -0.04129948447717722], 
    [0.05827667869714784, 0.16190055488929195, 0.06842084323925283, 0.07910880530860676, 0.05367567405107829, 0.03616139657170056, 0.02586493489694119, 0.017352066837351177, 0.004386057861146665, -0.006595958916584823, 0.023631256266358053, 0.03818828294020179, 0.006585614143264778, -0.049611191237959984, -0.06000146592788171, -0.02752592855795088, 0.04382923270704366, 0.06477331282905535, 0.16350019018877365], 
    [-0.016703344514920893, 0.14149377356394938, 0.04897611205369161, 0.06509540529031364, 0.046600353089434506, 0.038404230493006807, 0.030310701433872076, 0.02427817654646916, 0.02133197698869756, 0.024131837949441473, 0.04088187221463031, 0.0468233609275864, 0.010682801030579099, -0.02403223441706301, -0.03426722876040174, -0.031890917381963285, 0.02227455780222555, 0.03462360259625247, 0.34698161072250444], 
    [-0.08146330063746438, 0.12007385628920675, 0.032814476504429306, 0.04126956712035963, 0.021628930877450436, 0.023389035785614288, 0.023162213628391593, 0.023046265960710813, 0.030122557041272154, 0.04257330872488965, 0.05687248277768375, 0.05457787959780975, 0.03772014805772357, 0.027761602265570662, 0.01976683649582716, 0.013957355614227085, 0.023125950663094294, 0.043725489591518465, 0.42846916574477156], 
    [-0.09544345293522158, 0.08976507870550877, 0.028349699079500155, 0.02260983988313347, -0.004741856301015886, -0.0005045132756796153, 0.00899623288828864, 0.019249257509050557, 0.02810618924812066, 0.03993120891088884, 0.06745698691653165, 0.05698185403482947, 0.05749531711990178, 0.05475605430478089, 0.048459099148130444, 0.05164352913434566, 0.05390823756871265, 0.0592524017192943, 0.4295167897463844], 
    [-0.01869525095021432, 0.062169695953742596, 0.03550037436762599, 0.014845718292278967, -0.01902656046068366, -0.02355551153093409, -0.006491663133657181, 0.0036827875387884217, 0.01806235520270269, 0.04814140184280179, 0.06759913548001253, 0.050894168402494215, 0.04667358791758888, 0.05058555492098922, 0.05659560476811795, 0.059946908599412055, 0.06618880379337327, 0.07002959604015867, 0.3791911444019349], 
    [0.1291822424938947, 0.04342760730088784, 0.044664574020579786, 0.010723293223134187, -0.019277976028496895, -0.028354100039788846, -0.01518208161869131, 0.005639131026670841, 0.028120782828152485, 0.05739233944471452, 0.06521954260090547, 0.0362924703493509, 0.03480104600739331, 0.040170338305775696, 0.04966401096507699, 0.057526462325715566, 0.06365647112801823, 0.0662160148904556, 0.30643462765038953], 
    [0.2447338548671135, 0.053915464970120425, 0.04864318627445852, 0.010361839385196444, -0.01356549474068399, -0.021343048842472165, -0.007463715967723589, 0.014188699519440894, 0.03731297371454656, 0.05565420710938154, 0.052332830414002565, 0.026409690418309668, 0.0139779030676985, 0.018179170266120686, 0.025614058164865474, 0.029065249133403644, 0.03066731014814851, 0.02567895689313357, 0.22570876444476262], 
    [0.28539100176114524, 0.09298817634611417, 0.05220200125801612, 0.014372216610491914, -0.007815496572448158, -0.00861853130133199, 0.009131004737790173, 0.024880829750141747, 0.040365412932692066, 0.04441160970581329, 0.036078730712718436, 0.02440662319713029, 0.0025332349768010056, -0.009969362994839324, -0.01176152215569063, -0.01626480018130388, 0.004823793715417892, -0.03811663620376112, 0.18288247215672454], 
    [0.1869904067254392, 0.1327427589087419, 0.08953586537762631, 0.039924354025213854, 0.0010424514785376748, -0.0029522192178520665, 0.004197383957929134, 0.017880767318405003, 0.024363093979144462, 0.02565488805327133, 0.018728828141689247, 0.01984696356874171, 0.013828187429409543, -0.005884064445095178, -0.025505961760739382, -0.039987512874011776, -0.008453443843689911, -0.044030593616956326, 0.20192872017060215], 
    [0.07673400834767297, 0.15189692923406933, 0.11297571924990235, 0.07668200687738175, 0.026703333604351523, -0.014259018157304385, -0.00008038024739797385, 0.007179210466113273, 0.014381840392504945, 0.006570895473413934, -0.0017294593116893501, 0.01253180762546441, 0.026398268875735043, 0.009775510413780388, -0.017154637670927862, -0.050397631703344034, -0.0141157356380805, -0.059178621308911175, 0.2601710269499439], 
    [-0.03865915609360429, 0.1498088636387791, 0.08249897531989976, 0.09662904771562472, 0.05663965688035738, 0.021003528812233288, 0.008117342831280287, 0.012831906159471416, 0.009383585894837789, -0.0022835556597178676, -0.030163861579354828, 0.0039419122888569354, 0.03527134672121301, 0.03621432670372861, -0.0015942084236595514, -0.025049794984761148, -0.01937037939271458, -0.012706731771412202, 0.2933683271847473], 
    [0.017902616026744145, 0.16535937030700976, 0.09423924939238534, 0.1167577561997396, 0.08256555387913592, 0.038978106530501044, 0.006130459459557377, 0.009665900884959024, 0.018528296394623982, 0.006767181521736986, -0.008952831245908047, 0.00042289082697722296, 0.039330947101026484, 0.04805907266261705, 0.010519542009749439, -0.044795059174729264, -0.018172033453372663, -0.06435623612947841, 0.27594280701620183], 
    [-0.3989513080133721, 0.13881525042150508, -0.008853376475268404, 0.06459825547956849, 0.07905893289368399, 0.1746283002872907, 0.19185315829492128, 0.15852645008851707, 0.08912079515596139, 0.02754354305980683, 0.02969072740108386, 0.11085796905593095, 0.239868210447774, 0.36038592436990635, 0.44304419378747484, 0.502029063755008, 0.5310800150108691, 0.5278214606951951, 0.4817852298919974]
]

largest_hessian_of_tiny_width_1_by_height_1 = [[0.]]

# Smallest Hessian
smallest_hessian_of_noise_width_10_by_height_15 = [
    [-0.04157439881613101, 3.2691487976322615, -9.579020791712914, 8.512318402369601, -4.944716685164633, -1.0910798395504562, -1.6450128005919356, -1.0178811690714025, 5.170537476877545, -7.214268738438774], 
    [-7.1131302144773345, -8.872792497549483, -12.044399436825518, -5.768616370539688, -13.248966091693887, 3.381967873572268, -2.1756953509437778, -6.949133307362279, -7.334596515481609, -0.1462272197634671], 
    [-2.830120014798374, 2.4565867363907854, -3.1858331026131723, -0.7960754780412115, 0.40343960610276003, -5.628930769770324, -3.1696460351102584, 3.749921210087689, -4.036001095462313, -7.0122047308278646], 
    [12.424965149833522, -7.333759315220177, -5.3238045843601025, 4.651618810879896, -3.077656458613152, -2.156381743314022, 2.330655912299711, -6.159606941984034, -5.822829452038153, 10.093387791342957], 
    [-18.295184597849385, -8.781739907129323, 1.2466451096598867, -7.546455493815714, -2.528852827963761, 6.047666076909431, -11.95759484972415, 2.5081854432053983, -3.057035574611296, -7.535979841471798], 
    [-4.158294191638923, 7.266730097183238, -10.916123997180765, 4.040623796236895, -1.2361447832057086, -9.836793083573278, -1.205165171010413, -0.32569435142357905, -9.49105200527067, 4.780873222812268], 
    [-2.5205401205619977, -11.468997837292912, -2.9056892643611176, -2.587109193555121, -1.819504857079296, 0.3975746734152151, 0.5498922009399676, -5.5381140872429135, 10.861019788581876, -14.960362264150948], 
    [-15.040046614872368, 9.94801154446935, -5.304125722303562, 0.49909432765180944, -1.2451242487884842, -4.089007210452571, -3.3269923373868817, -5.265411833681391, -6.6896611959780525, -3.504423973362931], 
    [-6.623324898261194, -6.881253487642571, -7.337881419958626, -0.3485503690065207, -6.0431078060880195, 2.466879241749295, -6.728017286732747, 2.9353867183898767, -0.7621932292278047, -1.1372028554099531], 
    [2.341777136514984, -3.013018526968334, 2.6386656553331815, -0.062057309485465964, -7.205733130626523, 3.2451692785109074, -2.2366570204742886, -9.71412666514762, -10.906807333436852, -2.2923675546569937], 
    [-8.116739139697856, -5.188680255528909, -2.8868478852945336, -7.371592855954818, 5.03800889279781, -12.923534378171134, 0.6860860271279233, -9.170784810073874, 7.050067771722216, -3.8812494265630817], 
    [1.9890030336662967, -3.0765110966168, 5.524628358236131, -4.644492375987522, -3.554448131150416, -7.116527788709888, 0.6486519328994367, -9.814596556860142, -14.25079101167049, -8.880324741494704], 
    [-6.155970865751393, -3.289282651015478, -4.635657309541097, -2.225067476649532, -0.7369085821146476, 1.7182273380579935, -1.7357836220156178, -1.9784566910954684, 2.7221114775651283, -3.485300924898262], 
    [3.739705961643256, -8.0673614780242, -2.9456862652979883, -1.72085664270379, -1.3351419563888136, -4.3265154038901805, -4.22668026947446, 0.17821194316415595, -9.755825576120454, -6.796178826268826], 
    [-3.3488529808216283, -6.966600517943028, 5.108101812800593, 0.853475482893199, -6.246874879763228, 3.2586607395848097, -4.358350129485757, -1.8270802954256724, 4.875973066962635, -4.621986533481318]
]

smallest_hessian_of_column_width_2_by_height_5 = [[-0.0759600000000007, -3.064662857142857], [-4.810260000000001, 0.7853057142857145], [0.9634800000000014, -0.9634800000000014], [-1.1157000000000008, -2.122980000000001], [-0.3476999999999995, -7.485960000000004]]

smallest_hessian_of_row_width_3_by_height_1 = [[0., -4.8000000000000025, 0.]]

smallest_hessian_of_smooth_width_19_by_height_20 = [
    [-0.29403921059937366, 0.07739459354266837, 0.029238287188919077, 0.0032545412881754276, -0.01733472709974873, -0.07856525129432315, -0.16155194227267744, -0.19723560681726382, -0.1451181590869538, -0.054396448390677116, 0.02541164197544172, 0.09074988048891021, 0.10358883606891753, 0.05889477523541961, -0.009167937010595928, -0.0811928521111662, -0.04750929704316975, 0.025982844062074184, -0.12399142203103708], 
    [-0.37153064073910785, -0.034262247861529725, -0.017885347201443722, -0.0005661483254675933, 0.0081804216097084, -0.0060269578357074515, -0.05086457785132438, -0.08651236265180369, -0.09188308863486773, -0.08037544277312228, -0.0808406840496613, -0.10460990186961236, -0.10890665400364104, -0.09927479641781314, -0.08160074320692921, -0.03303769563496638, -0.061615035077129704, -0.13726137390977164, -0.3377087229308888], 
    [-0.43633278824155486, -0.011572670968187369, 0.0006436593014263211, 0.004251702620467579, 0.010600108947546589, -0.0080916728743757, -0.04063737609322125, -0.060497939876732444, -0.06480140875207874, -0.05001807652117342, -0.02304227846950905, -0.0002488121244058735, -0.003025208005339543, -0.018012725557199526, -0.02582544539945287, -0.005206634458287232, -0.0029558432935701553, -0.02087242136019731, -0.4918138636267402], 
    [-0.4772034324959766, -0.026291431102751193, -0.017313692207865918, -0.008389346515280522, -0.00023339994468491427, -0.014464758345582996, -0.03597100635675407, -0.036714184467048376, -0.051868973720787276, -0.039747555652248814, -0.016825542244711444, -0.005397297921794191, 0.0113026470703027, -0.0035909739887057235, -0.0076827137657196065, 0.026183435540127295, 0.015726086076443126, 0.008168694293461133, -0.5307484727944418], 
    [-0.4752512138511972, -0.017393744610901575, -0.0109911662773171, -0.010735604325802913, -0.015175120531425794, -0.02190599471192204, -0.02932044697948613, -0.027439659801438684, -0.04252457275130453, -0.034751020263118146, -0.012307012862078337, -0.0004101922111717173, 0.00008648370682511468, -0.01462014472209464, -0.008750992799690311, 0.022085455633946784, 0.0012545707119801025, 0.00529005730382759, -0.46698171252690146], 
    [-0.44521009549328916, 0.025657203821954622, 0.015328403323763961, 0.0032928522259369707, -0.006935144786246896, -0.0240371084619396, -0.026863736199705918, -0.02473285518178553, -0.036795724837994134, -0.033171604433821736, -0.02926181197329321, -0.030413162972957788, -0.03449024119057269, -0.03531131586285097, -0.033135674432109075, -0.0244320707436075, -0.03595036984096458, -0.0508140032096203, -0.3035142848248761], 
    [-0.4098932861421072, 0.06954459607910642, 0.056264908300639946, 0.03849370385106386, -0.0021565118884385604, -0.024310807085764743, -0.027193277487954453, -0.02618185740121455, -0.03520055474490483, -0.03112167915596013, -0.047308886889804336, -0.06452683532831655, -0.07925963751528554, -0.08047716005832369, -0.06738568805368106, -0.0652870740435984, -0.06929251386633406, -0.0928426825644562, -0.07079469018049744], 
    [-0.38694465929717176, 0.05844812157148221, 0.04352253515118813, 0.03405516143846757, -0.003613588943513503, -0.026197705018215774, -0.02920670653768142, -0.034450317853828114, -0.04228193631891548, -0.04463117580961454, -0.051556830352163345, -0.061047475048297245, -0.07254190442156885, -0.08875182717596322, -0.08043409409181666, -0.07111867185081613, -0.05945220972250057, -0.08783049246549923, -0.005017023883103211], 
    [-0.35841986451458735, -0.004587352145371175, 0.010934870232120345, 0.012524491681814272, -0.010887046976721224, -0.02674688149111843, -0.036445405607477256, -0.051734774448868016, -0.05832208719283751, -0.036151180968030286, -0.01757990975287238, -0.018513549165924133, -0.022266312535898336, -0.05442738851090273, -0.07743232354866242, -0.05752913721517608, -0.017845744074538015, -0.08336492962343972, 0.04936758000959024], 
    [-0.29116276544880393, -0.06647445281564396, -0.04090996366839051, -0.02045416884350577, -0.01987187245535576, -0.03113054818114329, -0.049360293935780994, -0.06465852392994632, -0.052039966743163246, -0.011636985424150374, 0.02309170443656941, 0.03842439706153383, 0.011794398874789168, -0.04783926626940849, -0.0726405813543095, -0.06492330622952788, 0.004052363206550348, -0.0954945994934511, 0.06554670384474182], 
    [-0.16669666396022018, -0.10353393347829225, -0.08225186459962729, -0.055533982942081964, -0.03145593969229508, -0.038319108395810667, -0.05608366228603577, -0.05915348627435281, -0.03419255125693328, 0.017137143531454156, 0.05295320227837039, 0.05162932288473218, 0.004740724867301133, -0.04375874352780017, -0.06688341295172631, -0.05611132172330905, -0.0024248626391655723, -0.10418476198032446, 0.07244560461144273], 
    [-0.07676288762164922, -0.09940433585637279, -0.08430893080245425, -0.07120306609594503, -0.04847252125844448, -0.04003713854386119, -0.0539127350725469, -0.04801618093372943, -0.010597035659436567, 0.033401584287974795, 0.03858258191645021, 0.045759482497731686, -0.005321505140501833, -0.04184095989653612, -0.05246009886781612, -0.05002398506653962, -0.0012083334555146876, -0.09598598335858978, 0.07067087770948755], 
    [-0.02950499657818173, -0.07612934238321817, -0.06559615963141796, -0.07268870200277257, -0.067184152018399, -0.05550773126941054, -0.051232432122540056, -0.030867131546555626, 0.0010870484311954237, 0.021902176760387214, 0.030521398512536543, 0.03043493638285262, -0.007136168007814693, -0.037336220813756794, -0.04233020532506618, -0.04336623398554317, -0.0020497623774180383, -0.0788900953647256, 0.0648708845506066], 
    [0.05678287393437609, -0.03340903252312437, -0.014735270148933395, -0.05209977766739717, -0.07063224378226482, -0.07547872492287265, -0.05348150212373663, -0.033050869917666675, -0.006171683541789201, 0.011980568798480442, 0.017660445546169395, 0.015116173651993853, -0.005484823250877318, -0.02936807552688384, -0.039158100144495736, -0.04022799168159044, -0.007605679350623714, -0.058303086574133044, 0.0058455840880861434], 
    [0.1383735008406778, -0.025329498498753395, 0.03565856591516574, -0.028680311512842237, -0.0585910401101376, -0.07836881023219161, -0.06073092819303065, -0.042886641484000114, -0.017613119934171348, 0.0023361245086913145, 0.009356523180036, 0.0015839643508598243, -0.008605533336179676, -0.02119017964547349, -0.04063682970789686, -0.04720055520638382, -0.0316119225529695, -0.05301707977029949, -0.07025322090295125], 
    [0.13972312270291234, -0.024460440019443964, 0.008131830264036015, -0.028449020699008246, -0.03625650842357479, -0.06062988752399772, -0.06640154328202248, -0.056445818397393474, -0.04316261125887902, -0.02423391195492669, -0.018000820016884207, -0.027231065319209137, -0.03491082351189655, -0.040877973431964004, -0.052121384305804846, -0.061340027325879044, -0.07328405890779024, -0.08914515929032715, -0.09683270047628104], 
    [-0.020584049517461178, -0.03222204092950331, -0.024127014971650297, -0.03425830306130622, -0.02288839203389149, -0.032650863991223536, -0.055152633510911264, -0.06408924572715796, -0.05758228451873509, -0.04724160178384972, -0.034015336023427004, -0.047156884696465756, -0.05991433114374392, -0.07372129991100804, -0.08340478665886453, -0.09280472662540033, -0.09276746599490984, -0.1025214106660481, -0.08241597719192469], 
    [-0.2572354378025794, -0.0596282774523705, -0.05563009210346946, -0.03068723848450637, -0.01706459347476491, 0.0006230577325202225, -0.02622170605151279, -0.04006935493484608, -0.046771150938451696, -0.04305651898526704, -0.03218841122318311, -0.04504179439320783, -0.04358384699319764, -0.03284729699290649, -0.03036869814352912, -0.050323265533613507, -0.02949122523797047, -0.07727969773171692, 0.000496609243979762], 
    [-0.4315568654697717, 0.012408729037891315, -0.03814214991921362, -0.026799375803969697, -0.029699370234386086, -0.026649407047625015, -0.025162025711347024, -0.041003102471662, -0.0423074314059239, -0.041419787434173336, -0.05862899968559148, -0.07777180462868935, -0.09833508910784229, -0.11812706126750808, -0.13415564901311727, -0.1537760507565353, -0.1623883474549525, -0.16317229929331553, -0.14157045978399435], 
    [-0.5044076252107523, -0.3383271842026788, -0.22749757888078778, -0.07173993909084919, 0.06846035455699445, 0.057560326292453515, 0.0192983402731916, 0.0032463126147799365, -0.014283590732311335, -0.05411194968553451, -0.08126861052555034, -0.05281360821226422, 0.022523043374607102, 0.05272143471383586, 0.012591217770049484, -0.03708630579403388, -0.01424599459391393, -0.037929715830310406, 0.2259648579151553]
]

smallest_hessian_of_tiny_width_1_by_height_1 = [[0.]]

# Hessian Orientation
hessian_orientation_of_noise_width_10_by_height_15 = [
    [1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 3.141592653589793, 1.5707963267948966, 3.141592653589793, -1.5707963267948966, 1.5707963267948966, 1.5707963267948966, -1.5707963267948966], 
    [3.141592653589793, 3.033601921529267, -2.392860176964733, -3.0883162152835855, 2.413383510784343, 3.079700135995576, -1.2194421680471217, -2.9885516782194133, -3.056434492279988, 3.141592653589793], 
    [-1.5707963267948966, 1.2350348518779275, 1.6341443666610571, 2.812604072971737, 1.2751245740535515, -2.609259073556025, 2.915246474329758, 1.3426256831939054, -1.2656618937212385, 3.141592653589793], 
    [1.5707963267948966, -1.3845560044889935, 2.867267906719761, 1.0427858065026359, -0.9890106243710113, -1.80321184491372, 1.1651029733656015, 2.790891289736457, -1.5671751676507717, 1.5707963267948966], 
    [3.141592653589793, 3.0420472168073127, 0.8812729812217575, 3.03170228496207, -2.058960486220809, -2.8373969063140256, -1.1179572427890472, -3.132464358417538, 1.3164002390166272, 3.141592653589793], 
    [1.5707963267948966, 1.1067011741955293, -1.5064485210406067, 2.6355327953903815, -2.493029886002448, 2.89029802429542, 1.4356873434290829, -3.0644616275000165, -3.1069905206912884, 3.141592653589793], 
    [3.141592653589793, 2.8892808448475136, -1.879988929637951, -2.8073882380585116, 2.1524280169417778, 1.50623268181169, 1.0547630628407758, -1.4030780958966866, 2.9294867289468427, -1.5707963267948966], 
    [-1.5707963267948966, 2.895572801263368, -1.5841068156671605, 2.543632691600434, -1.7516438050392578, -3.033908129604782, 2.814840693182565, -3.0124463679985296, 3.0794544342075323, -1.5707963267948966], 
    [-1.5707963267948966, -3.037951245019043, 2.5380387043653685, -2.8312602454520936, -1.4991460067040736, 2.9239110411045037, -1.744462203660326, 1.419212774284944, 1.7822639185093871, 3.141592653589793], 
    [1.5707963267948966, 1.7225334539221457, 1.0608437095199474, -3.0952323386804714, -2.427507167343594, -3.101470023650686, 2.645010325388354, 3.087198998011833, 2.997177774118107, 3.141592653589793], 
    [3.141592653589793, 3.016261279079182, -3.071722960733016, -1.520700390295439, -2.93443065789776, -1.5634382262385065, 3.064922598301595, 1.519921841563369, 1.5029781779118734, 1.5707963267948966], 
    [1.5707963267948966, 1.4668915195597034, 1.8029687920309685, -1.5787892427583292, 2.880966159087876, -1.5430189525574405, -2.9377535504590098, -2.911514391953325, -3.09882003975858, 3.141592653589793], 
    [3.141592653589793, -2.4551186018484707, 2.8495459326363353, 2.4830751317640956, 1.6469899708528046, 1.196817508197942, -1.006324550469897, 1.7502461048062594, 1.3427991648272755, 1.5707963267948966], 
    [3.141592653589793, -1.4063185363168296, 3.075073872573296, -2.4584195330501113, -1.7052357728202348, 3.0636438945749074, -1.7372107304353273, 2.9682841717657333, 3.0561896297873004, 3.141592653589793], 
    [3.141592653589793, -1.5707963267948966, 1.5707963267948966, 3.141592653589793, -1.5707963267948966, 3.141592653589793, -1.5707963267948966, 3.141592653589793, 1.5707963267948966, 1.5707963267948966]
]

hessian_orientation_of_column_width_2_by_height_5 = [[1.5707963267948966, 3.141592653589793], [-1.5707963267948966, 3.141592653589793], [1.5707963267948966, 1.5707963267948966], [3.141592653589793, -1.5707963267948966], [3.141592653589793, -1.5707963267948966]]

hessian_orientation_of_row_width_3_by_height_1 = [[3.141592653589793, -1.5707963267948966, 3.141592653589793]]

hessian_orientation_of_smooth_width_19_by_height_20 = [
    [-1.5707963267948966, 3.141592653589793, 3.141592653589793, 3.141592653589793, 3.141592653589793, 3.141592653589793, 3.141592653589793, 3.141592653589793, 3.141592653589793, -1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 3.141592653589793, 3.141592653589793, 1.5707963267948966, 1.5707963267948966], 
    [-1.5707963267948966, 2.964726471969636, 2.98588734398242, 3.116467917602823, 2.9206721220516596, 2.227941512866826, 1.8241340295662356, -1.5662708976206297, -1.811150633154467, -2.162681439956473, -2.6658621364855737, -3.0073681860134447, 3.0411328976323833, 2.7903612541390928, 2.554236565952445, 2.696739862567795, -2.648038077209871, -2.8049005108440803, -1.5707963267948966], 
    [-1.5707963267948966, 3.0532739941003317, -3.120166494864568, -3.0625077978625, 3.0988954442507146, 2.1752797344008568, -1.2294147573436172, -1.494827909918602, -1.7591836957384668, -1.987460856771107, -2.3647611736363725, -2.9254028829263548, 2.8726373719433087, 2.4984341282977263, 2.359704406356762, 2.66556524353973, 2.9488473537990845, -2.995903861924592, -1.5707963267948966], 
    [-1.5707963267948966, 3.129151023055968, -3.0230935348581522, -3.007736499899953, -2.9522702452642635, -1.1722231560898069, -1.3016336652829592, -1.4904076987265815, -1.6787197560362175, -1.8366132809157518, 0.9140829040191957, -2.7614220115492056, 2.974482687644768, 2.031942736909885, 2.0830802725886213, 2.409919485060428, 2.1913439785613478, 3.093289237788479, -1.5707963267948966], 
    [-1.5707963267948966, -3.0846389116254196, -2.9473492932604004, -2.9849537400773456, -2.8898924425385797, -1.274584224967715, -1.3793935337477585, -1.5258318016988615, -1.665486557556031, -1.812948965134047, 0.9640211139167143, -2.4310700891541144, 1.074195291204157, 1.569581497368589, 1.856752960715375, 2.3650336744162517, 2.3268523623972714, 2.858844257239329, -1.5707963267948966], 
    [-1.5707963267948966, -3.0458887978570117, -2.933703392126002, -3.055815036728555, -3.036483661542141, -1.4858975929137515, -1.5297613706793418, -1.6241840059058121, -1.7108742121124385, -2.151286296680344, -2.6957859718117128, -2.7533526036493186, -2.548805316085171, -2.039045344824367, -1.1736796606722084, 2.601219917864722, 2.567778007399724, 2.7356795095843274, -1.5707963267948966], 
    [-1.5707963267948966, -3.070347944422331, 2.869348915897068, 2.8849693653077737, 1.972784115087532, -1.3540568840591594, -1.3478012981632594, -1.209017664531784, -1.266995609667397, -3.089346123029691, -3.0132298318314232, -2.979909579045897, -2.8702863723694763, -2.7227168311816903, 3.0568893535946637, 2.7527127952879784, 2.6987372877387696, 2.627688188548818, -1.5707963267948966], 
    [-1.5707963267948966, -3.1311707015025094, 2.413176871123542, 2.537227475213108, 2.045777085456668, 1.8906299448151216, -1.2656107518535091, -1.18258895832939, -1.023730336833407, 2.61039372884585, 3.0557674688220526, -3.10306709142572, -2.9889798620428643, -2.6898844632021834, -2.6542794801046576, 2.7791889601796105, 2.746125898994562, 2.4121961492241697, 3.141592653589793], 
    [-1.5707963267948966, -3.0746302219593566, 2.9152904146658494, 2.685965118673557, 2.204570089445795, 2.028810234801355, -1.1486078156733086, -1.083086531397584, -0.966276797322776, 2.4129670634175473, 2.8799058387846133, 3.1015657576709255, -3.014818747334228, -1.8949949690059076, -1.8211094425631944, -1.587622986391794, 2.765828277613114, -1.153261149221591, 3.141592653589793], 
    [-1.5707963267948966, -2.96513883862351, -3.0276013418983667, 3.011567612181121, 2.461381631835528, -0.9576833997818038, -1.0419029351279856, -1.0551905935813393, -1.0230446815674226, 2.2988518050748072, 2.7644788219294205, 3.0583910747114764, 1.6140716823454695, -1.5667030771850756, -1.6110508525248008, -1.666813809535086, 1.3138498084711772, -1.5075433859043763, 3.141592653589793], 
    [-1.5707963267948966, -2.8654238136838948, -2.883113478598256, -2.9618855541877847, 2.963910805242764, -0.8489263817665214, -1.0362532491747396, -1.1063102283180204, -1.0950763493006914, 2.240624954006509, -3.1006246481298154, 1.1961516765325586, 1.6624814578467422, 1.6540260038582333, -1.5605884532674281, -1.650013562567045, 1.3362575544634365, -1.654821193410452, 3.141592653589793], 
    [3.141592653589793, -2.7392080074252485, -2.763005870054265, -2.714428437940595, -2.6560701784890437, -1.075881981168104, -1.1301028527996073, -1.1808310933957529, 1.842212357139121, -2.636750629314452, -2.769524615937022, 0.8003769779060768, 1.6745387629139956, 1.654540831992482, 1.5676119406437883, 1.472728787619308, 1.339347984639157, -1.7186674677957092, 3.141592653589793], 
    [3.141592653589793, -2.544514265129295, -2.674138448490393, -2.53047365829635, -2.3124823692551773, -1.8109318194931197, -1.4598358615486335, -1.5671803435702463, 1.118189753392344, -2.5961009934335286, -2.7592055407363376, -2.5754788162799174, 1.6580028193313838, 1.5744086562019008, 1.4978172181592089, 1.4272077960819642, 1.288682943070262, -1.7759294545254614, 3.141592653589793], 
    [3.141592653589793, 1.1003633146436442, -2.5197667454751658, -2.2560857986519216, -2.085230151633977, -1.9049560774429954, -1.9038811444808452, -2.0212593183540597, 0.8458797186512289, -2.606757850064337, -2.86905192413671, -3.1402319261325835, 1.6070634078481758, -1.700494477266803, -1.7843104457575156, -1.8071731275829452, 1.047234266313015, -1.9020976201211361, 3.141592653589793], 
    [3.141592653589793, 1.638873382300212, 1.639711923355881, -1.6803086230159574, -1.8371639930769266, -1.934485010733844, -2.0693767320156535, -2.168420232976029, 0.8008547422702357, -2.6075610930544353, -2.9911622223517393, 2.8543983314175714, 2.6684068791021525, -2.185802067676079, -2.134222956656811, -2.113681899469466, -2.868710757465287, -2.6239663979006136, 3.141592653589793], 
    [3.141592653589793, 2.0104588855090677, 2.2078301676091723, 2.0529089920197414, -1.4771762662556729, -1.9549868506497228, -2.199854882989129, -2.351509905042131, -2.5047303506015006, -2.730749270172729, 3.135467645724485, 2.82893578631062, 2.8463218983056886, 3.0469312428278985, -2.9094960171192183, -2.8179765327390838, 3.115093143095323, 2.7739852395737152, 3.141592653589793], 
    [1.5707963267948966, 2.319939709582134, 2.293943867854425, 2.2835893018644127, 2.2223148062930593, -1.9134994606167723, -2.330137072481177, -2.4583896211726213, -2.5794905620049207, -2.7175605177873132, 3.0997758662550425, 2.746329837343498, 2.806379973931403, 2.9298702516336697, 3.079420964391367, 3.1075700057370708, 3.0479912197129444, 2.6093057849881895, 3.141592653589793], 
    [-1.5707963267948966, 2.6693426308584156, 2.4282423051616426, 2.460233454597242, 2.361282499598377, 2.066175968705453, -2.113045335468501, -2.3315371640687355, -2.4540611318390226, -2.519097731996822, 3.03363794042329, 2.5106120368781295, 2.6335478097852323, 2.7203109478610497, 2.681291638332126, -1.3980455689957203, 2.560328715715038, -1.4789625401790127, 3.141592653589793], 
    [-1.5707963267948966, 2.6973941150865772, 2.211042889941409, 2.4650177760945686, 2.562905495699914, 2.79931795372375, -2.924200723840527, -2.5040771684343803, -2.32909225070206, -1.986383542255169, -1.34784504744644, 2.395130088753309, 2.7444146681907204, 2.9020455539652947, 2.9731274504047978, 3.0157076041967845, 3.1017932100005354, -3.0168628300977134, 3.141592653589793], 
    [-1.5707963267948966, 3.141592653589793, 3.141592653589793, 3.141592653589793, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, -1.5707963267948966, -1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966, 1.5707963267948966]
]

hessian_orientation_of_tiny_width_1_by_height_1 = [[1.5707963267948966]]

##############################################################################
# 4) Helper to compare angles, allowing certain offsets
##############################################################################

def assert_angle_allclose(actual, expected, offsets, rtol, atol, period=2*np.pi):
    """
    Compare two angle arrays (in radians) allowing each pixels difference
    to be near one of the given offsets. The difference is wrapped to
    [-period/2, period/2] to handle circular equivalences.
    """
    best_diff = None
    for off in offsets:
        alt = expected + off
        # Wrap differences to [-period/2, period/2]
        delta = actual - alt
        delta_wrapped = (delta + period/2) % period - period/2
        this_diff = np.abs(delta_wrapped)
        if best_diff is None:
            best_diff = this_diff
        else:
            best_diff = np.minimum(best_diff, this_diff)

    valid_mask = ~np.isnan(expected)
    np.testing.assert_allclose(best_diff[valid_mask], 0.0, rtol=rtol, atol=atol)

##############################################################################
# 5) Individual test functions
#    We define a single tolerance (rtol, atol) at module scope,
#    then each test uses them.
##############################################################################

RTOL = 1e-12
ATOL = 1.0

@pytest.mark.parametrize("image_data, expected_data", [
    (noise_width_10_by_height_15,  gradient_magnitude_of_noise_width_10_by_height_15),
    (column_width_2_by_height_5, gradient_magnitude_of_column_width_2_by_height_5),
    (row_width_3_by_height_1, gradient_magnitude_of_row_width_3_by_height_1),
    (smooth_width_19_by_height_20, gradient_magnitude_of_smooth_width_19_by_height_20),
    (tiny_width_1_by_height_1, gradient_magnitude_of_tiny_width_1_by_height_1),
])
def test_gradient_magnitude(image_data, expected_data):
    """Test gradient magnitude for both 'noise' and 'smooth' images."""
    diff = differentialsNoNorm(np.array(image_data, dtype=np.float32))
    diff.run(differentials.GRADIENT_MAGNITUDE)
    computed = diff.image
    expected = np.array(expected_data, dtype=np.float32)
    np.testing.assert_allclose(computed, expected, rtol=RTOL, atol=ATOL)


@pytest.mark.parametrize("image_data, expected_data", [
    (noise_width_10_by_height_15,  gradient_direction_of_noise_width_10_by_height_15),
    (column_width_2_by_height_5, gradient_direction_of_column_width_2_by_height_5),
    (row_width_3_by_height_1, gradient_direction_of_row_width_3_by_height_1),
    (smooth_width_19_by_height_20, gradient_direction_of_smooth_width_19_by_height_20),
    (tiny_width_1_by_height_1, gradient_direction_of_tiny_width_1_by_height_1),
])
def test_gradient_direction(image_data, expected_data):
    """
    Test gradient direction for both 'noise' and 'smooth' images.
    We adjust computed angles to match the Java convention:
      angle_java = (pi/2) - angle_python
    Then allow offsets (0, /2) in assert_angle_allclose.
    """
    diff = differentialsNoNorm(np.array(image_data, dtype=np.float32))
    diff.run(differentials.GRADIENT_DIRECTION)
    computed = diff.image
    computed_adjusted = np.pi/2 - computed
    expected = np.array(expected_data, dtype=np.float32)
    offsets = [0.0, np.pi/2]
    assert_angle_allclose(computed_adjusted, expected, offsets, RTOL, ATOL)


@pytest.mark.parametrize("image_data, expected_data", [
    (noise_width_10_by_height_15,  laplacian_of_noise_width_10_by_height_15),
    (column_width_2_by_height_5, laplacian_of_column_width_2_by_height_5),
    (row_width_3_by_height_1, laplacian_of_row_width_3_by_height_1),
    (smooth_width_19_by_height_20, laplacian_of_smooth_width_19_by_height_20),
    (tiny_width_1_by_height_1, laplacian_of_tiny_width_1_by_height_1),
])
def test_laplacian(image_data, expected_data):
    """Test Laplacian for both 'noise' and 'smooth' images."""
    diff = differentialsNoNorm(np.array(image_data, dtype=np.float32))
    diff.run(differentials.LAPLACIAN)
    computed = diff.image
    expected = np.array(expected_data, dtype=np.float32)
    np.testing.assert_allclose(computed, expected, rtol=RTOL, atol=ATOL)


@pytest.mark.parametrize("image_data, expected_data", [
    (noise_width_10_by_height_15,  largest_hessian_of_noise_width_10_by_height_15),
    (column_width_2_by_height_5, largest_hessian_of_column_width_2_by_height_5),
    (row_width_3_by_height_1, largest_hessian_of_row_width_3_by_height_1),
    (smooth_width_19_by_height_20, largest_hessian_of_smooth_width_19_by_height_20),
    (tiny_width_1_by_height_1, largest_hessian_of_tiny_width_1_by_height_1),
])
def test_largest_hessian(image_data, expected_data):
    """Test the largest Hessian eigenvalue for both 'noise' and 'smooth'."""
    diff = differentialsNoNorm(np.array(image_data, dtype=np.float32))
    diff.run(differentials.LARGEST_HESSIAN)
    computed = diff.image
    expected = np.array(expected_data, dtype=np.float32)
    np.testing.assert_allclose(computed, expected, rtol=RTOL, atol=ATOL)


@pytest.mark.parametrize("image_data, expected_data", [
    (noise_width_10_by_height_15,  smallest_hessian_of_noise_width_10_by_height_15),
    (column_width_2_by_height_5, smallest_hessian_of_column_width_2_by_height_5),
    (row_width_3_by_height_1, smallest_hessian_of_row_width_3_by_height_1),
    (smooth_width_19_by_height_20, smallest_hessian_of_smooth_width_19_by_height_20),
    (tiny_width_1_by_height_1, smallest_hessian_of_tiny_width_1_by_height_1),
])
def test_smallest_hessian(image_data, expected_data):
    """Test the smallest Hessian eigenvalue for both 'noise' and 'smooth'."""
    diff = differentialsNoNorm(np.array(image_data, dtype=np.float32))
    diff.run(differentials.SMALLEST_HESSIAN)
    computed = diff.image
    expected = np.array(expected_data, dtype=np.float32)
    np.testing.assert_allclose(computed, expected, rtol=RTOL, atol=ATOL)


@pytest.mark.parametrize("image_data, expected_data", [
    (noise_width_10_by_height_15,  hessian_orientation_of_noise_width_10_by_height_15),
    (column_width_2_by_height_5, hessian_orientation_of_column_width_2_by_height_5),
    (row_width_3_by_height_1, hessian_orientation_of_row_width_3_by_height_1),
    (smooth_width_19_by_height_20, hessian_orientation_of_smooth_width_19_by_height_20),
    (tiny_width_1_by_height_1, hessian_orientation_of_tiny_width_1_by_height_1),
])
def test_hessian_orientation(image_data, expected_data):
    """
    Test Hessian orientation for both 'noise' and 'smooth' images.
    We allow offsets of 0, /2, , 3/2 because eigenvectors
    can flip direction or swap sign, leading to these shifts in angle.
    """
    diff = differentialsNoNorm(np.array(image_data, dtype=np.float32))
    diff.run(differentials.HESSIAN_ORIENTATION)
    computed = diff.image
    expected = np.array(expected_data, dtype=np.float32)

    # Potential offsets for orientation equivalences
    offsets = [
        0.0,
        np.pi/2,  -np.pi/2,
        np.pi,    -np.pi,
        3*np.pi/2, -3*np.pi/2
    ]
    assert_angle_allclose(computed, expected, offsets=offsets, rtol=RTOL, atol=ATOL)
