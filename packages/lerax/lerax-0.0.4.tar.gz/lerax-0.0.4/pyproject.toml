[project]
name = "lerax"
version = "0.0.4"
description = "Deep Reinforcement Learning with JAX and Equinox."
readme = "README.md"
requires-python = ">=3.13"
license = "GPL-3.0-or-later"
license-files = ["LICENSE"]
authors = [{ name = "Theodore Pinkerton", email = "ted@tedpinkerton.ca" }]
dependencies = [
  "diffrax",
  "distreqx",
  "equinox",
  "jax",
  "jaxtyping",
  "optax",
  "rich",
  "tensorboard",
  "tensorboardX",
]

[project.urls]
documentation = "https://docs.tedpinkerton.ca/lerax"
homepage = "https://github.com/RunnersNum40/lerax"
issues = "https://github.com/RunnersNum40/lerax/issues"
source = "https://github.com/RunnersNum40/lerax.git"

[project.optional-dependencies]
compatibility = ["gymnasium", "stable-baselines3", "gymnax", "flax"]
docs = ["zensical", "mkdocstrings-python"]
mujoco = ["mujoco-mjx"]
render = ["pygame", "imageio", "imageio-ffmpeg"]

[dependency-groups]
dev = [
  "gymnasium",
  "gymnax",
  "mkdocstrings-python",
  "mujoco-mjx",
  "pygame",
  "pyright",
  "pytest",
  "pytest-cov",
  "pytest-xdist",
  "ruff",
  "stable-baselines3",
  "zensical",
]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.build.targets.wheel]
packages = ["lerax"]

[tool.hatch.build.targets.sdist]
include = ["lerax", "README.md", "LICENSE", "pyproject.toml"]

[tool.pyright]
reportIncompatibleMethodOverride = true
reportIncompatibleVariableOverride = false  # Incompatible with eqx.AbstractVar
reportFunctionMemberAccess = false
stubPath = "stubs"
include = ["lerax/**", "examples/**", "tests/**"]

[tool.pytest]
addopts = ["--cov=lerax", "--import-mode=importlib", "-Werror"]
testpaths = ["tests"]

[tool.ruff]
exclude = ["stubs"]

[tool.ruff.lint]
fixable = ["I001", "F401"]
ignore = ["E402", "E721", "E731", "E741", "F722", "E501"]
select = ["E", "F", "I001"]

[[tool.uv.index]]
name = "testpypi"
url = "https://test.pypi.org/simple/"
publish-url = "https://test.pypi.org/legacy/"
explicit = true
